{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"WitFoo Analytics Documentation","text":"<p>Welcome to the official documentation for WitFoo Analytics \u2014 a security operations platform that transforms raw security data into actionable intelligence.</p>"},{"location":"#platform-overview","title":"Platform Overview","text":"<p>WitFoo Analytics ingests security artifacts from your infrastructure, correlates them into incidents, and provides comprehensive reporting, compliance tracking, and threat intelligence capabilities.</p> <ul> <li> <p> Signals</p> <p>Search, classify, and enrich security artifacts with lead rules and automated classification.</p> <p> User Guide</p> </li> <li> <p> Graph</p> <p>Visualize relationships between network nodes and edges for threat mapping and asset management.</p> <p> User Guide</p> </li> <li> <p> Observer</p> <p>Monitor work units, collections, and observations with customizable MO definitions.</p> <p> User Guide</p> </li> <li> <p> Reporter</p> <p>Executive summaries, compliance readiness, tool effectiveness analysis, and cost/savings reports.</p> <p> User Guide</p> </li> <li> <p> CyberGrid</p> <p>Subscribe to and publish threat intelligence feeds across organizations.</p> <p> User Guide</p> </li> <li> <p> Health</p> <p>Monitor container health, system resources, and configure alerting thresholds.</p> <p> User Guide</p> </li> </ul>"},{"location":"#quick-links","title":"Quick Links","text":"Resource Description Getting Started Installation, first login, and architecture overview Admin Guide User management, roles, permissions, and system settings API Reference REST API documentation for 150+ endpoints AI &amp; MCP AI assistant configuration and MCP server integration Deployment Docker Compose, WFA, TLS, and monitoring setup Conductor Integrations Setup guides for 39 supported security tool integrations Reference Permissions matrix, environment variables, and schema"},{"location":"#witfoo-resources","title":"WitFoo Resources","text":"Resource Access Notes Documentation Open All WitFoo Product, API, MCP, and User Documentation Discussions GitHub Account Public conversations on WitFoo Products Downloads Open Download or Launch WitFoo Appliances Release Notes Open WitFoo product release notes and changelogs Demo Open Live demo of WitFoo Analytics Platform Open Ticket Open Open a (private) ticket with the WitFoo team. Can be product or business related. Training Free Registration (click Sign Up) Official WitFoo training courses for users, engineers, and partners. Includes WitFoo Certifications (upon passing exams.) LinkedIn Open Public Updates and Social Engagement Videos Open WitFoo Public videos (training and marketing) WWW Open WitFoo official website"},{"location":"admin-guide/","title":"Administration Guide","text":"<p>The WitFoo Analytics Administration Guide covers the configuration and management of your WitFoo Analytics v0.9.1 deployment. This guide is intended for system administrators responsible for user access, platform settings, and service operations.</p>"},{"location":"admin-guide/#whats-covered","title":"What's Covered","text":"<p>This guide is organized into the following sections:</p> Section Description User Management Create, edit, disable, and delete user accounts Roles Predefined system roles and custom role creation Permissions 93 permissions across 17 categories with inclusion rules Settings Platform-wide configuration options Business Metrics FTE count, costs, revenue, and investigation time Frameworks Compliance framework selection and synchronization Authentication LDAP, SAML, and local authentication configuration Notifications Email, Slack, and webhook notification channels Certificates TLS certificate upload and hot-reload Conductor Conductor service administration"},{"location":"admin-guide/#access-requirements","title":"Access Requirements","text":"<p>All administrative functions require appropriate permissions. At minimum, you need one of the following:</p> <ul> <li><code>admin</code> \u2014 Full access to all administrative functions</li> <li><code>users:write</code> \u2014 User account management</li> <li><code>roles:write</code> \u2014 Role and permission management</li> <li><code>settings:write</code> \u2014 Platform settings modification</li> </ul> <p>Production Warning</p> <p>Administrative changes take effect immediately. Role and permission modifications propagate on the user's next login due to JWT token caching. To force immediate propagation, disable and re-enable the affected user account.</p>"},{"location":"admin-guide/#architecture-overview","title":"Architecture Overview","text":"<p>WitFoo Analytics enforces access control at two layers:</p> <ol> <li>Backend (Go) \u2014 JWT middleware validates permissions on every API request. Unauthorized requests receive a <code>403 Forbidden</code> response.</li> <li>Frontend (Svelte) \u2014 Permission guards hide UI elements and redirect unauthorized users to <code>/unauthorized</code>.</li> </ol> <p>This defense-in-depth approach ensures that even direct API access is subject to permission enforcement.</p>"},{"location":"admin-guide/#getting-started","title":"Getting Started","text":"<p>If you are setting up a new deployment:</p> <ol> <li>Configure authentication to connect your identity provider</li> <li>Review the predefined roles and create any custom roles your organization needs</li> <li>Create user accounts and assign appropriate roles</li> <li>Configure business metrics for accurate reporting</li> <li>Set up notification channels for alerting</li> <li>Upload TLS certificates for production HTTPS</li> </ol>"},{"location":"admin-guide/conductor/","title":"Conductor Administration","text":"<p>Conductor is the data pipeline management service in WitFoo Analytics. It orchestrates the ingestion, processing, and routing of security data from external sources into the analytics platform.</p>"},{"location":"admin-guide/conductor/#permission-requirements","title":"Permission Requirements","text":"Action Required Permission View Conductor status <code>conductor:read</code> Modify pipeline configuration <code>conductor:write</code> Full Conductor administration <code>conductor:admin</code>"},{"location":"admin-guide/conductor/#navigating-to-conductor","title":"Navigating to Conductor","text":"<ol> <li>Click Admin in the top navigation bar</li> <li>Select Conductor from the dropdown</li> </ol> <p>Alternatively, users with <code>conductor:read</code> permission can access the Conductor UI directly at <code>/conductor</code>.</p>"},{"location":"admin-guide/conductor/#architecture-overview","title":"Architecture Overview","text":"<p>Conductor manages the flow of data through the WitFoo Analytics pipeline:</p> <pre><code>Data Sources \u2192 Conductor \u2192 Artifact Ingestion \u2192 Graph Processor \u2192 Incident Engine\n</code></pre> <p>Key components:</p> Component Description Pipelines Configured data flows from source to destination Connectors Integrations with external data sources (syslog, API, file) Processors Transformation and enrichment stages Queue NATS-based message queue for reliable delivery"},{"location":"admin-guide/conductor/#pipeline-management","title":"Pipeline Management","text":""},{"location":"admin-guide/conductor/#viewing-pipelines","title":"Viewing Pipelines","text":"<p>The Conductor dashboard displays all configured pipelines with their current status:</p> Status Description Running Pipeline is actively processing data Paused Pipeline is configured but not processing Error Pipeline encountered an error and stopped Disabled Pipeline is administratively disabled"},{"location":"admin-guide/conductor/#creating-a-pipeline","title":"Creating a Pipeline","text":"<p>Required Permission</p> <p>Creating pipelines requires the <code>conductor:write</code> permission.</p> <ol> <li>Navigate to Conductor</li> <li>Click Create Pipeline</li> <li> <p>Configure the pipeline:</p> Field Description Name Descriptive pipeline name Source Data source connector Processors Optional transformation stages Destination Target service (typically Artifact Ingestion) Enabled Start pipeline immediately after creation </li> <li> <p>Click Save</p> </li> </ol>"},{"location":"admin-guide/conductor/#pausing-and-resuming-pipelines","title":"Pausing and Resuming Pipelines","text":"<ol> <li>Navigate to Conductor</li> <li>Locate the pipeline in the list</li> <li>Click Pause or Resume</li> </ol> <p>Pausing a pipeline stops data processing but preserves the configuration. Queued messages are retained and processed when the pipeline is resumed.</p>"},{"location":"admin-guide/conductor/#deleting-a-pipeline","title":"Deleting a Pipeline","text":"<p>Production Warning</p> <p>Deleting a pipeline permanently removes its configuration. Any data currently in the pipeline's queue will be lost. Consider pausing the pipeline instead.</p> <ol> <li>Navigate to Conductor</li> <li>Locate the pipeline and click Delete</li> <li>Confirm the deletion</li> </ol>"},{"location":"admin-guide/conductor/#monitoring","title":"Monitoring","text":""},{"location":"admin-guide/conductor/#pipeline-health","title":"Pipeline Health","text":"<p>The Conductor dashboard displays real-time metrics for each pipeline:</p> Metric Description Messages/sec Current throughput rate Queue Depth Number of messages waiting to be processed Error Rate Percentage of messages that failed processing Last Activity Timestamp of the last processed message"},{"location":"admin-guide/conductor/#queue-monitoring","title":"Queue Monitoring","text":"<p>Monitor the NATS message queue for backpressure and delivery issues:</p> <ol> <li>Navigate to Conductor \u2192 Queue</li> <li>Review queue depth and consumer lag for each pipeline</li> </ol> <p>Warning</p> <p>A consistently growing queue depth indicates that the processing pipeline cannot keep up with the incoming data rate. Consider scaling the Graph Processor worker count (<code>WORKER_COUNT</code> environment variable) or adding additional processing capacity.</p>"},{"location":"admin-guide/conductor/#logs","title":"Logs","text":"<p>View Conductor service logs for troubleshooting:</p> <pre><code>docker logs witfoo-analytics-conductor 2&gt;&amp;1 | tail -100\n</code></pre> <p>Filter for errors:</p> <pre><code>docker logs witfoo-analytics-conductor 2&gt;&amp;1 | grep -i \"error\\|fatal\\|panic\"\n</code></pre>"},{"location":"admin-guide/conductor/#conductor-registration","title":"Conductor Registration","text":"<p>In multi-tenant deployments, Conductor instances must be registered with the platform.</p>"},{"location":"admin-guide/conductor/#registration-process","title":"Registration Process","text":"<ol> <li>A Conductor instance starts and sends a registration request to the platform</li> <li>A platform administrator with <code>platform:conductor:admin</code> permission reviews the request</li> <li>The administrator approves or rejects the registration</li> <li>Approved Conductor instances can begin processing data for their assigned tenant</li> </ol>"},{"location":"admin-guide/conductor/#approving-registrations","title":"Approving Registrations","text":"<ol> <li>Navigate to Admin \u2192 Platform \u2192 Conductor Registrations</li> <li>Review pending registration requests</li> <li>Verify the Conductor instance details (hostname, tenant, version)</li> <li>Click Approve or Reject</li> </ol>"},{"location":"admin-guide/conductor/#configuration","title":"Configuration","text":"<p>Conductor service configuration is managed via environment variables:</p> Variable Default Description <code>PORT</code> <code>8085</code> Conductor HTTP server port <code>NATS_URL</code> <code>nats://localhost:4222</code> NATS server connection URL <code>CASSANDRA_HOSTS</code> <code>localhost</code> Cassandra cluster hosts <code>CASSANDRA_KEYSPACE</code> <code>analytics_v2</code> Cassandra keyspace <code>LOG_LEVEL</code> <code>INFO</code> Logging level"},{"location":"admin-guide/conductor/#troubleshooting","title":"Troubleshooting","text":""},{"location":"admin-guide/conductor/#pipeline-stuck-in-error-state","title":"Pipeline stuck in Error state","text":"<ol> <li>Check the pipeline error message in the Conductor UI</li> <li>Review Conductor logs for detailed error information</li> <li>Verify the data source is accessible and responding</li> <li>Fix the underlying issue and click Restart on the pipeline</li> </ol>"},{"location":"admin-guide/conductor/#high-queue-depth","title":"High queue depth","text":"<ol> <li>Check the Graph Processor service health</li> <li>Verify Cassandra cluster performance</li> <li>Consider increasing <code>WORKER_COUNT</code> on the Graph Processor service</li> <li>Check for network connectivity issues between services</li> </ol>"},{"location":"admin-guide/conductor/#conductor-not-connecting-to-nats","title":"Conductor not connecting to NATS","text":"<ol> <li>Verify the <code>NATS_URL</code> environment variable is correct</li> <li>Check that the NATS service is running: <code>docker ps | grep nats</code></li> <li>Test NATS connectivity: <code>docker exec witfoo-analytics-conductor nc -zv nats 4222</code></li> <li>Review NATS logs: <code>docker logs witfoo-analytics-nats</code></li> </ol>"},{"location":"admin-guide/permissions/","title":"Permissions","text":"<p>WitFoo Analytics uses a hierarchical Role-Based Access Control (RBAC) system with 93 fine-grained permissions organized into 17 categories. Permissions are enforced at both the backend API layer and the frontend UI layer.</p>"},{"location":"admin-guide/permissions/#permission-inclusion-rules","title":"Permission Inclusion Rules","text":"<p>WitFoo Analytics uses implicit permission inclusion to simplify role configuration:</p>"},{"location":"admin-guide/permissions/#rule-1-admin-grants-all","title":"Rule 1: Admin Grants All","text":"<p>The <code>admin</code> permission automatically grants all 93 permissions in the platform. Users with the Admin role have unrestricted access.</p>"},{"location":"admin-guide/permissions/#rule-2-manage-grants-all-resource-permissions","title":"Rule 2: Manage Grants All Resource Permissions","text":"<p>A <code>resource:manage</code> permission grants all other permissions for that resource:</p> <pre><code>signals:manage \u2192 signals:read, signals:write, signals:delete, signals:export\n</code></pre>"},{"location":"admin-guide/permissions/#rule-3-write-grants-read","title":"Rule 3: Write Grants Read","text":"<p>A <code>resource:write</code> permission automatically includes <code>resource:read</code>:</p> <pre><code>signals:write \u2192 signals:read\n</code></pre> <p>Tip</p> <p>When configuring custom roles, you don't need to explicitly add <code>read</code> permissions if you've already granted <code>write</code> or <code>manage</code> for the same resource.</p>"},{"location":"admin-guide/permissions/#permission-catalog","title":"Permission Catalog","text":""},{"location":"admin-guide/permissions/#signals-5-permissions","title":"Signals (5 permissions)","text":"Permission Description <code>signals:read</code> View signals page and search results <code>signals:write</code> Create and modify signal data <code>signals:delete</code> Delete signal records <code>signals:export</code> Export signal data to CSV/JSON <code>signals:manage</code> All signal operations"},{"location":"admin-guide/permissions/#graph-nodes-5-permissions","title":"Graph \u2014 Nodes (5 permissions)","text":"Permission Description <code>nodes:read</code> View graph nodes <code>nodes:write</code> Create and modify graph nodes <code>nodes:delete</code> Delete graph nodes <code>nodes:export</code> Export node data <code>nodes:manage</code> All node operations"},{"location":"admin-guide/permissions/#graph-edges-5-permissions","title":"Graph \u2014 Edges (5 permissions)","text":"Permission Description <code>edges:read</code> View graph edges <code>edges:write</code> Create and modify graph edges <code>edges:delete</code> Delete graph edges <code>edges:export</code> Export edge data <code>edges:manage</code> All edge operations"},{"location":"admin-guide/permissions/#work-units-5-permissions","title":"Work Units (5 permissions)","text":"Permission Description <code>work_units:read</code> View work units and incidents <code>work_units:write</code> Modify work unit status and assignments <code>work_units:delete</code> Delete work units <code>work_units:export</code> Export work unit data <code>work_units:manage</code> All work unit operations"},{"location":"admin-guide/permissions/#observer-10-permissions","title":"Observer (10 permissions)","text":"Permission Description <code>work_definitions:read</code> View MO definitions <code>work_definitions:write</code> Create and modify MO definitions <code>work_definitions:delete</code> Delete MO definitions <code>work_definitions:manage</code> All work definition operations <code>observations:read</code> View observations <code>observations:write</code> Create and modify observations <code>observations:delete</code> Delete observations <code>observations:manage</code> All observation operations <code>collections:read</code> View work collections <code>collections:write</code> Create and modify work collections"},{"location":"admin-guide/permissions/#reporter-7-permissions","title":"Reporter (7 permissions)","text":"Permission Description <code>reports:read</code> View all reporter dashboards <code>reports:write</code> Modify report parameters <code>reports:generate</code> Generate new reports on demand <code>reports:export</code> Export reports to PDF/CSV <code>frameworks:read</code> View compliance frameworks <code>frameworks:write</code> Modify framework assignments <code>frameworks:manage</code> Full framework administration"},{"location":"admin-guide/permissions/#cybergrid-8-permissions","title":"CyberGrid (8 permissions)","text":"Permission Description <code>cybergrid:publications:read</code> View publications <code>cybergrid:publications:write</code> Create and modify publications <code>cybergrid:subscriptions:read</code> View subscriptions <code>cybergrid:subscriptions:write</code> Create and modify subscriptions <code>cybergrid:jobs:approve</code> Approve or reject pending jobs <code>cybergrid:library:write</code> Submit IOCs to threat intelligence library <code>cybergrid:queue:monitor</code> View queue statistics and health <code>cybergrid:manage</code> Full CyberGrid administration"},{"location":"admin-guide/permissions/#settings-5-permissions","title":"Settings (5 permissions)","text":"Permission Description <code>settings:read</code> View business settings <code>settings:write</code> Modify business settings <code>settings:products:read</code> View product catalog and costs <code>settings:products:write</code> Modify product costs <code>settings:manage</code> All settings operations"},{"location":"admin-guide/permissions/#administration-5-permissions","title":"Administration (5 permissions)","text":"Permission Description <code>users:read</code> View user accounts <code>users:write</code> Create and modify user accounts <code>roles:read</code> View roles and permissions <code>roles:write</code> Create and modify roles <code>admin</code> Global administrator \u2014 grants all permissions"},{"location":"admin-guide/permissions/#health-dashboard-4-permissions","title":"Health Dashboard (4 permissions)","text":"Permission Description <code>health:read</code> View health dashboards and container status <code>health:manage</code> Manage health alert configurations <code>metrics:read</code> Access Prometheus <code>/metrics</code> endpoint <code>metrics:export</code> Export historical metrics data"},{"location":"admin-guide/permissions/#ai-assistant-4-permissions","title":"AI Assistant (4 permissions)","text":"Permission Description <code>ai:read</code> View AI features and use chat assistant <code>ai:write</code> Send messages and create chat sessions <code>ai:manage</code> Configure AI providers, API keys, and MCP settings <code>ai:export</code> Export chat history and conversations"},{"location":"admin-guide/permissions/#conductor-3-permissions","title":"Conductor (3 permissions)","text":"Permission Description <code>conductor:read</code> View Conductor UI and pipeline status <code>conductor:write</code> Modify pipeline configuration <code>conductor:admin</code> Full Conductor administration"},{"location":"admin-guide/permissions/#dashboards-4-permissions","title":"Dashboards (4 permissions)","text":"Permission Description <code>dashboards:read</code> View custom dashboards <code>dashboards:write</code> Create and modify custom dashboards <code>dashboards:delete</code> Delete custom dashboards <code>dashboards:manage</code> All dashboard operations"},{"location":"admin-guide/permissions/#playbooks-4-permissions","title":"Playbooks (4 permissions)","text":"Permission Description <code>playbooks:read</code> View playbook definitions and execution history <code>playbooks:write</code> Create and modify playbook definitions <code>playbooks:delete</code> Delete playbook definitions <code>playbooks:manage</code> All playbook operations"},{"location":"admin-guide/permissions/#tasks-4-permissions","title":"Tasks (4 permissions)","text":"Permission Description <code>tasks:read</code> View task work items <code>tasks:write</code> Create and modify task work items <code>tasks:delete</code> Delete task work items <code>tasks:manage</code> All task operations"},{"location":"admin-guide/permissions/#responders-4-permissions","title":"Responders (4 permissions)","text":"Permission Description <code>responders:read</code> View responder job definitions and execution history <code>responders:write</code> Create and modify responder job definitions <code>responders:delete</code> Delete responder job definitions <code>responders:manage</code> All responder operations"},{"location":"admin-guide/permissions/#platform-administration-6-permissions","title":"Platform Administration (6 permissions)","text":"Permission Description <code>platform:read</code> View platform dashboards and tenant listings <code>platform:write</code> Create and modify tenant configurations <code>platform:manage</code> Full platform administration <code>platform:conductor:admin</code> Approve/reject Conductor registrations across tenants <code>platform:users:admin</code> Manage users across all tenants <code>platform:switch</code> Switch active tenant context"},{"location":"admin-guide/permissions/#auditor-5-permissions","title":"Auditor (5 permissions)","text":"Permission Description <code>auditor:read</code> View audit findings, runs, and check definitions <code>auditor:write</code> Create and modify connector configurations <code>auditor:delete</code> Delete connector configurations <code>auditor:execute</code> Trigger audit runs and test connections <code>auditor:manage</code> All auditor operations"},{"location":"admin-guide/permissions/#enforcement","title":"Enforcement","text":"<p>Permissions are enforced at two layers:</p> <ul> <li>Backend: The Go API middleware extracts permissions from the JWT token and validates each request. Insufficient permissions result in a <code>403 Forbidden</code> response.</li> <li>Frontend: Svelte components (<code>PermissionGuard</code>, <code>PermissionButton</code>) hide or disable UI elements based on the user's loaded permissions.</li> </ul> <p>Both layers use identical permission expansion logic to ensure consistency.</p>"},{"location":"admin-guide/permissions/#troubleshooting","title":"Troubleshooting","text":""},{"location":"admin-guide/permissions/#permission-changes-not-taking-effect","title":"Permission changes not taking effect","text":"<p>Permissions are embedded in the JWT token at login. Users must log out and log back in to receive updated permissions. Alternatively, disable and re-enable the user account to force token invalidation.</p>"},{"location":"admin-guide/permissions/#verifying-a-users-active-permissions","title":"Verifying a user's active permissions","text":"<p>Check the browser developer console:</p> <pre><code>JSON.parse(localStorage.getItem('permissions'))\n</code></pre> <p>Check backend logs for permission denials:</p> <pre><code>docker logs witfoo-analytics-incident-engine 2&gt;&amp;1 | grep \"403\\|permission denied\"\n</code></pre>"},{"location":"admin-guide/roles/","title":"Roles","text":"<p>Roles in WitFoo Analytics define a collection of permissions that determine what a user can see and do within the platform. WitFoo Analytics ships with 8 predefined system roles and supports the creation of custom roles for organization-specific needs.</p>"},{"location":"admin-guide/roles/#permission-requirements","title":"Permission Requirements","text":"Action Required Permission View roles <code>roles:read</code> Create custom role <code>roles:write</code> Edit custom role <code>roles:write</code> Delete custom role <code>roles:write</code>"},{"location":"admin-guide/roles/#predefined-system-roles","title":"Predefined System Roles","text":"<p>WitFoo Analytics includes 8 system roles that cannot be modified or deleted:</p>"},{"location":"admin-guide/roles/#admin","title":"Admin","text":"<p>Full system access. The <code>admin</code> permission implicitly grants all 93 permissions in the platform.</p> <p>Intended for: Platform administrators, senior security engineers</p>"},{"location":"admin-guide/roles/#analyst","title":"Analyst","text":"<p>Read-only access to all operational data including signals, nodes, edges, work units, reports, frameworks, and settings.</p> <p>Intended for: SOC analysts, security investigators</p> <p>Key permissions: <code>signals:read</code>, <code>nodes:read</code>, <code>edges:read</code>, <code>work_units:read</code>, <code>reports:read</code>, <code>frameworks:read</code>, <code>settings:read</code>, <code>cybergrid:publications:read</code></p>"},{"location":"admin-guide/roles/#readonly","title":"ReadOnly","text":"<p>Identical to Analyst. Maintained for backward compatibility.</p>"},{"location":"admin-guide/roles/#report-viewer","title":"Report Viewer","text":"<p>View and export reports and compliance frameworks.</p> <p>Intended for: Management, compliance stakeholders</p> <p>Key permissions: <code>reports:read</code>, <code>reports:export</code>, <code>frameworks:read</code></p>"},{"location":"admin-guide/roles/#report-admin","title":"Report Admin","text":"<p>Full administration of the Reporter module including report generation, framework management, and business settings.</p> <p>Intended for: Compliance officers, report administrators</p> <p>Key permissions: <code>reports:read</code>, <code>reports:write</code>, <code>reports:generate</code>, <code>reports:export</code>, <code>frameworks:read</code>, <code>frameworks:write</code>, <code>frameworks:manage</code>, <code>settings:read</code>, <code>settings:write</code>, <code>settings:products:read</code>, <code>settings:products:write</code></p>"},{"location":"admin-guide/roles/#cybergrid-viewer","title":"CyberGrid Viewer","text":"<p>Read-only access to CyberGrid publications, subscriptions, and queue monitoring.</p> <p>Intended for: Threat intelligence consumers</p> <p>Key permissions: <code>cybergrid:publications:read</code>, <code>cybergrid:subscriptions:read</code>, <code>cybergrid:queue:monitor</code></p>"},{"location":"admin-guide/roles/#cybergrid-admin","title":"CyberGrid Admin","text":"<p>Full CyberGrid administration including publication management, subscription configuration, and job approval.</p> <p>Intended for: Threat intelligence team leads</p> <p>Key permissions: <code>cybergrid:manage</code> (includes all CyberGrid permissions)</p>"},{"location":"admin-guide/roles/#framework-manager","title":"Framework Manager","text":"<p>Compliance framework administration with report viewing and settings access.</p> <p>Intended for: Compliance managers, auditors</p> <p>Key permissions: <code>frameworks:read</code>, <code>frameworks:write</code>, <code>frameworks:manage</code>, <code>reports:read</code>, <code>settings:read</code>, <code>settings:write</code></p>"},{"location":"admin-guide/roles/#role-comparison-matrix","title":"Role Comparison Matrix","text":"Permission Admin Analyst Report Viewer Report Admin CG Viewer CG Admin Framework Mgr <code>admin</code> \u2713 <code>signals:read</code> \u2713 \u2713 <code>nodes:read</code> \u2713 \u2713 <code>reports:read</code> \u2713 \u2713 \u2713 \u2713 \u2713 <code>reports:export</code> \u2713 \u2713 \u2713 <code>reports:generate</code> \u2713 \u2713 <code>frameworks:read</code> \u2713 \u2713 \u2713 \u2713 \u2713 <code>frameworks:manage</code> \u2713 \u2713 \u2713 <code>cybergrid:publications:read</code> \u2713 \u2713 \u2713 \u2713 <code>cybergrid:manage</code> \u2713 \u2713 <code>settings:read</code> \u2713 \u2713 \u2713 \u2713 <code>settings:write</code> \u2713 \u2713 \u2713 <p>Info</p> <p>System roles are read-only. They cannot be edited or deleted through the UI or API.</p>"},{"location":"admin-guide/roles/#creating-custom-roles","title":"Creating Custom Roles","text":"<p>Custom roles allow you to tailor access to your organization's team structure.</p>"},{"location":"admin-guide/roles/#steps","title":"Steps","text":"<ol> <li>Navigate to Admin \u2192 Roles</li> <li>Click Create Role</li> <li>Enter a Name (e.g., \"SOC Tier 1\", \"Compliance Officer\")</li> <li>Enter a Description explaining the role's purpose</li> <li>Expand permission categories and select the required permissions</li> <li>Review the permission count and verify inclusions</li> <li>Click Create Role</li> </ol>"},{"location":"admin-guide/roles/#example-custom-roles","title":"Example Custom Roles","text":"<p>SOC Tier 1 Analyst</p> <ul> <li>Purpose: Junior analysts performing initial signal triage</li> <li>Permissions: <code>signals:read</code>, <code>nodes:read</code>, <code>work_units:read</code>, <code>work_units:write</code></li> </ul> <p>Integration Engineer</p> <ul> <li>Purpose: Engineers configuring data pipelines and integrations</li> <li>Permissions: <code>settings:read</code>, <code>settings:write</code>, <code>conductor:read</code>, <code>conductor:write</code></li> </ul> <p>Compliance Officer</p> <ul> <li>Purpose: Track framework compliance and generate audit reports</li> <li>Permissions: <code>reports:read</code>, <code>reports:export</code>, <code>frameworks:read</code>, <code>auditor:read</code></li> </ul>"},{"location":"admin-guide/roles/#best-practices","title":"Best Practices","text":"<ul> <li>Least privilege: Grant only the permissions required for the job function</li> <li>Descriptive names: Use role titles familiar to your organization</li> <li>Document purpose: Always fill in the description field</li> <li>Test before deploying: Create a test user to verify the role works as expected</li> <li>Review quarterly: Audit role permissions as team responsibilities evolve</li> </ul>"},{"location":"admin-guide/roles/#editing-custom-roles","title":"Editing Custom Roles","text":"<ol> <li>Navigate to Admin \u2192 Roles</li> <li>Click the Edit icon next to the custom role</li> <li>Modify the name, description, or permissions</li> <li>Click Save</li> </ol> <p>Warning</p> <p>Changes to a role affect all users assigned to that role. Updated permissions take effect on each user's next login.</p>"},{"location":"admin-guide/roles/#deleting-custom-roles","title":"Deleting Custom Roles","text":"<ol> <li>Navigate to Admin \u2192 Roles</li> <li>Click the Delete icon next to the custom role</li> <li>Confirm the deletion</li> </ol> <p>Production Warning</p> <p>Deleting a role removes it from all assigned users. Ensure affected users are reassigned to another role before deletion.</p>"},{"location":"admin-guide/users/","title":"User Management","text":"<p>User management in WitFoo Analytics allows administrators to create, modify, disable, and delete user accounts. Each user is assigned one or more roles that determine their access to platform features.</p>"},{"location":"admin-guide/users/#permission-requirements","title":"Permission Requirements","text":"Action Required Permission View user list <code>users:read</code> Create user <code>users:write</code> Edit user <code>users:write</code> Disable user <code>users:write</code> Delete user <code>users:write</code> <p>Note</p> <p>The <code>admin</code> permission implicitly grants all user management permissions.</p>"},{"location":"admin-guide/users/#navigating-to-user-management","title":"Navigating to User Management","text":"<ol> <li>Click Admin in the top navigation bar</li> <li>Select Users from the dropdown menu</li> </ol>"},{"location":"admin-guide/users/#creating-a-user","title":"Creating a User","text":"<ol> <li>Navigate to Admin \u2192 Users</li> <li>Click Create User</li> <li> <p>Complete the required fields:</p> Field Description Required Username Unique login identifier Yes Email User's email address Yes Display Name Full name shown in the UI Yes Password Initial password (local auth only) Yes* Role One or more roles to assign Yes <p>*Password is not required when using LDAP or SAML authentication.</p> </li> <li> <p>Select one or more roles from the role dropdown</p> </li> <li>Click Save</li> </ol> <p>Tip</p> <p>When using external authentication (LDAP/SAML), user accounts are provisioned automatically on first login. You only need to pre-create accounts if you want to assign roles before the user's first login.</p>"},{"location":"admin-guide/users/#editing-a-user","title":"Editing a User","text":"<ol> <li>Navigate to Admin \u2192 Users</li> <li>Locate the user in the list and click the Edit icon</li> <li>Modify the desired fields:<ul> <li>Display name</li> <li>Email address</li> <li>Role assignments</li> </ul> </li> <li>Click Save</li> </ol> <p>Warning</p> <p>Changing a user's roles does not take effect until the user's next login. JWT tokens contain the user's permissions and are valid for 24 hours.</p>"},{"location":"admin-guide/users/#disabling-a-user","title":"Disabling a User","text":"<p>Disabling a user prevents login without deleting the account or its associated data.</p> <ol> <li>Navigate to Admin \u2192 Users</li> <li>Locate the user and click the Edit icon</li> <li>Toggle the Enabled switch to off</li> <li>Click Save</li> </ol> <p>Disabled users:</p> <ul> <li>Cannot log in to the platform</li> <li>Cannot authenticate via API</li> <li>Retain all historical data and audit trails</li> <li>Can be re-enabled at any time</li> </ul> <p>Tip</p> <p>Disabling and re-enabling a user forces token invalidation, which is useful when you need permission changes to take effect immediately.</p>"},{"location":"admin-guide/users/#deleting-a-user","title":"Deleting a User","text":"<p>Production Warning</p> <p>User deletion is permanent and cannot be undone. Consider disabling the account instead if you may need to restore access later.</p> <ol> <li>Navigate to Admin \u2192 Users</li> <li>Locate the user and click the Delete icon</li> <li>Confirm the deletion in the dialog</li> </ol> <p>Deleted users:</p> <ul> <li>Are permanently removed from the system</li> <li>Lose all role assignments</li> <li>Historical audit log entries referencing the user are preserved</li> </ul>"},{"location":"admin-guide/users/#forcing-permission-updates","title":"Forcing Permission Updates","text":"<p>Permission changes (role assignment modifications) are stored in the JWT token issued at login. To force a user to receive updated permissions:</p> <ol> <li>Ask the user to log out and log back in, or</li> <li>Disable and re-enable the user account to invalidate their current token</li> </ol>"},{"location":"admin-guide/users/#bulk-operations","title":"Bulk Operations","text":"<p>Currently, user management operations are performed individually. For bulk provisioning, use the WitFoo Analytics API:</p> <pre><code>curl -X POST https://your-instance/api/v1/users \\\n  -H \"Authorization: Bearer $ADMIN_TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"username\":\"jdoe\",\"email\":\"jdoe@example.com\",\"displayName\":\"Jane Doe\",\"roleIds\":[\"analyst\"]}'\n</code></pre>"},{"location":"admin-guide/users/#troubleshooting","title":"Troubleshooting","text":""},{"location":"admin-guide/users/#user-cannot-log-in-after-role-change","title":"User cannot log in after role change","text":"<p>Permissions are cached in the JWT token. The user must log out and log back in, or an administrator can disable and re-enable the account.</p>"},{"location":"admin-guide/users/#user-sees-unauthorized-on-pages-they-should-access","title":"User sees \"Unauthorized\" on pages they should access","text":"<ol> <li>Verify the user's assigned role in Admin \u2192 Users</li> <li>Check that the role includes the required permissions in Admin \u2192 Roles</li> <li>Ensure the user has logged in after the role change</li> </ol>"},{"location":"admin-guide/users/#ldapsaml-user-not-appearing-in-user-list","title":"LDAP/SAML user not appearing in user list","text":"<p>External users are created on first login. If the user has not yet authenticated, their account will not exist in WitFoo Analytics.</p>"},{"location":"admin-guide/settings/","title":"Settings Overview","text":"<p>The Settings section of WitFoo Analytics allows administrators to configure platform-wide options that affect reporting, authentication, notifications, and security.</p>"},{"location":"admin-guide/settings/#permission-requirements","title":"Permission Requirements","text":"Action Required Permission View settings <code>settings:read</code> Modify settings <code>settings:write</code> Full settings administration <code>settings:manage</code>"},{"location":"admin-guide/settings/#navigating-to-settings","title":"Navigating to Settings","text":"<ol> <li>Click Admin in the top navigation bar</li> <li>Select Settings from the dropdown menu</li> </ol>"},{"location":"admin-guide/settings/#settings-sections","title":"Settings Sections","text":""},{"location":"admin-guide/settings/#business-metrics","title":"Business Metrics","text":"<p>Configure the financial and operational parameters used in WitFoo Analytics reporting dashboards. This includes FTE (Full-Time Equivalent) counts, labor costs, revenue figures, and average investigation time.</p> <p> Business Metrics</p>"},{"location":"admin-guide/settings/#compliance-frameworks","title":"Compliance Frameworks","text":"<p>Select and manage the compliance frameworks (e.g., NIST CSF, CIS Controls, MITRE ATT&amp;CK) that drive your organization's security posture reporting.</p> <p> Frameworks</p>"},{"location":"admin-guide/settings/#authentication","title":"Authentication","text":"<p>Configure how users authenticate to WitFoo Analytics, including local authentication, LDAP directory integration, and SAML single sign-on.</p> <p> Authentication</p>"},{"location":"admin-guide/settings/#notifications","title":"Notifications","text":"<p>Set up notification channels (email, Slack, webhooks) and define rules for when alerts and notifications are sent.</p> <p> Notifications</p>"},{"location":"admin-guide/settings/#certificates","title":"Certificates","text":"<p>Upload and manage TLS certificates for HTTPS access to the WitFoo Analytics platform.</p> <p> Certificates</p>"},{"location":"admin-guide/settings/#settings-and-permissions","title":"Settings and Permissions","text":"<p>Settings modifications require the <code>settings:write</code> permission. The <code>settings:manage</code> permission grants full access to all settings operations, including product catalog management.</p> <p>Info</p> <p>Changes to business metrics and framework selections affect report calculations across the entire platform. Coordinate with stakeholders before modifying these values.</p>"},{"location":"admin-guide/settings/#environment-variables","title":"Environment Variables","text":"<p>Some platform settings are configured via environment variables rather than the UI. See the table below for key configuration options:</p> Variable Default Description <code>JWT_SECRET</code> (none) JWT signing key \u2014 required in production <code>CORS_ORIGINS</code> <code>*</code> Allowed CORS origins <code>LOG_LEVEL</code> <code>INFO</code> Logging level (DEBUG, INFO, WARN, ERROR) <code>ENVIRONMENT</code> <code>development</code> Environment identifier <p>Production Warning</p> <p>Always set <code>JWT_SECRET</code> to a strong, unique value (minimum 32 characters) in production environments. Never use the default development secret.</p>"},{"location":"admin-guide/settings/authentication/","title":"Authentication","text":"<p>WitFoo Analytics supports three authentication methods: local authentication, LDAP directory integration, and SAML 2.0 single sign-on. You can configure one or more methods simultaneously.</p>"},{"location":"admin-guide/settings/authentication/#permission-requirements","title":"Permission Requirements","text":"Action Required Permission View authentication settings <code>settings:read</code> Modify authentication settings <code>settings:manage</code> <p>Production Warning</p> <p>Misconfiguring authentication can lock all users out of the platform. Always test configuration changes with a secondary admin account before applying them to the primary authentication method.</p>"},{"location":"admin-guide/settings/authentication/#navigating-to-authentication-settings","title":"Navigating to Authentication Settings","text":"<ol> <li>Click Admin in the top navigation bar</li> <li>Select Settings from the dropdown</li> <li>Click the Authentication tab</li> </ol>"},{"location":"admin-guide/settings/authentication/#local-authentication","title":"Local Authentication","text":"<p>Local authentication stores user credentials directly in the WitFoo Analytics database. This is the default authentication method and is always available as a fallback.</p>"},{"location":"admin-guide/settings/authentication/#configuration","title":"Configuration","text":"Setting Description Default Enabled Enable/disable local authentication Enabled Minimum Password Length Minimum characters required 12 Require Uppercase Require at least one uppercase letter Yes Require Number Require at least one numeric digit Yes Require Special Character Require at least one special character Yes Password Expiry (days) Days before password must be changed (0 = never) 90 Max Login Attempts Failed attempts before account lockout 5 Lockout Duration (minutes) Minutes before locked account is automatically unlocked 30"},{"location":"admin-guide/settings/authentication/#configuring-local-authentication","title":"Configuring Local Authentication","text":"<ol> <li>Navigate to Admin \u2192 Settings \u2192 Authentication</li> <li>Expand the Local Authentication section</li> <li>Adjust password policy settings as needed</li> <li>Click Save</li> </ol>"},{"location":"admin-guide/settings/authentication/#ldap-authentication","title":"LDAP Authentication","text":"<p>LDAP integration allows users to authenticate with their existing directory credentials (Active Directory, OpenLDAP, etc.).</p>"},{"location":"admin-guide/settings/authentication/#configuration_1","title":"Configuration","text":"Setting Description Example Enabled Enable LDAP authentication Yes Server URL LDAP server address <code>ldaps://ldap.example.com:636</code> Bind DN Service account distinguished name <code>cn=witfoo,ou=services,dc=example,dc=com</code> Bind Password Service account password (stored encrypted) Search Base Base DN for user searches <code>ou=users,dc=example,dc=com</code> User Filter LDAP filter for user lookup <code>(sAMAccountName={username})</code> Group Base Base DN for group searches <code>ou=groups,dc=example,dc=com</code> Group Filter LDAP filter for group membership <code>(member={dn})</code> TLS Verify Verify server TLS certificate Yes"},{"location":"admin-guide/settings/authentication/#configuring-ldap","title":"Configuring LDAP","text":"<ol> <li>Navigate to Admin \u2192 Settings \u2192 Authentication</li> <li>Expand the LDAP section</li> <li>Toggle Enabled to on</li> <li>Enter the LDAP server URL (use <code>ldaps://</code> for TLS)</li> <li>Enter the bind DN and password for the service account</li> <li>Configure the search base and user filter</li> <li>Optionally configure group-based role mapping</li> <li>Click Test Connection to verify connectivity</li> <li>Click Save</li> </ol> <p>Tip</p> <p>Use <code>ldaps://</code> (LDAP over TLS) in production. If your LDAP server uses a self-signed certificate, upload the CA certificate in the Certificates settings.</p>"},{"location":"admin-guide/settings/authentication/#ldap-group-to-role-mapping","title":"LDAP Group-to-Role Mapping","text":"<p>Map LDAP groups to WitFoo Analytics roles for automatic role assignment:</p> LDAP Group DN WitFoo Role <code>cn=soc-analysts,ou=groups,dc=example,dc=com</code> Analyst <code>cn=soc-admins,ou=groups,dc=example,dc=com</code> Admin <code>cn=compliance,ou=groups,dc=example,dc=com</code> Framework Manager <p>Users are assigned roles based on their LDAP group membership at each login. If a user's group membership changes in the directory, their WitFoo Analytics roles update on next login.</p>"},{"location":"admin-guide/settings/authentication/#saml-20-authentication","title":"SAML 2.0 Authentication","text":"<p>SAML integration enables single sign-on with identity providers such as Okta, Azure AD, OneLogin, and PingFederate.</p>"},{"location":"admin-guide/settings/authentication/#configuration_2","title":"Configuration","text":"Setting Description Example Enabled Enable SAML authentication Yes Entity ID WitFoo Analytics SP entity ID <code>https://witfoo.example.com/saml/metadata</code> SSO URL IdP single sign-on URL <code>https://idp.example.com/sso/saml</code> SLO URL IdP single logout URL (optional) <code>https://idp.example.com/slo/saml</code> Certificate IdP signing certificate (PEM format) (uploaded file) Name ID Format SAML NameID format <code>urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress</code> Attribute Mapping Map SAML attributes to user fields See below"},{"location":"admin-guide/settings/authentication/#configuring-saml","title":"Configuring SAML","text":"<ol> <li>Navigate to Admin \u2192 Settings \u2192 Authentication</li> <li>Expand the SAML section</li> <li>Toggle Enabled to on</li> <li>Enter your IdP's SSO URL and upload the IdP signing certificate</li> <li>Configure attribute mappings for username, email, and display name</li> <li>Download the WitFoo Analytics SP metadata XML to configure your IdP</li> <li>Click Test Connection to initiate a test SAML flow</li> <li>Click Save</li> </ol>"},{"location":"admin-guide/settings/authentication/#saml-attribute-mapping","title":"SAML Attribute Mapping","text":"SAML Attribute WitFoo Field Required <code>NameID</code> or custom attribute Username Yes <code>email</code> Email Yes <code>displayName</code> or <code>cn</code> Display Name No <code>groups</code> or <code>memberOf</code> Role mapping No"},{"location":"admin-guide/settings/authentication/#multiple-authentication-methods","title":"Multiple Authentication Methods","text":"<p>When multiple authentication methods are enabled, the login page displays options for each active method. Users can authenticate via any enabled method.</p> <p>Priority order: SAML \u2192 LDAP \u2192 Local</p> <p>Info</p> <p>Local authentication is recommended as a fallback even when LDAP or SAML is the primary method. This ensures administrator access if the external identity provider is unavailable.</p>"},{"location":"admin-guide/settings/business-metrics/","title":"Business Metrics","text":"<p>Business metrics configure the financial and operational parameters that WitFoo Analytics uses to calculate ROI, cost-per-incident, and other executive reporting metrics. Accurate business metrics are essential for meaningful Reporter dashboards.</p>"},{"location":"admin-guide/settings/business-metrics/#permission-requirements","title":"Permission Requirements","text":"Action Required Permission View business metrics <code>settings:read</code> Modify business metrics <code>settings:write</code> Manage product catalog <code>settings:products:write</code>"},{"location":"admin-guide/settings/business-metrics/#navigating-to-business-metrics","title":"Navigating to Business Metrics","text":"<ol> <li>Click Admin in the top navigation bar</li> <li>Select Settings from the dropdown</li> <li>Click the Business Metrics tab</li> </ol>"},{"location":"admin-guide/settings/business-metrics/#configurable-metrics","title":"Configurable Metrics","text":""},{"location":"admin-guide/settings/business-metrics/#fte-count","title":"FTE Count","text":"<p>The number of Full-Time Equivalent security operations staff.</p> Field Description Example SOC Analysts Number of FTE analysts in the SOC 8 Security Engineers Number of FTE security engineers 4 Management Number of FTE security managers 2 Total FTE Auto-calculated total 14 <p>This value is used to calculate per-analyst workload metrics and staffing efficiency ratios.</p>"},{"location":"admin-guide/settings/business-metrics/#labor-costs","title":"Labor Costs","text":"<p>Annual labor costs for the security operations team.</p> Field Description Example Average Analyst Salary Fully loaded annual cost per analyst $95,000 Average Engineer Salary Fully loaded annual cost per engineer $120,000 Average Manager Salary Fully loaded annual cost per manager $140,000 <p>Tip</p> <p>Use fully loaded costs (salary + benefits + overhead) for the most accurate ROI calculations.</p>"},{"location":"admin-guide/settings/business-metrics/#revenue","title":"Revenue","text":"<p>Organization revenue figures used for security-spend-as-percentage-of-revenue calculations.</p> Field Description Example Annual Revenue Organization's annual revenue $50,000,000 Security Budget Annual security operations budget $2,500,000"},{"location":"admin-guide/settings/business-metrics/#investigation-time","title":"Investigation Time","text":"<p>Average time metrics for security investigations.</p> Field Description Example Mean Time to Detect (MTTD) Average detection time in minutes 15 Mean Time to Respond (MTTR) Average response time in minutes 45 Average Investigation Duration Average total investigation time in minutes 120 <p>These values serve as baseline targets. WitFoo Analytics compares actual investigation times against these baselines in the Reporter dashboards.</p>"},{"location":"admin-guide/settings/business-metrics/#updating-business-metrics","title":"Updating Business Metrics","text":"<ol> <li>Navigate to Admin \u2192 Settings \u2192 Business Metrics</li> <li>Modify the desired fields</li> <li>Click Save</li> </ol> <p>Changes take effect immediately and are reflected in all Reporter dashboards on the next page load or report generation.</p> <p>Warning</p> <p>Modifying business metrics affects all historical report calculations. Reports are recalculated using the current metric values, not the values that were in effect when the data was collected.</p>"},{"location":"admin-guide/settings/business-metrics/#product-catalog","title":"Product Catalog","text":"<p>The product catalog tracks the cost of security tools and services used by your organization. These costs feed into total-cost-of-ownership calculations.</p>"},{"location":"admin-guide/settings/business-metrics/#adding-a-product","title":"Adding a Product","text":"<ol> <li>Navigate to Admin \u2192 Settings \u2192 Business Metrics</li> <li>Scroll to the Product Catalog section</li> <li>Click Add Product</li> <li>Enter the product name, vendor, annual cost, and category</li> <li>Click Save</li> </ol>"},{"location":"admin-guide/settings/business-metrics/#product-categories","title":"Product Categories","text":"<ul> <li>SIEM \u2014 Security Information and Event Management</li> <li>EDR \u2014 Endpoint Detection and Response</li> <li>NDR \u2014 Network Detection and Response</li> <li>SOAR \u2014 Security Orchestration, Automation, and Response</li> <li>Cloud Security \u2014 Cloud-native security tools</li> <li>Identity \u2014 Identity and access management</li> <li>Other \u2014 Miscellaneous security tools</li> </ul> <p>Info</p> <p>Product catalog modifications require the <code>settings:products:write</code> permission, which is separate from the general <code>settings:write</code> permission.</p>"},{"location":"admin-guide/settings/business-metrics/#best-practices","title":"Best Practices","text":"<ul> <li>Update quarterly: Review and update business metrics at least once per quarter</li> <li>Use fully loaded costs: Include benefits, overhead, and training costs in salary figures</li> <li>Coordinate with finance: Align revenue and budget figures with your finance team</li> <li>Document assumptions: Keep a record of the assumptions behind your metric values</li> </ul>"},{"location":"admin-guide/settings/certificates/","title":"TLS Certificates","text":"<p>WitFoo Analytics uses TLS certificates to secure HTTPS connections to the platform. Administrators can upload custom certificates to replace the default self-signed certificate.</p>"},{"location":"admin-guide/settings/certificates/#permission-requirements","title":"Permission Requirements","text":"Action Required Permission View certificate status <code>settings:read</code> Upload certificates <code>settings:manage</code>"},{"location":"admin-guide/settings/certificates/#navigating-to-certificate-settings","title":"Navigating to Certificate Settings","text":"<ol> <li>Click Admin in the top navigation bar</li> <li>Select Settings from the dropdown</li> <li>Click the Certificates tab</li> </ol>"},{"location":"admin-guide/settings/certificates/#certificate-requirements","title":"Certificate Requirements","text":"<p>WitFoo Analytics accepts certificates in the following formats:</p> Component Format File Extension Certificate PEM-encoded X.509 <code>.pem</code>, <code>.crt</code> Private Key PEM-encoded RSA or ECDSA <code>.pem</code>, <code>.key</code> CA Bundle PEM-encoded certificate chain <code>.pem</code>, <code>.crt</code>"},{"location":"admin-guide/settings/certificates/#requirements","title":"Requirements","text":"<ul> <li>The certificate must match the private key</li> <li>The certificate's Common Name (CN) or Subject Alternative Name (SAN) must match the hostname used to access WitFoo Analytics</li> <li>The certificate must not be expired</li> <li>If using an intermediate CA, include the full certificate chain in the CA bundle</li> </ul>"},{"location":"admin-guide/settings/certificates/#uploading-a-certificate","title":"Uploading a Certificate","text":"<ol> <li>Navigate to Admin \u2192 Settings \u2192 Certificates</li> <li>Click Upload Certificate</li> <li>Select or drag-and-drop the following files:<ul> <li>Certificate file (<code>.pem</code> or <code>.crt</code>)</li> <li>Private key file (<code>.pem</code> or <code>.key</code>)</li> <li>CA bundle (optional, <code>.pem</code> or <code>.crt</code>)</li> </ul> </li> <li>Click Validate to verify the certificate</li> <li>Review the certificate details:<ul> <li>Subject (CN/SAN)</li> <li>Issuer</li> <li>Valid from / Valid to</li> <li>Key type and size</li> </ul> </li> <li>Click Apply</li> </ol> <p>Production Warning</p> <p>Applying a certificate immediately restarts the TLS listener. Active connections will be briefly interrupted. Schedule certificate changes during a maintenance window.</p>"},{"location":"admin-guide/settings/certificates/#hot-reload","title":"Hot-Reload","text":"<p>WitFoo Analytics supports TLS certificate hot-reload. When a new certificate is applied:</p> <ol> <li>The reverse proxy service validates the new certificate and key pair</li> <li>The TLS listener is gracefully restarted with the new certificate</li> <li>Existing connections complete their current request before switching</li> <li>New connections immediately use the updated certificate</li> </ol> <p>No full service restart is required. The hot-reload process typically completes in under 2 seconds.</p>"},{"location":"admin-guide/settings/certificates/#verifying-the-new-certificate","title":"Verifying the New Certificate","text":"<p>After applying a certificate, verify it is active:</p> <pre><code>echo | openssl s_client -connect your-instance:443 -servername your-instance 2&gt;/dev/null | openssl x509 -noout -subject -dates\n</code></pre> <p>Expected output:</p> <pre><code>subject=CN = your-instance.example.com\nnotBefore=Jan  1 00:00:00 2025 GMT\nnotAfter=Jan  1 00:00:00 2026 GMT\n</code></pre>"},{"location":"admin-guide/settings/certificates/#certificate-expiration-monitoring","title":"Certificate Expiration Monitoring","text":"<p>WitFoo Analytics monitors certificate expiration and generates health alerts:</p> Days Until Expiry Alert Severity 30 days Info 14 days Warning 7 days High 1 day Critical Expired Critical <p>Certificate expiration alerts are sent through configured notification channels.</p> <p>Tip</p> <p>Set up a notification rule for Health Alert events to receive certificate expiration warnings automatically.</p>"},{"location":"admin-guide/settings/certificates/#using-lets-encrypt","title":"Using Let's Encrypt","text":"<p>For automated certificate management with Let's Encrypt:</p> <ol> <li>Ensure port 80 is accessible from the internet for HTTP-01 challenge validation</li> <li>Use a certificate management tool (e.g., <code>certbot</code>) to obtain and renew certificates</li> <li>Configure a post-renewal hook to upload the certificate to WitFoo Analytics:</li> </ol> <pre><code>#!/bin/bash\n# /etc/letsencrypt/renewal-hooks/deploy/witfoo-upload.sh\ncurl -X POST https://localhost/api/v1/settings/certificates \\\n  -H \"Authorization: Bearer $ADMIN_TOKEN\" \\\n  -F \"cert=@/etc/letsencrypt/live/your-domain/fullchain.pem\" \\\n  -F \"key=@/etc/letsencrypt/live/your-domain/privkey.pem\"\n</code></pre>"},{"location":"admin-guide/settings/certificates/#troubleshooting","title":"Troubleshooting","text":""},{"location":"admin-guide/settings/certificates/#certificate-and-key-mismatch","title":"Certificate and key mismatch","text":"<p>The validation step checks that the certificate and private key form a valid pair. If validation fails:</p> <pre><code># Verify the certificate and key match\nopenssl x509 -noout -modulus -in cert.pem | openssl md5\nopenssl rsa -noout -modulus -in key.pem | openssl md5\n</code></pre> <p>Both commands should output the same MD5 hash.</p>"},{"location":"admin-guide/settings/certificates/#browser-shows-not-secure-after-upload","title":"Browser shows \"Not Secure\" after upload","text":"<ul> <li>Verify the CA bundle includes all intermediate certificates</li> <li>Clear the browser's TLS session cache</li> <li>Confirm the certificate's SAN matches the URL in the browser address bar</li> </ul>"},{"location":"admin-guide/settings/certificates/#certificate-not-loading-after-upload","title":"Certificate not loading after upload","text":"<p>Check the reverse proxy logs:</p> <pre><code>docker logs witfoo-analytics-reverse-proxy 2&gt;&amp;1 | grep -i \"tls\\|cert\\|ssl\"\n</code></pre>"},{"location":"admin-guide/settings/frameworks/","title":"Compliance Frameworks","text":"<p>WitFoo Analytics integrates with industry-standard compliance frameworks to map security operations activities to compliance requirements. Framework selection drives the compliance dashboards in the Reporter module.</p>"},{"location":"admin-guide/settings/frameworks/#permission-requirements","title":"Permission Requirements","text":"Action Required Permission View frameworks <code>frameworks:read</code> Modify framework assignments <code>frameworks:write</code> Full framework administration <code>frameworks:manage</code>"},{"location":"admin-guide/settings/frameworks/#navigating-to-frameworks","title":"Navigating to Frameworks","text":"<ol> <li>Click Admin in the top navigation bar</li> <li>Select Settings from the dropdown</li> <li>Click the Frameworks tab</li> </ol>"},{"location":"admin-guide/settings/frameworks/#supported-frameworks","title":"Supported Frameworks","text":"<p>WitFoo Analytics supports the following compliance and security frameworks:</p> Framework Version Description NIST CSF 2.0 NIST Cybersecurity Framework NIST 800-53 Rev 5 Security and Privacy Controls CIS Controls v8 Center for Internet Security Controls MITRE ATT&amp;CK v14 Adversary Tactics, Techniques, and Procedures ISO 27001 2022 Information Security Management PCI DSS 4.0 Payment Card Industry Data Security Standard HIPAA \u2014 Health Insurance Portability and Accountability Act SOC 2 \u2014 Service Organization Control Type 2"},{"location":"admin-guide/settings/frameworks/#selecting-a-primary-framework","title":"Selecting a Primary Framework","text":"<p>The primary framework determines the default compliance view across all Reporter dashboards.</p> <ol> <li>Navigate to Admin \u2192 Settings \u2192 Frameworks</li> <li>Review the list of available frameworks</li> <li>Click Set as Primary next to your organization's primary compliance framework</li> <li>Confirm the selection</li> </ol> <p>Info</p> <p>Only one framework can be designated as primary at a time. Changing the primary framework updates all default compliance views across the platform.</p>"},{"location":"admin-guide/settings/frameworks/#enabling-additional-frameworks","title":"Enabling Additional Frameworks","text":"<p>You can enable multiple frameworks simultaneously for cross-framework compliance mapping.</p> <ol> <li>Navigate to Admin \u2192 Settings \u2192 Frameworks</li> <li>Toggle the Enabled switch for each framework you want to activate</li> <li>Click Save</li> </ol> <p>Enabled frameworks appear in the framework selector on Reporter dashboards, allowing analysts to view compliance posture against multiple standards.</p>"},{"location":"admin-guide/settings/frameworks/#framework-synchronization","title":"Framework Synchronization","text":"<p>Framework definitions are periodically updated to reflect the latest versions and control mappings.</p>"},{"location":"admin-guide/settings/frameworks/#manual-sync","title":"Manual Sync","text":"<ol> <li>Navigate to Admin \u2192 Settings \u2192 Frameworks</li> <li>Click Sync Frameworks</li> <li>Wait for the synchronization to complete</li> </ol>"},{"location":"admin-guide/settings/frameworks/#sync-behavior","title":"Sync Behavior","text":"<ul> <li>New controls and mappings are added automatically</li> <li>Existing control mappings are updated if changes are detected</li> <li>Custom mappings created by your organization are preserved</li> <li>Sync does not delete any existing data</li> </ul> <p>Warning</p> <p>Framework synchronization requires network connectivity to the WitFoo update service. Ensure your deployment can reach the update endpoint.</p>"},{"location":"admin-guide/settings/frameworks/#framework-mappings","title":"Framework Mappings","text":"<p>Each framework maps security controls to observable activities in WitFoo Analytics:</p> <ul> <li>Signals are mapped to detection controls</li> <li>Work Units are mapped to response controls</li> <li>Observations are mapped to monitoring controls</li> </ul> <p>These mappings drive the compliance coverage calculations shown in Reporter dashboards.</p>"},{"location":"admin-guide/settings/frameworks/#best-practices","title":"Best Practices","text":"<ul> <li>Select your audit framework as primary: Choose the framework your organization is actively audited against</li> <li>Enable ATT&amp;CK alongside compliance frameworks: MITRE ATT&amp;CK provides tactical context that complements compliance-focused frameworks</li> <li>Review mappings after sync: Verify that updated mappings align with your organization's control implementations</li> <li>Sync quarterly: Synchronize framework definitions at least once per quarter to stay current</li> </ul>"},{"location":"admin-guide/settings/notifications/","title":"Notifications","text":"<p>WitFoo Analytics supports configurable notification channels for alerting security teams about incidents, system health events, and administrative actions. Notifications can be delivered via email, Slack, or webhooks.</p>"},{"location":"admin-guide/settings/notifications/#permission-requirements","title":"Permission Requirements","text":"Action Required Permission View notification settings <code>settings:read</code> Modify notification settings <code>settings:write</code>"},{"location":"admin-guide/settings/notifications/#navigating-to-notification-settings","title":"Navigating to Notification Settings","text":"<ol> <li>Click Admin in the top navigation bar</li> <li>Select Settings from the dropdown</li> <li>Click the Notifications tab</li> </ol>"},{"location":"admin-guide/settings/notifications/#notification-channels","title":"Notification Channels","text":""},{"location":"admin-guide/settings/notifications/#email","title":"Email","text":"<p>Send notifications to individual email addresses or distribution lists.</p>"},{"location":"admin-guide/settings/notifications/#configuration","title":"Configuration","text":"Setting Description Example SMTP Server Mail server hostname <code>smtp.example.com</code> SMTP Port Mail server port <code>587</code> Use TLS Enable TLS encryption Yes Username SMTP authentication username <code>witfoo@example.com</code> Password SMTP authentication password (stored encrypted) From Address Sender email address <code>witfoo-alerts@example.com</code> From Name Sender display name <code>WitFoo Analytics</code>"},{"location":"admin-guide/settings/notifications/#setting-up-email-notifications","title":"Setting Up Email Notifications","text":"<ol> <li>Navigate to Admin \u2192 Settings \u2192 Notifications</li> <li>Expand the Email section</li> <li>Enter your SMTP server details</li> <li>Click Send Test Email to verify the configuration</li> <li>Click Save</li> </ol>"},{"location":"admin-guide/settings/notifications/#slack","title":"Slack","text":"<p>Send notifications to Slack channels via incoming webhooks.</p>"},{"location":"admin-guide/settings/notifications/#configuration_1","title":"Configuration","text":"Setting Description Example Webhook URL Slack incoming webhook URL <code>https://hooks.slack.com/services/T.../B.../xxx</code> Channel Default channel (can be overridden per rule) <code>#security-alerts</code> Username Bot display name <code>WitFoo Analytics</code> Icon Bot icon emoji or URL <code>:shield:</code>"},{"location":"admin-guide/settings/notifications/#setting-up-slack-notifications","title":"Setting Up Slack Notifications","text":"<ol> <li>Create an incoming webhook in your Slack workspace settings</li> <li>Navigate to Admin \u2192 Settings \u2192 Notifications</li> <li>Expand the Slack section</li> <li>Paste the webhook URL</li> <li>Click Send Test Message to verify</li> <li>Click Save</li> </ol>"},{"location":"admin-guide/settings/notifications/#webhooks","title":"Webhooks","text":"<p>Send notification payloads to arbitrary HTTP endpoints for integration with custom systems, PagerDuty, Microsoft Teams, or other tools.</p>"},{"location":"admin-guide/settings/notifications/#configuration_2","title":"Configuration","text":"Setting Description Example URL Webhook endpoint URL <code>https://api.pagerduty.com/events</code> Method HTTP method <code>POST</code> Headers Custom HTTP headers (JSON) <code>{\"Authorization\": \"Bearer xxx\"}</code> Payload Template JSON payload template with variables See below"},{"location":"admin-guide/settings/notifications/#payload-variables","title":"Payload Variables","text":"<p>Notification payloads support the following template variables:</p> Variable Description <code>{{.EventType}}</code> Type of event (incident, health, admin) <code>{{.Severity}}</code> Event severity (critical, high, medium, low, info) <code>{{.Title}}</code> Event title <code>{{.Description}}</code> Event description <code>{{.Timestamp}}</code> ISO 8601 timestamp <code>{{.Source}}</code> Originating service or module <code>{{.URL}}</code> Direct link to the event in WitFoo Analytics"},{"location":"admin-guide/settings/notifications/#notification-rules","title":"Notification Rules","text":"<p>Notification rules define which events trigger notifications and which channels receive them.</p>"},{"location":"admin-guide/settings/notifications/#creating-a-rule","title":"Creating a Rule","text":"<ol> <li>Navigate to Admin \u2192 Settings \u2192 Notifications</li> <li>Scroll to the Rules section</li> <li>Click Add Rule</li> <li> <p>Configure the rule:</p> Field Description Name Descriptive rule name Event Type Category of events to match Severity Filter Minimum severity level to trigger Channel Notification channel(s) to use Enabled Toggle rule on/off </li> <li> <p>Click Save</p> </li> </ol>"},{"location":"admin-guide/settings/notifications/#event-types","title":"Event Types","text":"Event Type Description Incident Created New incident or work unit created Incident Escalated Incident severity increased Incident Resolved Incident marked as resolved Health Alert System health threshold exceeded Health Recovery System health returned to normal User Login Failed Failed authentication attempt Admin Action Administrative change (user/role/settings)"},{"location":"admin-guide/settings/notifications/#example-rules","title":"Example Rules","text":"<p>Critical Incidents to Slack and Email</p> <ul> <li>Event Type: Incident Created</li> <li>Severity Filter: Critical</li> <li>Channels: Slack (<code>#soc-critical</code>), Email (<code>soc-oncall@example.com</code>)</li> </ul> <p>Health Alerts to PagerDuty</p> <ul> <li>Event Type: Health Alert</li> <li>Severity Filter: High</li> <li>Channels: Webhook (PagerDuty endpoint)</li> </ul> <p>Tip</p> <p>Start with high-severity rules and expand coverage gradually to avoid notification fatigue.</p>"},{"location":"admin-guide/settings/notifications/#testing-notifications","title":"Testing Notifications","text":"<p>Each channel provides a Send Test button that delivers a sample notification. Always test after configuration changes to verify delivery.</p> <p>Warning</p> <p>Webhook endpoints must respond with a <code>2xx</code> status code within 10 seconds. Endpoints that consistently fail are automatically disabled after 5 consecutive failures.</p>"},{"location":"admin-guide/settings/saml-sso/","title":"SAML SSO Enablement Guide","text":"<p>Configure SAML 2.0 Single Sign-On for WitFoo Analytics, Conductor-UI, and Console-UI.</p>"},{"location":"admin-guide/settings/saml-sso/#overview","title":"Overview","text":"<p>WitFoo supports SAML 2.0 SP-initiated SSO with the following identity providers:</p> <ul> <li>Okta</li> <li>Azure AD (Entra ID)</li> <li>Google Workspace</li> <li>OneLogin</li> <li>PingFederate</li> <li>Any SAML 2.0 compliant IdP</li> </ul> <p>Each WitFoo component acts as a SAML Service Provider (SP). Users authenticate at the IdP and are redirected back with a signed SAML assertion.</p>"},{"location":"admin-guide/settings/saml-sso/#prerequisites","title":"Prerequisites","text":"<ul> <li>Administrative access to your Identity Provider</li> <li><code>settings:manage</code> permission in WitFoo</li> <li>HTTPS configured on WitFoo (required for SAML security)</li> <li>IdP metadata URL or XML document</li> </ul>"},{"location":"admin-guide/settings/saml-sso/#architecture","title":"Architecture","text":"<pre><code>User \u2192 WitFoo Login \u2192 IdP SSO URL \u2192 IdP Authentication\n                                         \u2193\nUser \u2190 JWT/Session \u2190 WitFoo ACS \u2190 SAML Response (signed)\n</code></pre> <p>Security features:</p> <ul> <li>XML signature verification on all assertions</li> <li>Assertion replay detection (24-hour window)</li> <li>Audience restriction validation</li> <li><code>NotOnOrAfter</code> / <code>NotBefore</code> time-window validation</li> <li>SP private key encrypted at rest (AES-256-GCM)</li> </ul>"},{"location":"admin-guide/settings/saml-sso/#step-1-register-witfoo-as-a-service-provider","title":"Step 1: Register WitFoo as a Service Provider","text":""},{"location":"admin-guide/settings/saml-sso/#gather-sp-information","title":"Gather SP Information","text":"Property Analytics Conductor-UI Console-UI Entity ID <code>https://&lt;analytics-host&gt;/api/v1/auth/saml/metadata</code> <code>https://&lt;conductor-host&gt;/api/v1/auth/saml/metadata</code> <code>https://&lt;console-host&gt;/api/v1/auth/saml/metadata</code> ACS URL <code>https://&lt;analytics-host&gt;/api/v1/auth/saml/acs</code> <code>https://&lt;conductor-host&gt;/api/v1/auth/saml/acs</code> <code>https://&lt;console-host&gt;/api/v1/auth/saml/acs</code> Name ID Format <code>urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress</code> Same Same Binding HTTP-POST (ACS) Same Same"},{"location":"admin-guide/settings/saml-sso/#idp-specific-setup","title":"IdP-Specific Setup","text":""},{"location":"admin-guide/settings/saml-sso/#okta","title":"Okta","text":"<ol> <li>Go to Applications &gt; Create App Integration &gt; SAML 2.0</li> <li>Set Single sign-on URL to the ACS URL above</li> <li>Set Audience URI (SP Entity ID) to the Entity ID above</li> <li>Configure attribute statements:<ul> <li><code>email</code> \u2192 <code>user.email</code></li> <li><code>firstName</code> \u2192 <code>user.firstName</code></li> <li><code>lastName</code> \u2192 <code>user.lastName</code></li> <li><code>groups</code> \u2192 (Group attribute statement, filter: regex <code>.*</code>)</li> </ul> </li> <li>Assign users/groups to the application</li> <li>Copy the IdP metadata URL from the Sign On tab</li> </ol>"},{"location":"admin-guide/settings/saml-sso/#azure-ad-entra-id","title":"Azure AD (Entra ID)","text":"<ol> <li>Go to Enterprise Applications &gt; New Application &gt; Create your own</li> <li>Select Integrate any other application (Non-gallery)</li> <li>Go to Single sign-on &gt; SAML</li> <li>Set Identifier (Entity ID) and Reply URL (ACS URL) from the table above</li> <li>Under Attributes &amp; Claims, configure:<ul> <li><code>emailaddress</code> \u2192 <code>user.mail</code></li> <li><code>givenname</code> \u2192 <code>user.givenname</code></li> <li><code>surname</code> \u2192 <code>user.surname</code></li> <li><code>groups</code> \u2192 Group claim (Security groups)</li> </ul> </li> <li>Download Federation Metadata XML or copy the App Federation Metadata Url</li> </ol>"},{"location":"admin-guide/settings/saml-sso/#google-workspace","title":"Google Workspace","text":"<ol> <li>Go to Admin Console &gt; Apps &gt; Web and mobile apps &gt; Add custom SAML app</li> <li>Copy the IdP metadata (SSO URL, Entity ID, Certificate)</li> <li>Set ACS URL and Entity ID from the table above</li> <li>Set Name ID format to <code>EMAIL</code></li> <li>Add attribute mappings:<ul> <li><code>email</code> \u2192 <code>Primary email</code></li> <li><code>firstName</code> \u2192 <code>First name</code></li> <li><code>lastName</code> \u2192 <code>Last name</code></li> </ul> </li> </ol>"},{"location":"admin-guide/settings/saml-sso/#step-2-configure-saml-in-witfoo","title":"Step 2: Configure SAML in WitFoo","text":""},{"location":"admin-guide/settings/saml-sso/#analytics","title":"Analytics","text":"<ol> <li>Navigate to Admin &gt; Settings &gt; Authentication</li> <li>Select the SAML tab</li> <li>Enter your IdP Metadata URL or paste IdP Metadata XML</li> <li>Click Fetch Metadata (if using URL) to auto-populate SSO URL and certificate</li> <li>Configure Attribute Mappings:<ul> <li>Email attribute: <code>email</code> (or <code>emailaddress</code> for Azure AD)</li> <li>Display name attribute: <code>displayName</code> (or <code>firstName</code> + <code>lastName</code>)</li> <li>Groups attribute: <code>groups</code> (optional, for role mapping)</li> </ul> </li> <li>Configure Group-to-Role Mapping (optional):<ul> <li>Map IdP group names to WitFoo roles (e.g., <code>WitFoo-Admins</code> \u2192 <code>admin</code>)</li> </ul> </li> <li>Enable SAML SSO</li> <li>Click Save</li> </ol>"},{"location":"admin-guide/settings/saml-sso/#conductor-ui","title":"Conductor-UI","text":"<ol> <li>Navigate to Admin &gt; Settings &gt; General</li> <li>Scroll to the SAML SSO section</li> <li>Enter the same IdP metadata URL and attribute mappings</li> <li>Enable SAML and save</li> </ol>"},{"location":"admin-guide/settings/saml-sso/#console-ui","title":"Console-UI","text":"<ol> <li>Navigate to Settings &gt; Authentication (superuser only)</li> <li>Select the SAML tab</li> <li>Configure identically to Analytics</li> <li>Enable and save</li> </ol>"},{"location":"admin-guide/settings/saml-sso/#step-3-test-sso","title":"Step 3: Test SSO","text":"<ol> <li>Open a new incognito/private browser window</li> <li>Navigate to the WitFoo login page</li> <li>Click Sign in with SSO</li> <li>Authenticate at your IdP</li> <li>Verify you are redirected back to WitFoo and logged in</li> </ol> <p>SP Metadata Download</p> <p>Download SP metadata XML from <code>https://&lt;host&gt;/api/v1/auth/saml/metadata?org_id=&lt;your-org-id&gt;</code> if your IdP requires it for setup.</p>"},{"location":"admin-guide/settings/saml-sso/#step-4-validate-data-flow","title":"Step 4: Validate Data Flow","text":"<p>After successful login, verify:</p> <ul> <li>User appears in Admin &gt; Users with correct email and role</li> <li>If group-to-role mapping is configured, the assigned role matches expectations</li> <li>The user's display name is populated from SAML attributes</li> </ul>"},{"location":"admin-guide/settings/saml-sso/#attribute-mapping-reference","title":"Attribute Mapping Reference","text":"WitFoo Field Common SAML Attributes Email <code>email</code>, <code>emailaddress</code>, <code>http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress</code> Display Name <code>displayName</code>, <code>name</code>, <code>cn</code> First Name <code>firstName</code>, <code>givenname</code>, <code>http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname</code> Last Name <code>lastName</code>, <code>surname</code>, <code>http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname</code> Groups <code>groups</code>, <code>memberOf</code>, <code>http://schemas.xmlsoap.org/claims/Group</code>"},{"location":"admin-guide/settings/saml-sso/#group-to-role-mapping","title":"Group-to-Role Mapping","text":"<p>Map IdP group names to WitFoo roles for automatic role assignment on login.</p> IdP Group (example) WitFoo Role <code>WitFoo-Admins</code> <code>admin</code> <code>WitFoo-Analysts</code> <code>analyst</code> <code>WitFoo-Viewers</code> <code>viewer</code> <code>SOC-Staff</code> <code>org_staff</code> <p>If no group mapping matches, new users are assigned the default role (<code>viewer</code>).</p>"},{"location":"admin-guide/settings/saml-sso/#troubleshooting","title":"Troubleshooting","text":""},{"location":"admin-guide/settings/saml-sso/#saml-response-signature-verification-failed","title":"\"SAML response signature verification failed\"","text":"<ul> <li>Verify the IdP certificate in WitFoo matches the signing certificate from your IdP</li> <li>Check if the IdP rotated its signing certificate</li> <li>Re-fetch metadata if using a metadata URL</li> </ul>"},{"location":"admin-guide/settings/saml-sso/#assertion-has-expired","title":"\"Assertion has expired\"","text":"<ul> <li>Ensure server clocks are synchronized (NTP)</li> <li>WitFoo allows 5 minutes of clock skew by default</li> </ul>"},{"location":"admin-guide/settings/saml-sso/#audience-mismatch","title":"\"Audience mismatch\"","text":"<ul> <li>The Entity ID configured in the IdP must exactly match the WitFoo SP Entity ID</li> <li>Check for trailing slashes or protocol differences (http vs https)</li> </ul>"},{"location":"admin-guide/settings/saml-sso/#user-not-found-after-sso","title":"\"User not found after SSO\"","text":"<ul> <li>Verify the email attribute mapping returns a valid email address</li> <li>Check that the SAML attribute name in WitFoo matches the attribute name sent by the IdP</li> <li>Review the SAML response in browser dev tools (Network tab \u2192 ACS POST \u2192 form data \u2192 <code>SAMLResponse</code> \u2192 base64 decode)</li> </ul>"},{"location":"admin-guide/settings/saml-sso/#replay-detected","title":"\"Replay detected\"","text":"<ul> <li>This occurs if the same SAML assertion is submitted twice within 24 hours</li> <li>Clear browser cache and re-authenticate</li> </ul>"},{"location":"admin-guide/settings/saml-sso/#login-page-shows-no-sso-button","title":"Login page shows no SSO button","text":"<ul> <li>Verify SAML is enabled in the authentication settings</li> <li>Ensure the auth mode is set to <code>saml</code> (not <code>local</code> or <code>ldap</code>)</li> </ul>"},{"location":"admin-guide/settings/saml-sso/#security-considerations","title":"Security Considerations","text":"<ul> <li>Always use HTTPS for all WitFoo endpoints</li> <li>Rotate IdP signing certificates on a regular schedule</li> <li>Monitor SAML assertion logs for anomalies</li> <li>Use group-based role mapping to enforce least-privilege access</li> <li>The SP private key is encrypted at rest using AES-256-GCM; protect the <code>AUTH_CONFIG_ENCRYPTION_KEY</code></li> </ul>"},{"location":"ai/","title":"AI Capabilities","text":"<p>WitFoo Analytics integrates AI-powered assistance directly into the security operations workflow. The AI subsystem provides a conversational interface for querying security data, analyzing incidents, and navigating the platform \u2014 backed by configurable large language model (LLM) providers and an extensible Model Context Protocol (MCP) server.</p>"},{"location":"ai/#overview","title":"Overview","text":"<p>The AI capabilities in WitFoo Analytics v0.9.1 consist of three core components:</p> <ul> <li>AI Provider Configuration \u2014 Connect to supported LLM providers with encrypted API key storage, model selection, and tuning parameters.</li> <li>Chat Interface \u2014 A context-aware sidebar panel for conversational interaction with security data, accessible from any page in the platform.</li> <li>MCP Server \u2014 A Model Context Protocol server that exposes WitFoo security data and tools to external AI clients and agents.</li> </ul>"},{"location":"ai/#supported-providers","title":"Supported Providers","text":"Provider Type Key Description Anthropic Claude <code>claude</code> Claude models via the Anthropic API OpenAI <code>openai</code> GPT models via the OpenAI API Google Gemini <code>gemini</code> Gemini models via the Google AI API IBM watsonx.ai <code>watsonx</code> Foundation models via IBM watsonx.ai"},{"location":"ai/#architecture","title":"Architecture","text":"<pre><code>graph LR\n    A[Chat UI Panel] --&gt;|REST API| B[WitFoo API Server]\n    B --&gt;|Provider SDK| C[LLM Provider]\n    B --&gt;|Tool Execution| D[Security Data Layer]\n    E[External AI Client] --&gt;|MCP Protocol| F[MCP Server]\n    F --&gt;|Tool Execution| D\n    D --&gt; G[(Cassandra)]</code></pre> <p>The AI assistant has direct access to live security data through built-in tool execution. When a user asks about security events, the assistant automatically queries artifacts, nodes, and incidents using the same data layer that powers the rest of the platform.</p>"},{"location":"ai/#permissions","title":"Permissions","text":"<p>Access to AI features is controlled by four granular permissions:</p> Permission Description <code>ai:read</code> View AI configurations and chat history. Required for all AI interactions. <code>ai:write</code> Send messages, create chat sessions, and interact with the AI assistant. <code>ai:manage</code> Create, update, and delete AI provider configurations and MCP server settings. <code>ai:export</code> Export chat transcripts and AI-generated reports. <p>Assign permissions through Settings &gt; Roles &amp; Permissions. The <code>ai:read</code> permission is a prerequisite for all other AI permissions.</p>"},{"location":"ai/#getting-started","title":"Getting Started","text":"<ol> <li>Configure a provider \u2014 Navigate to Settings &gt; AI Configuration and add at least one AI provider with a valid API key. See AI Configuration.</li> <li>Open the chat panel \u2014 Press ++ctrl+slash++ from any page to toggle the AI chat sidebar. See Chat Interface.</li> <li>Ask a question \u2014 Type a security question like \"Show me high-severity IDS alerts from the last 24 hours\" and the assistant will query your live data.</li> </ol> <p>For programmatic access and external AI agent integration, see the MCP Server documentation.</p>"},{"location":"ai/#section-contents","title":"Section Contents","text":"Page Description Configuration AI provider setup, API keys, model selection, and tuning Chat Interface Chat panel usage, sessions, context, and keyboard shortcuts MCP Server Model Context Protocol server for external AI integration"},{"location":"ai/chat/","title":"Chat Interface","text":"<p>The AI chat interface provides a conversational sidebar for interacting with the WitFoo AI Security Assistant. The assistant has direct access to your organization's live security data and can query events, look up assets, and provide analytical summaries.</p>"},{"location":"ai/chat/#opening-the-chat-panel","title":"Opening the Chat Panel","text":"<p>The chat panel is a 400px-wide sidebar that slides in from the right side of the screen.</p> Action Method Toggle panel Press ++ctrl+slash++ Open from menu Click the AI Assistant icon in the top navigation bar <p>The panel overlays the current page content without navigating away, so you can reference dashboards, incident details, or alert views while chatting.</p>"},{"location":"ai/chat/#chat-sessions","title":"Chat Sessions","text":"<p>Conversations are organized into sessions. Each session maintains its own message history and context.</p>"},{"location":"ai/chat/#creating-a-session","title":"Creating a Session","text":"<ul> <li>Click New Chat at the top of the chat panel to start a fresh session.</li> <li>Sessions are automatically titled \"New Chat\" and can be renamed.</li> <li>The current page path is captured as <code>page_context</code> when a session is created.</li> </ul>"},{"location":"ai/chat/#managing-sessions","title":"Managing Sessions","text":"Action Description List sessions Previous sessions appear in the sidebar's session list (most recent first) Rename Click the session title to edit it, or use the context menu Delete Use the context menu on a session to delete it and all its messages Switch Click any session in the list to load its conversation history <p>Sessions are scoped to the authenticated user \u2014 each user has their own private chat history.</p>"},{"location":"ai/chat/#session-limits","title":"Session Limits","text":"<p>The session list returns up to 50 sessions by default. Each session loads up to 100 messages of conversation history for AI context.</p>"},{"location":"ai/chat/#sending-messages","title":"Sending Messages","text":"<p>Type your message in the input field at the bottom of the chat panel and press ++enter++ to send.</p>"},{"location":"ai/chat/#context-aware-queries","title":"Context-Aware Queries","text":"<p>The chat interface captures contextual information with each message:</p> <pre><code>interface ChatContext {\n  page_path: string;       // Current page URL path\n  entity_type?: string;    // Type of entity being viewed (e.g., \"incident\", \"node\")\n  entity_id?: string;      // ID of the entity being viewed\n  selected_data?: Record&lt;string, any&gt;;  // Any selected data from the current view\n}\n</code></pre> <p>This context allows the assistant to understand what you're looking at when you ask questions like \"Tell me more about this alert\" or \"What other activity is associated with this IP?\"</p>"},{"location":"ai/chat/#example-queries","title":"Example Queries","text":"Query What Happens \"Show me high-severity IDS alerts from the last 24 hours\" Searches artifacts by severity and time range \"What nodes have communicated with 10.0.1.50?\" Queries the node graph for network relationships \"Summarize today's security events\" Searches recent artifacts and provides a summary \"Are there any critical incidents this week?\" Queries incidents by severity and date range"},{"location":"ai/chat/#tool-execution","title":"Tool Execution","text":"<p>The assistant uses built-in tools to query live data:</p> <ul> <li><code>search_artifacts</code> \u2014 Query security events (IDS alerts, firewall logs, authentication events, DNS queries) by time range, severity, or alarm status.</li> <li><code>search_nodes</code> \u2014 Look up network assets, users, domains, and processes by IP, hostname, or type.</li> </ul> <p>Tool execution may require multiple API round-trips to the LLM provider. The write deadline is automatically extended to 2 minutes for chat requests to accommodate this.</p>"},{"location":"ai/chat/#message-roles","title":"Message Roles","text":"<p>Each message in a session has one of three roles:</p> Role Description <code>user</code> Messages sent by you <code>assistant</code> Responses from the AI assistant <code>system</code> System-level instructions (not displayed in the UI)"},{"location":"ai/chat/#error-handling","title":"Error Handling","text":"<p>If the AI provider returns an error, the assistant stores an error message in the conversation:</p> <p>\"I'm sorry, I encountered an error processing your request. Please try again. (Error: ...)\"</p> <p>Common causes:</p> <ul> <li>AI not configured \u2014 No provider is enabled. Navigate to Settings &gt; AI Configuration.</li> <li>API key invalid \u2014 The provider rejected the API key. Reconfigure the provider.</li> <li>Rate limit exceeded \u2014 The provider's rate limit was hit. Wait and retry.</li> <li>Timeout \u2014 Complex queries may exceed the 2-minute deadline.</li> </ul>"},{"location":"ai/chat/#keyboard-shortcuts","title":"Keyboard Shortcuts","text":"Shortcut Action ++ctrl+slash++ Toggle the chat panel open/closed ++enter++ Send the current message ++shift+enter++ Insert a newline in the message input"},{"location":"ai/chat/#api-reference","title":"API Reference","text":"Method Endpoint Permission Description <code>GET</code> <code>/api/v1/ai/chat/sessions</code> <code>ai:read</code> List sessions (default limit: 50) <code>POST</code> <code>/api/v1/ai/chat/sessions</code> <code>ai:write</code> Create a new session <code>GET</code> <code>/api/v1/ai/chat/sessions/:id</code> <code>ai:read</code> Get session details <code>GET</code> <code>/api/v1/ai/chat/sessions/:id/messages</code> <code>ai:read</code> Get session messages (default limit: 100) <code>PUT</code> <code>/api/v1/ai/chat/sessions/:id/title</code> <code>ai:write</code> Update session title <code>POST</code> <code>/api/v1/ai/chat/sessions/:id/messages</code> <code>ai:write</code> Send a message and receive AI response <code>DELETE</code> <code>/api/v1/ai/chat/sessions/:id</code> <code>ai:write</code> Delete a session"},{"location":"ai/chat/#send-message-request","title":"Send Message Request","text":"<pre><code>{\n  \"content\": \"Show me critical alerts from the last hour\",\n  \"context\": {\n    \"page_path\": \"/incidents\",\n    \"entity_type\": \"incident\",\n    \"entity_id\": \"inc-2024-0042\"\n  }\n}\n</code></pre>"},{"location":"ai/chat/#send-message-response","title":"Send Message Response","text":"<pre><code>{\n  \"message\": \"Message sent\",\n  \"data\": {\n    \"user_message\": {\n      \"session_id\": \"a1b2c3d4-...\",\n      \"role\": \"user\",\n      \"content\": \"Show me critical alerts from the last hour\",\n      \"created_at\": \"2025-01-15T10:30:00Z\"\n    },\n    \"assistant_message\": {\n      \"session_id\": \"a1b2c3d4-...\",\n      \"role\": \"assistant\",\n      \"content\": \"I found 3 critical alerts in the last hour...\",\n      \"tokens\": 847,\n      \"created_at\": \"2025-01-15T10:30:05Z\"\n    }\n  }\n}\n</code></pre>"},{"location":"ai/configuration/","title":"AI Configuration","text":"<p>Configure AI providers to enable the WitFoo AI Security Assistant. Each organization can register one or more AI provider configurations, with one active (enabled) provider at a time.</p>"},{"location":"ai/configuration/#prerequisites","title":"Prerequisites","text":"<ul> <li>The <code>ai:manage</code> permission is required to create, update, or delete AI configurations.</li> <li>A valid API key from at least one supported provider.</li> </ul>"},{"location":"ai/configuration/#provider-setup","title":"Provider Setup","text":"<p>Navigate to Settings &gt; AI Configuration to manage providers.</p>"},{"location":"ai/configuration/#creating-a-configuration","title":"Creating a Configuration","text":"<p>Send a <code>POST</code> request to <code>/api/v1/ai/configs</code> or use the Add Provider button in the UI.</p> <pre><code>{\n  \"provider\": \"claude\",\n  \"api_key\": \"sk-ant-api03-...\",\n  \"model_id\": \"claude-sonnet-4-20250514\",\n  \"max_tokens\": 4096,\n  \"temperature\": 0.7\n}\n</code></pre> <p>Required fields:</p> Field Type Description <code>provider</code> string One of <code>claude</code>, <code>openai</code>, <code>gemini</code>, <code>watsonx</code> <code>api_key</code> string Provider API key (encrypted at rest, never returned in responses) <code>model_id</code> string Model identifier (provider-specific) <p>Optional fields:</p> Field Type Default Description <code>base_url</code> string Provider default Custom API endpoint URL <code>project_id</code> string \u2014 Project ID (required for <code>watsonx</code>) <code>region</code> string \u2014 Deployment region <code>max_tokens</code> integer <code>4096</code> Maximum response tokens (1\u2013100,000) <code>temperature</code> float <code>0.7</code> Response randomness (0.0\u20132.0)"},{"location":"ai/configuration/#provider-specific-examples","title":"Provider-Specific Examples","text":""},{"location":"ai/configuration/#anthropic-claude","title":"Anthropic Claude","text":"<pre><code>{\n  \"provider\": \"claude\",\n  \"api_key\": \"sk-ant-api03-...\",\n  \"model_id\": \"claude-sonnet-4-20250514\",\n  \"max_tokens\": 4096,\n  \"temperature\": 0.7\n}\n</code></pre>"},{"location":"ai/configuration/#openai","title":"OpenAI","text":"<pre><code>{\n  \"provider\": \"openai\",\n  \"api_key\": \"sk-proj-...\",\n  \"model_id\": \"gpt-4o\",\n  \"max_tokens\": 4096,\n  \"temperature\": 0.7\n}\n</code></pre>"},{"location":"ai/configuration/#google-gemini","title":"Google Gemini","text":"<pre><code>{\n  \"provider\": \"gemini\",\n  \"api_key\": \"AIza...\",\n  \"model_id\": \"gemini-2.0-flash\",\n  \"max_tokens\": 8192,\n  \"temperature\": 0.7\n}\n</code></pre>"},{"location":"ai/configuration/#ibm-watsonxai","title":"IBM watsonx.ai","text":"<pre><code>{\n  \"provider\": \"watsonx\",\n  \"api_key\": \"your-iam-api-key\",\n  \"model_id\": \"ibm/granite-13b-chat-v2\",\n  \"project_id\": \"a1b2c3d4-...\",\n  \"region\": \"us-south\",\n  \"max_tokens\": 4096,\n  \"temperature\": 0.7\n}\n</code></pre> <p>watsonx Requirement</p> <p>The <code>project_id</code> field is required when using the <code>watsonx</code> provider. Configuration creation will fail without it.</p>"},{"location":"ai/configuration/#api-key-security","title":"API Key Security","text":"<p>API keys are encrypted before storage and are never returned in API responses or displayed in the UI after initial entry. The <code>api_key</code> and <code>api_key_encrypted</code> fields are excluded from all JSON serialization.</p> <p>To rotate an API key, delete the existing configuration and create a new one.</p>"},{"location":"ai/configuration/#updating-a-configuration","title":"Updating a Configuration","text":"<p>Send a <code>PUT</code> request to <code>/api/v1/ai/configs/:id</code>. Only include the fields you want to change:</p> <pre><code>{\n  \"model_id\": \"claude-sonnet-4-20250514\",\n  \"max_tokens\": 8192,\n  \"temperature\": 0.5\n}\n</code></pre>"},{"location":"ai/configuration/#enabling-and-disabling-providers","title":"Enabling and Disabling Providers","text":"<p>Toggle a provider's enabled status via <code>PUT /api/v1/ai/configs/:id/enable</code>:</p> <pre><code>{\n  \"enabled\": true\n}\n</code></pre> <p>Only one provider should be enabled at a time. The platform uses the first enabled configuration found for the organization.</p>"},{"location":"ai/configuration/#deleting-a-configuration","title":"Deleting a Configuration","text":"<p>Send a <code>DELETE</code> request to <code>/api/v1/ai/configs/:id</code>. This action is irreversible and removes the encrypted API key from storage.</p>"},{"location":"ai/configuration/#api-reference","title":"API Reference","text":"Method Endpoint Permission Description <code>GET</code> <code>/api/v1/ai/configs</code> <code>ai:read</code> List all configurations <code>GET</code> <code>/api/v1/ai/configs/:id</code> <code>ai:read</code> Get a specific configuration <code>POST</code> <code>/api/v1/ai/configs</code> <code>ai:manage</code> Create a new configuration <code>PUT</code> <code>/api/v1/ai/configs/:id</code> <code>ai:manage</code> Update a configuration <code>PUT</code> <code>/api/v1/ai/configs/:id/enable</code> <code>ai:manage</code> Toggle enabled status <code>DELETE</code> <code>/api/v1/ai/configs/:id</code> <code>ai:manage</code> Delete a configuration"},{"location":"ai/configuration/#system-prompt","title":"System Prompt","text":"<p>The AI assistant uses a built-in system prompt that identifies it as the WitFoo AI Security Assistant and instructs it to:</p> <ul> <li>Always use available tools to query real security data before answering</li> <li>Calculate appropriate time ranges from natural language (e.g., \"today\", \"this week\")</li> <li>Summarize findings with specific IPs, hostnames, timestamps, and counts</li> <li>Provide actionable security analysis</li> </ul> <p>The system prompt is not currently user-configurable. It includes the current UTC timestamp to support time-relative queries.</p>"},{"location":"ai/mcp/","title":"MCP Server","text":"<p>WitFoo Analytics includes a Model Context Protocol (MCP) server that exposes security data and operational tools to external AI clients and agents. MCP provides a standardized interface for AI systems to discover and invoke tools, query security data, and interact with the WitFoo platform programmatically.</p>"},{"location":"ai/mcp/#what-is-mcp","title":"What is MCP?","text":"<p>The Model Context Protocol is an open standard for connecting AI models to external data sources and tools. It defines a structured JSON-RPC-based protocol for:</p> <ul> <li>Tool Discovery \u2014 AI clients enumerate available tools and their schemas.</li> <li>Tool Invocation \u2014 AI clients call tools with structured inputs and receive structured outputs.</li> <li>Context Sharing \u2014 Security context flows between WitFoo and external AI systems.</li> </ul>"},{"location":"ai/mcp/#use-cases","title":"Use Cases","text":"Use Case Description External AI Agents Connect third-party AI agents (e.g., Claude Desktop, custom LangChain agents) to WitFoo security data Automated Triage Build AI-powered workflows that automatically query and classify security events Cross-Platform Analysis Allow AI systems that span multiple security tools to include WitFoo data in their analysis Custom Integrations Develop organization-specific AI workflows that leverage WitFoo's data layer"},{"location":"ai/mcp/#available-tools","title":"Available Tools","text":"<p>The MCP server exposes the following tools:</p> Tool Description <code>search_artifacts</code> Query security events by time range, severity, type, and alarm status <code>search_nodes</code> Look up network assets, users, domains, and processes <code>get_incident</code> Retrieve incident details by ID <code>query_graph</code> Execute graph queries across the security knowledge graph <p>See MCP Tools for complete schemas and examples.</p>"},{"location":"ai/mcp/#architecture-overview","title":"Architecture Overview","text":"<pre><code>graph LR\n    A[External AI Client] --&gt;|JSON-RPC over HTTP| B[MCP Server]\n    B --&gt;|Authentication| C[Token Validation]\n    C --&gt;|Authorized| D[Tool Router]\n    D --&gt; E[search_artifacts]\n    D --&gt; F[search_nodes]\n    D --&gt; G[get_incident]\n    D --&gt; H[query_graph]\n    E --&gt; I[(Security Data Layer)]\n    F --&gt; I\n    G --&gt; I\n    H --&gt; I</code></pre>"},{"location":"ai/mcp/#quick-start","title":"Quick Start","text":"<ol> <li>Enable the MCP server \u2014 Navigate to Settings &gt; AI Configuration &gt; MCP or update via API. See MCP Configuration.</li> <li>Generate an API token \u2014 Create a token with appropriate permissions. See MCP Authentication.</li> <li>Connect your client \u2014 Point your MCP-compatible AI client to <code>https://your-instance.witfoo.com/api/v1/mcp</code>.</li> <li>Discover tools \u2014 The client will automatically enumerate available tools via the MCP protocol.</li> </ol>"},{"location":"ai/mcp/#section-contents","title":"Section Contents","text":"Page Description Architecture Protocol details, transport layer, and message flow Configuration Server setup, connection settings, and rate limits Tools Available tools with schemas and examples Authentication Token management and permission requirements Errors Error codes and troubleshooting"},{"location":"ai/mcp/architecture/","title":"MCP Architecture","text":"<p>This page describes the Model Context Protocol implementation in WitFoo Analytics, including the protocol specification, transport layer, message flow, and security model.</p>"},{"location":"ai/mcp/architecture/#protocol-overview","title":"Protocol Overview","text":"<p>WitFoo's MCP server implements the Model Context Protocol using JSON-RPC 2.0 over HTTP. The server supports the standard MCP lifecycle:</p> <ol> <li>Initialization \u2014 Client connects and negotiates capabilities.</li> <li>Discovery \u2014 Client requests the list of available tools.</li> <li>Invocation \u2014 Client calls tools with structured parameters.</li> <li>Response \u2014 Server returns structured results.</li> </ol>"},{"location":"ai/mcp/architecture/#transport-layer","title":"Transport Layer","text":"Property Value Protocol JSON-RPC 2.0 Transport HTTP/HTTPS Content-Type <code>application/json</code> Endpoint <code>/api/v1/mcp</code> Authentication Bearer token <p>All MCP communication occurs over standard HTTPS. The server does not currently support WebSocket or Server-Sent Events (SSE) transport.</p>"},{"location":"ai/mcp/architecture/#message-flow","title":"Message Flow","text":""},{"location":"ai/mcp/architecture/#tool-discovery","title":"Tool Discovery","text":"<pre><code>sequenceDiagram\n    participant Client as AI Client\n    participant MCP as MCP Server\n    participant Auth as Auth Layer\n\n    Client-&gt;&gt;MCP: POST /api/v1/mcp&lt;br/&gt;{\"method\": \"initialize\"}\n    MCP-&gt;&gt;Auth: Validate Bearer Token\n    Auth--&gt;&gt;MCP: Token Valid (org_id, permissions)\n    MCP--&gt;&gt;Client: {\"result\": {\"capabilities\": {\"tools\": true}}}\n\n    Client-&gt;&gt;MCP: POST /api/v1/mcp&lt;br/&gt;{\"method\": \"tools/list\"}\n    MCP--&gt;&gt;Client: {\"result\": {\"tools\": [...]}}</code></pre>"},{"location":"ai/mcp/architecture/#tool-invocation","title":"Tool Invocation","text":"<pre><code>sequenceDiagram\n    participant Client as AI Client\n    participant MCP as MCP Server\n    participant Auth as Auth Layer\n    participant Data as Security Data Layer\n\n    Client-&gt;&gt;MCP: POST /api/v1/mcp&lt;br/&gt;{\"method\": \"tools/call\",&lt;br/&gt;\"params\": {\"name\": \"search_artifacts\", ...}}\n    MCP-&gt;&gt;Auth: Validate Bearer Token\n    Auth--&gt;&gt;MCP: Token Valid\n    MCP-&gt;&gt;MCP: Rate Limit Check\n    MCP-&gt;&gt;Data: Execute Query\n    Data--&gt;&gt;MCP: Results\n    MCP--&gt;&gt;Client: {\"result\": {\"content\": [...]}}</code></pre>"},{"location":"ai/mcp/architecture/#json-rpc-message-format","title":"JSON-RPC Message Format","text":""},{"location":"ai/mcp/architecture/#request","title":"Request","text":"<pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"method\": \"tools/call\",\n  \"params\": {\n    \"name\": \"search_artifacts\",\n    \"arguments\": {\n      \"time_range\": \"last_24h\",\n      \"severity\": \"critical\"\n    }\n  }\n}\n</code></pre>"},{"location":"ai/mcp/architecture/#success-response","title":"Success Response","text":"<pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"result\": {\n    \"content\": [\n      {\n        \"type\": \"text\",\n        \"text\": \"Found 12 critical artifacts in the last 24 hours...\"\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"ai/mcp/architecture/#error-response","title":"Error Response","text":"<pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"error\": {\n    \"code\": -32602,\n    \"message\": \"Invalid params\",\n    \"data\": \"severity must be one of: low, medium, high, critical\"\n  }\n}\n</code></pre>"},{"location":"ai/mcp/architecture/#request-lifecycle","title":"Request Lifecycle","text":"<p>Each MCP request passes through the following stages:</p> <ol> <li>Transport \u2014 HTTP request received at <code>/api/v1/mcp</code>.</li> <li>Authentication \u2014 Bearer token validated; <code>org_id</code> and permissions extracted.</li> <li>Rate Limiting \u2014 Request checked against the per-organization rate limit (<code>rate_limit_per_min</code>).</li> <li>Concurrency Control \u2014 Request checked against the maximum concurrent request limit (<code>max_concurrent</code>).</li> <li>Routing \u2014 JSON-RPC method dispatched to the appropriate handler.</li> <li>Authorization \u2014 Tool-level permissions verified (e.g., <code>ai:read</code> for queries).</li> <li>Execution \u2014 Tool logic executed against the security data layer.</li> <li>Response \u2014 JSON-RPC response returned to the client.</li> </ol>"},{"location":"ai/mcp/architecture/#security-model","title":"Security Model","text":""},{"location":"ai/mcp/architecture/#data-isolation","title":"Data Isolation","text":"<p>All MCP tool executions are scoped to the authenticated organization (<code>org_id</code>). There is no cross-organization data access through the MCP server.</p>"},{"location":"ai/mcp/architecture/#origin-restrictions","title":"Origin Restrictions","text":"<p>The MCP server enforces an allowed origins list for CORS. Only origins explicitly configured in the MCP server settings can make requests. The default allowed origin is <code>http://localhost:5173</code> (development only).</p>"},{"location":"ai/mcp/architecture/#rate-limiting","title":"Rate Limiting","text":"<p>Rate limits are enforced per organization:</p> Setting Default Range <code>rate_limit_per_min</code> 60 1\u201310,000 <code>max_concurrent</code> 5 1\u2013100"},{"location":"ai/mcp/architecture/#encryption","title":"Encryption","text":"<p>All MCP traffic must use HTTPS in production. API tokens are transmitted as Bearer tokens in the <code>Authorization</code> header and are never logged.</p>"},{"location":"ai/mcp/architecture/#capabilities","title":"Capabilities","text":"<p>The WitFoo MCP server advertises the following capabilities during initialization:</p> Capability Supported Description <code>tools</code> \u2705 Tool discovery and invocation <code>resources</code> \u274c Not yet implemented <code>prompts</code> \u274c Not yet implemented <code>sampling</code> \u274c Not yet implemented"},{"location":"ai/mcp/authentication/","title":"MCP Authentication","text":"<p>All MCP server requests require authentication via Bearer tokens. This page covers token generation, usage, permission requirements, and security best practices.</p>"},{"location":"ai/mcp/authentication/#authentication-method","title":"Authentication Method","text":"<p>The MCP server uses Bearer token authentication via the standard HTTP <code>Authorization</code> header:</p> <pre><code>Authorization: Bearer &lt;token&gt;\n</code></pre> <p>Tokens are the same API tokens used throughout the WitFoo Analytics API. They encode the organization ID (<code>org_id</code>), user ID (<code>user_id</code>), and granted permissions.</p>"},{"location":"ai/mcp/authentication/#token-requirements","title":"Token Requirements","text":"<p>MCP tokens must include the following permissions:</p> Permission Required Purpose <code>ai:read</code> Yes Required for all MCP tool invocations (queries, searches) <code>ai:write</code> Conditional Required for tools that modify data (future) <code>ai:manage</code> No Only needed for MCP server configuration, not tool usage <code>ai:export</code> Conditional Required for bulk data export tools (future) <p>At minimum, an MCP token must have the <code>ai:read</code> permission to discover and invoke tools.</p>"},{"location":"ai/mcp/authentication/#generating-tokens","title":"Generating Tokens","text":""},{"location":"ai/mcp/authentication/#via-the-ui","title":"Via the UI","text":"<ol> <li>Navigate to Settings &gt; API Tokens.</li> <li>Click Create Token.</li> <li>Enter a descriptive name (e.g., \"MCP - Claude Desktop\").</li> <li>Select the <code>ai:read</code> permission (and any additional permissions needed).</li> <li>Set an expiration date.</li> <li>Click Generate.</li> <li>Copy the token immediately \u2014 it will not be shown again.</li> </ol>"},{"location":"ai/mcp/authentication/#via-the-api","title":"Via the API","text":"<pre><code>curl -X POST https://your-instance.witfoo.com/api/v1/auth/tokens \\\n  -H \"Authorization: Bearer &lt;admin-token&gt;\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"MCP - Claude Desktop\",\n    \"permissions\": [\"ai:read\"],\n    \"expires_at\": \"2025-12-31T23:59:59Z\"\n  }'\n</code></pre>"},{"location":"ai/mcp/authentication/#authentication-flow","title":"Authentication Flow","text":"<pre><code>sequenceDiagram\n    participant Client as AI Client\n    participant MCP as MCP Server\n    participant Auth as Auth Middleware\n    participant DB as Token Store\n\n    Client-&gt;&gt;MCP: POST /api/v1/mcp&lt;br/&gt;Authorization: Bearer &lt;token&gt;\n    MCP-&gt;&gt;Auth: Extract Bearer Token\n    Auth-&gt;&gt;DB: Validate Token\n    DB--&gt;&gt;Auth: Token Metadata&lt;br/&gt;(org_id, user_id, permissions)\n\n    alt Token Valid\n        Auth--&gt;&gt;MCP: Set org_id, user_id in context\n        MCP-&gt;&gt;MCP: Check ai:read permission\n        MCP--&gt;&gt;Client: JSON-RPC Response\n    else Token Invalid\n        Auth--&gt;&gt;Client: 401 Unauthorized\n    else Token Expired\n        Auth--&gt;&gt;Client: 401 Unauthorized&lt;br/&gt;{\"error\": \"token expired\"}\n    else Missing Permission\n        MCP--&gt;&gt;Client: JSON-RPC Error&lt;br/&gt;{\"code\": -32603, \"message\": \"insufficient permissions\"}\n    end</code></pre>"},{"location":"ai/mcp/authentication/#token-scoping","title":"Token Scoping","text":"<p>Each token is scoped to a single organization. When an MCP tool executes, it can only access data belonging to the organization associated with the token. This ensures complete data isolation between organizations.</p>"},{"location":"ai/mcp/authentication/#principle-of-least-privilege","title":"Principle of Least Privilege","text":"<p>Create dedicated tokens for MCP access with only the permissions required:</p> Use Case Recommended Permissions Read-only AI agent <code>ai:read</code> AI agent with export <code>ai:read</code>, <code>ai:export</code> Full AI access <code>ai:read</code>, <code>ai:write</code>, <code>ai:export</code> <p>Do not use administrative tokens for MCP access.</p>"},{"location":"ai/mcp/authentication/#token-lifecycle","title":"Token Lifecycle","text":""},{"location":"ai/mcp/authentication/#expiration","title":"Expiration","text":"<p>All MCP tokens should have an expiration date. Recommended expiration periods:</p> Environment Recommended Expiration Development 7\u201330 days Production 90\u2013365 days Automated pipelines Match pipeline lifecycle"},{"location":"ai/mcp/authentication/#rotation","title":"Rotation","text":"<p>To rotate an MCP token:</p> <ol> <li>Generate a new token with the same permissions.</li> <li>Update the AI client configuration with the new token.</li> <li>Verify the client connects successfully.</li> <li>Revoke the old token.</li> </ol>"},{"location":"ai/mcp/authentication/#revocation","title":"Revocation","text":"<p>Revoke a token immediately if it is compromised:</p> <pre><code>curl -X DELETE https://your-instance.witfoo.com/api/v1/auth/tokens/&lt;token-id&gt; \\\n  -H \"Authorization: Bearer &lt;admin-token&gt;\"\n</code></pre> <p>Revoked tokens are rejected immediately on the next request.</p>"},{"location":"ai/mcp/authentication/#security-best-practices","title":"Security Best Practices","text":"<p>Never Expose Tokens</p> <ul> <li>Do not commit tokens to version control.</li> <li>Do not include tokens in client-side code.</li> <li>Do not log tokens in application logs.</li> </ul> <ul> <li>Use HTTPS only \u2014 MCP tokens are transmitted in HTTP headers. Always use HTTPS in production.</li> <li>Set expiration dates \u2014 Avoid creating tokens that never expire.</li> <li>One token per client \u2014 Create separate tokens for each AI client or integration.</li> <li>Monitor usage \u2014 Review token activity in the audit log.</li> <li>Restrict origins \u2014 Configure <code>allowed_origins</code> in the MCP server settings to limit which domains can use MCP.</li> </ul>"},{"location":"ai/mcp/authentication/#troubleshooting","title":"Troubleshooting","text":"Symptom Cause Resolution <code>401 Unauthorized</code> Missing or invalid token Verify the token is included in the <code>Authorization</code> header <code>401 Unauthorized</code> (token was working) Token expired Generate a new token Tools return permission errors Token lacks <code>ai:read</code> Create a new token with the required permissions <code>403 Forbidden</code> Origin not in allowed list Add the client's origin to <code>allowed_origins</code> in MCP config"},{"location":"ai/mcp/configuration/","title":"MCP Server Configuration","text":"<p>Configure the MCP server to enable external AI clients to connect to your WitFoo Analytics instance. MCP configuration is managed per organization.</p>"},{"location":"ai/mcp/configuration/#prerequisites","title":"Prerequisites","text":"<ul> <li>The <code>ai:manage</code> permission is required to view and update MCP server settings.</li> <li>HTTPS must be configured on your WitFoo instance for production MCP access.</li> </ul>"},{"location":"ai/mcp/configuration/#configuration-settings","title":"Configuration Settings","text":"Setting Type Default Description <code>enabled</code> boolean <code>false</code> Enable or disable the MCP server <code>allowed_origins</code> string[] <code>[\"http://localhost:5173\"]</code> CORS allowed origins for MCP requests <code>rate_limit_per_min</code> integer <code>60</code> Maximum requests per minute per organization <code>max_concurrent</code> integer <code>5</code> Maximum concurrent MCP requests per organization"},{"location":"ai/mcp/configuration/#enabling-the-mcp-server","title":"Enabling the MCP Server","text":""},{"location":"ai/mcp/configuration/#via-the-ui","title":"Via the UI","text":"<ol> <li>Navigate to Settings &gt; AI Configuration &gt; MCP.</li> <li>Toggle Enable MCP Server to on.</li> <li>Configure allowed origins for your environment.</li> <li>Click Save.</li> </ol>"},{"location":"ai/mcp/configuration/#via-the-api","title":"Via the API","text":"<p>Retrieve the current configuration:</p> <pre><code>curl -X GET https://your-instance.witfoo.com/api/v1/ai/mcp \\\n  -H \"Authorization: Bearer &lt;token&gt;\"\n</code></pre> <p>Response:</p> <pre><code>{\n  \"message\": \"MCP configuration retrieved\",\n  \"data\": {\n    \"org_id\": \"org-abc123\",\n    \"enabled\": false,\n    \"allowed_origins\": [\"http://localhost:5173\"],\n    \"rate_limit_per_min\": 60,\n    \"max_concurrent\": 5\n  }\n}\n</code></pre> <p>Enable the server and configure origins:</p> <pre><code>curl -X PUT https://your-instance.witfoo.com/api/v1/ai/mcp \\\n  -H \"Authorization: Bearer &lt;token&gt;\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"enabled\": true,\n    \"allowed_origins\": [\n      \"https://your-instance.witfoo.com\",\n      \"https://claude.ai\"\n    ],\n    \"rate_limit_per_min\": 120,\n    \"max_concurrent\": 10\n  }'\n</code></pre>"},{"location":"ai/mcp/configuration/#allowed-origins","title":"Allowed Origins","text":"<p>The <code>allowed_origins</code> list controls which domains can make cross-origin requests to the MCP server. This is enforced via CORS headers.</p> <p>Production Configuration</p> <p>Remove <code>http://localhost:5173</code> from allowed origins in production environments. Only include origins that legitimately need MCP access.</p> <p>Examples:</p> <pre><code>{\n  \"allowed_origins\": [\n    \"https://your-instance.witfoo.com\",\n    \"https://claude.ai\",\n    \"https://your-internal-ai-tool.company.com\"\n  ]\n}\n</code></pre>"},{"location":"ai/mcp/configuration/#rate-limiting","title":"Rate Limiting","text":"<p>Rate limits protect the platform from excessive MCP requests. Limits are enforced per organization.</p> Setting Min Max Default Description <code>rate_limit_per_min</code> 1 10,000 60 Requests per minute <code>max_concurrent</code> 1 100 5 Simultaneous requests <p>When a rate limit is exceeded, the server returns a JSON-RPC error with code <code>-32000</code> and an appropriate message. See MCP Errors for details.</p>"},{"location":"ai/mcp/configuration/#tuning-recommendations","title":"Tuning Recommendations","text":"Environment <code>rate_limit_per_min</code> <code>max_concurrent</code> Notes Development 60 5 Default values, suitable for testing Production (single agent) 120 10 One external AI agent Production (multiple agents) 300\u2013600 20\u201330 Multiple concurrent AI integrations High-throughput automation 1,000+ 50+ Automated triage pipelines"},{"location":"ai/mcp/configuration/#api-reference","title":"API Reference","text":"Method Endpoint Permission Description <code>GET</code> <code>/api/v1/ai/mcp</code> <code>ai:read</code> Retrieve MCP configuration <code>PUT</code> <code>/api/v1/ai/mcp</code> <code>ai:manage</code> Update MCP configuration"},{"location":"ai/mcp/configuration/#default-configuration","title":"Default Configuration","text":"<p>When no MCP configuration exists for an organization, the API returns a default configuration:</p> <pre><code>{\n  \"org_id\": \"&lt;org_id&gt;\",\n  \"enabled\": false,\n  \"allowed_origins\": [\"http://localhost:5173\"],\n  \"rate_limit_per_min\": 60,\n  \"max_concurrent\": 5\n}\n</code></pre> <p>The first <code>PUT</code> request creates the configuration record; subsequent requests update it (upsert behavior).</p>"},{"location":"ai/mcp/configuration/#validation-rules","title":"Validation Rules","text":"<p>The API enforces the following validation on update requests:</p> Field Rule <code>rate_limit_per_min</code> Must be between 1 and 10,000 <code>max_concurrent</code> Must be between 1 and 100 <code>allowed_origins</code> Must be an array of strings (URL format recommended) <code>enabled</code> Boolean <p>Invalid requests return HTTP 400 with a descriptive error message.</p>"},{"location":"ai/mcp/errors/","title":"MCP Error Codes","text":"<p>This page documents error codes returned by the WitFoo MCP server, their causes, and resolution steps. MCP errors follow the JSON-RPC 2.0 error format.</p>"},{"location":"ai/mcp/errors/#error-response-format","title":"Error Response Format","text":"<p>All MCP errors are returned as JSON-RPC error objects:</p> <pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"error\": {\n    \"code\": -32600,\n    \"message\": \"Invalid Request\",\n    \"data\": \"Additional details about the error\"\n  }\n}\n</code></pre> Field Type Description <code>code</code> integer Numeric error code (JSON-RPC standard or WitFoo-specific) <code>message</code> string Short human-readable error description <code>data</code> string/object Optional additional error details"},{"location":"ai/mcp/errors/#standard-json-rpc-errors","title":"Standard JSON-RPC Errors","text":"<p>These error codes are defined by the JSON-RPC 2.0 specification:</p> Code Name Description <code>-32700</code> Parse Error The request body is not valid JSON <code>-32600</code> Invalid Request The JSON is valid but not a valid JSON-RPC request <code>-32601</code> Method Not Found The requested method does not exist <code>-32602</code> Invalid Params The method parameters are invalid <code>-32603</code> Internal Error An internal server error occurred"},{"location":"ai/mcp/errors/#parse-error-32700","title":"Parse Error (-32700)","text":"<p>Cause: The request body cannot be parsed as JSON.</p> <pre><code>{\n  \"error\": {\n    \"code\": -32700,\n    \"message\": \"Parse error\",\n    \"data\": \"unexpected end of JSON input\"\n  }\n}\n</code></pre> <p>Resolution: Verify the request body is valid JSON. Check for missing closing braces, unescaped characters, or truncated payloads.</p>"},{"location":"ai/mcp/errors/#invalid-request-32600","title":"Invalid Request (-32600)","text":"<p>Cause: The JSON is valid but does not conform to the JSON-RPC 2.0 structure.</p> <p>Resolution: Ensure the request includes <code>jsonrpc: \"2.0\"</code>, a valid <code>method</code> string, and an <code>id</code> field.</p>"},{"location":"ai/mcp/errors/#method-not-found-32601","title":"Method Not Found (-32601)","text":"<p>Cause: The requested method is not implemented by the WitFoo MCP server.</p> <pre><code>{\n  \"error\": {\n    \"code\": -32601,\n    \"message\": \"Method not found\",\n    \"data\": \"Method 'resources/list' is not supported\"\n  }\n}\n</code></pre> <p>Resolution: Use <code>tools/list</code> to discover available methods. Currently supported methods: <code>initialize</code>, <code>tools/list</code>, <code>tools/call</code>.</p>"},{"location":"ai/mcp/errors/#invalid-params-32602","title":"Invalid Params (-32602)","text":"<p>Cause: The tool was called with invalid or missing parameters.</p> <pre><code>{\n  \"error\": {\n    \"code\": -32602,\n    \"message\": \"Invalid params\",\n    \"data\": \"search_nodes requires 'query' parameter\"\n  }\n}\n</code></pre> <p>Resolution: Check the tool's input schema (available via <code>tools/list</code>) and ensure all required parameters are provided with correct types.</p>"},{"location":"ai/mcp/errors/#internal-error-32603","title":"Internal Error (-32603)","text":"<p>Cause: An unexpected error occurred during tool execution.</p> <p>Resolution: Retry the request. If the error persists, check the WitFoo server logs and contact support.</p>"},{"location":"ai/mcp/errors/#witfoo-specific-errors","title":"WitFoo-Specific Errors","text":"<p>These error codes are specific to the WitFoo MCP server implementation:</p> Code Name Description <code>-32000</code> Rate Limit Exceeded Organization rate limit has been reached <code>-32001</code> Concurrency Limit Maximum concurrent requests exceeded <code>-32002</code> Authentication Required No valid Bearer token provided <code>-32003</code> Insufficient Permissions Token lacks required permissions <code>-32004</code> MCP Disabled MCP server is not enabled for this organization <code>-32005</code> Origin Not Allowed Request origin is not in the allowed origins list <code>-32010</code> Query Timeout Tool execution exceeded the time limit <code>-32011</code> Result Too Large Query results exceed the maximum response size"},{"location":"ai/mcp/errors/#rate-limit-exceeded-32000","title":"Rate Limit Exceeded (-32000)","text":"<pre><code>{\n  \"error\": {\n    \"code\": -32000,\n    \"message\": \"Rate limit exceeded\",\n    \"data\": \"60 requests per minute limit reached. Retry after 12 seconds.\"\n  }\n}\n</code></pre> <p>Resolution: Wait for the rate limit window to reset, or increase <code>rate_limit_per_min</code> in the MCP configuration.</p>"},{"location":"ai/mcp/errors/#concurrency-limit-32001","title":"Concurrency Limit (-32001)","text":"<pre><code>{\n  \"error\": {\n    \"code\": -32001,\n    \"message\": \"Concurrency limit exceeded\",\n    \"data\": \"Maximum 5 concurrent requests. Try again shortly.\"\n  }\n}\n</code></pre> <p>Resolution: Wait for in-flight requests to complete, or increase <code>max_concurrent</code> in the MCP configuration.</p>"},{"location":"ai/mcp/errors/#authentication-required-32002","title":"Authentication Required (-32002)","text":"<pre><code>{\n  \"error\": {\n    \"code\": -32002,\n    \"message\": \"Authentication required\",\n    \"data\": \"Provide a valid Bearer token in the Authorization header\"\n  }\n}\n</code></pre> <p>Resolution: Include a valid API token in the <code>Authorization: Bearer &lt;token&gt;</code> header. See MCP Authentication.</p>"},{"location":"ai/mcp/errors/#insufficient-permissions-32003","title":"Insufficient Permissions (-32003)","text":"<pre><code>{\n  \"error\": {\n    \"code\": -32003,\n    \"message\": \"Insufficient permissions\",\n    \"data\": \"Token requires 'ai:read' permission for tool invocation\"\n  }\n}\n</code></pre> <p>Resolution: Generate a new token with the required permissions. All tool invocations require at minimum <code>ai:read</code>.</p>"},{"location":"ai/mcp/errors/#mcp-disabled-32004","title":"MCP Disabled (-32004)","text":"<pre><code>{\n  \"error\": {\n    \"code\": -32004,\n    \"message\": \"MCP server disabled\",\n    \"data\": \"Enable MCP in Settings &gt; AI Configuration &gt; MCP\"\n  }\n}\n</code></pre> <p>Resolution: Enable the MCP server via the UI or API. See MCP Configuration.</p>"},{"location":"ai/mcp/errors/#origin-not-allowed-32005","title":"Origin Not Allowed (-32005)","text":"<pre><code>{\n  \"error\": {\n    \"code\": -32005,\n    \"message\": \"Origin not allowed\",\n    \"data\": \"Origin 'https://example.com' is not in the allowed origins list\"\n  }\n}\n</code></pre> <p>Resolution: Add the client's origin to <code>allowed_origins</code> in the MCP configuration.</p>"},{"location":"ai/mcp/errors/#query-timeout-32010","title":"Query Timeout (-32010)","text":"<pre><code>{\n  \"error\": {\n    \"code\": -32010,\n    \"message\": \"Query timeout\",\n    \"data\": \"Tool execution exceeded 30 second limit\"\n  }\n}\n</code></pre> <p>Resolution: Narrow the query parameters (smaller time range, lower limit, more specific filters).</p>"},{"location":"ai/mcp/errors/#result-too-large-32011","title":"Result Too Large (-32011)","text":"<pre><code>{\n  \"error\": {\n    \"code\": -32011,\n    \"message\": \"Result too large\",\n    \"data\": \"Response exceeds 1MB limit. Use a smaller 'limit' parameter.\"\n  }\n}\n</code></pre> <p>Resolution: Reduce the <code>limit</code> parameter or add more specific filters to narrow results.</p>"},{"location":"ai/mcp/errors/#http-level-errors","title":"HTTP-Level Errors","text":"<p>Some errors are returned as standard HTTP responses before reaching the JSON-RPC layer:</p> HTTP Status Cause Resolution <code>401 Unauthorized</code> Missing or invalid Bearer token Check the <code>Authorization</code> header <code>403 Forbidden</code> Origin not allowed (CORS) Add origin to <code>allowed_origins</code> <code>404 Not Found</code> Wrong endpoint URL Use <code>/api/v1/mcp</code> <code>413 Payload Too Large</code> Request body exceeds size limit Reduce request size <code>429 Too Many Requests</code> Rate limit exceeded (HTTP-level) Wait and retry <code>503 Service Unavailable</code> MCP server disabled or unavailable Enable MCP or check server health"},{"location":"ai/mcp/errors/#troubleshooting-checklist","title":"Troubleshooting Checklist","text":"<p>When encountering MCP errors, work through this checklist:</p> <ol> <li>Is the MCP server enabled? Check <code>GET /api/v1/ai/mcp</code> for <code>\"enabled\": true</code>.</li> <li>Is the token valid? Test with a simple <code>initialize</code> request.</li> <li>Does the token have <code>ai:read</code>? Check token permissions.</li> <li>Is the origin allowed? Verify <code>allowed_origins</code> includes your client's domain.</li> <li>Are rate limits configured appropriately? Check <code>rate_limit_per_min</code> and <code>max_concurrent</code>.</li> <li>Are the tool parameters correct? Use <code>tools/list</code> to verify the expected schema.</li> <li>Check server logs for detailed error information at <code>Settings &gt; System &gt; Logs</code>.</li> </ol>"},{"location":"ai/mcp/tools/","title":"MCP Tools","text":"<p>The WitFoo MCP server exposes a set of security-focused tools that external AI clients can discover and invoke. Each tool has a defined input schema, executes against live security data, and returns structured results.</p>"},{"location":"ai/mcp/tools/#tool-discovery","title":"Tool Discovery","text":"<p>AI clients discover available tools by sending a <code>tools/list</code> request:</p> <pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 1,\n  \"method\": \"tools/list\"\n}\n</code></pre> <p>The server responds with the complete list of tools and their JSON Schema definitions.</p>"},{"location":"ai/mcp/tools/#available-tools","title":"Available Tools","text":""},{"location":"ai/mcp/tools/#search_artifacts","title":"search_artifacts","text":"<p>Query security events including IDS alerts, firewall logs, authentication events, and DNS queries.</p> <p>Input Schema:</p> <pre><code>{\n  \"type\": \"object\",\n  \"properties\": {\n    \"time_range\": {\n      \"type\": \"string\",\n      \"description\": \"Predefined range: last_1h, last_24h, last_7d, last_30d\",\n      \"enum\": [\"last_1h\", \"last_24h\", \"last_7d\", \"last_30d\"]\n    },\n    \"start_time\": {\n      \"type\": \"string\",\n      \"format\": \"date-time\",\n      \"description\": \"ISO 8601 start time (alternative to time_range)\"\n    },\n    \"end_time\": {\n      \"type\": \"string\",\n      \"format\": \"date-time\",\n      \"description\": \"ISO 8601 end time (alternative to time_range)\"\n    },\n    \"severity\": {\n      \"type\": \"string\",\n      \"enum\": [\"low\", \"medium\", \"high\", \"critical\"],\n      \"description\": \"Filter by severity level\"\n    },\n    \"artifact_type\": {\n      \"type\": \"string\",\n      \"description\": \"Filter by artifact type (e.g., ids_alert, firewall, auth, dns)\"\n    },\n    \"alarm\": {\n      \"type\": \"boolean\",\n      \"description\": \"Filter by alarm status\"\n    },\n    \"limit\": {\n      \"type\": \"integer\",\n      \"default\": 25,\n      \"maximum\": 100,\n      \"description\": \"Maximum number of results\"\n    }\n  }\n}\n</code></pre> <p>Example Request:</p> <pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 2,\n  \"method\": \"tools/call\",\n  \"params\": {\n    \"name\": \"search_artifacts\",\n    \"arguments\": {\n      \"time_range\": \"last_24h\",\n      \"severity\": \"critical\",\n      \"limit\": 10\n    }\n  }\n}\n</code></pre> <p>Example Response:</p> <pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 2,\n  \"result\": {\n    \"content\": [\n      {\n        \"type\": \"text\",\n        \"text\": \"Found 3 critical artifacts in the last 24 hours:\\n\\n1. [IDS Alert] ET EXPLOIT Possible CVE-2024-1234 - src: 10.0.1.50, dst: 192.168.1.10 - 2025-01-15T08:23:00Z\\n2. [Auth] Brute force detected - user: admin, src: 203.0.113.45 - 2025-01-15T06:15:00Z\\n3. [Firewall] Blocked outbound C2 - src: 10.0.2.30, dst: 198.51.100.77:443 - 2025-01-15T03:42:00Z\"\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"ai/mcp/tools/#search_nodes","title":"search_nodes","text":"<p>Look up network assets, users, domains, and processes in the security knowledge graph.</p> <p>Input Schema:</p> <pre><code>{\n  \"type\": \"object\",\n  \"properties\": {\n    \"query\": {\n      \"type\": \"string\",\n      \"description\": \"Search query (IP address, hostname, username, domain)\"\n    },\n    \"node_type\": {\n      \"type\": \"string\",\n      \"enum\": [\"ip\", \"hostname\", \"user\", \"domain\", \"process\"],\n      \"description\": \"Filter by node type\"\n    },\n    \"limit\": {\n      \"type\": \"integer\",\n      \"default\": 25,\n      \"maximum\": 100,\n      \"description\": \"Maximum number of results\"\n    }\n  },\n  \"required\": [\"query\"]\n}\n</code></pre> <p>Example Request:</p> <pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 3,\n  \"method\": \"tools/call\",\n  \"params\": {\n    \"name\": \"search_nodes\",\n    \"arguments\": {\n      \"query\": \"10.0.1.50\",\n      \"node_type\": \"ip\"\n    }\n  }\n}\n</code></pre> <p>Example Response:</p> <pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 3,\n  \"result\": {\n    \"content\": [\n      {\n        \"type\": \"text\",\n        \"text\": \"Found node: 10.0.1.50\\n- Type: ip\\n- Hostname: workstation-042.corp.local\\n- First seen: 2024-11-01T00:00:00Z\\n- Last seen: 2025-01-15T10:30:00Z\\n- Associated artifacts: 147\\n- Risk score: 78/100\"\n      }\n    ]\n  }\n}\n</code></pre>"},{"location":"ai/mcp/tools/#get_incident","title":"get_incident","text":"<p>Retrieve detailed information about a specific incident.</p> <p>Input Schema:</p> <pre><code>{\n  \"type\": \"object\",\n  \"properties\": {\n    \"incident_id\": {\n      \"type\": \"string\",\n      \"description\": \"Incident identifier\"\n    }\n  },\n  \"required\": [\"incident_id\"]\n}\n</code></pre> <p>Example Request:</p> <pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 4,\n  \"method\": \"tools/call\",\n  \"params\": {\n    \"name\": \"get_incident\",\n    \"arguments\": {\n      \"incident_id\": \"inc-2024-0042\"\n    }\n  }\n}\n</code></pre>"},{"location":"ai/mcp/tools/#query_graph","title":"query_graph","text":"<p>Execute queries against the security knowledge graph to discover relationships between entities.</p> <p>Input Schema:</p> <pre><code>{\n  \"type\": \"object\",\n  \"properties\": {\n    \"source\": {\n      \"type\": \"string\",\n      \"description\": \"Source entity (IP, hostname, user, domain)\"\n    },\n    \"relationship\": {\n      \"type\": \"string\",\n      \"enum\": [\"communicates_with\", \"authenticates_to\", \"resolves_to\", \"associated_with\"],\n      \"description\": \"Relationship type to traverse\"\n    },\n    \"depth\": {\n      \"type\": \"integer\",\n      \"default\": 1,\n      \"maximum\": 3,\n      \"description\": \"Graph traversal depth\"\n    },\n    \"limit\": {\n      \"type\": \"integer\",\n      \"default\": 25,\n      \"maximum\": 100\n    }\n  },\n  \"required\": [\"source\"]\n}\n</code></pre> <p>Example Request:</p> <pre><code>{\n  \"jsonrpc\": \"2.0\",\n  \"id\": 5,\n  \"method\": \"tools/call\",\n  \"params\": {\n    \"name\": \"query_graph\",\n    \"arguments\": {\n      \"source\": \"10.0.1.50\",\n      \"relationship\": \"communicates_with\",\n      \"depth\": 2\n    }\n  }\n}\n</code></pre>"},{"location":"ai/mcp/tools/#tool-permissions","title":"Tool Permissions","text":"<p>All MCP tools require at minimum the <code>ai:read</code> permission. The permission model is:</p> Tool Required Permission <code>search_artifacts</code> <code>ai:read</code> <code>search_nodes</code> <code>ai:read</code> <code>get_incident</code> <code>ai:read</code> <code>query_graph</code> <code>ai:read</code>"},{"location":"ai/mcp/tools/#response-format","title":"Response Format","text":"<p>All tool responses follow the MCP content format:</p> <pre><code>{\n  \"content\": [\n    {\n      \"type\": \"text\",\n      \"text\": \"Human-readable result text\"\n    }\n  ]\n}\n</code></pre> <p>Results are returned as formatted text optimized for LLM consumption. The text includes specific data points (IPs, timestamps, counts) that the AI client can reference in its responses.</p>"},{"location":"api/","title":"API Overview","text":"<p>WitFoo Analytics exposes a RESTful JSON API for integrating with the security operations platform. All endpoints follow consistent conventions for authentication, request format, pagination, and error handling.</p>"},{"location":"api/#base-url","title":"Base URL","text":"<p>All API requests use the base path:</p> <pre><code>https://&lt;your-instance&gt;/api/v1/\n</code></pre> <p>The API proxy prepends <code>/api</code> to all routes. Internal handler routes are registered under <code>/v1/</code>, resulting in the full path <code>/api/v1/{resource}</code>.</p>"},{"location":"api/#versioning","title":"Versioning","text":"<p>WitFoo Analytics uses URL-based versioning:</p> <pre><code>/api/v1/artifacts\n/api/v2/artifacts  (future)\n</code></pre> <p>Breaking changes (field removal, type changes, structural changes) require a version bump. Non-breaking changes (new optional fields, new endpoints, new query parameters) are added within the current version.</p>"},{"location":"api/#content-type","title":"Content Type","text":"<p>All requests and responses use <code>application/json</code> unless otherwise noted.</p> <pre><code>Content-Type: application/json\nAccept: application/json\n</code></pre>"},{"location":"api/#authentication","title":"Authentication","text":"<p>All endpoints (except public registration and health checks) require a valid JWT bearer token:</p> <pre><code>Authorization: Bearer &lt;jwt-token&gt;\n</code></pre> <p>See Authentication for details on obtaining and refreshing tokens.</p>"},{"location":"api/#health-check-endpoints","title":"Health Check Endpoints","text":"<p>These endpoints do not require authentication:</p> Method Path Description GET <code>/health</code> Basic liveness check GET <code>/ready</code> Readiness check with dependency status GET <code>/version</code> Build and version information <p>Health response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Service is healthy\",\n  \"data\": {\n    \"status\": \"healthy\",\n    \"service\": \"precinct-api\",\n    \"version\": \"7.0.0-alpha.phase3\"\n  }\n}\n</code></pre> <p>Readiness response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Service is ready\",\n  \"data\": {\n    \"status\": \"ready\",\n    \"service\": \"precinct-api\",\n    \"dependencies\": {\n      \"cassandra\": \"healthy\"\n    }\n  }\n}\n</code></pre>"},{"location":"api/#resource-groups","title":"Resource Groups","text":"Group Base Path Description Artifacts <code>/api/v1/artifacts</code> Security event artifacts Incidents <code>/api/v1/incidents</code> Security incidents Nodes <code>/api/v1/graph/nodes</code> Graph nodes (assets, users, files) Edges <code>/api/v1/graph/edges</code> Graph edges (connections, sessions) Observations <code>/api/v1/observations</code> Security observations Lead Rules <code>/api/v1/lead-rules</code> Lead detection rules Classification Rules <code>/api/v1/classification-rules</code> Node classification rules Enrichment Settings <code>/api/v1/enrichment-settings</code> Node enrichment configuration Frameworks <code>/api/v1/frameworks</code> Compliance frameworks Reports <code>/api/v1/reports</code> Report generation and retrieval Settings <code>/api/v1/settings</code> Business and system settings Admin Users <code>/api/v1/admin/users</code> User management Admin Roles <code>/api/v1/admin/roles</code> Role management Health Dashboard <code>/api/v1/health</code> Container and system monitoring CyberGrid <code>/api/v1/cybergrid</code> Threat intelligence sharing Notifications <code>/api/v1/notification-channels</code> Notification channels and rules Auth Settings <code>/api/v1/admin/settings/auth</code> Authentication provider config AI <code>/api/v1/ai</code> AI configuration and chat Monitoring <code>/api/v1/monitoring</code> SAI performance monitoring Conductor <code>/api/v1/platform/conductors</code> Conductor registration management"},{"location":"api/authentication/","title":"Authentication","text":"<p>WitFoo Analytics uses JWT (JSON Web Token) bearer authentication for all protected API endpoints.</p>"},{"location":"api/authentication/#login","title":"Login","text":"<p>Obtain a JWT token by authenticating with email and password.</p> <p>Endpoint: <code>POST /auth/login</code></p> <p>Request:</p> <pre><code>{\n  \"email\": \"analyst@example.com\",\n  \"password\": \"your-password\"\n}\n</code></pre> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Login successful\",\n  \"data\": {\n    \"token\": \"eyJhbGciOiJIUzI1NiIs...\",\n    \"user\": {\n      \"id\": \"123e4567-e89b-12d3-a456-426614174000\",\n      \"email\": \"analyst@example.com\",\n      \"org_id\": \"acme\",\n      \"full_name\": \"Jane Analyst\"\n    }\n  }\n}\n</code></pre> <p>curl example:</p> <pre><code>curl -X POST https://witfoo.example.com/auth/login \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"email\": \"analyst@example.com\", \"password\": \"your-password\"}'\n</code></pre>"},{"location":"api/authentication/#using-the-token","title":"Using the Token","text":"<p>Include the JWT in the <code>Authorization</code> header for all subsequent requests:</p> <pre><code>Authorization: Bearer eyJhbGciOiJIUzI1NiIs...\n</code></pre> <p>curl example:</p> <pre><code>curl https://witfoo.example.com/api/v1/artifacts \\\n  -H \"Authorization: Bearer eyJhbGciOiJIUzI1NiIs...\"\n</code></pre>"},{"location":"api/authentication/#token-structure","title":"Token Structure","text":"<p>The JWT payload contains:</p> Claim Type Description <code>sub</code> string User ID (UUID) <code>org_id</code> string Organization identifier <code>role</code> string User role <code>role_ids</code> array Assigned role IDs <code>permissions</code> array Resolved permissions <code>exp</code> number Expiration timestamp (Unix) <code>iat</code> number Issued-at timestamp (Unix) <p>Example decoded payload:</p> <pre><code>{\n  \"sub\": \"user-123\",\n  \"org_id\": \"acme\",\n  \"role\": \"admin\",\n  \"exp\": 1736936400,\n  \"iat\": 1736932800\n}\n</code></pre>"},{"location":"api/authentication/#token-validation","title":"Token Validation","text":"<p>The API validates tokens on every request:</p> <ol> <li>Signature verification \u2014 confirms the token was issued by this instance</li> <li>Expiration check \u2014 rejects tokens past their <code>exp</code> claim</li> <li>Claims extraction \u2014 <code>org_id</code>, <code>user_id</code>, and permissions are injected into the request context</li> <li>Resource authorization \u2014 middleware enforces that the user can access the requested organization and resource</li> </ol>"},{"location":"api/authentication/#registration","title":"Registration","text":"<p>Create a new user account (when self-registration is enabled).</p> <p>Endpoint: <code>POST /auth/register</code></p> <p>Request:</p> <pre><code>{\n  \"email\": \"newuser@example.com\",\n  \"password\": \"secure-password-123\",\n  \"full_name\": \"New User\",\n  \"org_id\": \"acme\"\n}\n</code></pre> <p>Response (201 Created):</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"User registered successfully\",\n  \"data\": {\n    \"id\": \"234e5678-e89b-12d3-a456-426614174001\",\n    \"email\": \"newuser@example.com\",\n    \"org_id\": \"acme\",\n    \"full_name\": \"New User\"\n  }\n}\n</code></pre>"},{"location":"api/authentication/#current-user","title":"Current User","text":"<p>Retrieve information about the authenticated user.</p> <p>Endpoint: <code>GET /auth/me</code></p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"User info retrieved\",\n  \"data\": {\n    \"id\": \"123e4567-e89b-12d3-a456-426614174000\",\n    \"email\": \"analyst@example.com\",\n    \"org_id\": \"acme\",\n    \"full_name\": \"Jane Analyst\"\n  }\n}\n</code></pre>"},{"location":"api/authentication/#saml-sso","title":"SAML SSO","text":"<p>WitFoo Analytics supports SAML 2.0 single sign-on. When SAML is configured for an organization:</p> Method Path Description GET <code>/auth/saml/metadata</code> SP metadata XML for IdP configuration GET <code>/auth/saml/login</code> Initiates SAML login (redirects to IdP) POST <code>/auth/saml/acs</code> Assertion Consumer Service (IdP callback) GET <code>/auth/saml/slo</code> Single Logout <p>After successful SAML authentication, the user is redirected to the UI with a JWT token in the URL.</p>"},{"location":"api/authentication/#error-responses","title":"Error Responses","text":"Status Meaning 400 Missing or invalid email/password 401 Invalid credentials or expired token 403 Account is disabled 409 User already exists (registration)"},{"location":"api/errors/","title":"Error Handling","text":"<p>This document describes the error response format, HTTP status codes, and common error scenarios across the WitFoo Analytics API.</p>"},{"location":"api/errors/#error-response-format","title":"Error Response Format","text":"<p>Error responses use the standard envelope with <code>success: false</code>:</p> <pre><code>{\n  \"success\": false,\n  \"message\": \"Human-readable error description\",\n  \"error\": \"detailed error information\"\n}\n</code></pre> <p>Some endpoints use a simplified format:</p> <pre><code>{\n  \"error\": \"description of what went wrong\",\n  \"details\": \"optional additional context\"\n}\n</code></pre>"},{"location":"api/errors/#http-status-codes","title":"HTTP Status Codes","text":""},{"location":"api/errors/#success-codes","title":"Success Codes","text":"Code Meaning Usage <code>200</code> OK Successful GET, PUT, PATCH, or POST <code>201</code> Created Resource successfully created <code>204</code> No Content Successful DELETE with no response body"},{"location":"api/errors/#client-error-codes","title":"Client Error Codes","text":"Code Meaning Common Causes <code>400</code> Bad Request Invalid JSON, validation failure, malformed UUID <code>401</code> Unauthorized Missing or expired JWT token, invalid credentials <code>403</code> Forbidden Insufficient permissions, platform admin required <code>404</code> Not Found Resource does not exist or wrong org scope <code>409</code> Conflict Duplicate resource (e.g., tenant already exists) <code>410</code> Gone Resource expired (e.g., expired share token) <code>422</code> Unprocessable Entity Validation error with valid JSON structure <code>429</code> Too Many Requests Rate limit exceeded"},{"location":"api/errors/#server-error-codes","title":"Server Error Codes","text":"Code Meaning Description <code>500</code> Internal Server Error Unexpected server-side failure <code>502</code> Bad Gateway Upstream service (e.g., incident-engine) unreachable <code>503</code> Service Unavailable Service temporarily unavailable"},{"location":"api/errors/#common-error-scenarios","title":"Common Error Scenarios","text":""},{"location":"api/errors/#authentication-errors","title":"Authentication Errors","text":"<pre><code>{\n  \"success\": false,\n  \"message\": \"Invalid user ID\",\n  \"error\": null\n}\n</code></pre> <p>Causes: Missing <code>Authorization</code> header, expired JWT, malformed token.</p>"},{"location":"api/errors/#validation-errors","title":"Validation Errors","text":"<pre><code>{\n  \"success\": false,\n  \"message\": \"Validation failed\",\n  \"error\": \"name is required; criteria must have at least one entry\"\n}\n</code></pre> <p>Causes: Missing required fields, invalid field values, constraint violations.</p>"},{"location":"api/errors/#permission-errors","title":"Permission Errors","text":"<pre><code>{\n  \"success\": false,\n  \"message\": \"Platform admin required\"\n}\n</code></pre> <p>Causes: User lacks the required role or permission for the endpoint.</p>"},{"location":"api/errors/#resource-not-found","title":"Resource Not Found","text":"<pre><code>{\n  \"error\": \"saved search not found\"\n}\n</code></pre> <p>Causes: Invalid ID, resource belongs to a different organization, resource was deleted.</p>"},{"location":"api/errors/#invalid-uuid-format","title":"Invalid UUID Format","text":"<pre><code>{\n  \"error\": \"invalid search ID format\"\n}\n</code></pre> <p>Causes: Path parameter is not a valid UUID string.</p>"},{"location":"api/errors/#expired-resource","title":"Expired Resource","text":"<pre><code>{\n  \"error\": \"shared search has expired\"\n}\n</code></pre> <p>Status: <code>410 Gone</code>. The resource existed but its TTL or share token has expired.</p>"},{"location":"api/errors/#conflict-errors","title":"Conflict Errors","text":"<pre><code>{\n  \"success\": false,\n  \"message\": \"Tenant already exists\",\n  \"error\": \"tenant already exists\"\n}\n</code></pre> <p>Status: <code>409 Conflict</code>. A resource with the same identifier already exists.</p>"},{"location":"api/errors/#upstream-service-errors","title":"Upstream Service Errors","text":"<p>When internal services (e.g., incident-engine) are unreachable, proxy endpoints return a degraded response rather than a raw error:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"mode\": \"degraded\",\n    \"capacity_percent\": 0,\n    \"license_status\": \"unknown\",\n    \"message\": \"Incident engine is temporarily unreachable\"\n  }\n}\n</code></pre>"},{"location":"api/errors/#error-handling-best-practices","title":"Error Handling Best Practices","text":"<ol> <li>Always check <code>success</code> in the response envelope before processing <code>data</code>.</li> <li>Display <code>message</code> to end users; use <code>error</code> or <code>details</code> for debugging.</li> <li>Retry on <code>429</code> and <code>503</code> with exponential backoff using the <code>Retry-After</code> header.</li> <li>Refresh tokens on <code>401</code> \u2014 the JWT may have expired.</li> <li>Log the full response for <code>500</code> errors to assist support investigations.</li> </ol>"},{"location":"api/standards/","title":"API Standards","text":"<p>This document describes the request/response conventions, pagination, filtering, and data formats used across all WitFoo Analytics API endpoints.</p>"},{"location":"api/standards/#base-url","title":"Base URL","text":"<p>All API requests use the following base URL:</p> <pre><code>https://&lt;your-precinct-host&gt;/api/v1/\n</code></pre> <p>The UI proxy prepends <code>/api</code> to all backend routes. Internal service routes use <code>/v1/</code> directly.</p>"},{"location":"api/standards/#content-type","title":"Content Type","text":"<p>All requests and responses use JSON:</p> <pre><code>Content-Type: application/json\nAccept: application/json\n</code></pre>"},{"location":"api/standards/#standard-response-envelope","title":"Standard Response Envelope","text":"<p>All API responses follow a consistent envelope format:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Operation completed successfully\",\n  \"data\": { },\n  \"meta\": { }\n}\n</code></pre> Field Type Description <code>success</code> boolean Whether the request succeeded <code>message</code> string Human-readable status message <code>data</code> any Response payload (object, array, or null) <code>meta</code> object Optional metadata (pagination, counts)"},{"location":"api/standards/#error-response-envelope","title":"Error Response Envelope","text":"<pre><code>{\n  \"success\": false,\n  \"message\": \"Descriptive error message\",\n  \"error\": \"detailed error string\"\n}\n</code></pre> <p>Some endpoints return a simplified error format:</p> <pre><code>{\n  \"error\": \"description of what went wrong\",\n  \"details\": \"optional additional context\"\n}\n</code></pre>"},{"location":"api/standards/#pagination","title":"Pagination","text":"<p>Paginated endpoints accept the following query parameters:</p> Parameter Type Default Description <code>limit</code> integer 25 Maximum items to return (max 1000) <code>offset</code> integer 0 Number of items to skip <code>page</code> integer 1 Page number (alternative to offset) <code>page_size</code> integer 25 Items per page (alternative to limit) <p>Paginated responses include a <code>meta</code> block:</p> <pre><code>{\n  \"success\": true,\n  \"data\": [],\n  \"meta\": {\n    \"total\": 142,\n    \"limit\": 25,\n    \"offset\": 0\n  }\n}\n</code></pre>"},{"location":"api/standards/#filtering","title":"Filtering","text":"<p>Most list endpoints support filtering via query parameters. Common patterns:</p> Pattern Example Description Exact match <code>?status=active</code> Field equals value Severity filter <code>?severity_level=7</code> Numeric comparison Time range <code>?start_time=2025-01-01T00:00:00Z&amp;end_time=2025-01-31T23:59:59Z</code> ISO 8601 range Entity type <code>?entity_type=signal</code> Filter by entity category Tag filter <code>?tags=malware,phishing</code> Comma-separated tags"},{"location":"api/standards/#sorting","title":"Sorting","text":"<p>Sortable endpoints accept:</p> Parameter Type Default Description <code>sort</code> string varies Field name to sort by <code>order</code> string <code>desc</code> Sort direction: <code>asc</code> or <code>desc</code>"},{"location":"api/standards/#date-and-time-format","title":"Date and Time Format","text":"<p>All timestamps use ISO 8601 format in UTC:</p> <pre><code>2025-06-18T14:30:00Z\n</code></pre> <p>Date-only fields use <code>YYYY-MM-DD</code> format:</p> <pre><code>2025-06-18\n</code></pre>"},{"location":"api/standards/#id-formats","title":"ID Formats","text":"Entity Format Example User ID UUID v4 <code>550e8400-e29b-41d4-a716-446655440000</code> Search ID TimeUUID <code>f47ac10b-58cc-4372-a567-0e02b2c3d479</code> Org ID String <code>witfoo</code> Rule ID Integer <code>42</code> Incident ID UUID <code>a1b2c3d4-e5f6-7890-abcd-ef1234567890</code>"},{"location":"api/standards/#request-size-limits","title":"Request Size Limits","text":"<ul> <li>Maximum request body: 10 MB</li> <li>Maximum batch size (e.g., batch node lookups): 100 items</li> <li>Maximum query string length: 8 KB</li> </ul>"},{"location":"api/standards/#rate-limiting","title":"Rate Limiting","text":"<p>API requests are subject to rate limiting. When exceeded, the API returns <code>429 Too Many Requests</code> with a <code>Retry-After</code> header.</p>"},{"location":"api/standards/#versioning","title":"Versioning","text":"<p>The API is versioned via the URL path (<code>/v1/</code>). Breaking changes will increment the version number. Non-breaking additions (new fields, new endpoints) may be added to the current version.</p>"},{"location":"api/endpoints/admin-roles/","title":"Admin Roles","text":"<p>Administrative endpoints for managing custom roles and their permissions. All endpoints require <code>admin:read</code> or <code>admin:write</code> permissions.</p>"},{"location":"api/endpoints/admin-roles/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/admin/roles</code> List all roles admin:read POST <code>/v1/admin/roles</code> Create role admin:write GET <code>/v1/admin/roles/:id</code> Get role by ID admin:read PUT <code>/v1/admin/roles/:id</code> Update role admin:write DELETE <code>/v1/admin/roles/:id</code> Delete role admin:write"},{"location":"api/endpoints/admin-roles/#get-v1adminroles","title":"GET /v1/admin/roles","text":"<p>List all roles for the authenticated admin's organization.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Roles retrieved successfully\",\n  \"data\": [\n    {\n      \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"org_id\": \"acme\",\n      \"role_name\": \"analyst\",\n      \"permissions\": [\"artifacts:read\", \"incidents:read\", \"incidents:write\"],\n      \"is_system\": false\n    }\n  ]\n}\n</code></pre>"},{"location":"api/endpoints/admin-roles/#post-v1adminroles","title":"POST /v1/admin/roles","text":"<p>Create a new custom role.</p> <p>Request:</p> <pre><code>{\n  \"role_name\": \"junior-analyst\",\n  \"org_id\": \"acme\",\n  \"permissions\": [\"artifacts:read\", \"incidents:read\"]\n}\n</code></pre> <p>Validation:</p> <ul> <li><code>role_name</code> is required (max 100 characters)</li> <li>At least one permission is required</li> <li><code>org_id</code> is required</li> <li>Permissions are validated against the permission registry when available</li> </ul> <p>Response: 201 Created.</p>"},{"location":"api/endpoints/admin-roles/#put-v1adminrolesid","title":"PUT /v1/admin/roles/:id","text":"<p>Update a role's name and/or permissions.</p> <p>Request:</p> <pre><code>{\n  \"role_name\": \"senior-analyst\",\n  \"permissions\": [\"artifacts:read\", \"incidents:read\", \"incidents:write\", \"graph:read\"]\n}\n</code></pre>"},{"location":"api/endpoints/admin-roles/#delete-v1adminrolesid","title":"DELETE /v1/admin/roles/:id","text":"<p>Delete a custom role. System roles cannot be deleted.</p> <p>Parameters:</p> Name Type In Required Description id string path yes Role ID (UUID)"},{"location":"api/endpoints/admin-users/","title":"Admin Users","text":"<p>Administrative endpoints for managing user accounts within an organization. All endpoints require <code>admin:read</code> or <code>admin:write</code> permissions.</p>"},{"location":"api/endpoints/admin-users/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/admin/users</code> List all users admin:read POST <code>/v1/admin/users</code> Create user admin:write GET <code>/v1/admin/users/:id</code> Get user with roles admin:read PUT <code>/v1/admin/users/:id</code> Update user admin:write DELETE <code>/v1/admin/users/:id</code> Disable user (soft delete) admin:write POST <code>/v1/admin/users/:id/roles</code> Assign roles admin:write POST <code>/v1/admin/users/:id/reset-password</code> Reset password admin:write PUT <code>/v1/admin/users/:id/locale</code> Update locale admin:write"},{"location":"api/endpoints/admin-users/#get-v1adminusers","title":"GET /v1/admin/users","text":"<p>List all users for the authenticated admin's organization.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Users retrieved successfully\",\n  \"data\": [\n    {\n      \"user\": {\n        \"id\": \"123e4567-e89b-12d3-a456-426614174000\",\n        \"email\": \"analyst@example.com\",\n        \"org_id\": \"acme\",\n        \"full_name\": \"Jane Analyst\",\n        \"is_active\": true\n      },\n      \"roles\": [\n        { \"id\": \"...\", \"role_name\": \"analyst\" }\n      ]\n    }\n  ]\n}\n</code></pre>"},{"location":"api/endpoints/admin-users/#post-v1adminusers","title":"POST /v1/admin/users","text":"<p>Create a new user account.</p> <p>Request:</p> <pre><code>{\n  \"email\": \"newuser@example.com\",\n  \"password\": \"secure-password-123\",\n  \"org_id\": \"acme\",\n  \"full_name\": \"New User\"\n}\n</code></pre> <p>Response: 201 Created.</p>"},{"location":"api/endpoints/admin-users/#post-v1adminusersidroles","title":"POST /v1/admin/users/:id/roles","text":"<p>Assign roles to a user.</p> <p>Request:</p> <pre><code>{\n  \"role_ids\": [\n    \"550e8400-e29b-41d4-a716-446655440000\"\n  ]\n}\n</code></pre>"},{"location":"api/endpoints/admin-users/#post-v1adminusersidreset-password","title":"POST /v1/admin/users/:id/reset-password","text":"<p>Admin-initiated password reset.</p> <p>Request:</p> <pre><code>{\n  \"new_password\": \"new-secure-password-456\"\n}\n</code></pre>"},{"location":"api/endpoints/admin-users/#put-v1adminusersidlocale","title":"PUT /v1/admin/users/:id/locale","text":"<p>Update a user's locale preference.</p> <p>Request:</p> <pre><code>{\n  \"locale\": \"es\"\n}\n</code></pre> <p>Supported locales: <code>en</code>, <code>es</code>, <code>fr</code>, <code>de</code>, <code>ja</code>, <code>ar</code>.</p>"},{"location":"api/endpoints/admin-users/#delete-v1adminusersid","title":"DELETE /v1/admin/users/:id","text":"<p>Disable a user account (soft delete). The user record is retained but marked inactive.</p>"},{"location":"api/endpoints/ai/","title":"AI Assistant","text":"<p>Configure AI provider integrations, manage chat sessions, and control MCP (Model Context Protocol) server settings. The AI assistant supports multiple providers including Anthropic Claude, OpenAI, Google Gemini, and IBM watsonx.ai.</p>"},{"location":"api/endpoints/ai/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/ai/config List AI provider configurations Authenticated POST /v1/ai/config Create AI provider configuration Authenticated PUT /v1/ai/config/:id Update AI provider configuration Authenticated DELETE /v1/ai/config/:id Delete AI provider configuration Authenticated GET /v1/ai/sessions List chat sessions Authenticated POST /v1/ai/sessions Create a chat session Authenticated GET /v1/ai/sessions/:id Get chat session with messages Authenticated POST /v1/ai/sessions/:id/messages Send a message Authenticated DELETE /v1/ai/sessions/:id Delete a chat session Authenticated GET /v1/ai/mcp/config Get MCP server configuration Authenticated PUT /v1/ai/mcp/config Update MCP server configuration Authenticated"},{"location":"api/endpoints/ai/#ai-provider-configuration","title":"AI Provider Configuration","text":""},{"location":"api/endpoints/ai/#supported-providers","title":"Supported Providers","text":"Provider Value Description Anthropic Claude <code>claude</code> Claude models OpenAI <code>openai</code> GPT models Google Gemini <code>gemini</code> Gemini models IBM watsonx.ai <code>watsonx</code> watsonx.ai models"},{"location":"api/endpoints/ai/#post-v1aiconfig","title":"POST /v1/ai/config","text":"<p>Create a new AI provider configuration.</p> <p>Request Body:</p> Name Type Required Description provider string yes Provider type: <code>claude</code>, <code>openai</code>, <code>gemini</code>, <code>watsonx</code> api_key string yes Provider API key model_id string yes Model identifier base_url string no Custom API base URL project_id string no Project ID (for watsonx/Gemini) region string no Cloud region max_tokens integer no Maximum response tokens temperature number no Response temperature (0.0\u20131.0) <p>Response: <code>201 Created</code></p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"org_id\": \"witfoo\",\n    \"config_id\": 1,\n    \"provider\": \"claude\",\n    \"model_id\": \"claude-sonnet-4-20250514\",\n    \"max_tokens\": 4096,\n    \"temperature\": 0.7,\n    \"enabled\": true,\n    \"created_at\": \"2025-06-18T14:30:00Z\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/ai/#chat-sessions","title":"Chat Sessions","text":""},{"location":"api/endpoints/ai/#post-v1aisessionsidmessages","title":"POST /v1/ai/sessions/:id/messages","text":"<p>Send a message to the AI assistant within a chat session. The assistant responds with context-aware analysis based on the current page and selected data.</p> <p>Request Body:</p> <pre><code>{\n  \"role\": \"user\",\n  \"content\": \"Analyze the network connections for this incident\",\n  \"context\": {\n    \"page_path\": \"/incidents/abc-123\",\n    \"entity_type\": \"incident\",\n    \"entity_id\": \"abc-123\",\n    \"selected_data\": { \"severity_level\": 8 }\n  }\n}\n</code></pre> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"message_id\": \"msg-uuid\",\n    \"role\": \"assistant\",\n    \"content\": \"Based on the incident data...\",\n    \"tokens\": 342,\n    \"created_at\": \"2025-06-18T14:31:00Z\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/ai/#mcp-server-configuration","title":"MCP Server Configuration","text":""},{"location":"api/endpoints/ai/#get-v1aimcpconfig","title":"GET /v1/ai/mcp/config","text":"<p>Get the MCP (Model Context Protocol) server configuration.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"org_id\": \"witfoo\",\n    \"enabled\": false,\n    \"allowed_origins\": [\"https://precinct.example.com\"],\n    \"rate_limit_per_min\": 60,\n    \"max_concurrent\": 5\n  }\n}\n</code></pre>"},{"location":"api/endpoints/ai/#put-v1aimcpconfig","title":"PUT /v1/ai/mcp/config","text":"<p>Update MCP server configuration. Supports partial updates.</p> <p>Request Body:</p> Name Type Required Description enabled boolean no Enable/disable MCP server allowed_origins array no Allowed CORS origins rate_limit_per_min integer no Rate limit per minute max_concurrent integer no Maximum concurrent connections"},{"location":"api/endpoints/artifacts/","title":"Artifacts","text":"<p>Artifacts represent raw security log entries ingested into the WitFoo Analytics platform. Each artifact contains parsed fields from security tools, network devices, and identity systems.</p>"},{"location":"api/endpoints/artifacts/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/artifacts List/search artifacts Authenticated GET /v1/artifacts/:id Get a specific artifact Authenticated GET /v1/artifacts/stats Get artifact statistics Authenticated"},{"location":"api/endpoints/artifacts/#get-v1artifacts","title":"GET /v1/artifacts","text":"<p>Search and list artifacts with filtering, pagination, and time range support.</p> <p>Parameters:</p> Name Type In Required Description stream_name string query no Filter by data stream severity_level integer query no Filter by severity (1\u201310) client_ip string query no Filter by client IP address server_ip string query no Filter by server IP address user_name string query no Filter by username start_time string query no Start of time range (ISO 8601) end_time string query no End of time range (ISO 8601) tags string query no Comma-separated tag filter stix_indicator_ids string query no STIX 2.x indicator ID filter attack_technique_ids string query no MITRE ATT&amp;CK technique ID filter limit integer query no Max results (default: 25) offset integer query no Pagination offset <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"data\": [\n    {\n      \"partition_key\": \"witfoo\",\n      \"time_bucket\": \"2025-06-18\",\n      \"created_at\": \"2025-06-18T14:30:00Z\",\n      \"stream_name\": \"firewall\",\n      \"severity_level\": 7,\n      \"client_ip\": \"192.168.1.100\",\n      \"server_ip\": \"10.0.0.5\",\n      \"action\": \"block\",\n      \"message\": \"Blocked connection from suspicious source\"\n    }\n  ],\n  \"meta\": {\n    \"total\": 1250,\n    \"limit\": 25,\n    \"offset\": 0\n  }\n}\n</code></pre> <p>Example:</p> <pre><code>curl -H \"Authorization: Bearer $TOKEN\" \\\n  \"https://precinct.example.com/api/v1/artifacts?severity_level=7&amp;start_time=2025-06-01T00:00:00Z&amp;limit=50\"\n</code></pre>"},{"location":"api/endpoints/artifacts/#key-artifact-fields","title":"Key Artifact Fields","text":"Category Fields Network <code>client_ip</code>, <code>server_ip</code>, <code>client_port</code>, <code>server_port</code>, <code>protocol</code> Identity <code>user_name</code>, <code>user_id</code>, <code>user_domain</code>, <code>user_email</code> File <code>file_name</code>, <code>file_path</code>, <code>file_hash</code>, <code>file_size</code>, <code>file_type</code> Threat <code>attack_type</code>, <code>threat_name</code>, <code>threat_category</code>, <code>threat_severity</code> Classification <code>message_type</code>, <code>rule_name</code>, <code>rule_category</code>, <code>severity_label</code> Metrics <code>bytes_sent</code>, <code>bytes_received</code>, <code>duration</code>, <code>packet_count</code> STIX/ATT&amp;CK <code>stix_indicator_ids</code>, <code>attack_technique_ids</code>"},{"location":"api/endpoints/auth-settings/","title":"Authentication Settings","text":"<p>Configure authentication providers for the organization including local authentication, LDAP, and SAML 2.0 integration.</p>"},{"location":"api/endpoints/auth-settings/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/settings/auth Get authentication settings Public GET /v1/auth/provider Get auth provider configuration Authenticated PUT /v1/auth/provider Update auth provider configuration Authenticated POST /v1/auth/provider/test Test auth provider connection Authenticated POST /v1/auth/switch-tenant Switch active tenant context Authenticated GET /v1/auth/tenant-context Get current tenant context Authenticated"},{"location":"api/endpoints/auth-settings/#get-v1settingsauth","title":"GET /v1/settings/auth","text":"<p>Public endpoint returning which authentication methods are enabled. Used by the login page to display appropriate options.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Auth settings retrieved successfully\",\n  \"data\": {\n    \"authentication\": {\n      \"saml2_enabled\": true,\n      \"ldap_enabled\": false\n    }\n  }\n}\n</code></pre>"},{"location":"api/endpoints/auth-settings/#auth-provider-configuration","title":"Auth Provider Configuration","text":""},{"location":"api/endpoints/auth-settings/#auth-modes","title":"Auth Modes","text":"Mode Description <code>local</code> Local username/password authentication only <code>ldap</code> LDAP directory authentication <code>saml</code> SAML 2.0 single sign-on <code>mixed</code> Multiple authentication methods enabled"},{"location":"api/endpoints/auth-settings/#ldap-configuration","title":"LDAP Configuration","text":"Field Type Description enabled boolean Enable LDAP authentication server_url string LDAP server URL bind_dn string Bind distinguished name bind_password string Bind password base_dn string Base DN for user searches user_filter string LDAP user search filter tls_enabled boolean Enable TLS for LDAP connection tls_skip_verify boolean Skip TLS certificate verification"},{"location":"api/endpoints/auth-settings/#saml-configuration","title":"SAML Configuration","text":"Field Type Description enabled boolean Enable SAML authentication entity_id string Service provider entity ID sso_url string IdP single sign-on URL slo_url string IdP single logout URL certificate string SP certificate (PEM) idp_metadata_url string IdP metadata URL name_id_format string NameID format attribute_mappings object SAML attribute to user field mappings sign_requests boolean Sign SAML requests"},{"location":"api/endpoints/auth-settings/#post-v1authswitch-tenant","title":"POST /v1/auth/switch-tenant","text":"<p>Switch the active tenant context for platform administrators. Returns a new JWT token with the updated tenant context.</p> <p>Request Body:</p> Name Type Required Description tenant_id string yes Target tenant ID <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"tenant context switched\",\n  \"data\": {\n    \"token\": \"eyJhbGciOiJIUzI1NiIs...\",\n    \"active_tenant_id\": \"tenant-abc\",\n    \"message\": \"Switched to tenant-abc\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/auth-settings/#get-v1authtenant-context","title":"GET /v1/auth/tenant-context","text":"<p>Get the current tenant context for the authenticated user.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"tenant context retrieved\",\n  \"data\": {\n    \"active_tenant_id\": \"tenant-abc\",\n    \"home_tenant_id\": \"witfoo\",\n    \"is_platform_admin\": true\n  }\n}\n</code></pre>"},{"location":"api/endpoints/classification-rules/","title":"Classification Rules","text":"<p>Classification rules automatically categorize graph nodes as internal, managed, or trusted based on matching criteria. Rules are evaluated against node attributes during graph processing.</p>"},{"location":"api/endpoints/classification-rules/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/classification-rules List classification rules Authenticated GET /v1/classification-rules/:id Get a classification rule Authenticated POST /v1/classification-rules Create a classification rule Authenticated PUT /v1/classification-rules/:id Update a classification rule Authenticated DELETE /v1/classification-rules/:id Delete a classification rule Authenticated"},{"location":"api/endpoints/classification-rules/#data-model","title":"Data Model","text":"Field Type Description org_id string Organization ID rule_id integer Auto-generated rule identifier name string Rule name description string Rule description rule_category string <code>network</code>, <code>asset</code>, <code>user</code>, <code>file</code>, <code>process</code>, <code>custom</code> target_attribute string Attribute to set: <code>internal</code>, <code>managed</code>, <code>trusted</code> criteria array List of matching criteria priority integer Evaluation priority (lower = higher priority) enabled boolean Whether the rule is active created_by string Creator user ID created_at string ISO 8601 timestamp updated_at string ISO 8601 timestamp"},{"location":"api/endpoints/classification-rules/#criteria-object","title":"Criteria Object","text":"<p>Each criterion in the <code>criteria</code> array:</p> Field Type Description field string Node field to match (e.g., <code>ip_address</code>, <code>hostname</code>) operator string <code>=</code>, <code>!=</code>, <code>contains</code>, <code>matches</code>, <code>&gt;</code>, <code>&lt;</code>, <code>&gt;=</code>, <code>&lt;=</code> value string Value to match against"},{"location":"api/endpoints/classification-rules/#post-v1classification-rules","title":"POST /v1/classification-rules","text":"<p>Create a new classification rule.</p> <p>Request Body:</p> <pre><code>{\n  \"name\": \"Internal Network Range\",\n  \"description\": \"Classify RFC 1918 addresses as internal\",\n  \"rule_category\": \"network\",\n  \"target_attribute\": \"internal\",\n  \"criteria\": [\n    { \"field\": \"ip_address\", \"operator\": \"matches\", \"value\": \"^10\\\\.\" },\n    { \"field\": \"ip_address\", \"operator\": \"matches\", \"value\": \"^192\\\\.168\\\\.\" }\n  ],\n  \"priority\": 10,\n  \"enabled\": true\n}\n</code></pre> <p>Response: <code>201 Created</code></p>"},{"location":"api/endpoints/classification-rules/#available-criteria-fields","title":"Available Criteria Fields","text":"Category Fields Asset <code>ip_address</code>, <code>hostname</code>, <code>mac_address</code>, <code>asset_id</code> User <code>credential</code>, <code>user_domain</code> File <code>filename</code>, <code>filehash</code>, <code>filepath</code> Process <code>process_name</code>, <code>process_id</code>, <code>command_line</code> Network <code>domain_name</code>, <code>url</code>, <code>url_host</code> Compliance <code>frameworks</code>, <code>control_compliance</code> General <code>node_type</code> <p>The <code>matches</code> operator supports regular expressions. The <code>control_compliance</code> field accepts a JSON-encoded value specifying a framework ID and control IDs for compliance-based classification.</p>"},{"location":"api/endpoints/conductor/","title":"Conductor","text":"<p>Coming Soon</p> <p>This page is under development. Content will be auto-generated from the WitFoo Analytics v0.9.1 codebase on the next release.</p>"},{"location":"api/endpoints/cybergrid/","title":"CyberGrid","text":"<p>CyberGrid enables cross-cluster threat intelligence sharing between WitFoo Analytics deployments. Manage publications, subscriptions, distributed jobs, IOC submissions, and anonymous threat data sharing.</p>"},{"location":"api/endpoints/cybergrid/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/cybergrid/publications List publications Authenticated POST /v1/cybergrid/publications Create a publication Authenticated PUT /v1/cybergrid/publications/:id Update a publication Authenticated DELETE /v1/cybergrid/publications/:id Delete a publication Authenticated GET /v1/cybergrid/publications/:id/subscribers List subscribers Authenticated POST /v1/cybergrid/publications/:id/subscribers/:sid/approve Approve subscriber Authenticated POST /v1/cybergrid/publications/:id/subscribers/:sid/reject Reject subscriber Authenticated GET /v1/cybergrid/subscriptions List subscriptions Authenticated POST /v1/cybergrid/subscriptions Create a subscription Authenticated PUT /v1/cybergrid/subscriptions/:id Update a subscription Authenticated DELETE /v1/cybergrid/subscriptions/:id Delete a subscription Authenticated PATCH /v1/cybergrid/subscriptions/:id/toggle Toggle subscription Authenticated POST /v1/cybergrid/jobs Submit a distributed job Authenticated GET /v1/cybergrid/jobs/:id Get job status Authenticated GET /v1/cybergrid/jobs/:id/results Get job results Authenticated POST /v1/cybergrid/jobs/:id/approve Approve a pending job Authenticated POST /v1/cybergrid/jobs/:id/reject Reject a pending job Authenticated POST /v1/cybergrid/ioc/submit Submit IOC detection Authenticated GET /v1/cybergrid/ioc/search Search IOC detections Authenticated GET /v1/cybergrid/anon/settings Get anonymous sharing settings Authenticated PUT /v1/cybergrid/anon/settings Update anonymous sharing settings Authenticated"},{"location":"api/endpoints/cybergrid/#publications","title":"Publications","text":"<p>Publications define what data types your organization shares with subscribers.</p>"},{"location":"api/endpoints/cybergrid/#subscription-types","title":"Subscription Types","text":"Type Description <code>work_definitions</code> MO definitions and work patterns <code>work_observations</code> Behavioral observation rules <code>node_classifications</code> Node classification rules <code>lead_rules</code> Lead rule definitions <code>incident_collection</code> Incident/collection data <code>report_collection</code> Report snapshots"},{"location":"api/endpoints/cybergrid/#post-v1cybergridpublications","title":"POST /v1/cybergrid/publications","text":"<p>Request Body:</p> <pre><code>{\n  \"name\": \"Threat Intel Share\",\n  \"description\": \"Share lead rules and observations\",\n  \"publication_types\": [\"lead_rules\", \"work_observations\"],\n  \"auto_approve\": false,\n  \"require_job_approval\": true,\n  \"enabled\": true\n}\n</code></pre>"},{"location":"api/endpoints/cybergrid/#subscriptions","title":"Subscriptions","text":"<p>Subscriptions connect to remote CyberGrid publications.</p>"},{"location":"api/endpoints/cybergrid/#post-v1cybergridsubscriptions","title":"POST /v1/cybergrid/subscriptions","text":"<p>Request Body:</p> <pre><code>{\n  \"remote_url\": \"https://partner.example.com/api/v1/cybergrid\",\n  \"remote_org_name\": \"Partner SOC\",\n  \"subscription_types\": [\"lead_rules\", \"work_observations\"],\n  \"enabled\": true,\n  \"auto_approve_jobs\": false\n}\n</code></pre>"},{"location":"api/endpoints/cybergrid/#distributed-jobs","title":"Distributed Jobs","text":"<p>Jobs execute cross-cluster queries against subscribed publications.</p>"},{"location":"api/endpoints/cybergrid/#job-types","title":"Job Types","text":"Type Description <code>search_signals</code> Search artifacts/signals <code>search_nodes</code> Search graph nodes <code>search_edges</code> Search graph edges `"},{"location":"api/endpoints/edges/","title":"Edges","text":"<p>Graph edges represent relationships between nodes: network connections, user sessions, file presence on hosts, and attribution links. Edges carry aggregate metrics (bytes, count) and matched lead rules.</p>"},{"location":"api/endpoints/edges/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/graph/edges</code> List edges with filters graph:read GET <code>/v1/graph/edges/:id</code> Get edge by ID graph:read POST <code>/v1/graph/edges/search</code> Search edges (POST) graph:read GET <code>/v1/graph/edges/stats</code> Get edge statistics graph:read GET <code>/v1/graph/edges/facets</code> Get edge facets graph:read GET <code>/v1/graph/nodes/:id/edges</code> Get edges for a node graph:read"},{"location":"api/endpoints/edges/#get-v1graphedges","title":"GET /v1/graph/edges","text":"<p>List edges with optional filters and pagination.</p> <p>Parameters:</p> Name Type In Required Description org_id string query yes Organization ID edge_type string query no <code>connection</code>, <code>session</code>, <code>presence</code>, <code>attribution</code> matched_lead_rules string query no Comma-separated lead rule IDs source_node_type string query no Source node type filter source_ip_address string query no Source node IP filter target_node_type string query no Target node type filter target_ip_address string query no Target node IP filter limit int query no Max results (default 100, max 1000) page_state string query no Pagination cursor (base64) <p>Response:</p> <pre><code>{\n  \"edges\": [\n    {\n      \"edge_id\": \"src_tgt_connection\",\n      \"org_id\": \"acme\",\n      \"edge_type\": \"connection\",\n      \"source_id\": \"550e8400-...\",\n      \"target_id\": \"660e8400-...\",\n      \"bytes\": 1048576,\n      \"count\": 42,\n      \"matched_lead_rules\": [1]\n    }\n  ],\n  \"next_page_state\": \"\",\n  \"count\": 1\n}\n</code></pre>"},{"location":"api/endpoints/edges/#get-v1graphnodesidedges","title":"GET /v1/graph/nodes/:id/edges","text":"<p>Get all edges connected to a specific node. With <code>depth=1</code>, also returns connected nodes.</p> <p>Parameters:</p> Name Type In Required Description org_id string query yes Organization ID id string path yes Node ID (UUID) edge_type string query no Filter by edge type depth int query no 0 = edges only, 1 = edges + connected nodes <p>Response:</p> <pre><code>{\n  \"node_id\": \"550e8400-...\",\n  \"edges\": [ ... ],\n  \"nodes\": [ ... ],\n  \"count\": 5\n}\n</code></pre>"},{"location":"api/endpoints/enrichment-settings/","title":"Enrichment Settings","text":"<p>Configure automated enrichment for graph nodes including IOC threat intelligence feeds, DNS reverse lookups, and STIX/TAXII threat indicator polling.</p>"},{"location":"api/endpoints/enrichment-settings/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/enrichment-settings List enrichment settings Authenticated GET /v1/enrichment-settings/:id Get an enrichment setting Authenticated POST /v1/enrichment-settings Create an enrichment setting Authenticated PUT /v1/enrichment-settings/:id Update an enrichment setting Authenticated DELETE /v1/enrichment-settings/:id Delete an enrichment setting Authenticated"},{"location":"api/endpoints/enrichment-settings/#data-model","title":"Data Model","text":"Field Type Description org_id string Organization ID setting_id integer Auto-generated setting identifier name string Setting name description string Setting description setting_type string <code>ioc_feed</code>, <code>dns_lookup</code>, or <code>stix_taxii</code> enabled boolean Whether the setting is active config object Type-specific configuration priority integer Evaluation priority created_by string Creator user ID created_at string ISO 8601 timestamp updated_at string ISO 8601 timestamp"},{"location":"api/endpoints/enrichment-settings/#setting-types","title":"Setting Types","text":"Type Description <code>ioc_feed</code> GeoIP and threat intelligence from WitFoo Library <code>dns_lookup</code> Reverse DNS hostname resolution for IP addresses <code>stix_taxii</code> TAXII 2.1 threat intelligence indicator polling"},{"location":"api/endpoints/enrichment-settings/#configuration-by-type","title":"Configuration by Type","text":"<p>IOC Feed (<code>ioc_feed</code>):</p> Field Type Default Description min_score number 0.5 Minimum threat score to flag (0.0\u20131.0) <p>DNS Lookup (<code>dns_lookup</code>):</p> Field Type Default Description dns_server string <code>8.8.8.8</code> DNS server address timeout_ms integer 5000 Lookup timeout in milliseconds <p>STIX/TAXII (<code>stix_taxii</code>):</p> Field Type Default Description taxii.server_url string \u2014 TAXII 2.1 server URL (required, must be http/https) taxii.collection_id string \u2014 TAXII collection ID (required) taxii.username string \u2014 Basic auth username taxii.password string \u2014 Basic auth password taxii.api_key string \u2014 API key (alternative to basic auth) taxii.poll_interval_minutes integer 60 Polling interval (min: 5) taxii.indicator_types array \u2014 Filter indicator types (e.g., <code>[\"ipv4-addr\", \"domain-name\"]</code>)"},{"location":"api/endpoints/enrichment-settings/#post-v1enrichment-settings","title":"POST /v1/enrichment-settings","text":"<p>Create a new enrichment setting.</p> <p>Request Body:</p> <pre><code>{\n  \"name\": \"TAXII Threat Feed\",\n  \"description\": \"Poll STIX indicators from threat intel provider\",\n  \"setting_type\": \"stix_taxii\",\n  \"enabled\": true,\n  \"config\": {\n    \"taxii\": {\n      \"server_url\": \"https://taxii.example.com/taxii2/\",\n      \"collection_id\": \"collection-abc-123\",\n      \"api_key\": \"your-api-key\",\n      \"poll_interval_minutes\": 30,\n      \"indicator_types\": [\"ipv4-addr\", \"domain-name\", \"file:hashes.SHA-256\"]\n    }\n  },\n  \"priority\": 10\n}\n</code></pre> <p>Response: <code>201 Created</code></p> <p>Example:</p> <pre><code>curl -X POST -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"DNS Resolver\",\n    \"description\": \"Reverse DNS for asset nodes\",\n    \"setting_type\": \"dns_lookup\",\n    \"enabled\": true,\n    \"config\": {\"dns_server\": \"8.8.8.8\", \"timeout_ms\": 3000},\n    \"priority\": 5\n  }' \\\n  \"https://precinct.example.com/api/v1/enrichment-settings\"\n</code></pre>"},{"location":"api/endpoints/frameworks/","title":"Frameworks","text":"<p>Compliance frameworks (CIS, NIST, PCI-DSS, etc.) map security controls to detection rules and graph data. Organizations can enable multiple frameworks and designate one as primary.</p>"},{"location":"api/endpoints/frameworks/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/frameworks</code> List frameworks frameworks:read GET <code>/v1/frameworks/:id</code> Get framework with controls frameworks:read PATCH <code>/v1/frameworks/:id/toggle</code> Enable/disable framework frameworks:write PATCH <code>/v1/frameworks/:id/set-primary</code> Set as primary framework frameworks:write"},{"location":"api/endpoints/frameworks/#get-v1frameworks","title":"GET /v1/frameworks","text":"<p>List all compliance frameworks for the organization.</p> <p>Parameters:</p> Name Type In Required Description enabled string query no Filter by enabled status (<code>true</code>) <p>Response:</p> <pre><code>[\n  {\n    \"org_id\": \"acme\",\n    \"framework_id\": \"nist\",\n    \"name\": \"NIST Cybersecurity Framework\",\n    \"enabled\": true,\n    \"is_primary\": true,\n    \"controls\": [ ... ]\n  }\n]\n</code></pre>"},{"location":"api/endpoints/frameworks/#get-v1frameworksid","title":"GET /v1/frameworks/:id","text":"<p>Get a specific framework with its controls.</p> <p>Parameters:</p> Name Type In Required Description id string path yes Framework ID (e.g., <code>cis</code>, <code>nist</code>, <code>pci</code>)"},{"location":"api/endpoints/frameworks/#patch-v1frameworksidtoggle","title":"PATCH /v1/frameworks/:id/toggle","text":"<p>Enable or disable a framework.</p> <p>Request:</p> <pre><code>{\n  \"enabled\": true\n}\n</code></pre>"},{"location":"api/endpoints/frameworks/#patch-v1frameworksidset-primary","title":"PATCH /v1/frameworks/:id/set-primary","text":"<p>Designate a framework as the primary compliance framework for the organization.</p> <p>Response:</p> <pre><code>{\n  \"framework_id\": \"nist\",\n  \"is_primary\": true\n}\n</code></pre>"},{"location":"api/endpoints/health-dashboard/","title":"Health Dashboard","text":"<p>Monitor the health of the WitFoo Analytics platform infrastructure, including Docker container status, resource utilization, and alert management.</p>"},{"location":"api/endpoints/health-dashboard/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/system/status Get current system status Authenticated GET /v1/system/status/history Get system status history Authenticated <p>These endpoints proxy requests to the incident-engine service. If the incident-engine is unreachable, a degraded status response is returned instead of an error.</p>"},{"location":"api/endpoints/health-dashboard/#get-v1systemstatus","title":"GET /v1/system/status","text":"<p>Returns the current system health status including capacity, license, and operational mode.</p> <p>Parameters: None.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"org_id\": \"witfoo\",\n    \"mode\": \"active\",\n    \"disk_total_gb\": 500,\n    \"disk_used_gb\": 125,\n    \"disk_usable_gb\": 375,\n    \"capacity_percent\": 25,\n    \"license_status\": \"active\",\n    \"license_expires_at\": \"2026-06-18T00:00:00Z\",\n    \"license_days_left\": 365,\n    \"recommendations\": [],\n    \"checked_at\": \"2025-06-18T14:30:00Z\"\n  }\n}\n</code></pre> <p>The <code>mode</code> field indicates the operational state:</p> Value Description <code>active</code> System operating normally <code>warning</code> Approaching capacity or license limits <code>disabled</code> System disabled due to capacity or license issues <code>degraded</code> Incident-engine unreachable <p>Degraded Response (when incident-engine is unreachable):</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"mode\": \"degraded\",\n    \"capacity_percent\": 0,\n    \"license_status\": \"unknown\",\n    \"message\": \"Incident engine is temporarily unreachable\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/health-dashboard/#get-v1systemstatushistory","title":"GET /v1/system/status/history","text":"<p>Returns historical system status data. Supports query string passthrough to the incident-engine.</p> <p>Parameters: Passed through to the incident-engine service.</p> <p>Response: Proxied from the incident-engine service.</p>"},{"location":"api/endpoints/health-dashboard/#data-types","title":"Data Types","text":""},{"location":"api/endpoints/health-dashboard/#container-health","title":"Container Health","text":"<p>Container health data includes the following fields:</p> Field Type Description container_name string Docker container name state string <code>running</code>, <code>restarting</code>, <code>paused</code>, <code>exited</code>, <code>dead</code> health string <code>healthy</code>, <code>unhealthy</code>, <code>starting</code>, <code>none</code> cpu_percent number CPU usage percentage memory_usage_mb number Memory usage in MB memory_limit_mb number Memory limit in MB memory_percent number Memory usage percentage restart_count integer Number of container restarts"},{"location":"api/endpoints/health-dashboard/#alert-configuration","title":"Alert Configuration","text":"<p>Health alerts can be configured for the following types:</p> Alert Type Description <code>container_down</code> Container stopped or exited <code>high_cpu</code> CPU usage exceeds threshold <code>high_memory</code> Memory usage exceeds threshold <code>high_restarts</code> Restart count exceeds threshold <code>disk_space</code> Available disk space below threshold <code>network_error</code> Network connectivity issues"},{"location":"api/endpoints/incidents/","title":"Incidents","text":"<p>Security incidents represent correlated threat events requiring investigation and response. Incidents support workflow management with status tracking, assignment, notes, and audit trails.</p>"},{"location":"api/endpoints/incidents/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/incidents</code> Search incidents incidents:read GET <code>/v1/incidents/stats</code> Get incident statistics incidents:read GET <code>/v1/incidents/:id</code> Get single incident incidents:read POST <code>/v1/incidents</code> Create incident incidents:write PUT <code>/v1/incidents/:id</code> Update incident incidents:write POST <code>/v1/incidents/:id/notes</code> Add note incidents:write GET <code>/v1/incidents/:id/notes</code> Get notes incidents:read GET <code>/v1/incidents/:id/audit</code> Get audit log incidents:read PUT <code>/v1/incidents/:id/status-audit</code> Update status with audit incidents:write"},{"location":"api/endpoints/incidents/#get-v1incidents","title":"GET /v1/incidents","text":"<p>Search incidents with filtering on status, severity, assignee, and time range.</p> <p>Parameters:</p> Name Type In Required Description status_id int query no Status ID filter severity_level int query no Severity level (1\u201310) assigned_to string query no Assigned user filter org_id string query no Organization ID override tags string[] query no Tags filter time_start string query no Start time (RFC 3339) time_end string query no End time (RFC 3339) min_suspicion number query no Minimum suspicion score (0\u2013100) max_suspicion number query no Maximum suspicion score (0\u2013100) suspicion_level string query no Category: <code>low</code>, <code>medium</code>, <code>high</code> node_id string query no Filter by associated node ID limit int query no Max results (default 100, max 5000) offset int query no Results to skip <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Incidents retrieved successfully\",\n  \"data\": [\n    {\n      \"incident_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"org_id\": \"acme\",\n      \"status_id\": 1,\n      \"severity_level\": 7,\n      \"assigned_to\": \"analyst@example.com\",\n      \"suspicion_score\": 0.85\n    }\n  ],\n  \"meta\": {\n    \"total\": 42,\n    \"limit\": 100,\n    \"offset\": 0\n  }\n}\n</code></pre>"},{"location":"api/endpoints/incidents/#post-v1incidentsidnotes","title":"POST /v1/incidents/:id/notes","text":"<p>Add a note to an incident.</p> <p>Request:</p> <pre><code>{\n  \"note_text\": \"Investigated source IP \u2014 confirmed malicious activity.\",\n  \"author_name\": \"Jane Analyst\"\n}\n</code></pre> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Note added successfully\",\n  \"data\": {\n    \"note_id\": \"...\",\n    \"note_text\": \"Investigated source IP \u2014 confirmed malicious activity.\",\n    \"author_name\": \"Jane Analyst\",\n    \"created_at\": \"2025-01-15T10:30:00Z\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/incidents/#put-v1incidentsidstatus-audit","title":"PUT /v1/incidents/:id/status-audit","text":"<p>Update incident status with automatic audit trail.</p> <p>Request:</p> <pre><code>{\n  \"status_id\": 3\n}\n</code></pre>"},{"location":"api/endpoints/lead-rules/","title":"Lead Rules","text":"<p>Lead rules define pattern-matching criteria applied to artifacts, nodes, and edges during ingestion. When data matches a lead rule, it is flagged for further analysis and may contribute to incident generation.</p>"},{"location":"api/endpoints/lead-rules/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/lead-rules List lead rules Authenticated GET /v1/lead-rules/:id Get a lead rule Authenticated POST /v1/lead-rules Create a lead rule Authenticated PUT /v1/lead-rules/:id Update a lead rule Authenticated DELETE /v1/lead-rules/:id Delete a lead rule Authenticated PATCH /v1/lead-rules/:id/toggle Toggle rule enabled state Authenticated"},{"location":"api/endpoints/lead-rules/#data-model","title":"Data Model","text":"Field Type Description rule_id integer Auto-generated rule identifier description string Rule description rule_type integer <code>1</code> = Artifact, <code>2</code> = Node, <code>3</code> = Edge enabled boolean Whether the rule is active criteria string Matching criteria expression suspicion_boost number Score boost when matched (0.0\u20131.0) client_set_id integer Optional client set reference server_set_id integer Optional server set reference file_set_id integer Optional file set reference user_set_id integer Optional user set reference service_set_id integer Optional service set reference hardware_set_id integer Optional hardware set reference foreign_id string External reference ID product_id string Associated product ID criteria_type string Criteria format type rule_source string Rule origin created_at string ISO 8601 timestamp updated_at string ISO 8601 timestamp"},{"location":"api/endpoints/lead-rules/#post-v1lead-rules","title":"POST /v1/lead-rules","text":"<p>Create a new lead rule.</p> <p>Request Body:</p> <pre><code>{\n  \"description\": \"Detect SSH brute force attempts\",\n  \"rule_type\": 1,\n  \"enabled\": true,\n  \"criteria\": \"action=block AND server_port=22 AND count&gt;10\",\n  \"suspicion_boost\": 0.7,\n  \"criteria_type\": \"expression\",\n  \"rule_source\": \"custom\"\n}\n</code></pre> <p>Response: <code>201 Created</code></p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"rule_id\": 42,\n    \"description\": \"Detect SSH brute force attempts\",\n    \"rule_type\": 1,\n    \"enabled\": true,\n    \"criteria\": \"action=block AND server_port=22 AND count&gt;10\",\n    \"suspicion_boost\": 0.7,\n    \"created_at\": \"2025-06-18T14:30:00Z\"\n  }\n}\n</code></pre> <p>Example:</p> <pre><code>curl -X POST -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"description\": \"Detect SSH brute force\",\n    \"rule_type\": 1,\n    \"enabled\": true,\n    \"criteria\": \"action=block AND server_port=22 AND count&gt;10\",\n    \"suspicion_boost\": 0.7\n  }' \\\n  \"https://precinct.example.com/api/v1/lead-rules\"\n</code></pre>"},{"location":"api/endpoints/lead-rules/#patch-v1lead-rulesidtoggle","title":"PATCH /v1/lead-rules/:id/toggle","text":"<p>Toggle the enabled/disabled state of a lead rule.</p> <p>Request Body:</p> <pre><code>{\n  \"enabled\": false\n}\n</code></pre> <p>Response: <code>200 OK</code></p>"},{"location":"api/endpoints/monitoring/","title":"Monitoring","text":"<p>Coming Soon</p> <p>This page is under development. Content will be auto-generated from the WitFoo Analytics v0.9.1 codebase on the next release.</p>"},{"location":"api/endpoints/nodes/","title":"Nodes","text":"<p>Graph nodes represent entities discovered in security data: assets (IP addresses), users, files, processes, domains, and URLs. Nodes are deduplicated and enriched with threat intelligence, classification, and compliance metadata.</p>"},{"location":"api/endpoints/nodes/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/graph/nodes</code> List nodes with filters graph:read GET <code>/v1/graph/nodes/:id</code> Get node by ID graph:read GET <code>/v1/graph/nodes/facets</code> Get node facets graph:read POST <code>/v1/graph/nodes/search</code> Search nodes (POST) graph:read POST <code>/v1/graph/nodes/batch</code> Batch get nodes graph:read POST <code>/v1/graph/nodes/asset</code> Create asset node graph:write POST <code>/v1/graph/nodes/user</code> Create user node graph:write POST <code>/v1/graph/nodes/file</code> Create file node graph:write"},{"location":"api/endpoints/nodes/#get-v1graphnodes","title":"GET /v1/graph/nodes","text":"<p>List nodes with optional filters and cursor-based pagination.</p> <p>Parameters:</p> Name Type In Required Description org_id string query yes Organization ID node_type string query no <code>asset</code>, <code>user</code>, <code>file</code>, <code>process</code>, <code>domain</code>, <code>url</code> internal boolean query no Filter by internal flag managed boolean query no Filter by managed flag matched_lead_rules string query no Comma-separated lead rule IDs frameworks string query no Comma-separated framework IDs frameworks_exclude string query no Exclude framework IDs limit int query no Max results (default 100) page_state string query no Pagination cursor (base64) <p>Response:</p> <pre><code>{\n  \"nodes\": [\n    {\n      \"node_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"org_id\": \"acme\",\n      \"node_type\": \"asset\",\n      \"ip_address\": \"192.168.1.100\",\n      \"hostname\": \"workstation-01\",\n      \"internal\": true,\n      \"managed\": true\n    }\n  ],\n  \"next_page_state\": \"base64-encoded-cursor\",\n  \"count\": 100\n}\n</code></pre>"},{"location":"api/endpoints/nodes/#post-v1graphnodesbatch","title":"POST /v1/graph/nodes/batch","text":"<p>Retrieve multiple nodes by ID in a single request (max 100).</p> <p>Request:</p> <pre><code>{\n  \"org_id\": \"acme\",\n  \"node_ids\": [\n    \"550e8400-e29b-41d4-a716-446655440000\",\n    \"660e8400-e29b-41d4-a716-446655440001\"\n  ]\n}\n</code></pre> <p>Response:</p> <pre><code>{\n  \"nodes\": [ ... ],\n  \"count\": 2,\n  \"errors\": {\n    \"invalid-uuid\": \"invalid UUID format\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/nodes/#get-v1graphnodesfacets","title":"GET /v1/graph/nodes/facets","text":"<p>Calculate facet counts for node filtering.</p> <p>Parameters:</p> Name Type In Required Description org_id string query yes Organization ID <p>Response:</p> <pre><code>{\n  \"node_types\": { \"asset\": 500, \"user\": 120 },\n  \"internal\": { \"true\": 400, \"false\": 220 },\n  \"managed\": { \"true\": 350, \"false\": 270 },\n  \"matched_lead_rules\": { \"1\": 45, \"5\": 12 },\n  \"frameworks\": { \"1\": 200, \"2\": 150 },\n  \"total_nodes\": 620\n}\n</code></pre>"},{"location":"api/endpoints/notifications/","title":"Notifications","text":"<p>Configure notification channels (email, Slack, webhook) and rules that trigger alerts based on security events. Also includes user-facing notification management for CyberGrid events.</p>"},{"location":"api/endpoints/notifications/#notification-channels","title":"Notification Channels","text":"Method Path Description Permission GET <code>/v1/notification-channels</code> List channels notifications:read POST <code>/v1/notification-channels</code> Create channel notifications:write GET <code>/v1/notification-channels/:id</code> Get channel notifications:read PUT <code>/v1/notification-channels/:id</code> Update channel notifications:write DELETE <code>/v1/notification-channels/:id</code> Delete channel notifications:write POST <code>/v1/notification-channels/:id/test</code> Test channel notifications:write"},{"location":"api/endpoints/notifications/#notification-rules","title":"Notification Rules","text":"Method Path Description Permission GET <code>/v1/notification-rules</code> List rules notifications:read POST <code>/v1/notification-rules</code> Create rule notifications:write GET <code>/v1/notification-rules/:id</code> Get rule notifications:read PUT <code>/v1/notification-rules/:id</code> Update rule notifications:write DELETE <code>/v1/notification-rules/:id</code> Delete rule notifications:write"},{"location":"api/endpoints/notifications/#user-notifications-cybergrid","title":"User Notifications (CyberGrid)","text":"Method Path Description Permission GET <code>/v1/cybergrid/notifications</code> List user notifications notifications:read PATCH <code>/v1/cybergrid/notifications/:id/read</code> Mark as read notifications:write PATCH <code>/v1/cybergrid/notifications/read-all</code> Mark all as read notifications:write"},{"location":"api/endpoints/notifications/#post-v1notification-channels","title":"POST /v1/notification-channels","text":"<p>Create a new notification channel.</p> <p>Request:</p> <pre><code>{\n  \"name\": \"Security Alerts Slack\",\n  \"channel_type\": \"slack\",\n  \"config\": {\n    \"webhook_url\": \"https://hooks.slack.com/services/...\"\n  }\n}\n</code></pre> <p>Response: 201 Created.</p>"},{"location":"api/endpoints/notifications/#post-v1notification-channelsidtest","title":"POST /v1/notification-channels/:id/test","text":"<p>Send a test notification to verify channel configuration.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Test notification sent successfully\",\n  \"data\": {\n    \"success\": true,\n    \"message\": \"Test notification delivered\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/notifications/#get-v1cybergridnotifications","title":"GET /v1/cybergrid/notifications","text":"<p>List notifications for the current user.</p> <p>Parameters:</p> Name Type In Required Description unread boolean query no Show only unread notifications"},{"location":"api/endpoints/observations/","title":"Observations","text":"<p>Observations are behavioral analysis rules used by the incident-engine to evaluate and score incidents. Each observation defines a pattern that, when matched against incident data, contributes to the overall suspicion score.</p>"},{"location":"api/endpoints/observations/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/observations List observations Authenticated GET /v1/observations/:id Get an observation Authenticated POST /v1/observations Create an observation Authenticated PUT /v1/observations/:id Update an observation Authenticated DELETE /v1/observations/:id Delete an observation Authenticated"},{"location":"api/endpoints/observations/#data-model","title":"Data Model","text":"Field Type Description observation_id integer Unique observation identifier observation_name string Display name matched boolean Whether the observation matched score number Raw score (0.0\u20131.0) score_percent number Score as percentage (0\u2013100) contribution_percent number Contribution to overall suspicion (0\u2013100) details string Human-readable match details"},{"location":"api/endpoints/observations/#observation-matching","title":"Observation Matching","text":"<p>When evaluating an incident, the system runs all enabled observations against the incident's artifacts, nodes, and edges. The response includes match results:</p> <pre><code>{\n  \"observations\": [\n    {\n      \"observation_id\": 1,\n      \"observation_name\": \"Lateral Movement Detection\",\n      \"matched\": true,\n      \"score\": 0.85,\n      \"score_percent\": 85,\n      \"contribution_percent\": 42,\n      \"details\": \"Multiple internal hosts contacted within 5-minute window\"\n    },\n    {\n      \"observation_id\": 2,\n      \"observation_name\": \"Data Exfiltration Pattern\",\n      \"matched\": false,\n      \"score\": 0.0,\n      \"score_percent\": 0,\n      \"contribution_percent\": 0,\n      \"details\": \"\"\n    }\n  ],\n  \"total_matched\": 1,\n  \"total_observations\": 2\n}\n</code></pre>"},{"location":"api/endpoints/reports/","title":"Reports","text":"<p>Access business intelligence reports including executive summaries, tool effectiveness analysis, compliance readiness, and cost/savings calculations. Reports are generated as snapshots and stored for historical comparison.</p>"},{"location":"api/endpoints/reports/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/reports/types List available report types Authenticated GET /v1/reports/:type Get latest report by type Authenticated GET /v1/reports/range Get reports for a date range Authenticated GET /v1/reports/business-settings Get business settings Authenticated PUT /v1/reports/business-settings Update business settings Authenticated"},{"location":"api/endpoints/reports/#report-types","title":"Report Types","text":"Type Description <code>executive</code> Executive summary with incident counts, savings, and ROI <code>tool_effectiveness</code> Per-tool metrics including detection rates and ROI <code>compliance</code> Compliance readiness scores across frameworks <code>cost_savings</code> Detailed cost analysis and savings breakdown"},{"location":"api/endpoints/reports/#get-v1reportstypes","title":"GET /v1/reports/types","text":"<p>List all available report types.</p> <p>Response:</p> <pre><code>{\n  \"report_types\": [\"executive\", \"tool_effectiveness\", \"compliance\", \"cost_savings\"]\n}\n</code></pre>"},{"location":"api/endpoints/reports/#get-v1reportstype","title":"GET /v1/reports/:type","text":"<p>Get the latest report snapshot for a specific type.</p> <p>Parameters:</p> Name Type In Required Description type string path yes Report type <p>Response:</p> <pre><code>{\n  \"org_id\": \"witfoo\",\n  \"report_type\": \"executive\",\n  \"report_date\": \"2025-06-18\",\n  \"snapshot_json\": \"{...}\",\n  \"generated_at\": \"2025-06-18T02:00:00Z\",\n  \"generation_duration_ms\": 1250\n}\n</code></pre>"},{"location":"api/endpoints/reports/#executive-summary-data","title":"Executive Summary Data","text":"<pre><code>{\n  \"total_incidents\": 342,\n  \"disrupted_incidents\": 128,\n  \"detected_incidents\": 214,\n  \"total_savings\": 2500000,\n  \"roi_percentage\": 185.5,\n  \"workforce_readiness\": 0.85,\n  \"fte_needed\": 4.2,\n  \"fte_budgeted\": 3,\n  \"incidents_by_severity\": { \"critical\": 12, \"high\": 45, \"medium\": 180, \"low\": 105 },\n  \"incidents_by_status\": { \"open\": 28, \"investigating\": 15, \"resolved\": 299 }\n}\n</code></pre>"},{"location":"api/endpoints/reports/#get-v1reportsrange","title":"GET /v1/reports/range","text":"<p>Get report snapshots for a date range.</p> <p>Parameters:</p> Name Type In Required Description type string query yes Report type start_date string query yes Start date (YYYY-MM-DD) end_date string query yes End date (YYYY-MM-DD) <p>Response:</p> <pre><code>{\n  \"reports\": [ ],\n  \"count\": 30\n}\n</code></pre>"},{"location":"api/endpoints/reports/#get-v1reportsbusiness-settings","title":"GET /v1/reports/business-settings","text":"<p>Get business settings used for report calculations.</p> <p>Response:</p> <pre><code>{\n  \"org_id\": \"witfoo\",\n  \"fte_cost\": 85000,\n  \"fte_count\": 3,\n  \"annual_revenue\": 50000000,\n  \"annual_spend\": 3000000,\n  \"it_outage_revenue\": 200000,\n  \"brand_damage\": 500000,\n  \"legal_costs\": 100000,\n  \"insurance_coverage\": 5000000,\n  \"currency_symbol\": \"$\",\n  \"product_costs\": { \"Firewall\": 50000, \"SIEM\": 120000 }\n}\n</code></pre>"},{"location":"api/endpoints/reports/#put-v1reportsbusiness-settings","title":"PUT /v1/reports/business-settings","text":"<p>Update business settings. Supports partial updates.</p> <p>Request Body:</p> Name Type Required Description fte_cost number no Annual cost per FTE fte_count integer no Budgeted FTE headcount annual_revenue number no Organization annual revenue annual_spend number no Annual security spend it_outage_revenue number no Revenue lost per IT outage brand_damage number no Estimated brand damage cost legal_costs number no Estimated legal costs insurance_coverage number no Cyber insurance coverage currency_symbol string no Currency symbol (default: <code>$</code>) product_costs object no Per-product annual costs"},{"location":"api/endpoints/saved-searches/","title":"Saved Searches","text":"<p>Manage saved search configurations with shareable URLs, TTL management, and per-entity-type filtering. Saved searches persist search criteria, column selections, and time ranges across sessions.</p>"},{"location":"api/endpoints/saved-searches/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/searches List saved searches Authenticated POST /v1/searches Create a saved search Authenticated GET /v1/searches/:id Get a saved search Authenticated PUT /v1/searches/:id Update a saved search Authenticated DELETE /v1/searches/:id Delete a saved search Authenticated POST /v1/searches/:id/share Generate share token Authenticated GET /v1/searches/shared/:token Get shared search by token Authenticated PATCH /v1/searches/:id/ttl Update search TTL Authenticated"},{"location":"api/endpoints/saved-searches/#get-v1searches","title":"GET /v1/searches","text":"<p>List saved searches for the current user or filtered by entity type.</p> <p>Parameters:</p> Name Type In Required Description entity_type string query no Filter by entity type: <code>signal</code>, <code>node</code>, <code>edge</code>, <code>incident</code>, <code>collection</code> <p>Response:</p> <pre><code>{\n  \"searches\": [\n    {\n      \"org_id\": \"witfoo\",\n      \"search_id\": \"f47ac10b-58cc-4372-a567-0e02b2c3d479\",\n      \"user_id\": \"550e8400-e29b-41d4-a716-446655440000\",\n      \"entity_type\": \"signal\",\n      \"name\": \"High Severity Alerts\",\n      \"description\": \"Signals with severity &gt;= 7\",\n      \"criteria\": {\n        \"filters\": [\n          { \"field\": \"severity_level\", \"operator\": \"&gt;=\", \"value\": \"7\" }\n        ],\n        \"time_range\": { \"start\": \"2025-06-01T00:00:00Z\" }\n      },\n      \"columns\": { \"columns\": [\"stream_name\", \"severity_level\", \"client_ip\"] },\n      \"is_shared\": false,\n      \"ttl_days\": 7,\n      \"view_count\": 12,\n      \"created_at\": \"2025-06-10T14:30:00Z\",\n      \"updated_at\": \"2025-06-15T09:00:00Z\"\n    }\n  ],\n  \"total\": 1\n}\n</code></pre> <p>Example:</p> <pre><code>curl -H \"Authorization: Bearer $TOKEN\" \\\n  \"https://precinct.example.com/api/v1/searches?entity_type=signal\"\n</code></pre>"},{"location":"api/endpoints/saved-searches/#post-v1searches","title":"POST /v1/searches","text":"<p>Create a new saved search.</p> <p>Request Body:</p> Name Type Required Description entity_type string yes One of: <code>signal</code>, <code>node</code>, <code>edge</code>, <code>incident</code>, <code>collection</code> name string yes Search name description string no Search description criteria object no Filter criteria and time range columns object no Column configuration is_shared boolean no Whether the search is shared (default: false) ttl_days integer no Time-to-live in days (default: 7) <p>Response: <code>201 Created</code></p> <pre><code>{\n  \"org_id\": \"witfoo\",\n  \"search_id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"entity_type\": \"node\",\n  \"name\": \"External Assets\",\n  \"ttl_days\": 7,\n  \"created_at\": \"2025-06-18T14:30:00Z\"\n}\n</code></pre>"},{"location":"api/endpoints/saved-searches/#get-v1searchesid","title":"GET /v1/searches/:id","text":"<p>Get a specific saved search by ID. Increments the view count.</p> <p>Parameters:</p> Name Type In Required Description id string path yes Search ID (UUID) <p>Response: <code>200 OK</code> \u2014 Full <code>SavedSearch</code> object.</p>"},{"location":"api/endpoints/saved-searches/#put-v1searchesid","title":"PUT /v1/searches/:id","text":"<p>Update an existing saved search.</p> <p>Parameters:</p> Name Type In Required Description id string path yes Search ID (UUID) <p>Request Body: Same fields as create (name, description, criteria, columns, is_shared, ttl_days).</p> <p>Response: <code>200 OK</code> \u2014 Updated <code>SavedSearch</code> object.</p>"},{"location":"api/endpoints/saved-searches/#delete-v1searchesid","title":"DELETE /v1/searches/:id","text":"<p>Delete a saved search.</p> <p>Parameters:</p> Name Type In Required Description id string path yes Search ID (UUID) <p>Response: <code>204 No Content</code></p>"},{"location":"api/endpoints/saved-searches/#post-v1searchesidshare","title":"POST /v1/searches/:id/share","text":"<p>Generate a share token for a saved search. Shared searches can be accessed by other users in the same organization.</p> <p>Parameters:</p> Name Type In Required Description id string path yes Search ID (UUID) <p>Request Body:</p> Name Type Required Description expires_in_days integer no Token expiration in days (default: 7, max: 30) <p>Response:</p> <pre><code>{\n  \"search_id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"token\": \"abc123def456\",\n  \"expires_at\": \"2025-06-25T14:30:00Z\",\n  \"share_url\": \"/ui/search/shared/abc123def456\"\n}\n</code></pre>"},{"location":"api/endpoints/saved-searches/#get-v1searchessharedtoken","title":"GET /v1/searches/shared/:token","text":"<p>Retrieve a saved search using a share token. Requires authentication to verify organization membership. Returns <code>410 Gone</code> if the share token has expired.</p> <p>Parameters:</p> Name Type In Required Description token string path yes Share token <p>Response: <code>200 OK</code> \u2014 Full <code>SavedSearch</code> object.</p>"},{"location":"api/endpoints/saved-searches/#patch-v1searchesidttl","title":"PATCH /v1/searches/:id/ttl","text":"<p>Update the TTL (time-to-live) for a saved search.</p> <p>Parameters:</p> Name Type In Required Description id string path yes Search ID (UUID) <p>Request Body:</p> Name Type Required Description ttl_days integer yes New TTL in days (0\u201390) <p>Response:</p> <pre><code>{\n  \"search_id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"ttl_days\": 30\n}\n</code></pre>"},{"location":"api/endpoints/settings/","title":"Settings","text":"<p>Manage organization-level settings including display preferences, authentication configuration, and general platform options.</p>"},{"location":"api/endpoints/settings/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/settings Get organization settings Authenticated PUT /v1/settings Update organization settings Authenticated GET /v1/settings/auth Get authentication settings Public"},{"location":"api/endpoints/settings/#get-v1settings","title":"GET /v1/settings","text":"<p>Retrieve all settings for the authenticated user's organization.</p> <p>Parameters: None (organization is derived from the JWT token).</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Settings retrieved successfully\",\n  \"data\": {\n    \"org_id\": \"witfoo\",\n    \"timezone\": \"America/New_York\",\n    \"date_format\": \"YYYY-MM-DD\",\n    \"time_format\": \"24h\",\n    \"enable_notifications\": true,\n    \"authentication\": {\n      \"saml2_enabled\": false,\n      \"ldap_enabled\": false\n    }\n  }\n}\n</code></pre> <p>Example:</p> <pre><code>curl -H \"Authorization: Bearer $TOKEN\" \\\n  \"https://precinct.example.com/api/v1/settings\"\n</code></pre>"},{"location":"api/endpoints/settings/#put-v1settings","title":"PUT /v1/settings","text":"<p>Update settings for the authenticated user's organization. Supports partial updates \u2014 only include fields you want to change.</p> <p>Request Body:</p> Name Type Required Description timezone string no IANA timezone (e.g., <code>America/New_York</code>) date_format string no Date format: <code>YYYY-MM-DD</code>, <code>MM/DD/YYYY</code>, <code>DD/MM/YYYY</code> time_format string no Time format: <code>24h</code> or <code>12h</code> enable_notifications boolean no Enable/disable notifications <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Settings updated successfully\",\n  \"data\": {\n    \"org_id\": \"witfoo\",\n    \"timezone\": \"America/Chicago\",\n    \"date_format\": \"MM/DD/YYYY\",\n    \"time_format\": \"12h\"\n  }\n}\n</code></pre> <p>Example:</p> <pre><code>curl -X PUT -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"timezone\": \"America/Chicago\", \"time_format\": \"12h\"}' \\\n  \"https://precinct.example.com/api/v1/settings\"\n</code></pre>"},{"location":"api/endpoints/settings/#get-v1settingsauth","title":"GET /v1/settings/auth","text":"<p>Retrieve authentication settings to determine which auth methods are enabled. This is a public endpoint (no authentication required) used by the login page to display appropriate authentication options.</p> <p>Parameters: None.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Auth settings retrieved successfully\",\n  \"data\": {\n    \"authentication\": {\n      \"saml2_enabled\": true,\n      \"saml2_config\": \"\",\n      \"ldap_enabled\": false,\n      \"ldap_config\": \"\"\n    }\n  }\n}\n</code></pre> <p>Note</p> <p>If the settings service is unavailable, this endpoint returns default values with both SAML and LDAP disabled.</p>"},{"location":"api/endpoints/tls/","title":"TLS Certificates","text":"<p>Manage TLS certificate configuration for the WitFoo Analytics platform. Upload custom certificates, generate self-signed certificates, or revert to the default configuration.</p>"},{"location":"api/endpoints/tls/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/admin/settings/tls Get current TLS certificate Authenticated POST /v1/admin/settings/tls/upload Upload a TLS certificate Authenticated POST /v1/admin/settings/tls/generate Generate self-signed certificate Authenticated DELETE /v1/admin/settings/tls Delete TLS certificate Authenticated"},{"location":"api/endpoints/tls/#get-v1adminsettingstls","title":"GET /v1/admin/settings/tls","text":"<p>Retrieve the current TLS certificate information for the organization. The private key is never returned in the response.</p> <p>Parameters: None.</p> <p>Response (certificate configured):</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"TLS certificate retrieved\",\n  \"data\": {\n    \"certificate_id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n    \"org_id\": \"witfoo\",\n    \"name\": \"Production Certificate\",\n    \"not_before\": \"2025-01-01T00:00:00Z\",\n    \"not_after\": \"2026-01-01T00:00:00Z\",\n    \"subject\": \"CN=precinct.example.com\",\n    \"issuer\": \"CN=Let's Encrypt Authority X3\",\n    \"dns_names\": [\"precinct.example.com\", \"*.precinct.example.com\"],\n    \"is_active\": true,\n    \"is_self_signed\": false,\n    \"created_at\": \"2025-06-01T10:00:00Z\"\n  }\n}\n</code></pre> <p>Response (no certificate):</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"No TLS certificate configured\",\n  \"data\": null\n}\n</code></pre>"},{"location":"api/endpoints/tls/#post-v1adminsettingstlsupload","title":"POST /v1/admin/settings/tls/upload","text":"<p>Upload a custom TLS certificate and private key pair. The certificate is validated, parsed for metadata, and written to disk for the reverse proxy.</p> <p>Request Body:</p> Name Type Required Description name string yes Display name for the certificate certificate string yes PEM-encoded certificate private_key string yes PEM-encoded private key <p>Response: <code>200 OK</code></p> <pre><code>{\n  \"success\": true,\n  \"message\": \"TLS certificate uploaded and activated\",\n  \"data\": {\n    \"certificate_id\": \"b2c3d4e5-f6a7-8901-bcde-f12345678901\",\n    \"name\": \"Production Certificate\",\n    \"subject\": \"CN=precinct.example.com\",\n    \"not_after\": \"2026-01-01T00:00:00Z\",\n    \"is_self_signed\": false\n  }\n}\n</code></pre> <p>Example:</p> <pre><code>curl -X POST -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Production Cert\",\n    \"certificate\": \"-----BEGIN CERTIFICATE-----\\n...\\n-----END CERTIFICATE-----\",\n    \"private_key\": \"-----BEGIN PRIVATE KEY-----\\n...\\n-----END PRIVATE KEY-----\"\n  }' \\\n  \"https://precinct.example.com/api/v1/admin/settings/tls/upload\"\n</code></pre>"},{"location":"api/endpoints/tls/#post-v1adminsettingstlsgenerate","title":"POST /v1/admin/settings/tls/generate","text":"<p>Generate a self-signed TLS certificate. The generated certificate uses a 4096-bit RSA key, is valid for 365 days, and includes <code>precinct.local</code> and <code>localhost</code> as DNS names.</p> <p>Parameters: None (no request body required).</p> <p>Response: <code>201 Created</code></p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Self-signed certificate generated and activated\",\n  \"data\": {\n    \"certificate_id\": \"c3d4e5f6-a7b8-9012-cdef-123456789012\",\n    \"name\": \"Self-Signed Certificate\",\n    \"subject\": \"CN=precinct.local,O=WitFoo Precinct\",\n    \"not_after\": \"2026-06-18T14:30:00Z\",\n    \"is_self_signed\": true\n  }\n}\n</code></pre>"},{"location":"api/endpoints/tls/#delete-v1adminsettingstls","title":"DELETE /v1/admin/settings/tls","text":"<p>Delete the current TLS certificate and revert to the platform default. Certificate files are removed from disk so the reverse proxy falls back to its default certificate.</p> <p>Parameters: None.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"TLS certificate deleted\",\n  \"data\": null\n}\n</code></pre>"},{"location":"api/endpoints/wfa/","title":"WFA (WitFoo Appliance)","text":"<p>Manage the WitFoo Appliance health, metrics, and configuration. These endpoints provide operational visibility into the appliance status and allow runtime configuration changes.</p>"},{"location":"api/endpoints/wfa/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET /v1/wfa/health Get appliance health status health:read GET /v1/wfa/stats Get appliance metrics metrics:read GET /v1/wfa/config Get appliance configuration settings:read PUT /v1/wfa/config Update appliance configuration settings:manage"},{"location":"api/endpoints/wfa/#get-v1wfahealth","title":"GET /v1/wfa/health","text":"<p>Returns the current health status of the WFA appliance, including service connectivity checks and uptime.</p> <p>Parameters: None.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"status\": \"healthy\",\n    \"services\": {\n      \"cassandra\": \"healthy\"\n    },\n    \"uptime_seconds\": 86400,\n    \"version\": \"7.0.0-alpha.pr104a\",\n    \"checked_at\": \"2025-06-18T14:30:00Z\"\n  }\n}\n</code></pre> <p>The <code>status</code> field is one of:</p> Value Description <code>healthy</code> All services operational <code>degraded</code> One or more services unhealthy <p>Example:</p> <pre><code>curl -H \"Authorization: Bearer $TOKEN\" \\\n  \"https://precinct.example.com/api/v1/wfa/health\"\n</code></pre>"},{"location":"api/endpoints/wfa/#get-v1wfastats","title":"GET /v1/wfa/stats","text":"<p>Returns current WFA metric values for the authenticated organization.</p> <p>Parameters: None.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"org_id\": \"witfoo\",\n    \"metrics\": {\n      \"artifacts_ingested\": 1250000,\n      \"nodes_created\": 45000,\n      \"edges_created\": 120000,\n      \"incidents_generated\": 342\n    }\n  }\n}\n</code></pre>"},{"location":"api/endpoints/wfa/#get-v1wfaconfig","title":"GET /v1/wfa/config","text":"<p>Returns the current WFA appliance configuration.</p> <p>Parameters: None.</p> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"retention_days\": 30,\n    \"modules_enabled\": \"all\",\n    \"cybergrid_enabled\": true,\n    \"metrics_interval_sec\": 60,\n    \"health_check_interval\": 30\n  }\n}\n</code></pre>"},{"location":"api/endpoints/wfa/#put-v1wfaconfig","title":"PUT /v1/wfa/config","text":"<p>Update the WFA appliance configuration. Supports partial updates \u2014 only include fields you want to change. A restart is required for changes to take full effect.</p> <p>Request Body:</p> Name Type Required Description retention_days integer no Data retention period (min: 1) modules_enabled string no Module mode: <code>all</code>, <code>search_only</code>, <code>search_observer</code> cybergrid_enabled boolean no Enable/disable CyberGrid metrics_interval_sec integer no Metrics collection interval in seconds (min: 5) health_check_interval integer no Health check interval in seconds (min: 5) <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"WFA configuration updated (restart required for full effect)\",\n  \"data\": {\n    \"retention_days\": 60,\n    \"modules_enabled\": \"all\",\n    \"cybergrid_enabled\": true,\n    \"metrics_interval_sec\": 60,\n    \"health_check_interval\": 30\n  }\n}\n</code></pre> <p>Example:</p> <pre><code>curl -X PUT -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"retention_days\": 60, \"cybergrid_enabled\": false}' \\\n  \"https://precinct.example.com/api/v1/wfa/config\"\n</code></pre> <p>Warning</p> <p>Configuration changes are applied in-memory immediately but a service restart is required for all changes to take full effect.</p>"},{"location":"conductor/","title":"WitFoo Conductor Overview","text":"<p>WitFoo Conductor is a high-performance security signal processing pipeline that ingests, parses, filters, and exports security log data from across your environment. Conductor serves as the data collection and normalization layer of the WitFoo platform, transforming raw log data from hundreds of sources into structured, enriched security artifacts ready for analysis.</p>"},{"location":"conductor/#architecture","title":"Architecture","text":"<p>Conductor follows a Source \u2192 Flow \u2192 Sink architecture pattern, with all inter-service communication handled by NATS JetStream messaging.</p> <pre><code>graph LR\n    subgraph Data Sources\n        A1[Syslog UDP/TCP]\n        A2[Beats/Logstash]\n        A3[Secure Syslog TLS]\n        A4[Cloud APIs]\n        A5[Security Platforms]\n    end\n\n    subgraph Push Ingestion\n        B1[signal-server]\n    end\n\n    subgraph Pull Ingestion\n        B2[signal-client]\n    end\n\n    subgraph Message Broker\n        C[broker-edge&lt;br/&gt;NATS JetStream]\n    end\n\n    subgraph Processing\n        D[signal-parser&lt;br/&gt;200+ Parsers]\n        E[artifact-filter&lt;br/&gt;Dedup &amp; Enrich]\n    end\n\n    subgraph Export\n        F[artifact-exporter]\n    end\n\n    subgraph Destinations\n        G1[WitFoo Analytics]\n        G2[Splunk HEC]\n        G3[OpenSearch]\n        G4[Microsoft Sentinel]\n        G5[AlienVault]\n        G6[Other Destinations]\n    end\n\n    A1 --&gt; B1\n    A2 --&gt; B1\n    A3 --&gt; B1\n    A4 --&gt; B2\n    A5 --&gt; B2\n\n    B1 --&gt; C\n    B2 --&gt; C\n    C --&gt; D\n    D --&gt; C\n    C --&gt; E\n    E --&gt; C\n    C --&gt; F\n\n    F --&gt; G1\n    F --&gt; G2\n    F --&gt; G3\n    F --&gt; G4\n    F --&gt; G5\n    F --&gt; G6</code></pre>"},{"location":"conductor/#service-map","title":"Service Map","text":"<p>Conductor consists of 7 core services, each running as an independent container managed by the WitFoo Agent (WFA).</p> Service Purpose Ports Description broker-edge Message broker 4223, 4443, 8223 NATS JetStream broker for all inter-service communication signal-server Push ingestion 514, 5044-5045, 6514, 7514 Receives logs via Syslog, Beats, and HTTP protocols signal-client Pull ingestion \u2014 Polls cloud and security platform APIs on schedule signal-parser Log parsing \u2014 Normalizes raw logs using 200+ vendor-specific parsers artifact-filter Filtering &amp; enrichment \u2014 Deduplicates artifacts and applies STIX threat intelligence artifact-exporter Export \u2014 Delivers processed artifacts to analytics platforms and SIEMs conductor-ui Web management 8000 (internal), 443 (HTTPS) Real-time dashboard and configuration interface"},{"location":"conductor/#key-features","title":"Key Features","text":"<ul> <li>200+ Log Parsers \u2014 Vendor-specific parsers for firewalls, IDS/IPS, authentication systems, DNS, cloud platforms, endpoints, email gateways, and network devices</li> <li>19 API Integrations \u2014 Pull-based collection from Microsoft, Cisco, CrowdStrike, Palo Alto, Proofpoint, Okta, and more</li> <li>8 Export Destinations \u2014 Deliver artifacts to WitFoo Analytics, Splunk, OpenSearch, Microsoft Sentinel, AlienVault, SCP, Syslog, and local filesystem</li> <li>Real-Time Dashboard \u2014 WebSocket-powered monitoring with pipeline throughput, service health, and container metrics</li> <li>ProtoGraph Deduplication \u2014 11-tuple matching reduces noise while preserving security-relevant event variations</li> <li>STIX Threat Intelligence \u2014 Automatic enrichment with structured threat intelligence data</li> <li>High Throughput \u2014 Sustained processing at &gt;2,000 messages per second with &lt;2ms per-message parser latency</li> </ul>"},{"location":"conductor/#deployment","title":"Deployment","text":"<p>Conductor is deployed as a set of Docker containers orchestrated by the WitFoo Agent (WFA) daemon on WitFoo Appliances. For deployment instructions, see the Deployment Guide. For CLI management, see the WFA CLI Reference.</p>"},{"location":"conductor/#documentation-map","title":"Documentation Map","text":"Section Description Signal Processing Pipeline End-to-end data flow and NATS stream architecture Broker Edge NATS JetStream message broker configuration Signal Server Push-based log ingestion Signal Client Pull-based API collection Signal Parser Parser architecture and performance Parser Catalog Complete list of supported log parsers Artifact Filter Filtering, deduplication, and enrichment Artifact Exporter Export destinations and configuration Conductor UI Web management interface Configuration Reference Configuration files and environment variables Deployment Guide Installation and deployment options WFA Integration WFA agent architecture and container lifecycle WFA CLI Reference Complete command reference for the <code>wfa</code> tool Troubleshooting Common issues and diagnostic procedures Metrics and Monitoring Prometheus metrics and Grafana integration"},{"location":"conductor/artifact-exporter/","title":"Artifact Exporter","text":"<p>Artifact Exporter is the final stage of the Conductor pipeline. It consumes finalized artifacts from the <code>artifacts.final</code> stream and delivers them to one or more configured export destinations.</p>"},{"location":"conductor/artifact-exporter/#overview","title":"Overview","text":"<p>Artifact Exporter supports 8 export destinations, each implemented as an independent connector. Multiple exporters can be enabled simultaneously, allowing artifacts to be delivered to both WitFoo Analytics and external SIEMs in parallel.</p>"},{"location":"conductor/artifact-exporter/#export-destinations","title":"Export Destinations","text":""},{"location":"conductor/artifact-exporter/#witfoo-analytics-reporter","title":"WitFoo Analytics (Reporter)","text":"<p>The primary export destination for the WitFoo platform. Artifacts are delivered via HTTP with HMAC-SHA256 authentication.</p> Setting Description Endpoint WitFoo Analytics artifact-ingestion service Authentication HMAC-SHA256 shared secret Format WitFoo internal artifact format"},{"location":"conductor/artifact-exporter/#splunk-hec","title":"Splunk HEC","text":"<p>Export to Splunk via the HTTP Event Collector (HEC) protocol.</p> Setting Description URL Splunk HEC endpoint URL Token HEC authentication token Index Target Splunk index Source type Splunk source type for ingested events"},{"location":"conductor/artifact-exporter/#opensearch","title":"OpenSearch","text":"<p>Export to OpenSearch (or Elasticsearch-compatible) clusters.</p> Setting Description URL OpenSearch cluster URL Index Target index name Auth mode Basic authentication, API key, or none"},{"location":"conductor/artifact-exporter/#microsoft-sentinel","title":"Microsoft Sentinel","text":"<p>Export to Microsoft Sentinel via the Log Analytics Data Collector API.</p> Setting Description Workspace ID Log Analytics workspace identifier Shared key Primary or secondary workspace key"},{"location":"conductor/artifact-exporter/#alienvault","title":"AlienVault","text":"<p>Export to AlienVault USM / OSSIM.</p> Setting Description Server URL AlienVault server endpoint API key Authentication API key"},{"location":"conductor/artifact-exporter/#scp-transfer","title":"SCP Transfer","text":"<p>Export artifacts as files via SCP (Secure Copy Protocol).</p> Setting Description Host Destination SSH host Path Remote directory path Credentials SSH username and key/password Row limits Maximum rows per file"},{"location":"conductor/artifact-exporter/#udp-syslog","title":"UDP Syslog","text":"<p>Export artifacts as syslog messages over UDP.</p> Setting Description Host Destination syslog server Port UDP port number"},{"location":"conductor/artifact-exporter/#local-filesystem","title":"Local FileSystem","text":"<p>Write artifacts to the local filesystem for archival or downstream processing.</p> Setting Description Output directory Local path for artifact files"},{"location":"conductor/artifact-exporter/#configuration","title":"Configuration","text":"<p>Artifact Exporter is configured through the NATS KV EXPORTERS bucket. Configuration can be managed via the Conductor UI Exporter Configuration page.</p> <p>Each exporter connector supports:</p> Setting Description Enable/disable Independently activate each destination Batch size Number of artifacts per export batch Retry settings Retry count and backoff for failed deliveries STIX enrichment Toggle STIX data inclusion in exports"},{"location":"conductor/artifact-exporter/#data-flow","title":"Data Flow","text":"<pre><code>graph LR\n    FINAL[\"artifacts.final\"] --&gt; AE[artifact-exporter]\n    AE --&gt; D1[WitFoo Analytics]\n    AE --&gt; D2[Splunk HEC]\n    AE --&gt; D3[OpenSearch]\n    AE --&gt; D4[Microsoft Sentinel]\n    AE --&gt; D5[AlienVault]\n    AE --&gt; D6[SCP Transfer]\n    AE --&gt; D7[UDP Syslog]\n    AE --&gt; D8[Local FileSystem]</code></pre>"},{"location":"conductor/artifact-exporter/#container-details","title":"Container Details","text":"Property Value Container name <code>artifact-exporter-svc</code> Internal hostname <code>artifact-exporter</code> Depends on <code>broker-edge</code> (healthy) Exposed ports None (outbound connections only)"},{"location":"conductor/artifact-exporter/#troubleshooting","title":"Troubleshooting","text":"<pre><code># Check exporter logs\ndocker logs --tail 100 artifact-exporter-svc 2&gt;&amp;1\n\n# Look for export errors\ndocker logs artifact-exporter-svc 2&gt;&amp;1 | grep -i \"error\\|fail\\|timeout\\|auth\"\n\n# Verify artifacts.final stream has data\ndocker exec broker-edge-svc nats stream info DATA\n</code></pre> Symptom Likely Cause Resolution Authentication failed Invalid credentials Update exporter credentials in Conductor UI Connection timeout Network issue to destination Verify connectivity with <code>wfa diag</code> Rate limited Destination throttling Reduce batch size in exporter configuration Exporter keeps restarting Configuration cycling Stop making UI changes; wait for stabilization <p>See Troubleshooting for additional diagnostic procedures.</p>"},{"location":"conductor/artifact-filter/","title":"Artifact Filter","text":"<p>Artifact Filter processes parsed artifacts through deduplication, threat intelligence enrichment, and predicate-based filtering. It sits between the parser and exporter stages, reducing noise and adding context before artifacts are exported.</p>"},{"location":"conductor/artifact-filter/#overview","title":"Overview","text":"<p>Artifact Filter performs two primary functions:</p> <ol> <li>STIX Threat Intelligence Enrichment \u2014 Enriches artifacts with structured threat intelligence data from STIX feeds</li> <li>ProtoGraph Deduplication and Predicate Filtering \u2014 Deduplicates artifacts using an 11-tuple hash and applies configurable filter rules</li> </ol> <pre><code>graph LR\n    PARSED[\"artifacts.parsed\"] --&gt; STIX[STIX Enrichment]\n    STIX --&gt; ENRICHED[\"artifacts.enriched\"]\n    ENRICHED --&gt; PG[ProtoGraph&lt;br/&gt;11-Tuple Dedup]\n    PG --&gt; PF[Predicate&lt;br/&gt;Filtering]\n    PF --&gt; FINAL[\"artifacts.final\"]</code></pre>"},{"location":"conductor/artifact-filter/#protograph-11-tuple-deduplication","title":"ProtoGraph 11-Tuple Deduplication","text":"<p>ProtoGraph uses an 11-tuple hash to identify duplicate artifacts. Two artifacts with identical values across all 11 fields are considered duplicates, and only one is forwarded.</p> Tuple Category Fields Host SenderHost Network ClientIP, ServerIP, ServerPort, Protocol Identity UserName Content FileName, StreamName, MessageType, Action Severity SeverityLabel <p>This fine-grained approach minimizes noise while preserving security-relevant event variations. For example, the same user authenticating from two different source IPs produces two distinct artifacts, even though most other fields are identical.</p>"},{"location":"conductor/artifact-filter/#data-reduction","title":"Data Reduction","text":"<p>ProtoGraph typically achieves significant data reduction:</p> Metric Description Filter reduction Percentage of artifacts removed by deduplication Compression ratio Ratio of raw messages to exported artifacts (e.g., 8:1) <p>Tip</p> <p>A compression ratio of 5x or higher indicates effective deduplication. Very low ratios may indicate filtering bypass or highly unique traffic patterns.</p>"},{"location":"conductor/artifact-filter/#stix-threat-intelligence-enrichment","title":"STIX Threat Intelligence Enrichment","text":"<p>When enabled, the STIX enrichment stage matches artifact fields (IP addresses, domains, file hashes) against STIX threat intelligence feeds. Matched artifacts are annotated with threat context including:</p> <ul> <li>Threat actor attribution</li> <li>Indicator confidence scores</li> <li>Related campaign information</li> <li>MITRE ATT&amp;CK technique mappings</li> </ul> <p>Enriched artifacts are published to the <code>artifacts.enriched</code> stream before proceeding to predicate filtering.</p>"},{"location":"conductor/artifact-filter/#predicate-based-filter-rules","title":"Predicate-Based Filter Rules","text":"<p>Predicate filters allow you to define rules that include or exclude artifacts based on field values. Rules are evaluated after deduplication and can be used to:</p> <ul> <li>Drop low-value artifacts (e.g., routine health checks)</li> <li>Include only specific artifact types for export</li> <li>Filter by source, destination, severity, or any artifact field</li> </ul>"},{"location":"conductor/artifact-filter/#configuration","title":"Configuration","text":"<p>Artifact Filter is configured through the NATS KV FILTERS bucket. Configuration can be managed via the Conductor UI Exporter Configuration page, which includes STIX enrichment and filter toggles.</p> Setting Description ProtoGraph enabled Enable/disable 11-tuple deduplication STIX enrichment enabled Enable/disable threat intelligence enrichment Predicate rules Include/exclude rules based on artifact fields"},{"location":"conductor/artifact-filter/#container-details","title":"Container Details","text":"Property Value Container name <code>artifact-filter-svc</code> Internal hostname <code>artifact-filter</code> Depends on <code>broker-edge</code> (healthy) Exposed ports None"},{"location":"conductor/artifact-filter/#troubleshooting","title":"Troubleshooting","text":"<pre><code># Check artifact-filter logs\ndocker logs --tail 100 artifact-filter-svc 2&gt;&amp;1\n\n# Verify filter is consuming and publishing\ndocker logs artifact-filter-svc 2&gt;&amp;1 | grep -i \"consumed\\|published\\|rejected\"\n\n# Check stream flow\ndocker exec broker-edge-svc nats stream info DATA\n</code></pre> Symptom Likely Cause Resolution Zero artifacts exported Filter rejecting all artifacts Review predicate rules; check if ProtoGraph is misconfigured No enrichment data STIX feeds not loaded Verify STIX enrichment is enabled and feeds are accessible High latency STIX lookup bottleneck Check STIX feed size and consider disabling for throughput testing <p>See Troubleshooting for additional diagnostic procedures.</p>"},{"location":"conductor/broker-edge/","title":"Broker Edge (NATS JetStream)","text":"<p>Broker Edge is the central message broker for all inter-service communication in the Conductor pipeline. Built on NATS JetStream, it provides durable, high-performance message delivery between pipeline services.</p>"},{"location":"conductor/broker-edge/#overview","title":"Overview","text":"<p>Every message flowing through the Conductor pipeline passes through Broker Edge. It manages the streams that connect ingestion services to parsers, parsers to filters, and filters to exporters. It also hosts the Key-Value (KV) buckets used for runtime configuration of all pipeline services.</p>"},{"location":"conductor/broker-edge/#ports","title":"Ports","text":"Port Protocol Purpose 4223 TCP NATS client connections (all pipeline services) 4443 TCP Leaf node and cluster connections 8223 HTTP Monitoring and health check endpoint"},{"location":"conductor/broker-edge/#streams","title":"Streams","text":"<p>Broker Edge manages five primary JetStream streams:</p> Stream Purpose Subjects DATA Primary pipeline data <code>{applianceID}.data.artifacts.raw</code>, <code>.parsed</code>, <code>.enriched</code>, <code>.final</code>, <code>.unknown</code> EVENTS Service lifecycle events Service start, stop, error events LOGS Aggregated service logs Log output from all pipeline services METRICS Performance metrics Pipeline throughput and latency metrics STATUSES Health status reports Per-service health status updates <p>The DATA stream carries all security artifacts through the pipeline stages. See Signal Processing Pipeline for the complete subject hierarchy.</p>"},{"location":"conductor/broker-edge/#kv-buckets","title":"KV Buckets","text":"<p>Broker Edge hosts NATS Key-Value buckets that serve as the runtime configuration store for all pipeline services. The Conductor UI reads and writes configuration to these buckets, and services watch for changes in real time.</p> Bucket Used By Purpose SERVERS signal-server Log server listener configuration (Syslog, Beats, TLS) PARSERS signal-parser Parser enable/disable state and settings FILTERS artifact-filter Filter rules and deduplication settings INTEGRATIONS signal-client API integration credentials and polling intervals EXPORTERS artifact-exporter Export destination configuration and credentials <p>Note</p> <p>Configuration changes made through the Conductor UI are written to these KV buckets and picked up by services in real time via NATS KV watchers. No service restart is required for most configuration changes.</p>"},{"location":"conductor/broker-edge/#health-check","title":"Health Check","text":"<p>The HTTP monitoring endpoint on port 8223 provides health and status information:</p> <pre><code># Check broker health\ncurl http://localhost:8223/healthz\n\n# View server information\ncurl http://localhost:8223/varz\n\n# View JetStream status\ncurl http://localhost:8223/jsz\n</code></pre> <p>From within the Docker network, services can verify connectivity:</p> <pre><code># Ping the broker\ndocker exec broker-edge-svc nats server ping --server=nats://127.0.0.1:4223\n\n# List all streams\ndocker exec broker-edge-svc nats stream ls\n\n# Check a specific stream\ndocker exec broker-edge-svc nats stream info DATA\n\n# List consumers on a stream\ndocker exec broker-edge-svc nats consumer ls DATA\n</code></pre>"},{"location":"conductor/broker-edge/#container-configuration","title":"Container Configuration","text":"<p>Broker Edge is configured through <code>/witfoo/configs/node.json</code> with the following relevant fields:</p> Field Default Description <code>broker_client_port</code> <code>4223</code> Client connection port <code>broker_leaf_port</code> <code>4443</code> Leaf node / cluster port <code>broker_max_data_mb</code> <code>1024</code> Maximum data size per stream (MB)"},{"location":"conductor/broker-edge/#clustering","title":"Clustering","text":"<p>For high-availability deployments, Broker Edge supports NATS leaf node connections on port 4443. This allows multiple Conductor nodes to form a cluster with message replication across nodes.</p> <p>Warning</p> <p>Clustering configuration is managed through the WFA configuration wizard (<code>wfa configure</code>). Manual NATS cluster configuration is not recommended.</p>"},{"location":"conductor/broker-edge/#troubleshooting","title":"Troubleshooting","text":"<p>Common Broker Edge issues:</p> Symptom Likely Cause Resolution Services report \"connection refused\" Broker not running or not ready Check <code>docker logs broker-edge-svc</code> and restart if needed Stream not found errors Streams not yet created Broker Edge creates streams on startup; wait for initialization High memory usage Large stream backlogs Check consumer lag with <code>nats consumer ls DATA</code> Port 4223 not listening Container startup failure Check Docker logs and verify port bindings <p>See Troubleshooting for detailed diagnostic procedures.</p>"},{"location":"conductor/configuration/","title":"Configuration Reference","text":"<p>Conductor services are configured through a combination of the node configuration file, environment variables, and NATS KV buckets for runtime settings.</p>"},{"location":"conductor/configuration/#node-configuration-file","title":"Node Configuration File","text":"<p>The primary configuration file is <code>/witfoo/configs/node.json</code>, generated by the <code>wfa configure</code> command. This file is mounted read-only into all Conductor containers.</p>"},{"location":"conductor/configuration/#key-fields","title":"Key Fields","text":"Field Type Description <code>org_id</code> string Organization identifier (DNS-valid, lowercase) <code>org_name</code> string Organization display name <code>appliance_id</code> string Unique appliance UUID <code>role</code> integer Node role (12 = Conductor) <code>hostname</code> string Node hostname <code>ip_address</code> string Node IP address <code>broker_client_port</code> integer NATS client port (default: 4223) <code>broker_leaf_port</code> integer NATS leaf/cluster port (default: 4443) <code>broker_max_data_mb</code> integer Maximum stream data size in MB (default: 1024) <code>registry</code> string Container image registry URL <code>local_metrics</code> boolean Enable local Prometheus/Grafana stack <code>offline_mode</code> boolean Disable external network access <code>metrics_export</code> boolean Enable Grafana Cloud metrics export <code>auto_update</code> boolean Enable automatic WFA and container updates <code>console_fqdn</code> string WitFoo Console FQDN for Analytics integration"},{"location":"conductor/configuration/#certificate-fields","title":"Certificate Fields","text":"Field Default Path Description <code>client_cert</code> <code>/witfoo/certs/client.crt</code> Client TLS certificate <code>client_key</code> <code>/witfoo/certs/client.key</code> Client TLS private key <code>server_cert</code> <code>/witfoo/certs/server.crt</code> Server TLS certificate <code>server_key</code> <code>/witfoo/certs/server.key</code> Server TLS private key <code>ca_cert</code> <code>/witfoo/certs/ca.crt</code> CA certificate"},{"location":"conductor/configuration/#example","title":"Example","text":"<pre><code>{\n  \"org_id\": \"acme-corp\",\n  \"org_name\": \"ACME Corporation\",\n  \"appliance_id\": \"42f9510c-8e20-4dc4-a03c-66bdba4345cd\",\n  \"role\": 12,\n  \"hostname\": \"conductor-01\",\n  \"ip_address\": \"10.0.1.50\",\n  \"broker_client_port\": 4223,\n  \"broker_leaf_port\": 4443,\n  \"broker_max_data_mb\": 1024,\n  \"local_metrics\": false,\n  \"offline_mode\": false,\n  \"metrics_export\": true,\n  \"auto_update\": true\n}\n</code></pre> <p>Warning</p> <p>The <code>node.json</code> file is generated by <code>wfa configure</code> and has permissions set to <code>0600</code>. Do not edit this file manually unless directed by WitFoo support. Use <code>wfa configure</code> to make changes.</p>"},{"location":"conductor/configuration/#environment-variables","title":"Environment Variables","text":"<p>Each container receives configuration via environment variables set by WFA:</p>"},{"location":"conductor/configuration/#common-variables-all-services","title":"Common Variables (All Services)","text":"Variable Description <code>WF_NODE_CONFIG_FILE</code> Path"},{"location":"conductor/deployment/","title":"Deployment Guide","text":""},{"location":"conductor/deployment/#production-deployment","title":"Production Deployment","text":"<p>In production, Conductor is deployed as a WitFoo Appliance \u2014 a dedicated Linux server running the WFA (WitFoo Agent) daemon as a systemd service.</p>"},{"location":"conductor/deployment/#prerequisites","title":"Prerequisites","text":"<ul> <li>Ubuntu 22.04 or 24.04 LTS (AMD64)</li> <li>Minimum 4 CPU cores and 8 GB RAM</li> <li>Docker Engine installed</li> <li>Network access to the container registry (or offline image loading)</li> <li>WitFoo license key (or 15-day trial)</li> </ul>"},{"location":"conductor/deployment/#installation","title":"Installation","text":"<ol> <li> <p>Install the WFA package:</p> <pre><code>sudo apt install wfa\n</code></pre> </li> <li> <p>Run the interactive configuration wizard:</p> <pre><code>sudo wfa configure\n</code></pre> <p>See the WFA CLI Reference for details on each configuration step.</p> </li> <li> <p>Start the WFA daemon:</p> <pre><code>sudo wfa start\n</code></pre> </li> <li> <p>Enable auto-start at boot:</p> <pre><code>sudo wfa enable\n</code></pre> </li> </ol> <p>WFA will pull container images, create containers, and start all services in dependency order.</p>"},{"location":"conductor/deployment/#service-dependency-order","title":"Service Dependency Order","text":"<p>WFA starts containers in the following order to satisfy inter-service dependencies:</p> <ol> <li>broker-edge \u2014 Must be healthy before any other service starts</li> <li>signal-server, signal-client, signal-parser \u2014 Connect to broker on startup</li> <li>artifact-filter \u2014 Consumes from signal-parser output</li> <li>artifact-exporter \u2014 Consumes from artifact-filter output</li> <li>conductor-ui \u2014 Connects to broker for configuration management</li> </ol>"},{"location":"conductor/deployment/#health-checks","title":"Health Checks","text":"<p>WFA monitors container health using Docker health checks. The broker-edge container includes a built-in health check:</p> <pre><code>nats server ping --server=nats://127.0.0.1:4223\n</code></pre> <p>Downstream services wait for broker-edge to report healthy before starting their connection attempts.</p>"},{"location":"conductor/deployment/#development-deployment","title":"Development Deployment","text":"<p>For development and testing, Conductor can be deployed using Docker Compose.</p>"},{"location":"conductor/deployment/#building-from-source","title":"Building from Source","text":"<pre><code># Build all service binaries\n./scripts/conductor-build.sh all\n\n# Build Docker images\ndocker compose -f docker-compose-conductor.yml build\n</code></pre>"},{"location":"conductor/deployment/#running-with-docker-compose","title":"Running with Docker Compose","text":"<pre><code># Start all services\ndocker compose -f docker-compose-conductor.yml up -d\n</code></pre>"},{"location":"conductor/deployment/#external-network","title":"External Network","text":"<p>The Docker Compose configuration uses an external network (<code>witfoo-analytics-net</code>) for integration with the WitFoo Analytics stack. Create this network before starting:</p> <pre><code>docker network create witfoo-analytics-net\n</code></pre>"},{"location":"conductor/deployment/#volume-mounts","title":"Volume Mounts","text":"Host Path Container Path Purpose <code>/witfoo/configs</code> <code>/configs</code> (read-only) Node configuration (<code>node.json</code>) <code>/witfoo/certs</code> <code>/certs</code> (read-only) TLS certificates <code>/data</code> <code>/data</code> Persistent data (NATS, SQLite) <code>/logs</code> <code>/logs</code> Service log files"},{"location":"conductor/metrics/","title":"Metrics and Monitoring","text":"<p>Monitor WitFoo Conductor pipeline health, performance, and resource usage through built-in metrics and dashboards.</p>"},{"location":"conductor/metrics/#real-time-dashboard","title":"Real-Time Dashboard","text":"<p>The Conductor UI dashboard (<code>/</code>) provides real-time monitoring with four tabs:</p> <ul> <li>Overview \u2014 CPU, memory, and disk usage gauges</li> <li>Pipeline \u2014 Message throughput and pipeline stage counts</li> <li>Service Status \u2014 Per-service health indicators</li> <li>Container Status \u2014 Per-container resource usage</li> </ul> <p>See Dashboard for detailed tab descriptions.</p>"},{"location":"conductor/metrics/#prometheus-metrics","title":"Prometheus Metrics","text":"<p>Each Conductor service exposes Prometheus-compatible metrics:</p> Service Metric Prefix Key Metrics signal-server <code>signal_server_</code> Messages received, bytes ingested, connection count signal-client <code>signal_client_</code> API polls completed, records fetched, errors signal-parser <code>signal_parser_</code> Messages parsed, parse duration, unknown count artifact-filter <code>artifact_filter_</code> Messages filtered, duplicates detected artifact-exporter <code>artifact_exporter_</code> Messages exported, batch count, export errors broker-edge <code>nats_</code> Stream messages, consumer pending, bytes total"},{"location":"conductor/metrics/#pipeline-stage-metrics","title":"Pipeline Stage Metrics","text":"<p>The primary throughput metric is <code>pipeline_stage_count</code> with labels:</p> <ul> <li><code>stage</code>: source_client, broker, filter, export</li> <li><code>status</code>: success, error, dropped</li> </ul>"},{"location":"conductor/metrics/#grafana-cloud-integration","title":"Grafana Cloud Integration","text":"<p>Conductor supports metrics export to Grafana Cloud via the grafana-agent service:</p> <ol> <li>Enable \"Local Metrics\" during <code>wfa configure</code> (Step 10)</li> <li>Metrics are scraped from all services and forwarded to Grafana Cloud</li> <li>Pre-built dashboards available for pipeline throughput and service health</li> </ol>"},{"location":"conductor/metrics/#local-prometheusgrafana-stack","title":"Local Prometheus/Grafana Stack","text":"<p>For air-gapped or on-premises deployments:</p> <pre><code># Prometheus: http://localhost:9090\n# Grafana: http://localhost:3001 (admin/admin)\n</code></pre> <p>Enable the local metrics stack during <code>wfa configure</code> by selecting \"Local metrics\" in the optional features step.</p>"},{"location":"conductor/metrics/#key-metrics-to-monitor","title":"Key Metrics to Monitor","text":"Metric Warning Threshold Description Pipeline throughput &lt; 100 msgs/sec Messages processed per second Parser unknown rate &gt; 10% Percentage of unparsed messages Export error rate &gt; 1% Failed export operations Disk usage &gt; 80% <code>wfa diag</code> warns at this threshold Container memory &gt; 90% of limit Risk of OOM kill"},{"location":"conductor/metrics/#alert-configuration","title":"Alert Configuration","text":"<p>Configure alerts through:</p> <ol> <li>Grafana Cloud \u2014 Alert rules on exported metrics</li> <li>Conductor UI \u2014 Service status warnings on the dashboard</li> <li>WFA Status \u2014 <code>sudo wfa status</code> shows recent errors from the systemd journal</li> </ol> <p>Tip</p> <p>Run <code>sudo wfa diag</code> regularly to verify all connectivity checks pass. This catches issues before they impact pipeline throughput.</p>"},{"location":"conductor/parsers-catalog/","title":"Parser Catalog","text":"<p>Conductor includes 200+ vendor-specific log parsers organized by category. Each parser is designed to extract structured security artifacts from a specific log format.</p>"},{"location":"conductor/parsers-catalog/#parser-categories","title":"Parser Categories","text":""},{"location":"conductor/parsers-catalog/#firewall","title":"Firewall","text":"<p>Parsers for network firewall log formats, extracting connection events, policy actions, and traffic metadata.</p> Parser Vendor / Product cisco-asa Cisco ASA cisco-ftd Cisco Firepower Threat Defense fortinet-fortigate Fortinet FortiGate paloalto-panos Palo Alto PAN-OS checkpoint-fw Check Point Firewall sonicwall-fw SonicWall Firewall juniper-srx Juniper SRX watchguard-firebox WatchGuard Firebox sophos-xg Sophos XG Firewall pfSense pfSense"},{"location":"conductor/parsers-catalog/#idsips","title":"IDS/IPS","text":"<p>Parsers for intrusion detection and prevention system alerts.</p> Parser Vendor / Product snort Snort IDS/IPS suricata Suricata IDS/IPS cisco-firepower Cisco Firepower IDS paloalto-threat Palo Alto Threat Prevention"},{"location":"conductor/parsers-catalog/#authentication","title":"Authentication","text":"<p>Parsers for authentication and identity management logs.</p> Parser Vendor / Product sshd OpenSSH microsoft-ad Microsoft Active Directory okta Okta Identity cisco-duo Cisco Duo MFA microsoft-entra Microsoft Entra ID linux-pam Linux PAM sudo Linux sudo"},{"location":"conductor/parsers-catalog/#dns","title":"DNS","text":"<p>Parsers for DNS query and response logs.</p> Parser Vendor / Product bind-dns ISC BIND microsoft-dns Microsoft DNS Server cisco-umbrella Cisco Umbrella infoblox-dns Infoblox DNS pihole Pi-hole"},{"location":"conductor/parsers-catalog/#cloud","title":"Cloud","text":"<p>Parsers for cloud platform audit and activity logs.</p> Parser Vendor / Product aws-cloudtrail AWS CloudTrail aws-vpc-flow AWS VPC Flow Logs azure-activity Microsoft Azure Activity azure-signin Microsoft Azure Sign-In gcp-audit Google Cloud Audit microsoft-o365 Microsoft Office 365"},{"location":"conductor/parsers-catalog/#endpoint","title":"Endpoint","text":"<p>Parsers for endpoint detection and response (EDR) and host-based logs.</p> Parser Vendor / Product crowdstrike-falcon CrowdStrike Falcon microsoft-defender Microsoft Defender deep-instinct Deep Instinct limacharlie LimaCharlie carbon-black VMware Carbon Black sysmon Microsoft Sysmon osquery osquery"},{"location":"conductor/parsers-catalog/#email","title":"Email","text":"<p>Parsers for email security gateway and mail server logs.</p> Parser Vendor / Product proofpoint-protect Proofpoint Email Protection mimecast Mimecast microsoft-exchange Microsoft Exchange postfix Postfix MTA barracuda-email Barracuda Email Security"},{"location":"conductor/parsers-catalog/#network","title":"Network","text":"<p>Parsers for network infrastructure and monitoring logs.</p> Parser Vendor / Product cisco-ios Cisco IOS cisco-meraki Cisco Meraki cisco-stealthwatch Cisco Stealthwatch netskope Netskope CASB paloalto-cortex Palo Alto Cortex zeek Zeek (Bro) Network Monitor nginx NGINX apache-httpd Apache HTTP Server"},{"location":"conductor/parsers-catalog/#backup-data-protection","title":"Backup &amp; Data Protection","text":"Parser Vendor / Product druva Druva Data Protection veeam Veeam Backup"},{"location":"conductor/parsers-catalog/#vulnerability-management","title":"Vulnerability Management","text":"Parser Vendor / Product tenable Tenable.io / Nessus qualys Qualys <p>Note</p> <p>This catalog represents a subset of the 200+ parsers included with Conductor. New parsers are added regularly through both manual development and the automated parser generation workflow.</p>"},{"location":"conductor/parsers-catalog/#parser-naming-convention","title":"Parser Naming Convention","text":"<p>Parsers follow a vendor-product naming format:</p> <pre><code>{vendor}-{product}\n</code></pre> <p>Examples: <code>cisco-asa</code>, <code>paloalto-panos</code>, <code>crowdstrike-falcon</code></p> <p>For open-source tools or single-product vendors, the product name alone may be used: <code>sshd</code>, <code>suricata</code>, <code>postfix</code>.</p>"},{"location":"conductor/parsers-catalog/#managing-parsers","title":"Managing Parsers","text":"<p>Parsers can be enabled or disabled through:</p> <ul> <li>Conductor UI \u2014 Parser Management page at <code>/admin/settings/processors</code></li> <li>NATS KV \u2014 Direct updates to the PARSERS bucket</li> </ul> <p>Tip</p> <p>Disable parsers for log sources not present in your environment. While the fingerprint early-exit optimization minimizes the performance impact of extra parsers, disabling unused parsers reduces the <code>artifacts.unknown</code> stream noise from partial fingerprint matches.</p>"},{"location":"conductor/pipeline/","title":"Signal Processing Pipeline","text":"<p>The Conductor pipeline processes security log data through a series of stages: ingestion, parsing, filtering, and export. Each stage is implemented as an independent service communicating through NATS JetStream message streams.</p>"},{"location":"conductor/pipeline/#end-to-end-data-flow","title":"End-to-End Data Flow","text":"<pre><code>graph TD\n    subgraph Ingestion\n        SS[signal-server&lt;br/&gt;Push: Syslog, Beats, HTTP]\n        SC[signal-client&lt;br/&gt;Pull: API Polling]\n    end\n\n    subgraph \"NATS JetStream (broker-edge)\"\n        RAW[\"artifacts.raw\"]\n        PARSED[\"artifacts.parsed\"]\n        ENRICHED[\"artifacts.enriched\"]\n        FINAL[\"artifacts.final\"]\n        UNKNOWN[\"artifacts.unknown\"]\n    end\n\n    subgraph Processing\n        SP[signal-parser&lt;br/&gt;200+ Parsers]\n        AF1[artifact-filter&lt;br/&gt;STIX Enrichment]\n        AF2[artifact-filter&lt;br/&gt;ProtoGraph Dedup&lt;br/&gt;Predicate Filtering]\n    end\n\n    subgraph Export\n        AE[artifact-exporter&lt;br/&gt;8 Destinations]\n    end\n\n    SS --&gt;|publish| RAW\n    SC --&gt;|publish| RAW\n    RAW --&gt;|consume| SP\n    SP --&gt;|matched| PARSED\n    SP --&gt;|unmatched| UNKNOWN\n    PARSED --&gt;|consume| AF1\n    AF1 --&gt;|enriched| ENRICHED\n    ENRICHED --&gt;|consume| AF2\n    AF2 --&gt;|filtered| FINAL\n    FINAL --&gt;|consume| AE</code></pre>"},{"location":"conductor/pipeline/#pipeline-stages","title":"Pipeline Stages","text":""},{"location":"conductor/pipeline/#stage-1-ingestion","title":"Stage 1: Ingestion","text":"<p>Raw log data enters the pipeline through two ingestion services:</p> <ul> <li>signal-server \u2014 Receives push-based data from network sources via Syslog (UDP/TCP), Beats/Logstash, Secure Syslog TLS, and HTTP protocols</li> <li>signal-client \u2014 Pulls data from cloud and security platform APIs on configurable schedules</li> </ul> <p>Both services publish raw messages to the <code>artifacts.raw</code> stream.</p>"},{"location":"conductor/pipeline/#stage-2-parsing","title":"Stage 2: Parsing","text":"<p>The signal-parser consumes raw messages and runs them through a serial pipeline of 200+ vendor-specific parsers. Each parser uses a fingerprint function for early-exit optimization \u2014 if the fingerprint doesn't match, the parser is skipped with minimal overhead.</p> <ul> <li>Matched messages are published to <code>artifacts.parsed</code> with structured fields extracted</li> <li>Unmatched messages are published to <code>artifacts.unknown</code> for monitoring and future parser development</li> </ul>"},{"location":"conductor/pipeline/#stage-3-filtering-and-enrichment","title":"Stage 3: Filtering and Enrichment","text":"<p>The artifact-filter processes parsed artifacts in two sub-stages:</p> <ol> <li>STIX Enrichment \u2014 Enriches artifacts with structured threat intelligence data, publishing to <code>artifacts.enriched</code></li> <li>ProtoGraph Deduplication and Predicate Filtering \u2014 Deduplicates artifacts using an 11-tuple hash and applies configurable filter rules, publishing to <code>artifacts.final</code></li> </ol>"},{"location":"conductor/pipeline/#stage-4-export","title":"Stage 4: Export","text":"<p>The artifact-exporter consumes finalized artifacts and delivers them to one or more configured destinations, including WitFoo Analytics, Splunk, OpenSearch, Microsoft Sentinel, and others.</p>"},{"location":"conductor/pipeline/#nats-jetstream-streams","title":"NATS JetStream Streams","text":"<p>All inter-service communication uses NATS JetStream with a subject hierarchy based on the appliance ID:</p> <pre><code>{applianceID}.data.artifacts.{stage}\n</code></pre>"},{"location":"conductor/pipeline/#stream-subjects","title":"Stream Subjects","text":"Subject Publisher Consumer Purpose <code>artifacts.raw</code> signal-server, signal-client signal-parser Raw ingested log data <code>artifacts.parsed</code> signal-parser artifact-filter Successfully parsed artifacts <code>artifacts.enriched</code> artifact-filter (STIX) artifact-filter (predicate) STIX-enriched artifacts <code>artifacts.final</code> artifact-filter artifact-exporter Export-ready artifacts <code>artifacts.unknown</code> signal-parser Monitoring only Unrecognized log formats"},{"location":"conductor/pipeline/#primary-streams","title":"Primary Streams","text":"Stream Purpose DATA Primary pipeline data (all <code>artifacts.*</code> subjects) EVENTS Service lifecycle and operational events LOGS Aggregated service log output METRICS Pipeline performance metrics STATUSES Service health status reports"},{"location":"conductor/pipeline/#throughput-characteristics","title":"Throughput Characteristics","text":"<p>The pipeline is designed for sustained high-throughput processing:</p> Metric Target Pipeline throughput &gt;2,000 messages/sec Per-message parser latency &lt;2ms (optimized parsers) Fingerprint check overhead Microseconds per parser End-to-end latency Sub-second (ingestion to export) <p>Note</p> <p>Actual throughput depends on hardware resources, message complexity, and the number of enabled parsers. The fingerprint-based early exit optimization ensures that parser count has minimal impact on per-message latency.</p>"},{"location":"conductor/pipeline/#source-flow-sink-pattern","title":"Source \u2192 Flow \u2192 Sink Pattern","text":"<p>All Conductor services implement a consistent architectural pattern from the shared pipeline framework:</p> <ul> <li>Source \u2014 Extracts data from an input (NATS consumer, TCP listener, API poller)</li> <li>Flow \u2014 Transforms data (parse, filter, enrich, deduplicate)</li> <li>Sink \u2014 Loads data to an output (NATS publisher, HTTP POST, file write)</li> </ul> <p>This pattern enables each service to be independently scaled, monitored, and restarted without affecting the rest of the pipeline. NATS JetStream provides durable message delivery, ensuring no data loss during service restarts or temporary outages.</p>"},{"location":"conductor/signal-client/","title":"Signal Client (Pull Ingestion)","text":"<p>Signal Client handles pull-based log collection from cloud and security platform APIs. It polls configured integrations on scheduled intervals, retrieves log data via HTTP/REST APIs, and publishes raw messages to the NATS JetStream <code>artifacts.raw</code> stream.</p>"},{"location":"conductor/signal-client/#overview","title":"Overview","text":"<p>Unlike Signal Server which receives pushed data, Signal Client actively reaches out to external APIs to collect log data. This is the primary ingestion method for cloud services, SaaS security platforms, and any source that exposes a REST API for log retrieval.</p>"},{"location":"conductor/signal-client/#how-it-works","title":"How It Works","text":"<pre><code>graph LR\n    subgraph \"Cloud &amp; Security APIs\"\n        API1[Microsoft 365]\n        API2[CrowdStrike Falcon]\n        API3[Cisco Umbrella]\n        API4[Okta]\n        API5[Other APIs]\n    end\n\n    SC[signal-client&lt;br/&gt;Scheduled Polling]\n\n    NATS[\"broker-edge&lt;br/&gt;artifacts.raw\"]\n\n    API1 --&gt;|HTTP/REST| SC\n    API2 --&gt;|HTTP/REST| SC\n    API3 --&gt;|HTTP/REST| SC\n    API4 --&gt;|HTTP/REST| SC\n    API5 --&gt;|HTTP/REST| SC\n    SC --&gt;|publish| NATS</code></pre> <ol> <li>Signal Client reads integration configurations from the NATS KV INTEGRATIONS bucket</li> <li>For each enabled integration, it creates a scheduled poller with the configured interval</li> <li>At each interval, the poller authenticates with the external API using stored credentials</li> <li>Retrieved log data is published to <code>{applianceID}.data.artifacts.raw</code></li> <li>The poller tracks its position (cursor/timestamp) to avoid re-fetching data</li> </ol>"},{"location":"conductor/signal-client/#supported-integrations","title":"Supported Integrations","text":"<p>Signal Client supports all 19 API-based integrations. See the Integration Management page for the complete list organized by vendor.</p> Vendor Integration Count Microsoft 5 (Azure Security, Defender, Sentinel, Entra ID, Office 365) Cisco 4 (AMP, Duo, Meraki, Umbrella) CrowdStrike 1 (Falcon) Palo Alto 1 (Cortex) Proofpoint 2 (CASB, Protect) Others 6+ (Deep Instinct, Druva, LimaCharlie, Mimecast, Netskope, Okta, Splunk, Stealthwatch, Tenable, DNS Zone Transfer)"},{"location":"conductor/signal-client/#configuration","title":"Configuration","text":"<p>Integrations are configured through the NATS KV INTEGRATIONS bucket. Configuration changes can be made through the Conductor UI Integrations page.</p> <p>Each integration requires:</p> <ul> <li>API credentials \u2014 API keys, tokens, client ID/secret, or tenant-specific authentication</li> <li>Polling interval \u2014 How frequently to check for new data</li> <li>Enable/disable toggle \u2014 Each integration can be independently activated</li> </ul>"},{"location":"conductor/signal-client/#credential-management","title":"Credential Management","text":"<p>API credentials are stored in the NATS KV INTEGRATIONS bucket. Credentials are encrypted at rest and are only accessible to the signal-client service.</p> <p>Warning</p> <p>Ensure that API credentials have the minimum required permissions for log retrieval. Overly permissive credentials increase the blast radius of a potential compromise.</p>"},{"location":"conductor/signal-client/#container-details","title":"Container Details","text":"Property Value Container name <code>signal-client-svc</code> Internal hostname <code>signal-client</code> Depends on <code>broker-edge</code> (healthy) Exposed ports None (outbound connections only)"},{"location":"conductor/signal-client/#troubleshooting","title":"Troubleshooting","text":"Symptom Likely Cause Resolution No data from integration Invalid credentials or expired token Verify credentials in Conductor UI Authentication errors in logs API key revoked or permissions changed Regenerate credentials at the source platform Intermittent collection gaps Network connectivity or API rate limiting Check <code>wfa diag</code> for connectivity; review polling interval Integration shows enabled but no data Polling interval not elapsed Wait for the next polling cycle; check logs for errors <pre><code># Check signal-client logs\ndocker logs --tail 100 signal-client-svc 2&gt;&amp;1\n\n# Look for authentication or connection errors\ndocker logs signal-client-svc 2&gt;&amp;1 | grep -i \"error\\|fail\\|auth\\|timeout\"\n</code></pre>"},{"location":"conductor/signal-parser/","title":"Signal Parser Architecture","text":"<p>Signal Parser is the normalization engine of the Conductor pipeline. It consumes raw log messages from the <code>artifacts.raw</code> stream, runs them through a serial pipeline of 200+ vendor-specific parsers, and publishes structured artifacts to either <code>artifacts.parsed</code> (successful match) or <code>artifacts.unknown</code> (no match).</p>"},{"location":"conductor/signal-parser/#overview","title":"Overview","text":"<p>The parser operates as a serial pipeline \u2014 each incoming message is tested against parsers in sequence until a match is found. A fingerprinting system provides early-exit optimization, ensuring that only relevant parsers attempt full parsing of each message.</p> <pre><code>graph TD\n    RAW[\"artifacts.raw&lt;br/&gt;Raw Messages\"] --&gt; WP[Worker Pool]\n    WP --&gt; FP{Fingerprint&lt;br/&gt;Check}\n    FP --&gt;|No Match| SKIP[Skip Parser]\n    FP --&gt;|Match| PARSE[Full Parse]\n    PARSE --&gt;|Success| PARSED[\"artifacts.parsed\"]\n    PARSE --&gt;|Fail| NEXT[Next Parser]\n    SKIP --&gt; NEXT\n    NEXT --&gt;|More Parsers| FP\n    NEXT --&gt;|No More| UNKNOWN[\"artifacts.unknown\"]</code></pre>"},{"location":"conductor/signal-parser/#parser-pipeline","title":"Parser Pipeline","text":""},{"location":"conductor/signal-parser/#fingerprinting","title":"Fingerprinting","text":"<p>Each parser implements a <code>Fingerprint()</code> function that performs a lightweight check on the raw message. This function typically examines syslog headers (hostname, app_name) or uses a simple regex pattern to determine if the parser is relevant.</p> <p>Two-phase fingerprinting:</p> <ol> <li>Fast path \u2014 Check parsed syslog headers (hostname, app_name) for strong signals. This avoids regex evaluation entirely for most messages.</li> <li>Slow path \u2014 Fall back to regex matching on the raw message body when headers are not available or not sufficient.</li> </ol> <p>If the fingerprint doesn't match, the parser is skipped with microsecond-level overhead.</p>"},{"location":"conductor/signal-parser/#parser-registry","title":"Parser Registry","text":"<p>The parser registry maintains the list of all available parsers and their enabled/disabled state. The registry is configured through the NATS KV PARSERS bucket and can be managed via the Conductor UI Parser Management page.</p> <p>Note</p> <p>Parsers must explicitly reject <code>nil</code> settings during setup to ensure they wait for proper configuration from the NATS KV bucket. This prevents parsers from running in a disabled state.</p>"},{"location":"conductor/signal-parser/#serial-processing","title":"Serial Processing","text":"<p>When a message's fingerprint matches a parser, the full <code>Parse()</code> function is invoked to extract structured fields. The serial pipeline uses a first-match-wins strategy:</p> <ol> <li>Message enters the parser pipeline</li> <li>Each parser's <code>Fingerprint()</code> is checked in order</li> <li>On first fingerprint match, <code>Parse()</code> is called</li> <li>If parsing succeeds, the structured artifact is published to <code>artifacts.parsed</code></li> <li>If parsing fails, the next parser is tried</li> <li>If no parser matches, the message is published to <code>artifacts.unknown</code></li> </ol>"},{"location":"conductor/signal-parser/#worker-pool","title":"Worker Pool","text":"<p>Signal Parser uses a configurable worker pool for parallel message processing. Multiple workers consume from the <code>artifacts.raw</code> stream concurrently, each running the serial parser pipeline independently.</p> Configuration Description Worker count Number of parallel processing goroutines Buffer size Per-worker message buffer"},{"location":"conductor/signal-parser/#performance","title":"Performance","text":"Metric Target Per-message latency (optimized parsers) &lt;2ms Fingerprint check overhead Microseconds Pipeline throughput &gt;2,000 messages/sec Parser count impact Minimal (fingerprint early-exit) <p>The fingerprint-based early exit ensures that adding more parsers has negligible impact on per-message latency. Only parsers whose fingerprints match incur the cost of full parsing.</p>"},{"location":"conductor/signal-parser/#unknown-message-handling","title":"Unknown Message Handling","text":"<p>Messages that don't match any parser are published to the <code>artifacts.unknown</code> stream. This stream serves as:</p> <ul> <li>A monitoring signal \u2014 High volumes of unknown messages indicate log sources that need new parsers</li> <li>A development input \u2014 Unknown message samples are used to develop and test new parsers</li> <li>An automation trigger \u2014 The auto-parser generator workflow monitors this stream to automatically create parsers for high-volume unknown formats</li> </ul> <p>Tip</p> <p>Monitor the <code>artifacts.unknown</code> stream volume in the Conductor UI dashboard. A sudden increase may indicate a new log source was added without a corresponding parser, or an existing parser's fingerprint no longer matches due to a vendor format change.</p>"},{"location":"conductor/signal-parser/#container-details","title":"Container Details","text":"Property Value Container name <code>signal-parser-svc</code> Internal hostname <code>signal-parser</code> Depends on <code>broker-edge</code> (healthy) Exposed ports None"},{"location":"conductor/signal-parser/#troubleshooting","title":"Troubleshooting","text":"<pre><code># Check parser registration count\ndocker logs signal-parser-svc 2&gt;&amp;1 | grep -i \"registered\\|parsers\"\n\n# Check for unknown message volume\ndocker exec broker-edge-svc nats stream info DATA | grep -A5 \"unknown\"\n\n# View sample unknown messages\ndocker exec broker-edge-svc nats consumer next DATA unknown-debug --count 5\n</code></pre> <p>See Troubleshooting for additional diagnostic procedures.</p>"},{"location":"conductor/signal-server/","title":"Signal Server (Push Ingestion)","text":"<p>Signal Server handles push-based log ingestion from network sources. It listens on multiple ports for incoming log data via standard protocols and publishes raw messages to the NATS JetStream <code>artifacts.raw</code> stream for downstream processing.</p>"},{"location":"conductor/signal-server/#overview","title":"Overview","text":"<p>Signal Server supports four listener types, each optimized for a specific log transport protocol. Multiple listeners can run simultaneously, allowing a single Conductor node to receive data from diverse source types.</p>"},{"location":"conductor/signal-server/#listeners","title":"Listeners","text":"Listener Port Protocol Description Syslog UDP 514 UDP Standard syslog over UDP \u2014 highest throughput, no delivery guarantee Syslog TCP 514 TCP Standard syslog over TCP \u2014 reliable delivery with connection tracking Beats/Logstash 5044-5045 TCP Elastic Beats protocol \u2014 receives data from Filebeat, Winlogbeat, and other Beats agents Secure Syslog TLS 6514 TCP/TLS Encrypted syslog \u2014 TLS-wrapped syslog for secure transport HTTP 7514 HTTP HTTP-based log ingestion \u2014 webhook and REST-style log submission <p>Note</p> <p>Syslog UDP (port 514) is the most common listener for network devices such as firewalls, routers, and switches. Beats/Logstash listeners are used for endpoint agents. Secure Syslog TLS is recommended for log sources traversing untrusted networks.</p>"},{"location":"conductor/signal-server/#configuration","title":"Configuration","text":"<p>Signal Server listeners are configured through the NATS KV SERVERS bucket. Configuration changes can be made through the Conductor UI Log Servers page or directly via the KV bucket.</p> <p>Each listener can be independently enabled or disabled without affecting other listeners.</p>"},{"location":"conductor/signal-server/#masquerading-options","title":"Masquerading Options","text":"<p>Signal Server supports protocol masquerading, which allows a listener to accept data in one format and convert it to another before publishing to the pipeline. This is useful when source devices send non-standard log formats over standard protocols.</p>"},{"location":"conductor/signal-server/#data-flow","title":"Data Flow","text":"<pre><code>graph LR\n    S1[Syslog UDP :514] --&gt; SS[signal-server]\n    S2[Syslog TCP :514] --&gt; SS\n    S3[Beats :5044-5045] --&gt; SS\n    S4[TLS Syslog :6514] --&gt; SS\n    S5[HTTP :7514] --&gt; SS\n    SS --&gt;|publish| NATS[\"broker-edge&lt;br/&gt;artifacts.raw\"]</code></pre> <p>All received messages are published to the <code>{applianceID}.data.artifacts.raw</code> subject on the DATA stream, regardless of the source protocol.</p>"},{"location":"conductor/signal-server/#container-details","title":"Container Details","text":"Property Value Container name <code>signal-server-svc</code> Internal hostname <code>signal-server</code> Depends on <code>broker-edge</code> (healthy) Capabilities <code>NET_BIND_SERVICE</code> (required for ports &lt; 1024)"},{"location":"conductor/signal-server/#troubleshooting","title":"Troubleshooting","text":"Symptom Likely Cause Resolution No messages arriving Firewall blocking inbound traffic Verify firewall rules allow traffic on configured ports \"Connection refused\" in logs Broker Edge not available Check <code>broker-edge-svc</code> health \"Buffer full\" warnings Parser backpressure Check signal-parser throughput and stream lag Malformed message errors Source device sending unexpected format Verify source device syslog configuration <pre><code># Check signal-server logs\ndocker logs --tail 100 signal-server-svc 2&gt;&amp;1\n\n# Verify listeners are active\ndocker logs signal-server-svc 2&gt;&amp;1 | grep -i \"service is running\"\n\n# Test syslog ingestion\necho \"&lt;14&gt;$(date '+%b %d %H:%M:%S') testhost testsvc[1234]: Test message\" | nc -u localhost 514\n</code></pre> <p>See Troubleshooting for additional diagnostic procedures.</p>"},{"location":"conductor/troubleshooting/","title":"Troubleshooting","text":"<p>This guide covers common issues, diagnostic procedures, and resolution steps for WitFoo Conductor deployments.</p>"},{"location":"conductor/troubleshooting/#diagnostic-tools","title":"Diagnostic Tools","text":""},{"location":"conductor/troubleshooting/#wfa-diagnostics","title":"WFA Diagnostics","text":"<p>Run <code>wfa diag</code> to verify connectivity and system health:</p> <pre><code>sudo wfa diag\n</code></pre> <p>This checks:</p> <ul> <li>Grafana Cloud \u2014 metrics endpoint connectivity</li> <li>WitFoo Intel \u2014 support and remote jobs</li> <li>WitFoo Library \u2014 support pack upload</li> <li>WitFoo Licensing \u2014 license validation</li> <li>Docker Registry \u2014 container image access</li> <li>Cassandra Seeds \u2014 database connectivity (port 9042)</li> <li>Disk Usage \u2014 warns if any partition exceeds 80%</li> </ul>"},{"location":"conductor/troubleshooting/#support-bundle","title":"Support Bundle","text":"<p>Generate a comprehensive support bundle with <code>wfa support</code>:</p> <pre><code>sudo wfa support\n</code></pre> <p>Collects 19 diagnostic categories including Docker state, system logs, Cassandra diagnostics, NATS stream info, network configuration, and extended service logs. Automatically uploads to WitFoo support if a license is configured.</p>"},{"location":"conductor/troubleshooting/#common-issues","title":"Common Issues","text":""},{"location":"conductor/troubleshooting/#services-not-starting","title":"Services Not Starting","text":"<pre><code># Check service status\nsudo wfa status\n\n# Check container state\ndocker ps -a\n\n# Check service logs\ndocker logs &lt;container-name&gt; --tail=100\n</code></pre>"},{"location":"conductor/troubleshooting/#nats-connectivity","title":"NATS Connectivity","text":"<p>If services cannot connect to the broker:</p> <pre><code># Verify broker-edge is running\ndocker ps | grep broker-edge\n\n# Check NATS streams\ndocker exec broker-edge-svc nats stream ls\n\n# Check NATS server info\ndocker exec broker-edge-svc nats server info\n</code></pre>"},{"location":"conductor/troubleshooting/#parser-errors","title":"Parser Errors","text":"<p>If messages are not being parsed:</p> <ol> <li>Check the unknown stream for unparsed messages</li> <li>Verify parsers are enabled in the Conductor UI (<code>/admin/settings/processors</code>)</li> <li>Check signal-parser logs: <code>docker logs signal-parser-svc --tail=200</code></li> </ol>"},{"location":"conductor/troubleshooting/#memory-issues","title":"Memory Issues","text":"<p>On constrained nodes (8 GB RAM), containers may experience OOM kills:</p> <pre><code># Check container memory usage\ndocker stats --no-stream\n\n# Check system memory\nfree -h\n</code></pre> <p>Tip</p> <p>For nodes with limited memory, consider reducing the number of enabled parsers and integrations.</p>"},{"location":"conductor/troubleshooting/#integration-specific-troubleshooting","title":"Integration-Specific Troubleshooting","text":"<p>For issues related to specific data source integrations (authentication errors, rate limiting, missing data), see the per-vendor troubleshooting sections in the Integration Enablement Guides, or the shared Common Integration Troubleshooting page covering connection, authentication, rate limiting, and data flow diagnostics.</p>"},{"location":"conductor/troubleshooting/#log-locations","title":"Log Locations","text":"Source Location WFA daemon <code>journalctl -u wfad</code> Container logs <code>docker logs &lt;container-name&gt;</code> Container log files <code>/logs/&lt;service-name&gt;/</code> NATS logs <code>docker logs broker-edge-svc</code>"},{"location":"conductor/wfa-cli/","title":"WFA CLI Reference","text":"<p>The <code>wfa</code> command-line tool manages WitFoo Appliances. All commands require <code>sudo</code>.</p>"},{"location":"conductor/wfa-cli/#wfa-configure","title":"<code>wfa configure</code>","text":"<p>Interactive setup wizard that generates <code>/witfoo/configs/node.json</code>. The wizard walks through 12 configuration steps:</p> Step Prompt Details 1 Organization Info Organization ID (DNS-valid, lowercase) and Organization Name 2 Role Selection Conductor or Console. Hardware check warns if below minimum (Conductor: 4 CPU, 8 GB RAM) 3 License Cloud: auto-fetch from <code>licensing.witfoo.com</code>. On-prem: manual key entry or 15-day trial request (company, contact, email, core count) 4 Appliance ID Auto-generated UUID (Conductor only; Console skips this step) 5 Network Hostname and IP address (auto-detect with manual override) 6 Broker Config Conductor only: client port (4223), leaf port (4443), max data (1024 MB) 7 Registry Container registry (auto-configured from license) 8 TLS Certificates Paths for client cert/key, server cert/key, CA cert (defaults: <code>/witfoo/certs/</code>) 9 Admin Password Minimum 8 characters, masked input with confirmation. Saved to <code>/data/local/.passwd</code> 10 Features Conductor: local metrics, offline mode, metrics export, auto-update, console FQDN. Console: offline mode, auto-update only 11 Review Display all settings for confirmation (y/n) 12 Save Write <code>/witfoo/configs/node.json</code> with permissions <code>0600</code> <pre><code>sudo wfa configure\n</code></pre>"},{"location":"conductor/wfa-cli/#wfa-status","title":"<code>wfa status</code>","text":"<p>Displays WFA version, <code>wfad</code> systemd service state, error count since start, and the last 10 error log entries from the journal.</p> <pre><code>sudo wfa status\n</code></pre>"},{"location":"conductor/wfa-cli/#wfa-diag","title":"<code>wfa diag</code>","text":"<p>Runs connectivity and system diagnostics with formatted output:</p> <p>Connectivity checks:</p> Check Target Grafana Cloud Metrics endpoint reachability Intel <code>intel.witfoo.com</code> Library <code>library.witfoo.com</code> Licensing <code>licensing.witfoo.com</code> Docker Registry Container image registry Cassandra Seeds Port 9042 (if applicable) <p>System checks:</p> Check Description Kafka Topics Topic health (Streamer roles) Disk Usage Warns at &gt;80% utilization <p>Output is a formatted table with check name, result, and status (pass/fail).</p> <pre><code>sudo wfa diag\n</code></pre>"},{"location":"conductor/wfa-cli/#wfa-support","title":"<code>wfa support</code>","text":"<p>Generates a comprehensive support bundle with 19 diagnostic categories:</p> Category Contents Docker Inspect Container configuration details Docker PS Running container list Docker Logs Last 500 lines per container Docker Images Installed image list Journal Last 24 hours of systemd journal Disk Usage Filesystem utilization Hosts File <code>/etc/hosts</code> contents Users System user list Var Log <code>/var/log</code> contents (500 MB limit) Node Config <code>/witfoo/configs/node.json</code> Cassandra nodetool (describecluster, ring, info, status, tablestats), CQL schema Netstat Network connections IP Route Routing table IPTables Firewall rules Listening Ports <code>ss -tulpn</code> output Docker Networks Network configuration NATS Server info, stream/consumer reports, KV bucket contents Pipeline Metrics conductor-ui API metrics, Docker stats Extended Logs Last 2000 lines per pipeline service <p>Output: <code>support-{org_id}-{timestamp}.zip</code></p> <p>The bundle auto-uploads to <code>library.witfoo.com</code> if a license is configured. Without a license, the file is saved locally.</p> <pre><code>sudo wfa support\n</code></pre>"},{"location":"conductor/wfa-cli/#wfa-certs","title":"<code>wfa certs</code>","text":"<p>Displays certificate status in a table format showing CA, server cert/key, and client cert/key with their source type (embedded, customer, or generated).</p> <pre><code>sudo wfa certs\n</code></pre> <p>Force re-extract embedded certificates and regenerate the CA bundle:</p> <pre><code>sudo wfa certs --refresh\n</code></pre>"},{"location":"conductor/wfa-cli/#wfa-images","title":"<code>wfa images</code>","text":"<p>Offline container image management for air-gapped deployments.</p> <p>List required images and their local availability:</p> <pre><code>sudo wfa images --list\n</code></pre> <p>Pull and save all required images to a tar file:</p> <pre><code>sudo wfa images --save\n</code></pre> <p>Output: <code>/witfoo/images/{role}-images.tar</code></p> <p>Load images from a tar file into Docker:</p> <pre><code>sudo wfa images --load\n</code></pre> <p>Offline Deployment Workflow</p> <p>For air-gapped environments:</p> <ol> <li>On an internet-connected machine: <code>sudo wfa images --save</code></li> <li>Transfer <code>/witfoo/images/{role}-images.tar</code> to the air-gapped node (USB, SCP, etc.)</li> <li>On the air-gapped node: <code>sudo wfa images --load</code></li> <li>Start services: <code>sudo wfa start</code></li> </ol>"},{"location":"conductor/wfa-cli/#wfa-start","title":"<code>wfa start</code>","text":"<p>Starts the <code>wfad</code> systemd service. Enables the service if not already enabled.</p> <pre><code>sudo wfa start\n</code></pre>"},{"location":"conductor/wfa-cli/#wfa-stop","title":"<code>wfa stop</code>","text":"<p>Stops the <code>wfad</code> systemd service and all managed containers.</p> <pre><code>sudo wfa stop\n</code></pre>"},{"location":"conductor/wfa-cli/#wfa-restart","title":"<code>wfa restart</code>","text":"<p>Restarts the <code>wfad</code> systemd service, which triggers a full container lifecycle restart.</p> <pre><code>sudo wfa restart\n</code></pre>"},{"location":"conductor/wfa-cli/#wfa-enable","title":"<code>wfa enable</code>","text":"<p>Enables the <code>wfad</code> service for automatic start at boot via <code>systemctl enable wfad</code>.</p> <pre><code>sudo wfa enable\n</code></pre>"},{"location":"conductor/wfa-cli/#wfa-reboot","title":"<code>wfa reboot</code>","text":"<p>Stops <code>wfad</code>, runs system package updates (<code>apt update &amp;&amp; apt upgrade -y</code>), then reboots the system.</p> <pre><code>sudo wfa reboot\n</code></pre>"},{"location":"conductor/wfa-cli/#wfa-version","title":"<code>wfa version</code>","text":"<p>Displays the current WFA version string.</p> <pre><code>sudo wfa version\n</code></pre>"},{"location":"conductor/wfa-integration/","title":"WFA Agent Architecture","text":"<p>WFA (WitFoo Agent) is the systemd daemon that orchestrates all Conductor containers on a WitFoo Appliance. It manages the complete container lifecycle from image management through runtime monitoring.</p>"},{"location":"conductor/wfa-integration/#container-lifecycle","title":"Container Lifecycle","text":"<p>WFA follows a deterministic startup sequence:</p> <ol> <li>Pull Images \u2014 Check the configured container registry for updated images, comparing SHA256 digests</li> <li>Create Containers \u2014 Configure each container with environment variables, volume mounts, port mappings, and network settings</li> <li>Start in Dependency Order \u2014 Launch containers respecting inter-service dependencies</li> <li>Monitor Health \u2014 Continuously check container health and restart failed services</li> </ol>"},{"location":"conductor/wfa-integration/#dependency-order","title":"Dependency Order","text":"<pre><code>broker-edge\n    \u251c\u2500\u2500 signal-server\n    \u251c\u2500\u2500 signal-client\n    \u251c\u2500\u2500 signal-parser\n    \u2502       \u2514\u2500\u2500 artifact-filter\n    \u2502               \u2514\u2500\u2500 artifact-exporter\n    \u2514\u2500\u2500 conductor-ui\n</code></pre> <p>Broker Edge must be healthy before any downstream service starts. The WFA container manager polls every 60 seconds for image updates.</p>"},{"location":"conductor/wfa-integration/#auto-update-mechanism","title":"Auto-Update Mechanism","text":"<p>When <code>auto_update</code> is enabled in <code>node.json</code>:</p> <ul> <li>WFA configures Ubuntu's <code>unattended-upgrades</code> to include the WitFoo apt repository</li> <li>System packages (including WFA itself) are updated hourly via systemd timer overrides</li> <li>Container images are checked every 60 seconds against the registry</li> <li>Updated images are pulled and containers are recreated automatically</li> </ul> <p>Note</p> <p>Container image updates are seamless \u2014 WFA compares SHA256 digests and only recreates containers when the image has changed. The startup dependency order is maintained during updates.</p>"},{"location":"conductor/wfa-integration/#certificate-management","title":"Certificate Management","text":"<p>WFA manages TLS certificates with three source types:</p> Source Description Embedded Default WitFoo certificates compiled into the WFA binary Customer Customer-provided certificates configured in <code>node.json</code> Generated Auto-generated certificates for development environments <p>Certificate precedence: Customer certificates override embedded ones. The <code>ca-bundle.crt</code> is automatically generated combining all CA certificates.</p> <p>All containers mount <code>/witfoo/certs</code> as <code>/certs</code> (read-only).</p>"},{"location":"conductor/wfa-integration/#monitoring-integration","title":"Monitoring Integration","text":"<p>When <code>export_metrics</code> is enabled, WFA deploys a Grafana Agent container that:</p> <ul> <li>Scrapes Prometheus metrics from pipeline services</li> <li>Forwards metrics to Grafana Cloud</li> <li>Streams service logs and journal entries</li> </ul> <p>When <code>local_metrics</code> is enabled, WFA additionally deploys:</p> <ul> <li>Prometheus (port 9090) \u2014 Local metrics collection with 24-hour retention</li> <li>Grafana (port 3000) \u2014 Local dashboards for pipeline visualization</li> </ul>"},{"location":"conductor/wfa-integration/#docker-system-maintenance","title":"Docker System Maintenance","text":"<p>After all containers are confirmed running, WFA runs a Docker system prune in the background to reclaim disk space from stopped containers, unused networks, and old images.</p>"},{"location":"conductor/integrations/","title":"Integrations","text":"<p>WitFoo Conductor collects security log data from cloud platforms, endpoints, identity providers, email security, network infrastructure, and more through pull-based API integrations. The Signal Client service polls each vendor's API on a configurable schedule and publishes artifacts to the processing pipeline.</p>","tags":["integration"]},{"location":"conductor/integrations/#quick-start","title":"Quick Start","text":"<ol> <li>Ensure you have the required vendor license and API access (see each guide's    Prerequisites section)</li> <li>Create API credentials in the vendor console</li> <li>Open the Conductor UI \u2192 Integrations page</li> <li>Select the vendor from the Add Integration dropdown</li> <li>Enter your credentials and enable the integration</li> <li>Validate data flow within 1\u20132 polling cycles</li> </ol>","tags":["integration"]},{"location":"conductor/integrations/#integration-catalog","title":"Integration Catalog","text":"","tags":["integration"]},{"location":"conductor/integrations/#endpoint-security","title":"Endpoint Security","text":"Integration Auth Method Guide Cisco AMP Client ID + API Key Enable \u2192 CrowdStrike Falcon OAuth2 Client Credentials Enable \u2192 Deep Instinct API Key Enable \u2192 SentinelOne API Token Enable \u2192 Sophos Central OAuth2 Client Credentials Enable \u2192 Carbon Black API Key Enable \u2192 Halcyon Username / Password Enable \u2192","tags":["integration"]},{"location":"conductor/integrations/#cloud-security","title":"Cloud Security","text":"Integration Auth Method Guide Azure Security OAuth2 (Azure AD) Enable \u2192 AWS GuardDuty IAM Access Key Enable \u2192 AWS Security Hub IAM Access Key Enable \u2192 Google Cloud SCC Service Account JSON Enable \u2192 Wiz OAuth2 Client Credentials Enable \u2192 Oracle Cloud (OCI) API Key (RSA Signing) Enable \u2192","tags":["integration"]},{"location":"conductor/integrations/#network-security","title":"Network Security","text":"Integration Auth Method Guide Cisco Meraki API Key Enable \u2192 Cisco Umbrella API Key + Secret Enable \u2192 Stealthwatch Username / Password Enable \u2192 Palo Alto Cortex API Key Enable \u2192 Fortinet FortiAnalyzer Session Token Enable \u2192 Zscaler ZIA API Key + Session Cookie Enable \u2192 Darktrace HMAC Token Enable \u2192","tags":["integration"]},{"location":"conductor/integrations/#identity-access","title":"Identity &amp; Access","text":"Integration Auth Method Guide Cisco Duo Client ID + Secret Enable \u2192 Okta API Token Enable \u2192 Auth0 OAuth2 Client Credentials Enable \u2192 1Password Events API Token Enable \u2192 CyberArk EPM Username / Password Enable \u2192 Arista AGNI API Key Enable \u2192","tags":["integration"]},{"location":"conductor/integrations/#email-security","title":"Email Security","text":"Integration Auth Method Guide Mimecast OAuth2 Client Credentials Enable \u2192 Proofpoint CASB Client ID + Secret Enable \u2192 Proofpoint Protect Client ID + Secret Enable \u2192 Abnormal Security API Token Enable \u2192","tags":["integration"]},{"location":"conductor/integrations/#siem","title":"SIEM","text":"Integration Auth Method Guide Splunk Token / Username + Password Enable \u2192 Rapid7 InsightIDR API Key Enable \u2192","tags":["integration"]},{"location":"conductor/integrations/#infrastructure","title":"Infrastructure","text":"Integration Auth Method Guide DNS Zone Transfer None (AXFR) Enable \u2192 Druva Client ID + Secret Enable \u2192 LimaCharlie API Key Enable \u2192 Netskope API Token (v1/v2) Enable \u2192","tags":["integration"]},{"location":"conductor/integrations/#vulnerability-management","title":"Vulnerability Management","text":"Integration Auth Method Guide Tenable Access Key + Secret Key Enable \u2192 Qualys Username / Password Enable \u2192","tags":["integration"]},{"location":"conductor/integrations/#common-configuration","title":"Common Configuration","text":"<p>All integrations share these common behaviors:</p> <ul> <li>Polling Interval \u2014 Configurable per integration (default varies by vendor).   Lower intervals mean fresher data but higher API usage</li> <li>Checkpoint Tracking \u2014 Signal Client resumes from the last successful   position after restarts, avoiding duplicate collection</li> <li>Rate Limiting \u2014 Built-in respect for vendor API quotas with exponential   backoff on HTTP 429 responses</li> <li>Enable/Disable \u2014 Each integration can be toggled without removing its   configuration</li> </ul> <p>Configuration changes propagate within seconds via the NATS KV watch mechanism. No container restart is required.</p> <p>See also: Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration"]},{"location":"conductor/integrations/abnormal-security/","title":"Abnormal Security","text":"<p>Collects threat detection data from Abnormal Security, including business email compromise (BEC), phishing, account takeover, and other advanced email threats identified by Abnormal's behavioral AI platform.</p> Category Email Security Connector Name <code>signal-client.abnormal-security</code> Auth Method API Token (Bearer) Polling Interval 10 min Multi-Instance Yes Vendor Docs Abnormal Security API","tags":["integration","email"]},{"location":"conductor/integrations/abnormal-security/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Abnormal Security subscription with API access enabled. Admin role required to generate API tokens.</p> <ul> <li> Active Abnormal Security subscription</li> <li> Admin access to the Abnormal Security portal</li> <li> Network: Conductor can reach <code>api.abnormalplatform.com</code> on port 443</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/abnormal-security/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Abnormal Security Portal at    <code>https://portal.abnormalplatform.com/</code></li> <li>Navigate to Settings \u2192 Integrations</li> <li>Select REST API</li> <li>Click Generate Token</li> <li>Copy the generated API Token</li> </ol> <p>Token Expiry</p> <p>Abnormal Security API tokens typically expire annually. Set a calendar reminder to rotate the token before expiry to avoid data collection interruptions.</p>","tags":["integration","email"]},{"location":"conductor/integrations/abnormal-security/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Abnormal Security</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>api.abnormalplatform.com</code> Abnormal API endpoint API Key <code>&lt;your-api-token&gt;</code> Bearer token from step 1 </li> <li> <p>Set the Polling Interval (recommended: 10 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","email"]},{"location":"conductor/integrations/abnormal-security/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"abnormal\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] abnormal-security: fetched &lt;N&gt; threats\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","email"]},{"location":"conductor/integrations/abnormal-security/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","email"]},{"location":"conductor/integrations/abnormal-security/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Token is correct and has not expired</li> <li>Regenerate the token in the Abnormal Security portal if needed</li> <li>Ensure the token was copied completely (no trailing whitespace)</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/abnormal-security/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The token may belong to a user without sufficient permissions</li> <li>Confirm the user has Admin access in the Abnormal Security portal</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/abnormal-security/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Abnormal Security enforces API rate limits based on subscription tier</li> <li>Increase the Polling Interval to 30 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/abnormal-security/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify threats exist in the Abnormal Security console for the polling window</li> <li>Confirm network connectivity: <code>curl -I https://api.abnormalplatform.com</code></li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","email"]},{"location":"conductor/integrations/arista-agni/","title":"Arista AGNI","text":"<p>Collects network identity and access data from Arista AGNI (formerly CloudVision Guardian), including user sessions, client connections, and network access events.</p> Category Identity &amp; Access Connector Name <code>signal-client.arista-agni</code> Auth Method API Key (Bearer) Polling Interval 10 min (events), 1 hr (assets) Multi-Instance Yes Vendor Docs Arista CloudVision API","tags":["integration","identity"]},{"location":"conductor/integrations/arista-agni/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Arista AGNI or CloudVision deployment with API access. Admin access required to generate API keys.</p> <ul> <li> Active Arista AGNI / CloudVision subscription</li> <li> Admin access to the CloudVision portal</li> <li> Network: Conductor can reach your CloudVision instance on port 443</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/arista-agni/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Arista CloudVision portal</li> <li>Navigate to Settings \u2192 API Keys</li> <li>Click Create API Key</li> <li>Copy the API Key and note the API Value (secret)</li> <li>Record the Organization ID from the portal settings</li> </ol> <p>Store Credentials Securely</p> <p>The API value is only shown once at creation time. Store it securely.</p>","tags":["integration","identity"]},{"location":"conductor/integrations/arista-agni/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Arista AGNI</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>&lt;your-cloudvision-url&gt;</code> CloudVision instance URL API Key <code>&lt;your-api-key&gt;</code> API key from step 1 API Value <code>&lt;your-api-value&gt;</code> API secret from step 1 </li> <li> <p>Set the Polling Interval (recommended: 10 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","identity"]},{"location":"conductor/integrations/arista-agni/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"arista\"\n</code></pre> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","identity"]},{"location":"conductor/integrations/arista-agni/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","identity"]},{"location":"conductor/integrations/arista-agni/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Key and API Value are correct</li> <li>Ensure the key has not been revoked or expired</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/arista-agni/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API key may not have sufficient access scope</li> <li>Verify the key has read permissions for AGNI data</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/arista-agni/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 30 minutes</li> <li>Conductor automatically implements exponential backoff</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/arista-agni/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Verify the Host URL is correct and reachable</li> <li>Ensure the Organization ID matches your CloudVision deployment</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/","title":"Auth0","text":"<p>Collects authentication and authorization event logs from Auth0 (Okta Customer Identity Cloud), including login events, failed authentication attempts, and admin audit logs.</p> Category Identity &amp; Access Connector Name <code>signal-client.auth0</code> Auth Method OAuth2 Client Credentials Polling Interval 5 min Multi-Instance Yes Vendor Docs Auth0 Management API","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Auth0 subscription. Admin access required to create Machine-to-Machine applications.</p> <ul> <li> Active Auth0 tenant</li> <li> Admin access to the Auth0 Dashboard</li> <li> Network: Conductor can reach your Auth0 domain on port 443</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Auth0 Dashboard at <code>https://manage.auth0.com/</code></li> <li>Navigate to Applications \u2192 Applications</li> <li>Click Create Application</li> <li>Select Machine to Machine Applications</li> <li>Name it (e.g., \"WitFoo Conductor\")</li> <li>Select the Auth0 Management API as the authorized API</li> <li>Grant the scope: <code>read:logs</code></li> <li>Click Authorize</li> <li>Note the Domain, Client ID, and Client Secret from the    application settings</li> </ol> <p>Auth0 Domain Format</p> <p>Your Auth0 domain has the format <code>&lt;your-tenant&gt;.us.auth0.com</code> (or <code>.eu.auth0.com</code> for EU tenants). Custom domains are also supported.</p>","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Auth0</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Domain <code>&lt;tenant&gt;.us.auth0.com</code> Auth0 tenant domain Client ID <code>&lt;your-client-id&gt;</code> Machine-to-Machine app Client ID Client Secret <code>&lt;your-client-secret&gt;</code> Machine-to-Machine app secret </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"auth0\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] auth0: fetched &lt;N&gt; log events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Client ID and Client Secret are correct</li> <li>Ensure the application is authorized for the Management API with <code>read:logs</code></li> <li>Check that the Domain format is correct (include <code>.auth0.com</code>)</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The application may lack the <code>read:logs</code> scope</li> <li>Re-authorize the application in Applications \u2192 select app \u2192   APIs tab \u2192 Auth0 Management API \u2192 add <code>read:logs</code></li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Auth0 rate limits vary by plan tier (50 req/sec on free plan)</li> <li>Increase the Polling Interval to 15 minutes</li> <li>Conductor automatically implements exponential backoff</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/#log-retention","title":"Log Retention","text":"<ul> <li>Auth0 log retention varies by plan:<ul> <li>Free: 2 days</li> <li>Developer: 2 days</li> <li>Developer Pro: 10 days</li> <li>Enterprise: 30 days</li> </ul> </li> <li>If gaps appear in data, increase polling frequency to stay within   retention window</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/auth0/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify authentication events exist: test by logging into your Auth0-powered app</li> <li>Verify network connectivity: <code>curl -I https://&lt;tenant&gt;.us.auth0.com</code></li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","identity"]},{"location":"conductor/integrations/aws-guardduty/","title":"AWS GuardDuty","text":"<p>Collects threat detection findings from Amazon GuardDuty, Amazon's managed threat detection service that monitors for malicious activity and anomalous behavior across AWS accounts and workloads.</p> Category Cloud Security Connector Name <code>signal-client.aws-guardduty</code> Auth Method IAM Access Key + Secret Key Polling Interval 5 min Multi-Instance Yes Vendor Docs AWS GuardDuty API","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-guardduty/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active AWS account with GuardDuty enabled. IAM permissions to create users and/or roles.</p> <ul> <li> Active AWS account</li> <li> GuardDuty enabled in the target region</li> <li> IAM access to create users or roles</li> <li> Network: Conductor can reach <code>guardduty.&lt;region&gt;.amazonaws.com</code> on port 443</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-guardduty/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Sign in to the AWS Console at <code>https://console.aws.amazon.com/</code></li> <li>Navigate to IAM \u2192 Users \u2192 Create user</li> <li>Name the user (e.g., <code>witfoo-guardduty-reader</code>)</li> <li>Select Programmatic access (Access key)</li> <li>Attach the managed policy: <code>AmazonGuardDutyReadOnlyAccess</code></li> <li>Complete user creation</li> <li>Copy the Access Key ID and Secret Access Key</li> </ol> <p>Cross-Account Collection</p> <p>For multi-account environments, create an IAM role with an external ID instead of an IAM user. The role should trust the Conductor account and have <code>AmazonGuardDutyReadOnlyAccess</code> attached.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-guardduty/#enable-guardduty-if-not-already-enabled","title":"Enable GuardDuty (if not already enabled)","text":"<ol> <li>Navigate to GuardDuty in the AWS Console</li> <li>Click Get Started \u2192 Enable GuardDuty</li> <li>GuardDuty begins analyzing VPC Flow Logs, CloudTrail events, and DNS logs</li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-guardduty/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select AWS GuardDuty</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Region <code>us-east-1</code> AWS region where GuardDuty is enabled Access Key ID <code>&lt;your-access-key&gt;</code> IAM access key from step 1 Secret Access Key <code>&lt;your-secret-key&gt;</code> IAM secret key from step 1 Detector ID (optional) Leave blank for auto-discovery </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol> <p>Detector ID Auto-Discovery</p> <p>If the Detector ID field is left blank, Conductor will automatically discover the GuardDuty detector in the configured region using the <code>ListDetectors</code> API.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-guardduty/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"guardduty\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] aws-guardduty: fetched &lt;N&gt; findings\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol> <p>GuardDuty Severity Scale</p> <p>GuardDuty findings use a severity scale of 0\u20138.9. Conductor normalizes these to WitFoo severity levels automatically.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-guardduty/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-guardduty/#authentication-failed-401403","title":"Authentication Failed (401/403)","text":"<ul> <li>Verify the Access Key ID and Secret Access Key are correct</li> <li>Ensure the IAM user has the <code>AmazonGuardDutyReadOnlyAccess</code> policy attached</li> <li>Check that the IAM user or access key is not disabled</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-guardduty/#wrong-region","title":"Wrong Region","text":"<ul> <li>GuardDuty is region-specific \u2014 ensure the Region field matches where   GuardDuty is enabled</li> <li>If GuardDuty is enabled in multiple regions, create one integration per region</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-guardduty/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm GuardDuty is enabled in the target AWS region</li> <li>GuardDuty may take up to 24 hours to generate initial findings</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://guardduty.&lt;region&gt;.amazonaws.com</code></li> </ul> <p>See also: Integration Catalog \u00b7 AWS Security Hub \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-securityhub/","title":"AWS Security Hub","text":"<p>Collects aggregated security findings from AWS Security Hub, which consolidates alerts from GuardDuty, Inspector, Macie, IAM Access Analyzer, Firewall Manager, and third-party tools into the AWS Security Finding Format (ASFF).</p> Category Cloud Security Connector Name <code>signal-client.aws-securityhub</code> Auth Method IAM Access Key + Secret Key Polling Interval 5 min Multi-Instance Yes Vendor Docs AWS Security Hub API","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-securityhub/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active AWS account with Security Hub enabled. IAM permissions to create users and/or roles.</p> <ul> <li> Active AWS account</li> <li> Security Hub enabled in the target region</li> <li> IAM access to create users or roles</li> <li> Network: Conductor can reach <code>securityhub.&lt;region&gt;.amazonaws.com</code> on port 443</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-securityhub/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<p>If you already have AWS credentials for GuardDuty, you can reuse the same IAM user \u2014 just add the Security Hub policy.</p> <ol> <li>Sign in to the AWS Console at <code>https://console.aws.amazon.com/</code></li> <li>Navigate to IAM \u2192 Users \u2192 Create user (or select existing user)</li> <li>Name the user (e.g., <code>witfoo-securityhub-reader</code>)</li> <li>Attach the managed policy: <code>AWSSecurityHubReadOnlyAccess</code></li> <li>If using an existing GuardDuty IAM user, add this policy to the same user</li> <li>Create an Access Key (programmatic access)</li> <li>Copy the Access Key ID and Secret Access Key</li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-securityhub/#enable-security-hub-if-not-already-enabled","title":"Enable Security Hub (if not already enabled)","text":"<ol> <li>Navigate to Security Hub in the AWS Console</li> <li>Click Go to Security Hub \u2192 Enable Security Hub</li> <li>Select security standards to enable (CIS, PCI DSS, AWS Foundational)</li> </ol> <p>Security Hub vs GuardDuty</p> <p>Security Hub aggregates findings from multiple AWS security services including GuardDuty. If you only need GuardDuty findings, use the AWS GuardDuty integration instead. Use both if you want findings from all integrated AWS security services.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-securityhub/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select AWS Security Hub</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Region <code>us-east-1</code> AWS region where Security Hub is enabled Access Key ID <code>&lt;your-access-key&gt;</code> IAM access key from step 1 Secret Access Key <code>&lt;your-secret-key&gt;</code> IAM secret key from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-securityhub/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"securityhub\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] aws-securityhub: fetched &lt;N&gt; findings\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-securityhub/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-securityhub/#authentication-failed-401403","title":"Authentication Failed (401/403)","text":"<ul> <li>Verify the Access Key ID and Secret Access Key are correct</li> <li>Ensure the IAM user has the <code>AWSSecurityHubReadOnlyAccess</code> policy attached</li> <li>Check that the access key is active</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-securityhub/#wrong-region","title":"Wrong Region","text":"<ul> <li>Security Hub is region-specific \u2014 configure one integration per region</li> <li>Findings are not cross-region unless using Organizations delegated admin</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/aws-securityhub/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm Security Hub is enabled in the target region</li> <li>Enable at least one security standard (CIS, PCI DSS) to generate findings</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://securityhub.&lt;region&gt;.amazonaws.com</code></li> </ul> <p>See also: Integration Catalog \u00b7 AWS GuardDuty \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/","title":"Azure Security","text":"<p>Collects security alerts and incidents from Microsoft Azure Security services including Microsoft Defender for Cloud, Sentinel, and Entra ID, providing visibility into cloud workload protection and identity threats.</p> Category Cloud Security Connector Name <code>signal-client.azure-security</code> Auth Method OAuth2 (Azure AD \u2014 Client ID + Client Secret + Tenant ID) Polling Interval 5 min (alerts), 15 min (incidents) Multi-Instance Yes Vendor Docs Microsoft Graph Security API","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Microsoft Azure subscription with Microsoft Defender for Cloud or Microsoft 365 Defender. Azure AD admin access required to register an application.</p> <ul> <li> Active Azure subscription with security services enabled</li> <li> Global Administrator or Application Administrator role in Azure AD</li> <li> Network: Conductor can reach <code>graph.microsoft.com</code> and <code>login.microsoftonline.com</code> on port 443</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Azure Portal at <code>https://portal.azure.com/</code></li> <li>Navigate to Azure Active Directory \u2192 App registrations \u2192 New registration</li> <li>Configure the application:<ul> <li>Name: <code>WitFoo Conductor</code></li> <li>Supported account types: Accounts in this organizational directory only</li> </ul> </li> <li>Click Register</li> <li>Note the Application (client) ID and Directory (tenant) ID from the overview page</li> <li>Navigate to Certificates &amp; secrets \u2192 New client secret<ul> <li>Description: <code>WitFoo Conductor</code></li> <li>Expires: 24 months (recommended)</li> </ul> </li> <li>Copy the Value (client secret) \u2014 it is only shown once</li> <li>Navigate to API permissions \u2192 Add a permission \u2192 Microsoft Graph \u2192 Application permissions<ul> <li>Add: <code>SecurityEvents.Read.All</code></li> <li>Add: <code>SecurityAlert.Read.All</code> (for v2 alerts)</li> </ul> </li> <li>Click Grant admin consent for your organization</li> </ol> <p>Store Credentials Securely</p> <p>The client secret grants access to your Azure security data. Store it securely and do not share it in tickets or email.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Azure Security</li> <li>Enter a unique name for this instance (e.g., \"Azure Production Tenant\")</li> <li> <p>Fill in the settings form:</p> Field Value Description Tenant ID <code>&lt;your-tenant-id&gt;</code> Azure AD directory (tenant) ID Client ID <code>&lt;your-client-id&gt;</code> Application (client) ID from app registration Client Secret <code>&lt;your-client-secret&gt;</code> Secret value from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes for alerts)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"azure\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] azure-security: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#data-collection-details","title":"Data Collection Details","text":"<p>The Azure Security connector collects data from two Microsoft Graph API versions:</p> Endpoint Version Interval Description Security Alerts v1 5 min Microsoft Defender for Cloud alerts Security Alerts v2 v2 5 min Enhanced alerts with typed evidence Incidents v1 15 min Correlated incident data from Sentinel","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#v2-alert-evidence-types","title":"V2 Alert Evidence Types","text":"<p>The v2 alerts endpoint (<code>/security/alerts_v2</code>) returns structured evidence objects. The connector processes these typed evidence payloads:</p> Evidence Type Description Mailbox Compromised or targeted mailbox details Message Email message artifacts (subject, sender, recipients) URL Suspicious or malicious URL indicators MailCluster Grouped email cluster analysis data <p>Pagination is handled automatically via <code>@odata.nextLink</code> response links.</p> <p>Rate Limiting Behavior</p> <p>Microsoft Graph API returns HTTP 429 with a <code>Retry-After</code> header. The connector implements a 10-minute cooldown with context-aware retry on 429 responses. HTTP 403 responses are handled silently (permission warning logged) to prevent blocking other data collection.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#required-api-permissions","title":"Required API Permissions","text":"Permission Type Purpose <code>SecurityEvents.Read.All</code> Application Read security events (v1 API) <code>SecurityAlert.Read.All</code> Application Read security alerts (v2 API) <p>Both permissions require admin consent to be granted.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Tenant ID, Client ID, and Client Secret are correct</li> <li>Ensure the client secret has not expired</li> <li>Check that the app registration exists in the correct Azure AD tenant</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The app registration may lack required API permissions</li> <li>Required: <code>SecurityEvents.Read.All</code> and <code>SecurityAlert.Read.All</code></li> <li>Ensure admin consent has been granted for the permissions</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Microsoft Graph API has per-app and per-tenant throttling limits</li> <li>Increase the Polling Interval to 10 minutes if rate limiting occurs</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/azure-security/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://graph.microsoft.com</code></li> <li>Confirm security alerts exist in the Azure Security Center for the polling time window</li> <li>Ensure Microsoft Defender for Cloud or another security service is generating alerts</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/carbon-black/","title":"Carbon Black","text":"<p>Collects endpoint alerts and device inventory from VMware Carbon Black Cloud (now Broadcom), including malware detections, suspicious activity alerts, and endpoint asset data.</p> Category Endpoint Security Connector Name <code>signal-client.carbon-black</code> Auth Method API Key + API ID (X-Auth-Token) Polling Interval 5 min (alerts), 1 hr (devices) Multi-Instance Yes Vendor Docs Carbon Black Cloud API","tags":["integration","endpoint"]},{"location":"conductor/integrations/carbon-black/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Carbon Black Cloud subscription. Administrator access required to create API keys.</p> <ul> <li> Active Carbon Black Cloud subscription</li> <li> Administrator access to the CBC console</li> <li> Organization Key (found in console settings)</li> <li> Network: Conductor can reach your CBC instance on port 443</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/carbon-black/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Carbon Black Cloud Console at    <code>https://defense.conferdeploy.net/</code> (or your regional instance)</li> <li>Navigate to Settings \u2192 API Access</li> <li>Click Add API Key</li> <li>Select Custom as the access level type</li> <li>Set permissions: <code>org.alerts: READ</code></li> <li>Name the key (e.g., \"WitFoo Conductor\")</li> <li>Click Save</li> <li>Copy the API ID and API Secret Key</li> <li>Note the Org Key from Settings \u2192 API Access (shown at the top)</li> </ol> <p>API Key Types</p> <p>Carbon Black Cloud has multiple API key types: API, SIEM, and Custom. Use Custom type with specific read permissions for WitFoo integration. SIEM keys provide different endpoint access.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/carbon-black/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Carbon Black</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>defense.conferdeploy.net</code> CBC console URL (varies by region) Org Key <code>&lt;your-org-key&gt;</code> Organization key from API Access page API Key <code>&lt;your-api-secret-key&gt;</code> API secret key from step 1 API ID <code>&lt;your-api-id&gt;</code> API ID from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes for alerts)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol> <p>Finding Your Org Key</p> <p>The Org Key is displayed at the top of the Settings \u2192 API Access page in the Carbon Black Cloud console. It is a short alphanumeric string (e.g., <code>ABCD1234</code>).</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/carbon-black/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"carbon-black\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] carbon-black: fetched &lt;N&gt; alerts\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","endpoint"]},{"location":"conductor/integrations/carbon-black/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","endpoint"]},{"location":"conductor/integrations/carbon-black/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API ID and API Secret Key are correct</li> <li>Ensure the header format is correct: <code>X-Auth-Token: &lt;API_SECRET_KEY&gt;/&lt;API_ID&gt;</code></li> <li>Confirm the API key has not been revoked</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/carbon-black/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API key may not have the required permissions</li> <li>Verify <code>org.alerts: READ</code> is granted on the Custom API key</li> <li>Check that the Org Key is correct</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/carbon-black/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Carbon Black Cloud rate limits vary by subscription tier</li> <li>Increase the Polling Interval to 15 minutes</li> <li>Conductor automatically implements exponential backoff</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/carbon-black/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Verify the Host URL matches your CBC instance region</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Confirm alerts exist in the CBC console</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-amp/","title":"Cisco AMP","text":"<p>Collects endpoint security events from Cisco AMP (Advanced Malware Protection) for Endpoints, providing visibility into malware detections, file convictions, and endpoint threat activity.</p> Category Endpoint Security Connector Name <code>signal-client.cisco-amp</code> Auth Method Client ID + API Key (Basic Auth) Polling Interval 5 min (events) Multi-Instance Yes Vendor Docs Cisco AMP API Documentation","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-amp/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Cisco Secure Endpoint (AMP for Endpoints) subscription. Admin access required to generate API credentials.</p> <ul> <li> Active Cisco Secure Endpoint subscription</li> <li> Admin role in the AMP Console</li> <li> Network: Conductor can reach your AMP API endpoint on port 443</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-amp/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li> <p>Log in to the AMP Console at <code>https://console.amp.cisco.com/</code></p> <p>Regional Endpoints</p> <p>North America: <code>api.amp.cisco.com</code> \u00b7 Europe: <code>api.eu.amp.cisco.com</code> \u00b7 Asia Pacific: <code>api.apjc.amp.cisco.com</code></p> </li> <li> <p>Navigate to Accounts \u2192 API Credentials</p> </li> <li>Click New API Credential</li> <li>Configure the credential:<ul> <li>Application Name: <code>WitFoo Conductor</code></li> <li>Scope: Read-only</li> </ul> </li> <li>Click Create</li> <li>Copy the Client ID (3rd Party API Client ID) and API Key</li> </ol> <p>Store Credentials Securely</p> <p>API credentials grant read access to your AMP data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-amp/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Cisco AMP</li> <li>Enter a unique name for this instance (e.g., \"Cisco AMP North America\")</li> <li> <p>Fill in the settings form:</p> Field Value Description FQDN <code>api.amp.cisco.com</code> API endpoint for your region Client ID <code>&lt;your-client-id&gt;</code> 3rd Party API Client ID Client Secret <code>&lt;your-api-key&gt;</code> API key from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-amp/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"cisco-amp\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] cisco-amp: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-amp/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-amp/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Client ID and API Key are correct</li> <li>Ensure the API credential has not been revoked in the AMP Console</li> <li>Check that the FQDN matches your AMP cloud region</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-amp/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API credential may have been created with insufficient scope</li> <li>Recreate with Read-only scope at minimum</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-amp/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Cisco AMP enforces per-minute API rate limits</li> <li>Increase the Polling Interval to 10 minutes if rate limiting occurs</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-amp/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://api.amp.cisco.com</code></li> <li>Confirm events exist in the AMP Console for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/cisco-duo/","title":"Cisco Duo","text":"<p>Collects authentication and security events from Cisco Duo, providing visibility into multi-factor authentication activity, enrollment status, and access policy enforcement.</p> Category Identity &amp; Access Connector Name <code>signal-client.cisco-duo</code> Auth Method Integration Key + Secret Key (HMAC-SHA1) Polling Interval 5 min (auth logs), 1 hr (admin logs) Multi-Instance Yes Vendor Docs Duo Admin API","tags":["integration","identity"]},{"location":"conductor/integrations/cisco-duo/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Cisco Duo subscription (any edition). Admin API application required \u2014 must be created by a Duo admin with Owner role.</p> <ul> <li> Active Cisco Duo account</li> <li> Duo admin with Owner role</li> <li> Network: Conductor can reach <code>api-&lt;hex&gt;.duosecurity.com</code> on port 443</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/cisco-duo/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Duo Admin Panel at <code>https://admin.duosecurity.com/</code></li> <li>Navigate to Applications \u2192 Protect an Application</li> <li>Search for Admin API and click Protect</li> <li>Configure the application:<ul> <li>Name: <code>WitFoo Conductor</code></li> <li>Permissions: Grant Read Log permission</li> </ul> </li> <li>Note the three credential values:<ul> <li>Integration Key (ikey)</li> <li>Secret Key (skey)</li> <li>API Hostname (e.g., <code>api-XXXXXXXX.duosecurity.com</code>)</li> </ul> </li> </ol> <p>Store Credentials Securely</p> <p>Duo API credentials grant access to your authentication log data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","identity"]},{"location":"conductor/integrations/cisco-duo/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Cisco Duo</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description FQDN <code>api-XXXXXXXX.duosecurity.com</code> API hostname from step 1 Integration Key (ikey) <code>&lt;your-ikey&gt;</code> Integration key from step 1 Secret Key (skey) <code>&lt;your-skey&gt;</code> Secret key from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes for auth logs)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","identity"]},{"location":"conductor/integrations/cisco-duo/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"cisco-duo\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] cisco-duo: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","identity"]},{"location":"conductor/integrations/cisco-duo/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","identity"]},{"location":"conductor/integrations/cisco-duo/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Integration Key and Secret Key are correct</li> <li>Ensure the Admin API application has not been deleted in the Duo Admin Panel</li> <li>Check that the FQDN matches your Duo API hostname</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/cisco-duo/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The Admin API application may lack Read Log permission</li> <li>Edit the application in the Duo Admin Panel to add the permission</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/cisco-duo/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Duo rate limits are per-integration and per-endpoint</li> <li>Increase the Polling Interval to 10 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/cisco-duo/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://api-XXXXXXXX.duosecurity.com</code></li> <li>Confirm authentication events exist in the Duo Admin Panel for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","identity"]},{"location":"conductor/integrations/cisco-meraki/","title":"Cisco Meraki","text":"<p>Collects network security events from Cisco Meraki cloud-managed networks, providing visibility into network threats, content filtering, and device connectivity.</p> Category Network Security Connector Name <code>signal-client.cisco-meraki</code> Auth Method API Key (X-Cisco-Meraki-API-Key) Polling Interval 5 min (events) Multi-Instance Yes Vendor Docs Meraki Dashboard API","tags":["integration","network"]},{"location":"conductor/integrations/cisco-meraki/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Cisco Meraki license. Organization-level API access must be enabled by a Meraki Dashboard administrator.</p> <ul> <li> Active Cisco Meraki subscription</li> <li> Organization admin access in the Meraki Dashboard</li> <li> API access enabled for the organization</li> <li> Network: Conductor can reach <code>api.meraki.com</code> on port 443</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-meraki/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Meraki Dashboard at <code>https://dashboard.meraki.com/</code></li> <li>Navigate to Organization \u2192 Settings</li> <li>Under Dashboard API access, enable the API</li> <li>Click your username (top-right) \u2192 My profile</li> <li>Scroll to API access and click Generate new API key</li> <li>Copy the API Key \u2014 it is only shown once</li> </ol> <p>Store Credentials Securely</p> <p>The Meraki API key grants organization-level access. Store it securely and do not share it in tickets or email.</p>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-meraki/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Cisco Meraki</li> <li>Enter a unique name for this instance (e.g., \"Meraki Production Org\")</li> <li> <p>Fill in the settings form:</p> Field Value Description FQDN <code>api.meraki.com</code> Meraki API endpoint Auth Token <code>&lt;your-api-key&gt;</code> API key from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-meraki/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"cisco-meraki\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] cisco-meraki: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-meraki/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","network"]},{"location":"conductor/integrations/cisco-meraki/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Key is correct and has not been revoked</li> <li>Ensure API access is still enabled at the organization level</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-meraki/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API key may not have access to the target organization</li> <li>Ensure you generated the key with an organization admin account</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-meraki/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Meraki enforces a limit of 10 API calls per second per organization</li> <li>Increase the Polling Interval if rate limiting occurs</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-meraki/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://api.meraki.com</code></li> <li>Confirm security events exist in the Meraki Dashboard for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-umbrella/","title":"Cisco Umbrella","text":"<p>Collects DNS security and web proxy events from Cisco Umbrella, providing visibility into DNS-layer threats, blocked domains, and web traffic activity.</p> Category Network Security Connector Name <code>signal-client.cisco-umbrella</code> Auth Method API Key + Secret (Basic Auth) Polling Interval 5 min (events) Multi-Instance Yes Vendor Docs Umbrella API Documentation","tags":["integration","network"]},{"location":"conductor/integrations/cisco-umbrella/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Cisco Umbrella subscription (DNS Security or Secure Internet Gateway). Admin access required to generate API keys.</p> <ul> <li> Active Cisco Umbrella subscription</li> <li> Full admin access in the Umbrella Dashboard</li> <li> Network: Conductor can reach <code>api.umbrella.com</code> on port 443</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-umbrella/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Umbrella Dashboard at <code>https://dashboard.umbrella.com/</code></li> <li>Navigate to Admin \u2192 API Keys</li> <li>Click Create API Key</li> <li>Select Umbrella Reporting scope</li> <li>Copy the Key and Secret</li> </ol> <p>Store Credentials Securely</p> <p>API credentials grant access to your Umbrella reporting data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-umbrella/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Cisco Umbrella</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description FQDN <code>api.umbrella.com</code> Umbrella API endpoint Key <code>&lt;your-api-key&gt;</code> API key from step 1 Secret <code>&lt;your-api-secret&gt;</code> API secret from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-umbrella/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"cisco-umbrella\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] cisco-umbrella: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-umbrella/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","network"]},{"location":"conductor/integrations/cisco-umbrella/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Key and Secret are correct</li> <li>Ensure the API key has not been revoked in the Umbrella Dashboard</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-umbrella/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API key may lack the Reporting scope</li> <li>Recreate with Umbrella Reporting scope</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-umbrella/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 10 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/cisco-umbrella/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://api.umbrella.com</code></li> <li>Confirm security events exist in the Umbrella Dashboard for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","network"]},{"location":"conductor/integrations/common-troubleshooting/","title":"Common Integration Troubleshooting","text":"<p>This guide covers issues common to all Signal Client pull-based integrations. For vendor-specific troubleshooting, see the individual integration guides.</p>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#connection-issues","title":"Connection Issues","text":"","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#cannot-reach-vendor-api","title":"Cannot Reach Vendor API","text":"<p>Conductor must have outbound HTTPS (port 443) access to the vendor's API endpoints. Verify connectivity from the Conductor host:</p> <pre><code># Test basic connectivity\ncurl -I https://&lt;vendor-api-endpoint&gt;\n\n# If behind a forward proxy\nexport HTTPS_PROXY=http://proxy:port\ncurl -I https://&lt;vendor-api-endpoint&gt;\n</code></pre> <p>If your environment uses a forward proxy, configure it in the Conductor node settings via <code>wfa configure</code>.</p>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#tls-certificate-errors","title":"TLS Certificate Errors","text":"<p>If the vendor API endpoint uses a certificate signed by a private CA:</p> <ol> <li>Copy the CA certificate to <code>/witfoo/certs/</code></li> <li>Run <code>sudo wfa configure</code> and update the CA certificate path</li> <li> <p>Restart Signal Client:</p> <pre><code>docker restart signal-client-svc\n</code></pre> </li> </ol>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#dns-resolution-failures","title":"DNS Resolution Failures","text":"<p>If Signal Client logs show DNS errors:</p> <ol> <li> <p>Verify the Conductor host can resolve the vendor hostname:</p> <pre><code>nslookup &lt;vendor-api-endpoint&gt;\n</code></pre> </li> <li> <p>Check <code>/etc/resolv.conf</code> for correct upstream DNS servers</p> </li> <li>If using internal DNS, ensure the vendor domain is not blocked</li> </ol>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#authentication-issues","title":"Authentication Issues","text":"","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#token-expired","title":"Token Expired","text":"<p>Most API tokens have expiration dates. If a previously working integration stops collecting data:</p> <ol> <li> <p>Check Signal Client logs for <code>401</code> errors:</p> <pre><code>docker logs signal-client-svc --tail=100 | grep \"401\"\n</code></pre> </li> <li> <p>Generate a new token in the vendor console</p> </li> <li>Update the credentials in the Conductor UI \u2192 Integrations</li> <li>Click Save \u2014 new credentials take effect within seconds via NATS KV    watch</li> </ol>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#oauth2-token-refresh-failures","title":"OAuth2 Token Refresh Failures","text":"<p>For OAuth2 integrations (Microsoft, CrowdStrike, Sophos, Wiz, etc.):</p> <ul> <li>Verify the Client ID and Client Secret are correct</li> <li>Check that the application/service principal has not been deleted</li> <li>Confirm required API scopes/permissions are still granted</li> <li>Some vendors require admin consent to be re-granted after scope changes</li> </ul>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#ip-allowlist","title":"IP Allowlist","text":"<p>Some vendors restrict API access by source IP address:</p> <ol> <li>Determine the Conductor host's public IP</li> <li>Add it to the vendor's API allowlist (often in Settings \u2192 API \u2192 IP    Restrictions)</li> <li>If Conductor uses a NAT gateway, add the NAT IP instead</li> </ol>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#rate-limiting","title":"Rate Limiting","text":"","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#http-429-too-many-requests","title":"HTTP 429 Too Many Requests","text":"<p>Signal Client implements automatic exponential backoff on 429 responses. If you see persistent rate limiting:</p> <ol> <li>Increase the polling interval \u2014 reduces the frequency of API calls</li> <li>Reduce concurrent integrations \u2014 if many integrations poll the same    vendor simultaneously</li> <li> <p>Check vendor rate limits \u2014 each vendor has different quotas:</p> Vendor Typical Rate Limit CrowdStrike 100 req/min Microsoft Graph 10,000 req/10min Okta 600 req/min Tenable 300-500 req/min SentinelOne 1000 req/min Qualys 300 req/hr </li> <li> <p>Contact the vendor to request a rate limit increase if needed</p> </li> </ol>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#data-issues","title":"Data Issues","text":"","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#no-artifacts-appearing","title":"No Artifacts Appearing","text":"<ol> <li>Verify the integration is Enabled in the Conductor UI</li> <li> <p>Check for errors in Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=100\n</code></pre> </li> <li> <p>Verify data exists in the vendor console for the polling time window</p> </li> <li> <p>Check the NATS JetStream stream:</p> <pre><code>docker exec broker-edge-svc nats stream info DATA\n</code></pre> </li> <li> <p>Confirm Artifact Exporter is running and connected to Analytics:</p> <pre><code>docker logs artifact-exporter-svc --tail=50\n</code></pre> </li> </ol>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#duplicate-artifacts","title":"Duplicate Artifacts","text":"<p>WitFoo's ProtoGraph deduplication in the Artifact Filter service automatically reduces duplicate events. If you see excessive duplicates:</p> <ol> <li>Reduce the polling interval to avoid overlapping time windows</li> <li>Check if multiple integration instances are configured for the same    vendor account</li> <li>Verify checkpoint tracking is working (Signal Client resumes from the    last successful position)</li> </ol>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#missing-events","title":"Missing Events","text":"<p>If some events appear but others are missing:</p> <ol> <li>Check the vendor's data retention settings \u2014 some APIs only return recent    data</li> <li>Verify the API credentials have permissions for all required data types</li> <li>Some integrations collect multiple data types on different schedules    (e.g., alerts every 5min, assets every 1hr)</li> </ol>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#performance","title":"Performance","text":"","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#high-memory-usage","title":"High Memory Usage","text":"<p>If Signal Client shows elevated memory usage:</p> <ul> <li>Reduce the number of concurrent polling integrations</li> <li>Increase polling intervals for less critical sources</li> <li>Check for vendors that return large batch responses (thousands of records   per page)</li> </ul>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#slow-polling","title":"Slow Polling","text":"<p>Common causes of slow poll cycles:</p> <ul> <li>Network latency to the vendor API endpoint</li> <li>Large data volumes \u2014 consider narrower time windows or more frequent   polling to keep batch sizes small</li> <li>Vendor API rate limiting \u2014 429 responses trigger backoff delays</li> <li>DNS resolution delays \u2014 verify DNS is fast from the Conductor host</li> </ul>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/common-troubleshooting/#diagnostic-commands","title":"Diagnostic Commands","text":"<p>Quick reference for troubleshooting from the Conductor host:</p> <pre><code># Signal Client logs (last 100 lines)\ndocker logs signal-client-svc --tail=100\n\n# Signal Client logs filtered by integration\ndocker logs signal-client-svc --tail=200 | grep \"&lt;connector-name&gt;\"\n\n# Check container health\ndocker inspect --format='{{.State.Health.Status}}' signal-client-svc\n\n# NATS stream statistics\ndocker exec broker-edge-svc nats stream info DATA\n\n# Test outbound connectivity to a vendor\ncurl -sI -o /dev/null -w \"%{http_code}\" https://&lt;vendor-api-endpoint&gt;\n\n# Check container resource usage\ndocker stats signal-client-svc --no-stream\n</code></pre> <p>See also: Integration Catalog \u00b7 Signal Client \u00b7 General Conductor Troubleshooting</p>","tags":["integration","troubleshooting"]},{"location":"conductor/integrations/crowdstrike-falcon/","title":"CrowdStrike Falcon","text":"<p>Collects endpoint detection and device inventory data from CrowdStrike Falcon, providing visibility into endpoint threats, detections, and managed host assets.</p> Category Endpoint Security Connector Name <code>signal-client.crowdstrike-falcon</code> Auth Method OAuth2 Client Credentials Polling Interval 10 min (detections), 1 hr (devices) Multi-Instance Yes Vendor Docs CrowdStrike API Reference","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active CrowdStrike Falcon subscription with API access enabled. Falcon Administrator role required to create API clients.</p> <ul> <li> Active CrowdStrike Falcon subscription</li> <li> Falcon Administrator role in the CrowdStrike console</li> <li> Network: Conductor can reach your CrowdStrike API endpoint on port 443</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li> <p>Log in to the Falcon Console at <code>https://falcon.crowdstrike.com/</code></p> <p>Cloud-Specific URLs</p> <p>Your API base URL depends on your CrowdStrike cloud environment:</p> Cloud Console URL API Base URL US-1 <code>falcon.crowdstrike.com</code> <code>api.crowdstrike.com</code> US-2 <code>falcon.us-2.crowdstrike.com</code> <code>api.us-2.crowdstrike.com</code> EU-1 <code>falcon.eu-1.crowdstrike.com</code> <code>api.eu-1.crowdstrike.com</code> US-GOV-1 <code>falcon.laggar.gcw.crowdstrike.com</code> <code>api.laggar.gcw.crowdstrike.com</code> </li> <li> <p>Navigate to Support and resources \u2192 API Clients and Keys</p> </li> <li>Click Add new API Client</li> <li>Configure the API client:<ul> <li>Client Name: <code>WitFoo Conductor</code></li> <li>Description: <code>Read-only access for security log collection</code></li> <li>Scopes:<ul> <li><code>Detections</code> \u2192 Read</li> <li><code>Hosts</code> \u2192 Read</li> </ul> </li> </ul> </li> <li>Click Create</li> <li>Copy the Client ID and Client Secret \u2014 the secret is only shown once</li> </ol> <p>Store Credentials Securely</p> <p>The Client Secret is displayed only at creation time. Store it securely and do not share it in tickets or email.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select CrowdStrike Falcon</li> <li>Enter a unique name for this instance (e.g., \"CrowdStrike US-2 Production\")</li> <li> <p>Fill in the settings form:</p> Field Value Description FQDN <code>api.crowdstrike.com</code> API base URL for your cloud (see table above) Client ID <code>&lt;your-client-id&gt;</code> From step 1 Client Secret <code>&lt;your-client-secret&gt;</code> From step 1 </li> <li> <p>Set the Polling Interval (recommended: 10 minutes for detections)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"crowdstrike\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] crowdstrike-falcon: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 10-minute interval, expect data within 10 minutes.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#data-collection-details","title":"Data Collection Details","text":"<p>The CrowdStrike connector collects data from multiple API endpoints on different schedules:</p> Endpoint Interval Description Detection IDs + Details 10 min Active detections (alerts). Batches at 1,000-item boundary. Device Details (v2) 1 hr Managed host inventory via <code>getDeviceDetailsV2</code>. String offset pagination. Combined Device/Host 1 hr Supplemental host data from combined endpoint. <p>Alert Batching</p> <p>The connector fetches detection IDs first, then batches detail requests in groups of 1,000. Large environments may see multiple batch cycles per polling interval.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#govcloud-configuration","title":"GovCloud Configuration","text":"<p>For US Government cloud deployments, use the GovCloud-specific URLs:</p> Setting Value FQDN <code>api.laggar.gcw.crowdstrike.com</code> Console <code>falcon.laggar.gcw.crowdstrike.com</code> <p>All other settings remain the same. GovCloud environments enforce FedRAMP-compliant authentication.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Client ID and Client Secret are correct</li> <li>Ensure the API client has not been revoked in the Falcon Console</li> <li>Check that the FQDN matches your CrowdStrike cloud (US-1, US-2, EU-1, US-GOV-1)</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API client may lack the required scopes</li> <li>Required scopes: <code>Detections: Read</code>, <code>Hosts: Read</code></li> <li>Edit the API client in the Falcon Console to add missing scopes</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>CrowdStrike rate limits are per-customer and shown in response headers   (<code>X-RateLimit-Limit</code>, <code>X-RateLimit-Remaining</code>)</li> <li>Increase the Polling Interval to 15 minutes if rate limiting occurs frequently</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/crowdstrike-falcon/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://api.crowdstrike.com</code></li> <li>Confirm detections or device data exists in the Falcon Console for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/cyberark-epm/","title":"CyberArk EPM","text":"<p>Collects endpoint privilege management events from CyberArk Endpoint Privilege Manager, including privilege elevation events, policy audit data, and application control actions.</p> Category Identity &amp; Access Connector Name <code>signal-client.cyberark-epm</code> Auth Method Username / Password \u2192 Session Token Polling Interval 10 min (events), 30 min (policy audit) Multi-Instance Yes Vendor Docs CyberArk EPM REST API","tags":["integration","identity"]},{"location":"conductor/integrations/cyberark-epm/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active CyberArk EPM SaaS subscription. Admin account with API access.</p> <ul> <li> Active CyberArk EPM subscription</li> <li> Admin account credentials</li> <li> Set ID (EPM set identifier)</li> <li> Network: Conductor can reach <code>&lt;tenant&gt;.epm.cyberark.com</code> on port 443</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/cyberark-epm/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the CyberArk EPM Console at    <code>https://&lt;tenant&gt;.epm.cyberark.com/</code></li> <li>Navigate to Administration \u2192 Account Management</li> <li>Create a new user (or use an existing admin account)</li> <li>Assign the user the Admin or Auditor role</li> <li>Record the username and password</li> <li>Note the Set ID from the EPM console (visible in the URL or under    Sets management)</li> </ol> <p>Dedicated Service Account</p> <p>Create a dedicated service account for the integration to avoid disruption if an admin changes their personal password.</p>","tags":["integration","identity"]},{"location":"conductor/integrations/cyberark-epm/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select CyberArk EPM</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>&lt;tenant&gt;.epm.cyberark.com</code> EPM console URL Username <code>&lt;your-username&gt;</code> API user from step 1 Password <code>&lt;your-password&gt;</code> API user password Set ID <code>&lt;your-set-id&gt;</code> EPM set identifier </li> <li> <p>Set the Polling Interval (recommended: 10 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","identity"]},{"location":"conductor/integrations/cyberark-epm/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"cyberark\"\n</code></pre> <p>Look for successful authentication messages: <pre><code>[INFO] cyberark-epm: authenticated, fetching events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","identity"]},{"location":"conductor/integrations/cyberark-epm/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","identity"]},{"location":"conductor/integrations/cyberark-epm/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Username and Password are correct</li> <li>CyberArk EPM session tokens expire after approximately 20 minutes;   Conductor handles automatic re-authentication</li> <li>If the password was recently changed, update it in the Conductor UI</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/cyberark-epm/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The user may not have sufficient role permissions</li> <li>Verify the user has Admin or Auditor role in EPM</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/cyberark-epm/#token-expiry-issues","title":"Token Expiry Issues","text":"<ul> <li>CyberArk EPM uses short-lived session tokens (~20 minutes)</li> <li>Conductor automatically re-authenticates when tokens expire</li> <li>If repeated authentication failures occur, check the account lockout   policy in CyberArk</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/cyberark-epm/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Verify the Set ID is correct</li> <li>Check the Host URL matches your EPM tenant</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify events exist in the EPM console</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","identity"]},{"location":"conductor/integrations/darktrace/","title":"Darktrace","text":"<p>Collects threat detection data from Darktrace, including model breaches, AI Analyst incidents, and network anomaly detections from Darktrace's self-learning AI platform.</p> Category Network Security Connector Name <code>signal-client.darktrace</code> Auth Method HMAC Token (Public + Private) Polling Interval 5 min Multi-Instance Yes Vendor Docs Darktrace API Documentation","tags":["integration","network"]},{"location":"conductor/integrations/darktrace/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Darktrace deployment. Admin access to the Darktrace Threat Visualizer to create API tokens.</p> <ul> <li> Active Darktrace appliance</li> <li> Admin access to Darktrace Threat Visualizer</li> <li> Network: Conductor can reach the Darktrace appliance on port 443</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/darktrace/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Darktrace Threat Visualizer at    <code>https://&lt;appliance-address&gt;/</code></li> <li>Navigate to System Config \u2192 API Tokens</li> <li>Click Create Token</li> <li>Copy the Public Token and Private Token</li> </ol> <p>Token Storage</p> <p>The private token is only shown once at creation time. Store it securely.</p>","tags":["integration","network"]},{"location":"conductor/integrations/darktrace/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Darktrace</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>&lt;appliance-address&gt;</code> Darktrace appliance URL or IP Public Token <code>&lt;your-public-token&gt;</code> Public API token from step 1 Private Token <code>&lt;your-private-token&gt;</code> Private API token from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol> <p>HMAC Authentication</p> <p>Darktrace uses HMAC-SHA1 request signing for API authentication. Conductor handles the signing automatically using the public and private tokens \u2014 no additional configuration needed.</p>","tags":["integration","network"]},{"location":"conductor/integrations/darktrace/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"darktrace\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] darktrace: fetched &lt;N&gt; model breaches\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","network"]},{"location":"conductor/integrations/darktrace/#detection-types-collected","title":"Detection Types Collected","text":"Type Description Model Breaches Rule-based anomaly detections AI Analyst Incidents AI-correlated security narratives","tags":["integration","network"]},{"location":"conductor/integrations/darktrace/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","network"]},{"location":"conductor/integrations/darktrace/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Public Token and Private Token are correct</li> <li>Ensure the API token has not been revoked in Darktrace</li> <li>Clock skew between Conductor and Darktrace can cause HMAC signature   failures \u2014 ensure both systems use NTP</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/darktrace/#network-connectivity","title":"Network Connectivity","text":"<ul> <li>The Darktrace appliance must be reachable from the Conductor host on   port 443</li> <li>If using a self-signed TLS certificate on the appliance, see   Common Troubleshooting</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/darktrace/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API token may have restricted access scope</li> <li>Create a new token with broader permissions</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/darktrace/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Verify model breaches exist in the Darktrace Threat Visualizer</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Confirm the appliance address is correct and reachable</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","network"]},{"location":"conductor/integrations/deep-instinct/","title":"Deep Instinct","text":"<p>Collects threat event data from Deep Instinct's deep learning-based endpoint protection platform, providing visibility into malware prevention, detection events, and device inventory.</p> Category Endpoint Security Connector Name <code>signal-client.deep-instinct</code> Auth Method API Key (Bearer Token) Polling Interval 5 min (events) Multi-Instance Yes Vendor Docs Deep Instinct API Documentation","tags":["integration","endpoint"]},{"location":"conductor/integrations/deep-instinct/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Deep Instinct subscription with API access. Admin role required to generate API keys.</p> <ul> <li> Active Deep Instinct D-Appliance or D-Cloud subscription</li> <li> Administrator access to the Deep Instinct Management Console</li> <li> Network: Conductor can reach your Deep Instinct management server on port 443</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/deep-instinct/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Deep Instinct Management Console at <code>https://&lt;your-instance&gt;.deepinstinctweb.com/</code></li> <li>Navigate to Settings \u2192 API Keys</li> <li>Click Generate New API Key</li> <li>Configure the key:<ul> <li>Name: <code>WitFoo Conductor</code></li> <li>Permissions: Read-only</li> </ul> </li> <li>Copy the generated API Key</li> </ol> <p>Store Credentials Securely</p> <p>API keys grant access to your Deep Instinct data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/deep-instinct/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Deep Instinct</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>&lt;your-instance&gt;.deepinstinctweb.com</code> Management server URL API Key <code>&lt;your-api-key&gt;</code> API key from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","endpoint"]},{"location":"conductor/integrations/deep-instinct/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"deep-instinct\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] deep-instinct: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/deep-instinct/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","endpoint"]},{"location":"conductor/integrations/deep-instinct/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Key is correct and has not been revoked</li> <li>Ensure the key has not expired in the Deep Instinct Console</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/deep-instinct/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API key may lack read permissions</li> <li>Generate a new key with appropriate permissions</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/deep-instinct/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 10 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/deep-instinct/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://&lt;your-instance&gt;.deepinstinctweb.com</code></li> <li>Confirm events exist in the Deep Instinct console for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/dns-zone-transfer/","title":"DNS Zone Transfer","text":"<p>Collects DNS zone records via AXFR (Authoritative Zone Transfer), providing visibility into DNS infrastructure, record changes, and domain inventory.</p> Category Infrastructure Connector Name <code>signal-client.dns-zone-transfer</code> Auth Method None (AXFR protocol) Polling Interval 60 min (zone transfers) Multi-Instance Yes Vendor Docs RFC 5936 \u2014 DNS Zone Transfer Protocol","tags":["integration","infrastructure"]},{"location":"conductor/integrations/dns-zone-transfer/#prerequisites","title":"Prerequisites","text":"<p>Requirements</p> <p>Your DNS server must allow AXFR zone transfers from the Conductor host's IP address. This is a server configuration, not a vendor subscription.</p> <ul> <li> DNS server(s) configured to allow AXFR transfers</li> <li> Conductor host IP address allowlisted for zone transfers</li> <li> Network: Conductor can reach DNS server(s) on port 53 (TCP)</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/dns-zone-transfer/#step-1-configure-dns-server-for-axfr","title":"Step 1: Configure DNS Server for AXFR","text":"<p>Zone transfer configuration varies by DNS server software. Ensure the Conductor host is authorized.</p> BINDWindows DNSInfoblox <p>In <code>named.conf</code>, add the Conductor IP to <code>allow-transfer</code>: <pre><code>zone \"example.com\" {\n    type master;\n    file \"/etc/bind/zones/example.com.zone\";\n    allow-transfer { &lt;conductor-ip&gt;; };\n};\n</code></pre></p> <ol> <li>Open DNS Manager</li> <li>Right-click the zone \u2192 Properties \u2192 Zone Transfers tab</li> <li>Select Allow zone transfers \u2192 Only to the following servers</li> <li>Add the Conductor host IP address</li> </ol> <ol> <li>Navigate to Data Management \u2192 DNS \u2192 Zones</li> <li>Edit the zone \u2192 Zone Transfers tab</li> <li>Add the Conductor host IP to the Allow Transfer list</li> </ol>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/dns-zone-transfer/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select DNS Zone Transfer</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description DNS Server IP <code>10.0.1.53</code> Primary DNS server address Forward Lookup Zones <code>example.com,internal.local</code> Comma-separated zone names </li> <li> <p>Set the Polling Interval (recommended: 60 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/dns-zone-transfer/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator after the first transfer</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"dns-zone-transfer\"\n</code></pre> <p>Look for successful transfer messages: <pre><code>[INFO] dns-zone-transfer: fetched &lt;N&gt; records\n</code></pre></p> </li> <li> <p>Test manually \u2014 Verify AXFR works from the Conductor host:</p> <pre><code>dig @10.0.1.53 example.com AXFR\n</code></pre> </li> </ol> <p>First Poll Timing</p> <p>The first zone transfer occurs within the configured polling interval after saving. For a 60-minute interval, expect data within 1 hour.</p>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/dns-zone-transfer/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","infrastructure"]},{"location":"conductor/integrations/dns-zone-transfer/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>DNS zone transfers do not use authentication \u2014 this error is not applicable</li> <li>If access is denied, see Forbidden below</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/dns-zone-transfer/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The DNS server is refusing the zone transfer</li> <li>Verify the Conductor host IP is in the server's <code>allow-transfer</code> list</li> <li>Check DNS server logs for transfer denied messages</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/dns-zone-transfer/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>DNS zone transfers are not rate limited in the traditional sense</li> <li>However, very frequent transfers may impact DNS server performance</li> <li>Keep the polling interval at 60 minutes or longer</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/dns-zone-transfer/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity on TCP port 53 to the DNS server</li> <li>Test manually: <code>dig @&lt;dns-server&gt; &lt;zone&gt; AXFR</code></li> <li>Ensure the zone names are spelled correctly</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/druva/","title":"Druva","text":"<p>Collects backup and data protection events from Druva inSync, providing visibility into data protection status, anomalous activity, and backup compliance across endpoints and cloud workloads.</p> Category Infrastructure Connector Name <code>signal-client.druva</code> Auth Method OAuth2 Client Credentials Polling Interval 15 min (events) Multi-Instance Yes Vendor Docs Druva API Documentation","tags":["integration","infrastructure"]},{"location":"conductor/integrations/druva/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Druva subscription (inSync or Phoenix). Admin access required to create API credentials.</p> <ul> <li> Active Druva subscription</li> <li> Admin access in the Druva Cloud Platform Console</li> <li> Network: Conductor can reach <code>apis.druva.com</code> on port 443</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/druva/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Druva Cloud Platform Console at <code>https://login.druva.com/</code></li> <li>Navigate to Druva Cloud Settings \u2192 API Credentials</li> <li>Click Create Credentials</li> <li>Configure the credential:<ul> <li>Name: <code>WitFoo Conductor</code></li> <li>Scope: Read-only</li> </ul> </li> <li>Copy the Client ID and Client Secret</li> </ol> <p>Store Credentials Securely</p> <p>API credentials grant access to your Druva data protection events. Store them securely and do not share them in tickets or email.</p>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/druva/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Druva</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description FQDN <code>apis.druva.com</code> Druva API endpoint Client ID <code>&lt;your-client-id&gt;</code> Client ID from step 1 Client Secret <code>&lt;your-client-secret&gt;</code> Client secret from step 1 </li> <li> <p>Set the Polling Interval (recommended: 15 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/druva/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"druva\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] druva: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 15-minute interval, expect data within 15 minutes.</p>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/druva/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","infrastructure"]},{"location":"conductor/integrations/druva/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Client ID and Client Secret are correct</li> <li>Ensure the credentials have not been revoked in the Druva console</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/druva/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API credential may lack required permissions</li> <li>Recreate with appropriate read scope</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/druva/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 30 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/druva/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://apis.druva.com</code></li> <li>Confirm events exist in the Druva console for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/fortianalyzer/","title":"Fortinet FortiAnalyzer","text":"<p>Collects log and event data from Fortinet FortiAnalyzer, the centralized logging and analytics platform for Fortinet security fabric devices.</p> Category Network Security Connector Name <code>signal-client.fortianalyzer</code> Auth Method Session Token (JSON-RPC) Polling Interval 5 min Multi-Instance Yes Vendor Docs FortiAnalyzer REST API","tags":["integration","network"]},{"location":"conductor/integrations/fortianalyzer/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active FortiAnalyzer deployment (physical or virtual appliance). Admin access to create API administrator accounts.</p> <ul> <li> Active FortiAnalyzer instance (v7.0+)</li> <li> Admin access to the FortiAnalyzer web UI</li> <li> ADOM (Administrative Domain) name</li> <li> Network: Conductor can reach the FortiAnalyzer IP on port 443</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/fortianalyzer/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the FortiAnalyzer web UI at <code>https://&lt;fortianalyzer-ip&gt;/</code></li> <li>Navigate to System Settings \u2192 Admin \u2192 Administrators</li> <li>Click Create New</li> <li>Set the Admin Profile to <code>Standard_User</code> or a custom read-only profile</li> <li>Configure the following:<ul> <li>Username and password</li> <li>Enable JSON API Access (set to Read-Only)</li> <li>Restrict Trusted Hosts to the Conductor IP if desired</li> </ul> </li> <li>Click OK to save</li> </ol> <p>ADOM Concept</p> <p>FortiAnalyzer uses Administrative Domains (ADOMs) to organize logs by customer or network segment. Use <code>root</code> for the default domain, or specify the ADOM that contains the logs you want to collect.</p>","tags":["integration","network"]},{"location":"conductor/integrations/fortianalyzer/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select FortiAnalyzer</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>&lt;fortianalyzer-ip&gt;</code> FortiAnalyzer IP or hostname Username <code>&lt;your-username&gt;</code> API admin from step 1 Password <code>&lt;your-password&gt;</code> API admin password ADOM <code>root</code> Administrative Domain (default: <code>root</code>) </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","network"]},{"location":"conductor/integrations/fortianalyzer/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"fortianalyzer\"\n</code></pre> <p>Look for successful session messages: <pre><code>[INFO] fortianalyzer: session established, fetching logs\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","network"]},{"location":"conductor/integrations/fortianalyzer/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","network"]},{"location":"conductor/integrations/fortianalyzer/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Username and Password are correct</li> <li>Ensure JSON API Access is enabled for the admin account</li> <li>Check that the admin account is not locked</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/fortianalyzer/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The admin profile may not have read access to the specified ADOM</li> <li>Verify the admin has access to the target ADOM in FortiAnalyzer</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/fortianalyzer/#session-timeout","title":"Session Timeout","text":"<ul> <li>FortiAnalyzer sessions have configurable idle timeouts</li> <li>Conductor handles automatic re-authentication when sessions expire</li> <li>If persistent failures occur, check admin session settings in FortiAnalyzer</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/fortianalyzer/#wrong-adom","title":"Wrong ADOM","text":"<ul> <li>If data appears from the wrong devices, verify the ADOM field</li> <li>Use <code>root</code> for the default domain</li> <li>List available ADOMs in FortiAnalyzer under System Settings \u2192 All ADOMs</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/fortianalyzer/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check the FortiAnalyzer has devices forwarding logs to it</li> <li>Verify network connectivity: <code>curl -k https://&lt;fortianalyzer-ip&gt;/jsonrpc</code></li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","network"]},{"location":"conductor/integrations/gcp-scc/","title":"Google Cloud Security Command Center","text":"<p>Collects security findings from Google Cloud Security Command Center (SCC), Google's centralized security and risk management platform for GCP resources.</p> Category Cloud Security Connector Name <code>signal-client.gcp-scc</code> Auth Method Service Account JSON Key Polling Interval 5 min Multi-Instance Yes Vendor Docs SCC API Documentation","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Google Cloud organization with Security Command Center enabled (Standard or Premium tier). Organization-level access required.</p> <ul> <li> Active Google Cloud organization (not just a project)</li> <li> SCC Standard or Premium tier enabled</li> <li> IAM access to create service accounts</li> <li> Network: Conductor can reach <code>securitycenter.googleapis.com</code> on port 443</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Sign in to the Google Cloud Console at <code>https://console.cloud.google.com/</code></li> <li>Select the project where you want to create the service account</li> <li>Navigate to IAM &amp; Admin \u2192 Service Accounts</li> <li>Click Create Service Account</li> <li>Name the account (e.g., <code>witfoo-scc-reader</code>)</li> <li>Click Create and Continue</li> <li>Grant the role Security Center Findings Viewer    (<code>roles/securitycenter.findingsViewer</code>)</li> <li>Click Done</li> <li>Select the new service account \u2192 Keys tab \u2192 Add Key \u2192    Create New Key \u2192 JSON</li> <li>Download the JSON key file</li> </ol> <p>Organization-Level Access</p> <p>SCC operates at the organization level, not the project level. The service account must have the Findings Viewer role granted at the organization level in IAM.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#grant-organization-level-access","title":"Grant Organization-Level Access","text":"<ol> <li>Navigate to IAM &amp; Admin \u2192 IAM at the organization level</li> <li>Click Grant Access</li> <li>Enter the service account email</li> <li>Assign role: Security Center Findings Viewer</li> <li>Click Save</li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Google Cloud SCC</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Organization ID <code>&lt;your-org-id&gt;</code> GCP organization numeric ID API Key (paste full JSON key) Service account JSON key content </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol> <p>Finding Your Organization ID</p> <p>Navigate to Cloud Identity \u2192 Account \u2192 Account Settings or run: <code>gcloud organizations list</code></p>","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"gcp-scc\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] gcp-scc: fetched &lt;N&gt; findings\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#verify-credentials-locally","title":"Verify Credentials Locally","text":"<pre><code># Test the service account key (optional, from any machine with gcloud)\ngcloud auth activate-service-account --key-file=&lt;key-file&gt;.json\ngcloud scc findings list &lt;organization-id&gt; --source=\"-\" --limit=5\n</code></pre>","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the JSON key content was pasted correctly (including all fields)</li> <li>Ensure the service account has not been deleted or disabled</li> <li>Regenerate the key if needed</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The service account likely lacks organization-level IAM binding</li> <li>Grant Security Center Findings Viewer at the organization level,   not the project level</li> <li>Verify: <code>gcloud organizations get-iam-policy &lt;org-id&gt;</code></li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#scc-tier-limitations","title":"SCC Tier Limitations","text":"<ul> <li>Standard tier provides limited finding types (Security Health Analytics)</li> <li>Premium tier adds Event Threat Detection, Container Threat Detection, etc.</li> <li>Check your SCC tier under Security \u2192 Security Command Center \u2192   Settings</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/gcp-scc/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm SCC is enabled at the organization level</li> <li>Enable security sources (Security Health Analytics, Event Threat Detection)</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://securitycenter.googleapis.com</code></li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/halcyon/","title":"Halcyon","text":"<p>Collects anti-ransomware event data from Halcyon.ai, including ransomware detections, endpoint protection events, and device inventory.</p> Category Endpoint Security Connector Name <code>signal-client.halcyon</code> Auth Method Username / Password \u2192 JWT Polling Interval 10 min (events), 1 hr (devices) Multi-Instance Yes Vendor Docs Halcyon Documentation","tags":["integration","endpoint"]},{"location":"conductor/integrations/halcyon/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Halcyon.ai subscription. Admin account credentials with API access.</p> <ul> <li> Active Halcyon.ai subscription</li> <li> Admin account credentials</li> <li> Tenant ID from Halcyon portal</li> <li> Network: Conductor can reach <code>app.halcyon.ai</code> on port 443</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/halcyon/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<p>Halcyon uses admin login credentials for API access (no separate API key):</p> <ol> <li>Log in to the Halcyon Console at <code>https://app.halcyon.ai/</code></li> <li>Confirm your admin username (email) and password</li> <li>Navigate to Settings \u2192 Account to find your Tenant ID</li> </ol> <p>Dedicated API User</p> <p>Consider creating a dedicated service account for the Conductor integration rather than using a personal admin account. This avoids disruption if the admin changes their password.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/halcyon/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Halcyon</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>app.halcyon.ai</code> Halcyon API endpoint Username <code>&lt;your-email&gt;</code> Admin account email Password <code>&lt;your-password&gt;</code> Admin account password Tenant ID <code>&lt;your-tenant-id&gt;</code> From Halcyon account settings </li> <li> <p>Set the Polling Interval (recommended: 10 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","endpoint"]},{"location":"conductor/integrations/halcyon/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"halcyon\"\n</code></pre> <p>Look for successful authentication and poll messages: <pre><code>[INFO] halcyon: authenticated, fetching events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","endpoint"]},{"location":"conductor/integrations/halcyon/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","endpoint"]},{"location":"conductor/integrations/halcyon/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Username and Password are correct</li> <li>Ensure the account has not been locked or disabled</li> <li>Check if multi-factor authentication is blocking API access</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/halcyon/#jwt-refresh-failures","title":"JWT Refresh Failures","text":"<ul> <li>Halcyon uses short-lived JWT tokens obtained via username/password   authentication</li> <li>If the refresh fails, the password may have been changed</li> <li>Update the password in the Conductor UI and save</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/halcyon/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The account may not have admin-level access</li> <li>Verify the account role in the Halcyon console</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/halcyon/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Verify the Tenant ID is correct</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Confirm ransomware events exist in the Halcyon console</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/limacharlie/","title":"LimaCharlie","text":"<p>Collects endpoint detection and telemetry events from LimaCharlie, providing visibility into endpoint activity, detections, and sensor health across your LimaCharlie organization.</p> Category Infrastructure Connector Name <code>signal-client.limacharlie</code> Auth Method API Key (Bearer) + Organization ID Polling Interval 5 min (events) Multi-Instance Yes Vendor Docs LimaCharlie API Documentation","tags":["integration","infrastructure"]},{"location":"conductor/integrations/limacharlie/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active LimaCharlie organization. Admin access required to generate API keys.</p> <ul> <li> Active LimaCharlie organization</li> <li> Admin access in the LimaCharlie web console</li> <li> Network: Conductor can reach <code>api.limacharlie.io</code> on port 443</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/limacharlie/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the LimaCharlie Console at <code>https://app.limacharlie.io/</code></li> <li>Select your organization</li> <li>Navigate to Access Management \u2192 REST API</li> <li>Click Create API Key</li> <li>Configure the key:<ul> <li>Name: <code>WitFoo Conductor</code></li> <li>Permissions: Read access to detections and telemetry</li> </ul> </li> <li>Copy the API Key</li> <li>Note your Organization ID from the organization settings page</li> </ol> <p>Store Credentials Securely</p> <p>API keys grant access to your LimaCharlie telemetry data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/limacharlie/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select LimaCharlie</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>api.limacharlie.io</code> LimaCharlie API endpoint Organization ID <code>&lt;your-org-id&gt;</code> Organization ID from step 1 API Key <code>&lt;your-api-key&gt;</code> API key from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/limacharlie/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"limacharlie\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] limacharlie: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/limacharlie/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","infrastructure"]},{"location":"conductor/integrations/limacharlie/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Key is correct and has not been revoked</li> <li>Ensure the Organization ID matches the key's organization</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/limacharlie/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API key may lack required permissions</li> <li>Ensure the key has read access to detections</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/limacharlie/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 10 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/limacharlie/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://api.limacharlie.io</code></li> <li>Confirm events exist in the LimaCharlie console for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/mimecast/","title":"Mimecast","text":"<p>Collects email security events from Mimecast, providing visibility into email threat detections, URL clicks, attachment analysis, and audit events.</p> Category Email Security Connector Name <code>signal-client.mimecast</code> Auth Method OAuth2 Client Credentials Polling Interval 5 min (events) Multi-Instance Yes Vendor Docs Mimecast API Documentation","tags":["integration","email"]},{"location":"conductor/integrations/mimecast/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Mimecast subscription with API access. Administrator role required to create API applications.</p> <ul> <li> Active Mimecast subscription</li> <li> Mimecast Administrator account</li> <li> Network: Conductor can reach your regional Mimecast API server on port 443</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/mimecast/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Mimecast Administration Console at <code>https://login.mimecast.com/</code></li> <li>Navigate to Administration \u2192 Services \u2192 API and Platform Integrations</li> <li>Click Add API Application</li> <li>Configure the application:<ul> <li>Application Name: <code>WitFoo Conductor</code></li> <li>Category: SIEM Integration</li> <li>Permissions: Enable log access</li> </ul> </li> <li>Note the Application ID and generate a Client ID and Client Secret</li> <li>Note your API Server (regional endpoint, e.g., <code>us-api.mimecast.com</code>, <code>eu-api.mimecast.com</code>)</li> </ol> <p>Store Credentials Securely</p> <p>API credentials grant access to your Mimecast log data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","email"]},{"location":"conductor/integrations/mimecast/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Mimecast</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description API Server <code>us-api.mimecast.com</code> Regional API endpoint Client ID <code>&lt;your-client-id&gt;</code> OAuth2 client ID from step 1 Client Secret <code>&lt;your-client-secret&gt;</code> OAuth2 client secret from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","email"]},{"location":"conductor/integrations/mimecast/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"mimecast\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] mimecast: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","email"]},{"location":"conductor/integrations/mimecast/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","email"]},{"location":"conductor/integrations/mimecast/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Client ID and Client Secret are correct</li> <li>Ensure the API application is still active in the Mimecast console</li> <li>Check that the API Server matches your Mimecast region</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/mimecast/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API application may lack required permissions</li> <li>Ensure the application has log access permissions</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/mimecast/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Mimecast enforces per-application rate limits</li> <li>Increase the Polling Interval to 10 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/mimecast/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity to your Mimecast API server</li> <li>Confirm email security events exist in the Mimecast console for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","email"]},{"location":"conductor/integrations/netskope/","title":"Netskope","text":"<p>Collects cloud security event data from Netskope, including DLP alerts, cloud application events, web transaction logs, and audit events from Netskope's Security Service Edge (SSE) platform.</p> Category Infrastructure Connector Name <code>signal-client.netskope</code> Auth Method API Token (v1 or v2) Polling Interval 5 min Multi-Instance Yes Vendor Docs Netskope REST API","tags":["integration","infrastructure"]},{"location":"conductor/integrations/netskope/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Netskope subscription. Admin access to create API tokens. Netskope API v1 or v2 access enabled.</p> <ul> <li> Active Netskope subscription</li> <li> Admin access to the Netskope tenant</li> <li> Network: Conductor can reach <code>&lt;tenant&gt;.goskope.com</code> on port 443</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/netskope/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<p>Netskope supports both v1 and v2 API tokens. v2 tokens are recommended as they support scoped permissions.</p> API v2 (Recommended)API v1 (Legacy) <ol> <li>Log in to the Netskope Admin Console at    <code>https://&lt;tenant&gt;.goskope.com/</code></li> <li>Navigate to Settings \u2192 Tools \u2192 REST API v2</li> <li>Click New Token</li> <li>Name the token (e.g., \"WitFoo Conductor\")</li> <li>Select required scopes:<ul> <li><code>/api/v2/events/data/alert</code> (alerts)</li> <li><code>/api/v2/events/data/page</code> (web transactions)</li> <li><code>/api/v2/events/data/application</code> (app events)</li> <li><code>/api/v2/events/data/audit</code> (audit logs)</li> </ul> </li> <li>Set token expiry (maximum recommended)</li> <li>Click Save</li> <li>Copy the Token</li> </ol> <ol> <li>Log in to the Netskope Admin Console</li> <li>Navigate to Settings \u2192 Tools \u2192 REST API v1</li> <li>Copy the existing Token or generate a new one</li> <li>Note: v1 tokens have global scope (no per-endpoint scoping)</li> </ol>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/netskope/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Netskope</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Base URL <code>&lt;tenant&gt;.goskope.com</code> Netskope tenant URL API Token <code>&lt;your-token&gt;</code> v1 or v2 API token from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/netskope/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"netskope\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] netskope: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/netskope/#event-types-collected","title":"Event Types Collected","text":"Type Description Alerts DLP violations, malware detections, anomaly alerts Page Events Web transaction data Application Events Cloud app activity Audit Events Admin actions and configuration changes","tags":["integration","infrastructure"]},{"location":"conductor/integrations/netskope/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","infrastructure"]},{"location":"conductor/integrations/netskope/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Token is correct</li> <li>For v2 tokens, ensure the token has not expired</li> <li>For v1 tokens, confirm the token is still active in Settings \u2192 REST API v1</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/netskope/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>For v2 tokens, the token may lack required scopes</li> <li>Add the needed event type scopes to the token in Netskope admin</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/netskope/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Netskope rate limits vary by license tier</li> <li>Increase the Polling Interval to 15 minutes</li> <li>Conductor automatically implements exponential backoff</li> </ul>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/netskope/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Verify the Base URL includes your tenant name (e.g., <code>acme.goskope.com</code>)</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Confirm traffic is flowing through Netskope (check Netskope dashboard)</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","infrastructure"]},{"location":"conductor/integrations/oci-cloud/","title":"Oracle Cloud Infrastructure (OCI)","text":"<p>Collects security and audit data from Oracle Cloud Infrastructure, including audit events, logging service data, and Cloud Guard problem detections.</p> Category Cloud Security Connector Name <code>signal-client.oci-cloud</code> Auth Method API Key (RSA Signing) Polling Interval 5 min (audit), 30 min (Cloud Guard) Multi-Instance Yes Vendor Docs OCI API Documentation","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Oracle Cloud Infrastructure tenancy. IAM permissions to create users and API keys.</p> <ul> <li> Active OCI tenancy</li> <li> IAM access to create users and generate API keys</li> <li> Network: Conductor can reach OCI API endpoints on port 443</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#generate-an-api-signing-key","title":"Generate an API Signing Key","text":"<ol> <li>Sign in to the OCI Console at <code>https://cloud.oracle.com/</code></li> <li>Navigate to Identity \u2192 Users \u2192 select your user (or create a    dedicated service user)</li> <li>Under Resources, click API Keys</li> <li>Click Add API Key</li> <li>Select Generate API Key Pair</li> <li>Click Download Private Key and save the PEM file securely</li> <li>Click Add</li> <li>Copy the fingerprint displayed</li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#collect-required-ocids","title":"Collect Required OCIDs","text":"Value Where to Find Tenancy OCID Governance \u2192 Tenancy Details \u2192 OCID User OCID Identity \u2192 Users \u2192 select user \u2192 OCID Compartment OCID Identity \u2192 Compartments \u2192 select compartment \u2192 OCID <p>Broadest Collection</p> <p>Use the Tenancy root compartment OCID (same as Tenancy OCID) to collect from all compartments. Use a specific compartment OCID to limit scope.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#grant-required-policies","title":"Grant Required Policies","text":"<p>Create an IAM policy for the API user:</p> <pre><code>Allow user &lt;username&gt; to read audit-events in tenancy\nAllow user &lt;username&gt; to read log-content in tenancy\nAllow user &lt;username&gt; to read cloud-guard-problems in tenancy\n</code></pre>","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Oracle Cloud (OCI)</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Tenancy OCID <code>ocid1.tenancy.oc1..aaa...</code> From Tenancy Details User OCID <code>ocid1.user.oc1..aaa...</code> API user OCID Fingerprint <code>aa:bb:cc:...</code> API key fingerprint from step 1 Private Key (paste PEM content) RSA private key content Region <code>us-ashburn-1</code> OCI region identifier Compartment OCID <code>ocid1.compartment.oc1..aaa...</code> Scope compartment </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol> <p>OCI Region Identifiers</p> <p>Common regions: <code>us-ashburn-1</code>, <code>us-phoenix-1</code>, <code>eu-frankfurt-1</code>, <code>eu-amsterdam-1</code>, <code>uk-london-1</code>, <code>ap-tokyo-1</code>, <code>ap-sydney-1</code>. Full list: OCI Regions</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"oci\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] oci-cloud: fetched &lt;N&gt; audit events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#data-sources","title":"Data Sources","text":"<p>OCI integration collects from three sources:</p> Source Data Type Default Interval Audit Events IAM, resource, and network activity 5 min Logging Search Custom log queries 5 min Cloud Guard Problems Security findings and recommendations 30 min <p>Cloud Guard Availability</p> <p>Cloud Guard may not be enabled in all tenancies. To enable: navigate to Security \u2192 Cloud Guard \u2192 Enable Cloud Guard in the OCI Console.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Private Key PEM content is pasted correctly (including   <code>-----BEGIN RSA PRIVATE KEY-----</code> header/footer)</li> <li>Ensure the Fingerprint matches the API key</li> <li>Check that the User OCID and Tenancy OCID are correct</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The IAM policies may not be configured for the user</li> <li>Verify the audit/logging/cloud-guard read policies are applied</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#invalid-region","title":"Invalid Region","text":"<ul> <li>Ensure the Region identifier uses the correct format   (e.g., <code>us-ashburn-1</code>, not <code>US East (Ashburn)</code>)</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/oci-cloud/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Verify audit events exist in OCI: Governance \u2192 Audit</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Ensure the compartment has active resources generating events</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/okta/","title":"Okta","text":"<p>Collects system log events from Okta, providing visibility into authentication activity, user lifecycle changes, and identity security events across your Okta organization.</p> Category Identity &amp; Access Connector Name <code>signal-client.okta</code> Auth Method API Token (SSWS) Polling Interval 5 min (system log) Multi-Instance Yes Vendor Docs Okta System Log API","tags":["integration","identity"]},{"location":"conductor/integrations/okta/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Okta subscription (any edition). Super Admin or Read Only Admin role required to create API tokens.</p> <ul> <li> Active Okta organization</li> <li> Super Admin or Read Only Admin role</li> <li> Network: Conductor can reach <code>&lt;your-org&gt;.okta.com</code> on port 443</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/okta/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Okta Admin Console at <code>https://&lt;your-org&gt;-admin.okta.com/</code></li> <li>Navigate to Security \u2192 API \u2192 Tokens</li> <li>Click Create Token</li> <li>Enter a name: <code>WitFoo Conductor</code></li> <li>Click Create Token</li> <li>Copy the Token Value \u2014 it is only shown once</li> </ol> <p>Store Credentials Securely</p> <p>Okta API tokens inherit the permissions of the admin who creates them. Store them securely and do not share them in tickets or email.</p> <p>Token Scope</p> <p>Tokens created by Read Only Admins have read-only access. For least-privilege, use a Read Only Admin account.</p>","tags":["integration","identity"]},{"location":"conductor/integrations/okta/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Okta</li> <li>Enter a unique name for this instance (e.g., \"Okta Production Org\")</li> <li> <p>Fill in the settings form:</p> Field Value Description FQDN <code>&lt;your-org&gt;.okta.com</code> Your Okta organization domain API Token <code>&lt;your-token&gt;</code> SSWS token from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","identity"]},{"location":"conductor/integrations/okta/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"okta\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] okta: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","identity"]},{"location":"conductor/integrations/okta/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","identity"]},{"location":"conductor/integrations/okta/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Token is correct and has not been revoked</li> <li>Tokens expire if the creating admin's account is deactivated or their   password is reset</li> <li>Regenerate the token if necessary</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/okta/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The token's admin may lack access to the System Log API</li> <li>Use a token created by a Super Admin or Read Only Admin</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/okta/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Okta enforces per-org rate limits (varies by subscription tier)</li> <li>Increase the Polling Interval to 10 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/okta/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://&lt;your-org&gt;.okta.com</code></li> <li>Confirm log events exist in the Okta System Log for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/","title":"1Password Events","text":"<p>Collects security event data from 1Password Events Reporting API, including sign-in attempts, item usage events, and audit log entries.</p> Category Identity &amp; Access Connector Name <code>signal-client.1password-events</code> Auth Method API Token (Bearer) Polling Interval 5 min Multi-Instance Yes Vendor Docs 1Password Events API","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>1Password Business or Enterprise plan required. Events Reporting is not available on Teams or individual plans. Account owner or admin access required.</p> <ul> <li> 1Password Business or Enterprise plan</li> <li> Account owner or admin access</li> <li> Network: Conductor can reach <code>events.1password.com</code> on port 443</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Sign in to 1Password at <code>https://start.1password.com/</code></li> <li>Navigate to Integrations \u2192 Directory</li> <li>Select Events Reporting under the \"Other\" category</li> <li>Click Create Events Reporting Integration</li> <li>Name the integration (e.g., \"WitFoo Conductor\")</li> <li>Copy the generated Bearer Token</li> </ol> <p>Token Storage</p> <p>The token is only shown once at creation time. Store it securely. If lost, you must delete the integration and create a new one.</p>","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select 1Password Events</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>events.1password.com</code> 1Password Events API endpoint API Token <code>&lt;your-bearer-token&gt;</code> Token from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"1password\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] 1password-events: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/#event-types-collected","title":"Event Types Collected","text":"Event Type Description Sign-in Attempts Successful and failed sign-in events Item Usages Password fills, item views, credential access Audit Events Admin actions, vault changes, group modifications","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Token is correct and was copied completely</li> <li>Ensure the Events Reporting integration has not been deleted in 1Password</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/#plan-limitations","title":"Plan Limitations","text":"<ul> <li>Events Reporting requires 1Password Business or Enterprise plan</li> <li>If you receive a 403 error, verify your plan tier in 1Password billing</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>1Password Events API has rate limits based on plan tier</li> <li>Increase the Polling Interval to 15 minutes</li> <li>Conductor automatically implements exponential backoff</li> </ul>","tags":["integration","identity"]},{"location":"conductor/integrations/onepassword-events/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>1Password events may have a short delay before appearing in the API</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://events.1password.com</code></li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","identity"]},{"location":"conductor/integrations/pan-cortex/","title":"Palo Alto Cortex","text":"<p>Collects security incidents and alerts from Palo Alto Networks Cortex XDR, providing visibility into endpoint and network threat detections across the Cortex platform.</p> Category Network Security Connector Name <code>signal-client.pan-cortex</code> Auth Method API Key (x-xdr-auth-id + Authorization) Polling Interval 5 min (incidents), 10 min (alerts) Multi-Instance Yes Vendor Docs Cortex XDR API Reference","tags":["integration","network"]},{"location":"conductor/integrations/pan-cortex/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Palo Alto Networks Cortex XDR subscription. Instance Administrator role required to create API keys.</p> <ul> <li> Active Cortex XDR Pro or Prevent subscription</li> <li> Instance Administrator role in Cortex XDR</li> <li> Network: Conductor can reach your Cortex XDR API endpoint on port 443</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/pan-cortex/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to Cortex XDR at <code>https://&lt;your-instance&gt;.xdr.paloaltonetworks.com/</code></li> <li>Navigate to Settings \u2192 Configurations \u2192 Integrations \u2192 API Keys</li> <li>Click + New Key</li> <li>Configure the key:<ul> <li>Security Level: Advanced</li> <li>Role: Viewer</li> </ul> </li> <li>Click Generate</li> <li>Copy the API Key and note the API Key ID</li> <li>Note your FQDN \u2014 the full API URL (e.g., <code>api-&lt;instance&gt;.xdr.us.paloaltonetworks.com</code>)</li> </ol> <p>Store Credentials Securely</p> <p>API keys grant access to your Cortex XDR data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","network"]},{"location":"conductor/integrations/pan-cortex/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select PAN Cortex</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description FQDN <code>api-&lt;instance&gt;.xdr.us.paloaltonetworks.com</code> Cortex XDR API FQDN Client ID <code>&lt;api-key-id&gt;</code> Numeric API key ID Secret <code>&lt;api-key&gt;</code> API key value from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","network"]},{"location":"conductor/integrations/pan-cortex/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"pan-cortex\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] pan-cortex: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","network"]},{"location":"conductor/integrations/pan-cortex/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","network"]},{"location":"conductor/integrations/pan-cortex/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Key ID and API Key are correct</li> <li>Ensure the API key has not been revoked in Cortex XDR</li> <li>Check that the FQDN matches your Cortex XDR instance region</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/pan-cortex/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API key may lack required permissions</li> <li>Ensure the key was created with at least Viewer role</li> <li>Verify the Security Level is set to Advanced (not Standard)</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/pan-cortex/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Cortex XDR API has per-minute rate limits</li> <li>Increase the Polling Interval to 10 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/pan-cortex/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity to the Cortex XDR API FQDN</li> <li>Confirm incidents or alerts exist in the Cortex XDR console</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","network"]},{"location":"conductor/integrations/proofpoint-casb/","title":"Proofpoint CASB","text":"<p>Collects cloud application security events from Proofpoint CASB (Cloud App Security Broker), providing visibility into SaaS application threats, compromised accounts, and data loss prevention events.</p> Category Email Security Connector Name <code>signal-client.proofpoint-casb</code> Auth Method Client ID + Client Secret + API Key (OAuth2) Polling Interval 5 min (events) Multi-Instance Yes Vendor Docs Proofpoint CASB API","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-casb/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Proofpoint CASB subscription. Admin access required to generate API credentials.</p> <ul> <li> Active Proofpoint CASB subscription</li> <li> Admin access in the Proofpoint CASB console</li> <li> Network: Conductor can reach the Proofpoint CASB API endpoint on port 443</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-casb/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Proofpoint CASB Console</li> <li>Navigate to Settings \u2192 API Integrations</li> <li>Click Create New API Credential</li> <li>Configure the credential:<ul> <li>Name: <code>WitFoo Conductor</code></li> <li>Permissions: Read-only access</li> </ul> </li> <li>Copy the Client ID, Client Secret, and API Key</li> </ol> <p>Store Credentials Securely</p> <p>API credentials grant access to your Proofpoint CASB data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-casb/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Proofpoint CASB</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description FQDN <code>&lt;api-endpoint&gt;</code> Proofpoint CASB API endpoint Client ID <code>&lt;your-client-id&gt;</code> Client ID from step 1 Secret <code>&lt;your-client-secret&gt;</code> Client secret from step 1 API Key <code>&lt;your-api-key&gt;</code> API key from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-casb/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"proofpoint-casb\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] proofpoint-casb: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-casb/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-casb/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Client ID, Client Secret, and API Key are correct</li> <li>Ensure the credentials have not been revoked</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-casb/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API credential may lack read permissions</li> <li>Contact your Proofpoint CASB administrator to verify permissions</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-casb/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 10 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-casb/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity to the Proofpoint CASB API endpoint</li> <li>Confirm events exist in the Proofpoint CASB console for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-protect/","title":"Proofpoint Protect","text":"<p>Collects email threat events from Proofpoint Email Protection, providing visibility into targeted attacks, phishing campaigns, malware delivery, and email-borne threats.</p> Category Email Security Connector Name <code>signal-client.proofpoint-protect</code> Auth Method Service Principal + Secret (Basic Auth) Polling Interval 5 min (events) Multi-Instance Yes Vendor Docs Proofpoint SIEM API","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-protect/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Proofpoint Email Protection subscription with TAP (Targeted Attack Protection). Admin access required to create service principals.</p> <ul> <li> Active Proofpoint Email Protection subscription with TAP</li> <li> Admin access in the Proofpoint TAP Dashboard</li> <li> Network: Conductor can reach <code>tap-api-v2.proofpoint.com</code> on port 443</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-protect/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Proofpoint TAP Dashboard at <code>https://threatinsight.proofpoint.com/</code></li> <li>Navigate to Settings \u2192 Connected Applications</li> <li>Click Create New Credential</li> <li>Configure the credential:<ul> <li>Name: <code>WitFoo Conductor</code></li> <li>Type: Service Principal</li> </ul> </li> <li>Copy the Service Principal and Secret</li> </ol> <p>Store Credentials Securely</p> <p>API credentials grant access to your Proofpoint email threat data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-protect/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Proofpoint Protect</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Service Principal <code>&lt;your-service-principal&gt;</code> Service principal from step 1 Secret <code>&lt;your-secret&gt;</code> Secret from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-protect/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"proofpoint-protect\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] proofpoint-protect: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-protect/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-protect/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Service Principal and Secret are correct</li> <li>Ensure the credential has not been revoked in the TAP Dashboard</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-protect/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The service principal may lack access to the SIEM API</li> <li>Contact your Proofpoint administrator to verify permissions</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-protect/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Proofpoint TAP API is limited to certain requests per minute</li> <li>Increase the Polling Interval to 10 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","email"]},{"location":"conductor/integrations/proofpoint-protect/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://tap-api-v2.proofpoint.com</code></li> <li>Confirm threat events exist in the Proofpoint TAP Dashboard for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","email"]},{"location":"conductor/integrations/qualys/","title":"Qualys","text":"<p>Collects vulnerability scan results and host detection data from Qualys Vulnerability Management, providing visibility into vulnerability posture across your infrastructure.</p> Category Vulnerability Management Connector Name <code>signal-client.qualys</code> Auth Method Basic Auth (Username + Password) Polling Interval 30 min Multi-Instance Yes Vendor Docs Qualys API Documentation","tags":["integration","vulnerability"]},{"location":"conductor/integrations/qualys/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Qualys subscription with API access enabled. Manager or higher role required to create API users.</p> <ul> <li> Active Qualys subscription with API access</li> <li> Manager role or higher in Qualys</li> <li> Know your Qualys platform URL (varies by subscription region)</li> <li> Network: Conductor can reach your Qualys API endpoint on port 443</li> </ul>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/qualys/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Qualys Console at your platform URL</li> <li>Navigate to Users (under Administration)</li> <li>Click Add User or select an existing user</li> <li>Assign the API role to the user</li> <li>Record the username and password</li> </ol> <p>Qualys Platform URLs</p> <p>Qualys uses region-specific platform URLs. Select the correct base URL for your subscription:</p> Platform API URL US Platform 1 <code>qualysapi.qualys.com</code> US Platform 2 <code>qualysapi.qg2.apps.qualys.com</code> US Platform 3 <code>qualysapi.qg3.apps.qualys.com</code> EU Platform 1 <code>qualysapi.qualys.eu</code> EU Platform 2 <code>qualysapi.qg2.apps.qualys.eu</code> India <code>qualysapi.qg1.apps.qualys.in</code> Canada <code>qualysapi.qg1.apps.qualys.ca</code> UAE <code>qualysapi.qg1.apps.qualys.ae</code>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/qualys/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Qualys</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>qualysapi.qualys.com</code> Platform API URL (see table above) Username <code>&lt;your-username&gt;</code> API user from step 1 Password <code>&lt;your-password&gt;</code> API user password </li> <li> <p>Set the Polling Interval (recommended: 30 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/qualys/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"qualys\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] qualys: fetched host detections\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/qualys/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","vulnerability"]},{"location":"conductor/integrations/qualys/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Username and Password are correct</li> <li>Ensure the user has the API role assigned in Qualys</li> <li>Basic Auth sends credentials as <code>Base64(username:password)</code> \u2014 special   characters in passwords are supported</li> </ul>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/qualys/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The user may lack the required module subscriptions</li> <li>Ensure the user has access to the Vulnerability Management module</li> </ul>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/qualys/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Qualys enforces a rate limit of approximately 300 requests per hour</li> <li>Increase the Polling Interval to 60 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/qualys/#wrong-platform-url","title":"Wrong Platform URL","text":"<ul> <li>If you see <code>404</code> or connection errors, verify you are using the correct   platform URL for your subscription region (see table above)</li> <li>The URL is not the web console URL; it is the API-specific endpoint</li> </ul>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/qualys/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://&lt;your-qualys-api-url&gt;</code></li> <li>Confirm completed scans exist in Qualys for the polling window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/rapid7-insightidr/","title":"Rapid7 InsightIDR","text":"<p>Collects investigation and alert data from Rapid7 InsightIDR, Rapid7's cloud SIEM and XDR platform for threat detection, investigation, and response.</p> Category SIEM Connector Name <code>signal-client.rapid7-insightidr</code> Auth Method API Key Polling Interval 5 min Multi-Instance Yes Vendor Docs InsightIDR API","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Rapid7 InsightIDR subscription. Platform Admin access required to generate API keys.</p> <ul> <li> Active Rapid7 InsightIDR subscription</li> <li> Platform Admin access to Rapid7 Insight Platform</li> <li> Network: Conductor can reach your Rapid7 regional endpoint on port 443</li> </ul>","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Rapid7 Insight Platform at <code>https://insight.rapid7.com/</code></li> <li>Navigate to Platform Settings \u2192 API Keys</li> <li>Click New User Key (or New Organization Key for shared access)</li> <li>Name the key (e.g., \"WitFoo Conductor\")</li> <li>Click Generate</li> <li>Copy the API Key</li> </ol> <p>Regional Endpoints</p> <p>Rapid7 uses regional API endpoints. Select the region that matches your Insight Platform account:</p> Region API Endpoint US 1 <code>us.api.insight.rapid7.com</code> US 2 <code>us2.api.insight.rapid7.com</code> US 3 <code>us3.api.insight.rapid7.com</code> EU <code>eu.api.insight.rapid7.com</code> Canada <code>ca.api.insight.rapid7.com</code> Australia <code>au.api.insight.rapid7.com</code> Japan <code>ap.api.insight.rapid7.com</code> <p>Check your account URL to determine your region.</p>","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Rapid7 InsightIDR</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Region <code>us</code> Regional identifier (see table above) API Key <code>&lt;your-api-key&gt;</code> API key from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"rapid7\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] rapid7-insightidr: fetched &lt;N&gt; investigations\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#data-types-collected","title":"Data Types Collected","text":"Type Description Investigations Threat investigations with alerts and evidence Alerts Detection rule triggers and anomaly alerts","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Key is correct and was copied completely</li> <li>Ensure the key has not been revoked in the Insight Platform</li> <li>Check that the key is a User Key (not an Organization Key with   restrictions)</li> </ul>","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#wrong-region","title":"Wrong Region","text":"<ul> <li>If you see 404 errors, verify the Region matches your Insight Platform   account region</li> <li>Check the URL in your browser when logged into Rapid7</li> </ul>","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API key user may not have InsightIDR access</li> <li>Verify the user has Platform Admin or at least read access to InsightIDR</li> </ul>","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 15 minutes</li> <li>Conductor automatically implements exponential backoff</li> </ul>","tags":["integration","siem"]},{"location":"conductor/integrations/rapid7-insightidr/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Verify investigations or alerts exist in InsightIDR</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Confirm the regional endpoint is reachable</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","siem"]},{"location":"conductor/integrations/sentinelone/","title":"SentinelOne","text":"<p>Collects endpoint threat data from SentinelOne Singularity, including threat detections, activity logs, and agent/device inventory.</p> Category Endpoint Security Connector Name <code>signal-client.sentinelone</code> Auth Method API Token Polling Interval 5 min (threats), 10 min (activities), 1 hr (agents) Multi-Instance Yes Vendor Docs SentinelOne API Documentation","tags":["integration","endpoint"]},{"location":"conductor/integrations/sentinelone/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active SentinelOne Singularity subscription. Admin access required to create service users and generate API tokens.</p> <ul> <li> Active SentinelOne subscription</li> <li> Admin access to the SentinelOne Management Console</li> <li> Network: Conductor can reach your SentinelOne management URL on port 443</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sentinelone/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the SentinelOne Management Console at    <code>https://&lt;your-instance&gt;.sentinelone.net/</code></li> <li>Navigate to Settings \u2192 Users \u2192 Service Users</li> <li>Click Create Service User</li> <li>Set the role to Viewer (read-only access is sufficient)</li> <li>Set the scope \u2014 Account-level for broadest visibility, or Site-level for    specific sites</li> <li>Click Create</li> <li>Click Generate API Token on the new service user</li> <li>Copy the API Token</li> </ol> <p>Token Scope</p> <p>Account-scoped tokens collect data from all sites. Site-scoped tokens are limited to a specific site. Use account scope unless you need to restrict data collection.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sentinelone/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select SentinelOne</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>&lt;your-instance&gt;.sentinelone.net</code> Management console URL API Key <code>&lt;your-api-token&gt;</code> API token from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes for threats)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sentinelone/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"sentinelone\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] sentinelone: fetched &lt;N&gt; threats\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sentinelone/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","endpoint"]},{"location":"conductor/integrations/sentinelone/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Token is correct and has not expired</li> <li>SentinelOne API tokens have configurable expiry; re-generate if expired</li> <li>Ensure the token was copied completely</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sentinelone/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The service user may not have sufficient role permissions</li> <li>Verify the user has at least Viewer role</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sentinelone/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>SentinelOne enforces a rate limit of approximately 1000 requests per minute</li> <li>Increase the Polling Interval to 15 minutes</li> <li>Conductor automatically implements exponential backoff</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sentinelone/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Verify the Host URL is correct (include the full management URL)</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Confirm threats or activities exist in the SentinelOne console</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sophos-central/","title":"Sophos Central","text":"<p>Collects endpoint protection and security event data from Sophos Central, including malware detections, web filtering events, and endpoint inventory.</p> Category Endpoint Security Connector Name <code>signal-client.sophos-central</code> Auth Method OAuth2 Client Credentials Polling Interval 5 min (alerts), 1 hr (endpoints) Multi-Instance Yes Vendor Docs Sophos Central API","tags":["integration","endpoint"]},{"location":"conductor/integrations/sophos-central/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Sophos Central subscription. Super Admin or Admin role required to create API credentials.</p> <ul> <li> Active Sophos Central account</li> <li> Super Admin or Admin role</li> <li> Network: Conductor can reach <code>id.sophos.com</code> and regional API   endpoints on port 443</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sophos-central/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to Sophos Central at <code>https://central.sophos.com/</code></li> <li>Navigate to Global Settings \u2192 API Credentials Management</li> <li>Click Add Credential</li> <li>Name the credential (e.g., \"WitFoo Conductor\")</li> <li>Assign the role: <code>Service Principal ReadOnly</code> (minimum required)</li> <li>Click Add</li> <li>Copy the Client ID and Client Secret</li> </ol> <p>Region Auto-Discovery</p> <p>Sophos Central uses a <code>/whoami</code> endpoint to automatically determine your regional API endpoint. Conductor handles this automatically \u2014 you only need to provide the Client ID and Client Secret.</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sophos-central/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Sophos Central</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Client ID <code>&lt;your-client-id&gt;</code> From step 1 Client Secret <code>&lt;your-client-secret&gt;</code> From step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes for alerts)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sophos-central/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"sophos\"\n</code></pre> <p>Look for successful authentication and poll messages: <pre><code>[INFO] sophos-central: authenticated via OAuth2\n[INFO] sophos-central: fetched &lt;N&gt; alerts\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sophos-central/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","endpoint"]},{"location":"conductor/integrations/sophos-central/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Client ID and Client Secret are correct</li> <li>Ensure the credential has not been deleted in Sophos Central</li> <li>Check that the credential role has sufficient permissions</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sophos-central/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API credential may have insufficient role scope</li> <li>Verify at least <code>Service Principal ReadOnly</code> is assigned</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sophos-central/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 15 minutes</li> <li>Conductor automatically implements exponential backoff</li> </ul>","tags":["integration","endpoint"]},{"location":"conductor/integrations/sophos-central/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify events exist in Sophos Central for the polling window</li> <li>Confirm network connectivity to <code>id.sophos.com</code></li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","endpoint"]},{"location":"conductor/integrations/splunk/","title":"Splunk","text":"<p>Collects search results from Splunk via the REST API, providing the ability to forward Splunk search results into WitFoo Analytics for correlated analysis alongside other security data sources.</p> Category SIEM Connector Name <code>signal-client.splunk</code> Auth Method Token or Username + Password Polling Interval 15 min (search-based) Multi-Instance Yes Vendor Docs Splunk REST API Reference","tags":["integration","siem"]},{"location":"conductor/integrations/splunk/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Splunk Enterprise or Splunk Cloud subscription. Admin access required to create API tokens or service accounts.</p> <ul> <li> Active Splunk Enterprise or Splunk Cloud deployment</li> <li> Admin or equivalent role to create tokens/users</li> <li> Network: Conductor can reach the Splunk management port (default 8089)</li> </ul>","tags":["integration","siem"]},{"location":"conductor/integrations/splunk/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"Token Authentication (Recommended)Username/Password Authentication <ol> <li>Log in to the Splunk Web UI at <code>https://&lt;splunk-server&gt;:8000/</code></li> <li>Navigate to Settings \u2192 Tokens (under Data)</li> <li>Click New Token</li> <li>Configure the token:<ul> <li>User: Select a user with search permissions</li> <li>Audience: <code>WitFoo Conductor</code></li> <li>Expiration: Set per your security policy</li> </ul> </li> <li>Copy the generated Token</li> </ol> <ol> <li>Log in to the Splunk Web UI at <code>https://&lt;splunk-server&gt;:8000/</code></li> <li>Navigate to Settings \u2192 Access Controls \u2192 Users</li> <li>Click New User</li> <li>Configure the user:<ul> <li>Username: <code>witfoo-conductor</code></li> <li>Role: Assign a role with search permissions (e.g., <code>user</code>)</li> <li>Password: Set a strong password</li> </ul> </li> <li>Note the Username and Password</li> </ol> <p>Store Credentials Securely</p> <p>Splunk credentials grant access to your indexed data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","siem"]},{"location":"conductor/integrations/splunk/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Splunk</li> <li>Enter a unique name for this instance (e.g., \"Splunk Production\")</li> <li> <p>Fill in the settings form:</p> Field Value Description URL <code>https://&lt;splunk-server&gt;:8089</code> Splunk REST API endpoint Username <code>witfoo-conductor</code> Username (if using basic auth) Password <code>&lt;password&gt;</code> Password (if using basic auth) Auth Token <code>&lt;token&gt;</code> Bearer token (if using token auth) Custom Search <code>index=main earliest=-15m</code> Optional: custom SPL query Poll Interval <code>15</code> Minutes between searches </li> <li> <p>Toggle Enabled to on</p> </li> <li>Click Save</li> </ol> <p>Custom Search Queries</p> <p>Leave the Custom Search field empty to use the default search, or provide a custom SPL query. The query runs on each polling cycle.</p>","tags":["integration","siem"]},{"location":"conductor/integrations/splunk/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"splunk\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] splunk: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first search runs within the configured polling interval after saving. For a 15-minute interval, expect results within 15 minutes.</p>","tags":["integration","siem"]},{"location":"conductor/integrations/splunk/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","siem"]},{"location":"conductor/integrations/splunk/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the credentials (token or username/password) are correct</li> <li>For tokens, ensure the token has not expired</li> <li>For Splunk Cloud, verify the REST API endpoint is correct</li> </ul>","tags":["integration","siem"]},{"location":"conductor/integrations/splunk/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The user or token may lack search permissions</li> <li>Ensure the user has a role with <code>search</code> capability</li> </ul>","tags":["integration","siem"]},{"location":"conductor/integrations/splunk/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 30 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","siem"]},{"location":"conductor/integrations/splunk/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -k -I https://&lt;splunk-server&gt;:8089</code></li> <li>Test the search query directly in the Splunk Web UI</li> <li>Ensure data exists in the target index for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","siem"]},{"location":"conductor/integrations/stealthwatch/","title":"Stealthwatch","text":"<p>Collects network flow analytics and security events from Cisco Stealthwatch (Secure Network Analytics), providing visibility into internal network threats, anomalous behaviors, and flow data.</p> Category Network Security Connector Name <code>signal-client.stealthwatch</code> Auth Method Username + Password (Session Cookie) Polling Interval 5 min (events) Multi-Instance Yes Vendor Docs Stealthwatch API Documentation","tags":["integration","network"]},{"location":"conductor/integrations/stealthwatch/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Cisco Secure Network Analytics (Stealthwatch) deployment. Admin access required to create API users.</p> <ul> <li> Active Stealthwatch Management Console (SMC)</li> <li> Admin access to create user accounts</li> <li> Network: Conductor can reach the Stealthwatch Management Console on port 443</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/stealthwatch/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the Stealthwatch Management Console at <code>https://&lt;smc-address&gt;/</code></li> <li>Navigate to Configuration \u2192 User Management</li> <li>Click Add User</li> <li>Configure the user:<ul> <li>Username: <code>witfoo-conductor</code></li> <li>Role: Analyst (read-only access)</li> <li>Password: Set a strong password</li> </ul> </li> <li>Note the Domain ID \u2014 visible on the SMC dashboard or under Domains</li> </ol> <p>Store Credentials Securely</p> <p>API credentials grant access to your Stealthwatch data. Store them securely and do not share them in tickets or email.</p>","tags":["integration","network"]},{"location":"conductor/integrations/stealthwatch/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Stealthwatch</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Host <code>&lt;smc-address&gt;</code> Stealthwatch Management Console IP or hostname Domain ID <code>&lt;your-domain-id&gt;</code> Stealthwatch domain identifier Username <code>witfoo-conductor</code> API user from step 1 Password <code>&lt;password&gt;</code> Password from step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","network"]},{"location":"conductor/integrations/stealthwatch/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"stealthwatch\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] stealthwatch: fetched &lt;N&gt; events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 5-minute interval, expect data within 5 minutes.</p>","tags":["integration","network"]},{"location":"conductor/integrations/stealthwatch/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","network"]},{"location":"conductor/integrations/stealthwatch/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Username and Password are correct</li> <li>Ensure the user account has not been locked or disabled</li> <li>Check that the Stealthwatch session has not expired</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/stealthwatch/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The user may lack required role permissions</li> <li>Ensure the user has at least Analyst role</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/stealthwatch/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 10 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/stealthwatch/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity from Conductor to the SMC</li> <li>Confirm the Domain ID is correct</li> <li>Ensure flow data is being collected by the Stealthwatch Flow Collectors</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","network"]},{"location":"conductor/integrations/tenable/","title":"Tenable","text":"<p>Collects vulnerability scan results and asset data from Tenable.io (Tenable Vulnerability Management), providing visibility into vulnerability posture, scan findings, and asset inventory.</p> Category Vulnerability Management Connector Name <code>signal-client.tenable</code> Auth Method Access Key + Secret Key Polling Interval 30 min (vulnerabilities), 1 hr (assets) Multi-Instance Yes Vendor Docs Tenable.io API Documentation","tags":["integration","vulnerability"]},{"location":"conductor/integrations/tenable/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Tenable.io (Tenable Vulnerability Management) subscription. Admin access required to generate API keys.</p> <ul> <li> Active Tenable.io subscription</li> <li> Admin or Standard user with API key generation permissions</li> <li> Network: Conductor can reach <code>cloud.tenable.com</code> on port 443</li> </ul>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/tenable/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to Tenable.io at <code>https://cloud.tenable.com/</code></li> <li>Click your account icon (top-right) \u2192 My Account</li> <li>Navigate to the API Keys tab</li> <li>Click Generate</li> <li>Copy the Access Key and Secret Key</li> </ol> <p>Store Credentials Securely</p> <p>Tenable API keys grant access to your vulnerability data. Store them securely and do not share them in tickets or email. The secret key is only shown once.</p>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/tenable/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Tenable</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description FQDN <code>cloud.tenable.com</code> Tenable.io API endpoint Client ID <code>&lt;your-access-key&gt;</code> Access key from step 1 API Secret <code>&lt;your-secret-key&gt;</code> Secret key from step 1 </li> <li> <p>Set the Polling Interval (recommended: 30 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/tenable/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"tenable\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] tenable: fetched &lt;N&gt; vulnerabilities\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to the WitFoo Analytics    Signals \u2192 Search page and search for artifacts from this source</p> </li> </ol> <p>First Poll Timing</p> <p>The first data pull occurs within the configured polling interval after saving. For a 30-minute interval, expect data within 30 minutes.</p>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/tenable/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","vulnerability"]},{"location":"conductor/integrations/tenable/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Access Key and Secret Key are correct</li> <li>Ensure the API keys have not been regenerated (regenerating invalidates   previous keys)</li> </ul>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/tenable/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The API keys may belong to a user without scan result access</li> <li>Ensure the user has at least Standard or Admin permissions</li> </ul>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/tenable/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Tenable.io enforces a rate limit of 300-500 requests per minute   (varies by subscription tier)</li> <li>Increase the Polling Interval to 60 minutes</li> <li>Conductor automatically implements exponential backoff on 429 responses</li> </ul>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/tenable/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs for errors: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify network connectivity: <code>curl -I https://cloud.tenable.com</code></li> <li>Confirm vulnerability scans have completed in Tenable.io</li> <li>Ensure scan results exist for the polling time window</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","vulnerability"]},{"location":"conductor/integrations/wiz/","title":"Wiz","text":"<p>Collects cloud security findings from Wiz, including misconfigurations, vulnerabilities, and threat detections across multi-cloud environments (AWS, Azure, GCP, OCI).</p> Category Cloud Security Connector Name <code>signal-client.wiz</code> Auth Method OAuth2 Client Credentials Polling Interval 5 min (issues), 30 min (vulnerabilities) Multi-Instance Yes Vendor Docs Wiz API Documentation","tags":["integration","cloud"]},{"location":"conductor/integrations/wiz/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Wiz subscription. Admin access required to create service accounts.</p> <ul> <li> Active Wiz subscription</li> <li> Admin access to the Wiz console</li> <li> Network: Conductor can reach your Wiz regional API endpoint on port 443</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/wiz/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to Wiz at <code>https://app.wiz.io/</code></li> <li>Navigate to Settings \u2192 Service Accounts</li> <li>Click Create Service Account</li> <li>Name the account (e.g., \"WitFoo Conductor\")</li> <li>Assign scopes: <code>read:resources</code> and <code>read:issues</code></li> <li>Click Create</li> <li>Copy the Client ID and Client Secret</li> </ol> <p>Regional API Endpoints</p> <p>Wiz uses regional API endpoints. Select the correct one for your tenant:</p> Region API Endpoint Auth Endpoint US <code>api.us1.app.wiz.io</code> <code>auth.app.wiz.io</code> EU <code>api.eu1.app.wiz.io</code> <code>auth.app.wiz.io</code> US 2 <code>api.us2.app.wiz.io</code> <code>auth.app.wiz.io</code> <p>If unsure, check your browser's address bar when logged into Wiz.</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/wiz/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Wiz</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description API Endpoint <code>api.us1.app.wiz.io</code> Regional API URL (see table) Auth Endpoint <code>auth.app.wiz.io</code> OAuth2 token endpoint Client ID <code>&lt;your-client-id&gt;</code> From step 1 Client Secret <code>&lt;your-client-secret&gt;</code> From step 1 </li> <li> <p>Set the Polling Interval (recommended: 5 minutes for issues)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/wiz/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"wiz\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] wiz: fetched &lt;N&gt; issues\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","cloud"]},{"location":"conductor/integrations/wiz/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","cloud"]},{"location":"conductor/integrations/wiz/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the Client ID and Client Secret are correct</li> <li>Ensure the service account has not been deleted in Wiz</li> <li>Check the Auth Endpoint is correct (<code>auth.app.wiz.io</code>)</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/wiz/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The service account may lack required scopes</li> <li>Verify <code>read:resources</code> and <code>read:issues</code> are assigned</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/wiz/#wrong-api-endpoint","title":"Wrong API Endpoint","text":"<ul> <li>If you see connection errors, verify the API Endpoint matches your   Wiz region (US, EU, etc.)</li> <li>The API endpoint is different from the console URL</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/wiz/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 15 minutes</li> <li>Conductor automatically implements exponential backoff</li> </ul>","tags":["integration","cloud"]},{"location":"conductor/integrations/wiz/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Ensure cloud accounts are connected in Wiz (Settings \u2192 Cloud Accounts)</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify there are active issues in the Wiz console</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","cloud"]},{"location":"conductor/integrations/zscaler-zia/","title":"Zscaler ZIA","text":"<p>Collects web security and threat event data from Zscaler Internet Access (ZIA), including web transactions, firewall logs, DNS logs, and threat events.</p> Category Network Security Connector Name <code>signal-client.zscaler-zia</code> Auth Method API Key + Admin Credentials Polling Interval 5 min Multi-Instance Yes Vendor Docs Zscaler ZIA API","tags":["integration","network"]},{"location":"conductor/integrations/zscaler-zia/#prerequisites","title":"Prerequisites","text":"<p>Vendor Requirements</p> <p>Active Zscaler Internet Access subscription. Admin access to ZIA Admin Portal. API access must be enabled for your organization.</p> <ul> <li> Active ZIA subscription</li> <li> Admin access to ZIA Admin Portal</li> <li> API key from ZIA administration</li> <li> Network: Conductor can reach your ZIA admin portal on port 443</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/zscaler-zia/#step-1-create-api-credentials","title":"Step 1: Create API Credentials","text":"<ol> <li>Log in to the ZIA Admin Portal at <code>https://admin.zs&lt;cloud&gt;.net/</code></li> <li>Navigate to Administration \u2192 API Key Management</li> <li>Copy the API Key displayed</li> <li>Note your admin email and password (used for API authentication)</li> </ol> <p>ZIA Cloud Identifiers</p> <p>Zscaler uses cloud-specific admin portal URLs. Select the correct base URL:</p> Cloud Admin URL Zscaler <code>admin.zscaler.net</code> ZscalerOne <code>admin.zscalerone.net</code> ZscalerTwo <code>admin.zscalertwo.net</code> ZscalerThree <code>admin.zscalerthree.net</code> ZscalerBeta <code>admin.zscloud.net</code> Zscaler Gov <code>admin.zscalergov.net</code> <p>Check your Zscaler documentation or account team if unsure which cloud you are on.</p>","tags":["integration","network"]},{"location":"conductor/integrations/zscaler-zia/#step-2-configure-in-conductor","title":"Step 2: Configure in Conductor","text":"<ol> <li>Open the Conductor UI at <code>https://&lt;conductor-ip&gt;/admin/settings/integrations</code></li> <li>From the Add Integration dropdown, select Zscaler ZIA</li> <li>Enter a unique name for this instance</li> <li> <p>Fill in the settings form:</p> Field Value Description Base URL <code>admin.zscaler.net</code> ZIA admin portal URL (see table) API Key <code>&lt;your-api-key&gt;</code> From API Key Management Username <code>&lt;admin-email&gt;</code> Admin account email Password <code>&lt;admin-password&gt;</code> Admin account password </li> <li> <p>Set the Polling Interval (recommended: 5 minutes)</p> </li> <li>Toggle Enabled to on</li> <li>Click Save</li> </ol>","tags":["integration","network"]},{"location":"conductor/integrations/zscaler-zia/#step-3-validate-data-flow","title":"Step 3: Validate Data Flow","text":"<p>After saving, verify the integration is working:</p> <ol> <li>Check connection status \u2014 The integration tile should show a green    status indicator within 1\u20132 polling cycles</li> <li> <p>Check Signal Client logs:</p> <pre><code>docker logs signal-client-svc --tail=50 | grep \"zscaler\"\n</code></pre> <p>Look for successful poll messages: <pre><code>[INFO] zscaler-zia: authenticated, fetching events\n</code></pre></p> </li> <li> <p>Check artifacts in Analytics \u2014 Navigate to WitFoo Analytics    Signals \u2192 Search and search for artifacts from this source</p> </li> </ol>","tags":["integration","network"]},{"location":"conductor/integrations/zscaler-zia/#troubleshooting","title":"Troubleshooting","text":"","tags":["integration","network"]},{"location":"conductor/integrations/zscaler-zia/#authentication-failed-401","title":"Authentication Failed (401)","text":"<ul> <li>Verify the API Key, Username, and Password are correct</li> <li>Ensure the admin account is not locked or disabled</li> <li>Zscaler uses timestamp obfuscation for authentication; Conductor handles   this automatically</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/zscaler-zia/#wrong-cloud","title":"Wrong Cloud","text":"<ul> <li>If you see connection errors, verify the Base URL matches your Zscaler   cloud (see table above)</li> <li>The base URL is different from the user-facing ZIA service URL</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/zscaler-zia/#forbidden-403","title":"Forbidden (403)","text":"<ul> <li>The admin account may not have API access enabled</li> <li>Contact your Zscaler admin to verify API access permissions</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/zscaler-zia/#rate-limited-429","title":"Rate Limited (429)","text":"<ul> <li>Increase the Polling Interval to 15 minutes</li> <li>Conductor automatically implements exponential backoff</li> </ul>","tags":["integration","network"]},{"location":"conductor/integrations/zscaler-zia/#no-data-appearing","title":"No Data Appearing","text":"<ul> <li>Confirm the integration shows Enabled in the Conductor UI</li> <li>Check Signal Client logs: <code>docker logs signal-client-svc --tail=100</code></li> <li>Verify web traffic is flowing through ZIA (check ZIA dashboard)</li> <li>Confirm the admin portal URL is correct</li> </ul> <p>See also: Integration Catalog \u00b7 Integration Management \u00b7 Signal Client \u00b7 Common Troubleshooting</p>","tags":["integration","network"]},{"location":"conductor/ui/","title":"Conductor UI Overview","text":"<p>Conductor UI is the web management interface for configuring and monitoring the Conductor pipeline. It provides real-time dashboards, service configuration, and user management through a modern web application.</p>"},{"location":"conductor/ui/#access","title":"Access","text":"Property Value Internal port 8000 External access HTTPS on port 443 (via reverse proxy) Login URL <code>https://&lt;conductor-host&gt;/auth/login</code> <p>Default Credentials</p> <p>The default administrator credentials are:</p> <ul> <li>Email: <code>admin@witfoo.com</code></li> <li>Password: <code>F00theN0ise!</code></li> </ul> <p>Change the default password immediately after first login via the Account settings page.</p>"},{"location":"conductor/ui/#technology","title":"Technology","text":"Component Technology Frontend SvelteKit with Carbon Design System Backend Go with Echo web framework Real-time updates WebSocket (with HTTP polling fallback at 5-second interval) Configuration store NATS KV buckets (via broker-edge)"},{"location":"conductor/ui/#route-table","title":"Route Table","text":"Route Purpose <code>/</code> Dashboard (4 tabs: Overview, Pipeline, Service Status, Container Status) <code>/auth/login</code> Authentication <code>/account</code> User profile settings and password change <code>/admin/users</code> User management (create, edit, deactivate) <code>/admin/settings/processors</code> Parser configuration (enable/disable 200+ parsers) <code>/admin/settings/integrations</code> API integration management (19 integrations) <code>/admin/settings/artifact-exporters</code> Export destination configuration (8 exporters) <code>/admin/settings/log-servers</code> Log server listener configuration"},{"location":"conductor/ui/#real-time-updates","title":"Real-Time Updates","text":"<p>The dashboard uses WebSocket connections for real-time metric updates. A pulsating dot indicator in the UI shows the WebSocket connection status:</p> <ul> <li>Connected \u2014 Live updates via WebSocket</li> <li>Disconnected \u2014 Automatic fallback to HTTP polling at 5-second intervals</li> </ul>"},{"location":"conductor/ui/#container-details","title":"Container Details","text":"Property Value Container name <code>conductor-ui-svc</code> Internal hostname <code>conductor-ui</code> Depends on <code>broker-edge</code> (healthy) Internal port 8000 Environment <code>REVERSE_PROXY_MODE=true</code>, <code>DISABLE_TLS=true</code> (TLS terminated at proxy)"},{"location":"conductor/ui/#ui-pages","title":"UI Pages","text":"Page Documentation Dashboard Dashboard Parser Management Parsers Integration Management Integrations Exporter Configuration Exporters Log Server Configuration Log Servers User Management Users"},{"location":"conductor/ui/dashboard/","title":"Dashboard","text":"<p>The Conductor UI dashboard provides real-time visibility into pipeline health, system resources, and service status. It is the default landing page after login, accessible at <code>/</code>.</p>"},{"location":"conductor/ui/dashboard/#layout","title":"Layout","text":"<p>The dashboard is organized into 4 tabs, each providing a different view of the Conductor node:</p>"},{"location":"conductor/ui/dashboard/#overview-tab","title":"Overview Tab","text":"<p>The Overview tab displays system resource gauges and pipeline summary metrics.</p> Widget Description CPU Cores Number of host CPU cores available Memory Usage Current memory utilization gauge (used / total) Disk Usage Current disk utilization gauge (used / total) Message Throughput Counters showing messages processed per pipeline stage Pipeline Health Status indicators for each pipeline stage (green/yellow/red)"},{"location":"conductor/ui/dashboard/#pipeline-tab","title":"Pipeline Tab","text":"<p>The Pipeline tab provides detailed time-series visualization of message flow through the pipeline.</p> Widget Description Stage Count Charts Time-series charts for <code>pipeline_stage_count</code> metrics Message Flow Visual representation of messages moving through stages Stage Filters Filter controls for stages: <code>source_client</code>, <code>broker</code>, <code>filter</code>, <code>export</code> <p>Use the stage filters to isolate specific parts of the pipeline when investigating throughput issues or bottlenecks.</p>"},{"location":"conductor/ui/dashboard/#service-status-tab","title":"Service Status Tab","text":"<p>The Service Status tab shows the health of each Conductor service based on WFA report events.</p> Widget Description Per-Service Health Health status for each of the 7 Conductor services Error Indicators Warning and error badges for services with issues Last Update Timestamp of the most recent health report per service"},{"location":"conductor/ui/dashboard/#container-status-tab","title":"Container Status Tab","text":"<p>The Container Status tab displays Docker container metrics for resource monitoring.</p> Widget Description Container CPU Per-container CPU usage percentage Container Memory Per-container memory usage and limits Uptime Container uptime since last restart Status Running, stopped, or restarting state"},{"location":"conductor/ui/dashboard/#real-time-updates","title":"Real-Time Updates","text":"<p>The dashboard receives live updates via WebSocket connection. A pulsating dot indicator shows the connection status:</p> <ul> <li>Pulsating green dot \u2014 WebSocket connected, receiving live updates</li> <li>Static/grey dot \u2014 WebSocket disconnected, using HTTP polling fallback</li> </ul> <p>When the WebSocket connection is lost, the dashboard automatically falls back to HTTP polling at 5-second intervals. The WebSocket connection is re-established automatically when available.</p> <p>Tip</p> <p>If dashboard metrics appear stale, check the WebSocket indicator. A disconnected WebSocket with polling fallback may show slightly delayed data compared to the live WebSocket feed.</p>"},{"location":"conductor/ui/exporters/","title":"Exporter Configuration","text":"<p>The Exporter Configuration page manages export destinations for processed artifacts.</p> <p>URL: <code>/admin/settings/artifact-exporters</code></p>"},{"location":"conductor/ui/exporters/#export-destinations","title":"Export Destinations","text":"<p>Conductor supports 8 export destinations, each independently configurable:</p> Exporter Configuration Fields Splunk HEC URL, token, index, source type OpenSearch URL, index, auth mode (basic, API key, none) Microsoft Sentinel Workspace ID, shared key AlienVault Server URL, API key SCP Transfer Host, path, credentials, row limits UDP Syslog Host, port Local FileSystem Output directory path Reporter WitFoo Analytics Reporter integration"},{"location":"conductor/ui/exporters/#interface","title":"Interface","text":"<p>Each exporter is displayed with:</p> <ul> <li>Exporter name and type \u2014 Identifies the destination</li> <li>Enable/disable toggle \u2014 Independently activate each exporter</li> <li>Configuration form \u2014 Destination-specific fields (URLs, credentials, ports)</li> <li>STIX enrichment toggle \u2014 Include or exclude STIX threat intelligence data in exports</li> <li>Filter configuration \u2014 Optional predicate filters for this exporter</li> </ul>"},{"location":"conductor/ui/exporters/#configuration-details","title":"Configuration Details","text":""},{"location":"conductor/ui/exporters/#splunk-hec","title":"Splunk HEC","text":"Field Description URL Full HEC endpoint URL (e.g., <code>https://splunk.example.com:8088/services/collector</code>) Token HEC authentication token Index Target Splunk index name Source type Splunk source type for ingested events"},{"location":"conductor/ui/exporters/#opensearch","title":"OpenSearch","text":"Field Description URL Cluster URL (e.g., <code>https://opensearch.example.com:9200</code>) Index Target index name Auth mode <code>basic</code> (username/password), <code>apikey</code>, or <code>none</code>"},{"location":"conductor/ui/exporters/#microsoft-sentinel","title":"Microsoft Sentinel","text":"Field Description Workspace ID Log Analytics workspace identifier Shared key Primary or secondary workspace key"},{"location":"conductor/ui/exporters/#scp-transfer","title":"SCP Transfer","text":"Field Description Host Destination SSH host Path Remote directory path Credentials SSH username and key or password Row limits Maximum rows per exported file"},{"location":"conductor/ui/exporters/#configuration-behavior","title":"Configuration Behavior","text":"<ul> <li>Exporter configurations are stored in the NATS KV EXPORTERS bucket</li> <li>Changes are picked up by artifact-exporter in real time</li> <li>Multiple exporters can be enabled simultaneously for parallel delivery</li> </ul> <p>Note</p> <p>Enabling multiple exporters sends the same artifacts to all active destinations. This is useful for sending data to both WitFoo Analytics and an external SIEM simultaneously.</p>"},{"location":"conductor/ui/exporters/#underlying-configuration","title":"Underlying Configuration","text":"<pre><code># List exporter configurations\ndocker exec broker-edge-svc nats kv ls EXPORTERS\n\n# View a specific exporter's configuration\ndocker exec broker-edge-svc nats kv get EXPORTERS splunk-hec\n</code></pre>"},{"location":"conductor/ui/integrations/","title":"Integration Management","text":"<p>The Integration Management page configures pull-based API integrations for cloud and security platform log collection.</p> <p>URL: <code>/admin/settings/integrations</code></p>"},{"location":"conductor/ui/integrations/#supported-integrations","title":"Supported Integrations","text":"<p>Conductor supports 19 API-based integrations organized by vendor:</p> Vendor Integrations Microsoft Azure Security, Defender, Sentinel, Entra ID, Office 365 Cisco AMP, Duo, Meraki, Umbrella CrowdStrike Falcon Palo Alto Cortex Proofpoint CASB, Protect Deep Instinct Deep Instinct Druva Druva LimaCharlie LimaCharlie Mimecast Mimecast Netskope Netskope Okta Okta Splunk Splunk Cisco Stealthwatch Tenable Tenable DNS DNS Zone Transfer"},{"location":"conductor/ui/integrations/#per-integration-configuration","title":"Per-Integration Configuration","text":"<p>Each integration requires vendor-specific credentials and settings:</p> Field Description Used By API Key / Token Primary authentication credential Most integrations Client ID OAuth2 client identifier Microsoft, CrowdStrike Client Secret OAuth2 client secret Microsoft, CrowdStrike Tenant ID Multi-tenant identifier Microsoft integrations Polling Interval How frequently to check for new data All integrations Enable/Disable Toggle to activate or deactivate All integrations"},{"location":"conductor/ui/integrations/#interface","title":"Interface","text":"<p>Each integration is displayed as a card or row with:</p> <ul> <li>Integration name and vendor \u2014 Identifies the source platform</li> <li>Status indicator \u2014 Shows whether the integration is active and collecting data</li> <li>Error tracking \u2014 Displays recent errors (authentication failures, timeouts, etc.)</li> <li>Configuration form \u2014 Credential fields and polling interval settings</li> <li>Enable/disable toggle \u2014 Independently activate each integration</li> </ul>"},{"location":"conductor/ui/integrations/#configuration-behavior","title":"Configuration Behavior","text":"<ul> <li>Integration configurations are stored in the NATS KV INTEGRATIONS bucket</li> <li>Changes are picked up by signal-client in real time</li> <li>Credentials are stored securely and are only accessible to the signal-client service</li> </ul> <p>Warning</p> <p>Ensure API credentials have the minimum required permissions for log retrieval. Test credentials before enabling an integration in production to avoid authentication error floods in the logs.</p>"},{"location":"conductor/ui/integrations/#underlying-configuration","title":"Underlying Configuration","text":"<pre><code># List integration configurations\ndocker exec broker-edge-svc nats kv ls INTEGRATIONS\n\n# View a specific integration's configuration\ndocker exec broker-edge-svc nats kv get INTEGRATIONS okta\n</code></pre>"},{"location":"conductor/ui/log-servers/","title":"Log Server Configuration","text":"<p>The Log Server Configuration page manages push-based log ingestion listeners on the signal-server service.</p> <p>URL: <code>/admin/settings/log-servers</code></p>"},{"location":"conductor/ui/log-servers/#log-server-connectors","title":"Log Server Connectors","text":"Connector Port Protocol Description Syslog UDP 514 UDP Standard syslog over UDP \u2014 highest throughput, commonly used for network devices Syslog TCP 514 TCP Standard syslog over TCP \u2014 reliable delivery with connection tracking Secure Syslog TLS 6514 TCP/TLS Encrypted syslog \u2014 TLS-wrapped transport for secure log delivery Beats/Logstash 5044-5045 TCP Elastic Beats protocol \u2014 receives data from Filebeat, Winlogbeat, and other Beats agents"},{"location":"conductor/ui/log-servers/#interface","title":"Interface","text":"<p>Each log server connector is displayed with:</p> <ul> <li>Connector name and protocol \u2014 Identifies the listener type</li> <li>Port number \u2014 The network port the listener binds to</li> <li>Enable/disable toggle \u2014 Independently activate each listener</li> <li>Masquerading options \u2014 Protocol conversion settings for non-standard log formats</li> </ul>"},{"location":"conductor/ui/log-servers/#enabledisable-toggles","title":"Enable/Disable Toggles","text":"<p>Each listener can be independently enabled or disabled. Disabling a listener stops the signal-server from accepting connections on that port.</p> <p>Note</p> <p>Disabling a listener does not close existing connections immediately. Active TCP connections will complete their current transmission before the listener stops accepting new connections.</p>"},{"location":"conductor/ui/log-servers/#masquerading-options","title":"Masquerading Options","text":"<p>Masquerading allows a listener to accept data in one format and convert it to another before publishing to the pipeline. This is useful when:</p> <ul> <li>Source devices send non-standard syslog formats</li> <li>Protocol conversion is needed between the source and the pipeline</li> <li>Custom header injection is required for downstream parser matching</li> </ul>"},{"location":"conductor/ui/log-servers/#configuration-behavior","title":"Configuration Behavior","text":"<ul> <li>Log server configurations are stored in the NATS KV SERVERS bucket</li> <li>Changes are picked up by signal-server in real time</li> <li>The signal-server container requires the <code>NET_BIND_SERVICE</code> capability for ports below 1024</li> </ul>"},{"location":"conductor/ui/log-servers/#common-configurations","title":"Common Configurations","text":""},{"location":"conductor/ui/log-servers/#receiving-from-network-devices","title":"Receiving from Network Devices","text":"<p>Most firewalls, routers, and switches send syslog over UDP port 514. Enable the Syslog UDP connector:</p> <pre><code>Syslog UDP: Enabled\nPort: 514\n</code></pre>"},{"location":"conductor/ui/log-servers/#receiving-from-elastic-beats-agents","title":"Receiving from Elastic Beats Agents","text":"<p>For endpoints running Filebeat or Winlogbeat, enable the Beats/Logstash connector:</p> <pre><code>Beats/Logstash: Enabled\nPorts: 5044-5045\n</code></pre>"},{"location":"conductor/ui/log-servers/#encrypted-syslog-from-remote-sites","title":"Encrypted Syslog from Remote Sites","text":"<p>For log sources traversing untrusted networks, enable Secure Syslog TLS:</p> <pre><code>Secure Syslog TLS: Enabled\nPort: 6514\n</code></pre> <p>Warning</p> <p>TLS syslog requires valid certificates configured on both the Conductor node and the sending device. See Configuration Reference for certificate paths.</p>"},{"location":"conductor/ui/log-servers/#underlying-configuration","title":"Underlying Configuration","text":"<pre><code># List log server configurations\ndocker exec broker-edge-svc nats kv ls SERVERS\n\n# View a specific server's configuration\ndocker exec broker-edge-svc nats kv get SERVERS syslog-udp\n</code></pre>"},{"location":"conductor/ui/notifications/","title":"Notifications","text":"<p>URL: <code>/admin/settings/notifications</code></p> <p>The Notifications page manages alerting channels and rules for Conductor system events. Configure email, Slack, and webhook destinations to receive automated alerts when pipeline issues occur.</p>"},{"location":"conductor/ui/notifications/#notification-channels","title":"Notification Channels","text":"<p>Channels define where notifications are delivered. Multiple channels can be active simultaneously.</p>"},{"location":"conductor/ui/notifications/#email-smtp","title":"Email (SMTP)","text":"Setting Description SMTP Host Mail server hostname SMTP Port Mail server port (25, 465, 587) Username SMTP authentication username Password SMTP authentication password From Address Sender email address From Name Sender display name TLS Mode None, StartTLS, or TLS (minimum TLS 1.2) Recipients Comma-separated email addresses"},{"location":"conductor/ui/notifications/#slack","title":"Slack","text":"Setting Description Webhook URL Slack incoming webhook URL Channel Target channel (e.g., <code>#alerts</code>) Username Bot display name"},{"location":"conductor/ui/notifications/#webhook","title":"Webhook","text":"Setting Description URL HTTP endpoint for notification delivery Method HTTP method (POST, PUT, PATCH) Auth Type None or Bearer token Auth Token Bearer token value (when auth type is Bearer) Headers Custom HTTP headers as key-value pairs <p>Testing Channels</p> <p>Click Test on any channel to send a test notification and verify connectivity before creating rules.</p>"},{"location":"conductor/ui/notifications/#notification-rules","title":"Notification Rules","text":"<p>Rules define which system events trigger notifications and to which channels they are routed.</p>"},{"location":"conductor/ui/notifications/#event-types","title":"Event Types","text":"Event Description <code>parser.failure</code> Signal parser encountered a processing error <code>exporter.failure</code> Artifact exporter failed to deliver to destination <code>system.capacity_warning</code> Pipeline approaching capacity limits <code>system.service_down</code> A Conductor service is unreachable <code>system.cert_expiring</code> TLS certificate nearing expiration <code>auth.failure</code> Authentication attempt failed <code>system.config_changed</code> System configuration was modified"},{"location":"conductor/ui/notifications/#rule-configuration","title":"Rule Configuration","text":"Field Description Name Human-readable rule name Description Purpose of the rule Event Types One or more events that trigger this rule Channels One or more channels to notify Cooldown Minimum minutes between repeated notifications (default: 15) Enabled Toggle rule on/off <p>Cooldown</p> <p>The cooldown period prevents notification storms. If the same rule fires multiple times within the cooldown window, only the first notification is sent. Subsequent events are recorded in the history as <code>skipped</code>.</p>"},{"location":"conductor/ui/notifications/#notification-history","title":"Notification History","text":"<p>The History tab displays a log of all notification attempts with:</p> Column Description Timestamp When the notification was attempted Event Type The triggering event Channel Target channel name Rule Rule that triggered the notification Status <code>sent</code>, <code>failed</code>, or <code>skipped</code> Message Event details or error message"},{"location":"conductor/ui/notifications/#api-endpoints","title":"API Endpoints","text":"<p>All endpoints require session authentication.</p> Method Endpoint Description <code>GET</code> <code>/api/v1/notifications/channels</code> List all channels <code>POST</code> <code>/api/v1/notifications/channels</code> Create a channel <code>GET</code> <code>/api/v1/notifications/channels/:id</code> Get channel by UUID <code>PUT</code> <code>/api/v1/notifications/channels/:id</code> Update a channel <code>DELETE</code> <code>/api/v1/notifications/channels/:id</code> Delete a channel <code>POST</code> <code>/api/v1/notifications/channels/:id/test</code> Send test notification <code>GET</code> <code>/api/v1/notifications/rules</code> List all rules <code>POST</code> <code>/api/v1/notifications/rules</code> Create a rule <code>GET</code> <code>/api/v1/notifications/rules/:id</code> Get rule by UUID <code>PUT</code> <code>/api/v1/notifications/rules/:id</code> Update a rule <code>DELETE</code> <code>/api/v1/notifications/rules/:id</code> Delete a rule <code>GET</code> <code>/api/v1/notifications/history</code> List notification history <p>Sensitive Fields</p> <p>Channel credentials (passwords, tokens, webhook URLs) are redacted in API responses. To update credentials, include the new value in the PUT request body.</p>"},{"location":"conductor/ui/parsers/","title":"Parser Management","text":"<p>The Parser Management page allows you to enable and disable the 200+ log parsers included with Conductor.</p> <p>URL: <code>/admin/settings/processors</code></p>"},{"location":"conductor/ui/parsers/#interface","title":"Interface","text":""},{"location":"conductor/ui/parsers/#master-switch","title":"Master Switch","text":"<p>A master toggle at the top of the page enables or disables all parsers simultaneously. This is useful for:</p> <ul> <li>Quickly disabling all parsing during maintenance</li> <li>Re-enabling all parsers after a bulk configuration change</li> </ul>"},{"location":"conductor/ui/parsers/#individual-parser-toggles","title":"Individual Parser Toggles","text":"<p>Each parser is listed with a checkbox toggle for independent enable/disable control. Parsers are organized by category for easy navigation.</p> Control Description Parser name Vendor-product identifier (e.g., <code>cisco-asa</code>, <code>crowdstrike-falcon</code>) Category Parser category (firewall, IDS/IPS, authentication, etc.) Enable/Disable Checkbox toggle to activate or deactivate the parser"},{"location":"conductor/ui/parsers/#configuration-behavior","title":"Configuration Behavior","text":"<ul> <li>Settings preserved \u2014 Disabling a parser preserves its configuration. Re-enabling restores the previous settings.</li> <li>Real-time updates \u2014 Parser state changes are written to the NATS KV PARSERS bucket and picked up by signal-parser in real time. No service restart is required.</li> <li>Race condition guard \u2014 The UI includes a guard against rapid clicks to prevent configuration race conditions.</li> </ul> <p>Note</p> <p>When toggling parsers, allow a moment for the configuration to propagate to the signal-parser service. The NATS KV watcher delivers updates within milliseconds, but rapid toggling may cause temporary inconsistencies.</p>"},{"location":"conductor/ui/parsers/#recommendations","title":"Recommendations","text":"<ul> <li>Disable unused parsers \u2014 While the fingerprint early-exit optimization minimizes performance impact, disabling parsers for log sources not in your environment reduces <code>artifacts.unknown</code> noise.</li> <li>Monitor unknown messages \u2014 After enabling new log sources, check the dashboard Pipeline tab for <code>artifacts.unknown</code> volume. High unknown counts indicate missing or misconfigured parsers.</li> <li>Use the master switch carefully \u2014 Disabling all parsers stops all artifact production. The pipeline will continue ingesting raw messages, but nothing will be parsed or exported.</li> </ul>"},{"location":"conductor/ui/parsers/#underlying-configuration","title":"Underlying Configuration","text":"<p>Parser state is stored in the NATS KV PARSERS bucket on broker-edge. Each parser has a key-value entry containing its enabled state and any parser-specific settings.</p> <pre><code># List parser configurations\ndocker exec broker-edge-svc nats kv ls PARSERS\n\n# View a specific parser's configuration\ndocker exec broker-edge-svc nats kv get PARSERS cisco-asa\n</code></pre>"},{"location":"conductor/ui/users/","title":"User Management &amp; Authentication","text":"<p>The User Management page allows administrators to create, edit, and manage user accounts for the Conductor UI.</p> <p>URL: <code>/admin/users</code></p>"},{"location":"conductor/ui/users/#user-management","title":"User Management","text":""},{"location":"conductor/ui/users/#creating-users","title":"Creating Users","text":"<p>To create a new user, provide:</p> Field Description Email User's email address (used as login identifier) Display Name User's display name shown in the UI Role User role assignment (administrator or standard user)"},{"location":"conductor/ui/users/#editing-users","title":"Editing Users","text":"<p>Administrators can edit the following fields for existing users:</p> <ul> <li>Display name</li> <li>Email address</li> <li>Role assignment</li> </ul>"},{"location":"conductor/ui/users/#deactivating-and-reactivating-users","title":"Deactivating and Reactivating Users","text":"<p>Users are soft-deleted (deactivated) rather than permanently removed. Deactivated users cannot log in but their accounts can be reactivated.</p> <p>The User Management page has two tabs:</p> Tab Description Active Users Currently active user accounts with separate pagination Inactive Users Deactivated user accounts that can be reactivated"},{"location":"conductor/ui/users/#authentication-modes","title":"Authentication Modes","text":"<p>Conductor UI supports three authentication modes:</p> Mode Description Local only Authentication against the local user database LDAP only Authentication against an external LDAP/Active Directory server Mixed LDAP authentication with local fallback (LDAP + local) <p>Default Credentials</p> <p>The default administrator account is:</p> <ul> <li>Email: <code>admin@witfoo.com</code></li> <li>Password: <code>F00theN0ise!</code></li> </ul> <p>Change this password immediately after first login.</p>"},{"location":"conductor/ui/users/#account-settings","title":"Account Settings","text":"<p>Users can manage their own account at <code>/account</code>:</p> Setting Description Profile editing Update display name and email Password change Change current password (requires current password confirmation)"},{"location":"conductor/ui/users/#session-management","title":"Session Management","text":"<p>User sessions are managed via encrypted cookies. Sessions expire after a configurable inactivity period.</p> Property Description Session storage Encrypted cookies Session expiry Configurable inactivity timeout Concurrent sessions Multiple sessions allowed per user"},{"location":"console/","title":"WitFoo Console Overview","text":"<p>WitFoo Console v0.9.1 is the central management console for the WitFoo Analytics platform, purpose-built for Managed Security Service Providers (MSSPs) operating multi-tenant security deployments. Console provides a unified web interface for managing organizations, nodes, users, and system configuration across your entire WitFoo infrastructure.</p>"},{"location":"console/#role-in-the-witfoo-platform","title":"Role in the WitFoo Platform","text":"<p>Console serves as the administrative control plane for MSSP operators. While WitFoo Conductor and Analytics appliances handle data collection and security analysis, Console provides the management layer that ties everything together:</p> <pre><code>graph TD\n    A[WitFoo Console] --&gt;|Manages| B[Organization A]\n    A --&gt;|Manages| C[Organization B]\n    A --&gt;|Manages| D[Organization C]\n    B --&gt; E[Conductor Node]\n    B --&gt; F[Analytics Node]\n    C --&gt; G[Conductor Node]\n    C --&gt; H[Analytics Node]\n    D --&gt; I[Conductor Node]\n    D --&gt; J[Analytics Node]</code></pre>"},{"location":"console/#mssp-management-capabilities","title":"MSSP Management Capabilities","text":"Capability Description Organization Management Create and manage customer organizations with full tenant isolation Node Management Register, configure, and monitor WitFoo Conductor and Analytics nodes User Management Manage user accounts, roles, and permissions with RBAC System Configuration Configure system-wide settings, integrations, and preferences"},{"location":"console/#architecture-overview","title":"Architecture Overview","text":"<p>Console follows a modern web application architecture with a Go/Echo backend serving a SvelteKit static frontend:</p> <ul> <li>The backend exposes a RESTful JSON API under the <code>/api</code> prefix and serves the pre-built frontend as static assets</li> <li>The frontend is compiled to static files using SvelteKit's static adapter, providing a responsive single-page application</li> <li>An embedded SQLite database provides local data persistence with zero external dependencies</li> </ul>"},{"location":"console/#technology-stack","title":"Technology Stack","text":"Layer Technology Backend Language Go 1.24+ Web Framework Echo Database SQLite (embedded) Frontend Framework SvelteKit with static adapter UI Component Library Carbon Components Svelte (Carbon Design System) Frontend Language TypeScript Charting Carbon Charts Deployment Docker with docker-compose"},{"location":"console/#key-features","title":"Key Features","text":"<ul> <li>Multi-Tenant Isolation \u2014 Each customer organization operates in a fully isolated context</li> <li>Zero-Dependency Database \u2014 Embedded SQLite eliminates external database infrastructure</li> <li>Minimal Container Footprint \u2014 Scratch-based Docker image at approximately 30 MB</li> <li>Automatic Initialization \u2014 Database migrations, default organization, and admin user creation on first launch</li> <li>Health Monitoring \u2014 Built-in health check endpoint for container orchestration</li> <li>Session Security \u2014 Configurable session encryption with hex-encoded secret keys</li> </ul> <p>Default Credentials</p> <p>On first launch, Console creates a default admin account:</p> <ul> <li>Username: <code>admin</code></li> <li>Password: <code>F00theN0ise!</code> (or custom value from <code>data/.passwd</code>)</li> </ul> <p>Change the default password immediately in production environments.</p>"},{"location":"console/#api-endpoints-summary","title":"API Endpoints Summary","text":"<p>Console exposes the following core API endpoints:</p> Method Endpoint Description <code>POST</code> <code>/api/login</code> User authentication <code>GET</code> <code>/api/auth/me</code> Current user info <code>POST</code> <code>/api/auth/logout</code> Logout <code>GET</code> <code>/api/organizations</code> List organizations <code>POST</code> <code>/api/organizations</code> Create organization <code>GET</code> <code>/api/nodes</code> List nodes <code>POST</code> <code>/api/nodes</code> Register node <code>GET</code> <code>/api/users</code> List users <code>POST</code> <code>/api/users</code> Create user <code>GET</code> <code>/api/health</code> Health check"},{"location":"console/architecture/","title":"Architecture &amp; Technology","text":"<p>WitFoo Console is built as a self-contained web application combining a Go backend API server with a pre-compiled SvelteKit frontend. This architecture minimizes operational complexity while providing a modern, responsive management interface.</p>"},{"location":"console/architecture/#system-architecture","title":"System Architecture","text":"<pre><code>graph LR\n    subgraph \"WitFoo Console Container\"\n        A[Echo HTTP Server :8000] --&gt; B[API Handlers /api/*]\n        A --&gt; C[Static File Server /]\n        B --&gt; D[(SQLite Database&lt;br/&gt;data/console.db)]\n        C --&gt; E[SvelteKit Static Files&lt;br/&gt;static/]\n    end\n    F[Browser] --&gt;|HTTP/HTTPS| A\n    G[Reverse Proxy / LB] --&gt;|HTTP| A\n    H[WitFoo Nodes] --&gt;|WebSocket + REST| B</code></pre>"},{"location":"console/architecture/#backend-architecture","title":"Backend Architecture","text":"<p>The backend is written in Go 1.24+ using the Echo web framework, providing a high-performance HTTP server with minimal resource consumption.</p>"},{"location":"console/architecture/#key-components","title":"Key Components","text":"Component Location Purpose Server Entry Point <code>cmd/server/main.go</code> Application bootstrap and server initialization Web Server Setup <code>cmd/server/web/</code> Echo router configuration, middleware, route registration HTTP Handlers <code>internal/handlers/</code> Request handling for all API endpoints Domain Models <code>internal/domain/</code> Business logic interfaces and domain types Data Models <code>internal/models/</code> Database-mapped data structures Storage Layer <code>internal/storage/</code> SQLite database operations and queries Configuration <code>internal/conf/</code> Application configuration management Embedded Assets <code>internal/assets/</code> Embedded static asset references"},{"location":"console/architecture/#api-design","title":"API Design","text":"<p>All API endpoints are served under the <code>/api</code> prefix and follow RESTful conventions:</p> <ul> <li>Content Type: <code>application/json</code> for all request and response bodies</li> <li>Authentication: Session-based with encrypted cookies</li> <li>Error Responses: Structured JSON error objects with appropriate HTTP status codes</li> </ul>"},{"location":"console/architecture/#graceful-shutdown","title":"Graceful Shutdown","text":"<p>The server implements a graceful shutdown with a 5-second timeout, ensuring in-flight requests complete before the process exits.</p>"},{"location":"console/architecture/#frontend-architecture","title":"Frontend Architecture","text":"<p>The frontend is built with SvelteKit using the static adapter, which pre-renders the application into static HTML, CSS, and JavaScript files at build time.</p>"},{"location":"console/architecture/#technology-choices","title":"Technology Choices","text":"Technology Purpose SvelteKit Application framework with file-based routing Static Adapter Compiles to static files served by Go backend TypeScript Type-safe frontend development Carbon Components Svelte IBM Carbon Design System UI components Carbon Charts Data visualization and charting SCSS Stylesheet preprocessing with Carbon tokens Svelte 5 Runes Reactive state management (<code>$state</code>, <code>$derived</code>, <code>$effect</code>)"},{"location":"console/architecture/#route-structure","title":"Route Structure","text":"<pre><code>frontend/src/routes/\n\u251c\u2500\u2500 +layout.svelte            # Root layout with navigation\n\u251c\u2500\u2500 +layout.ts                # Layout data loading\n\u251c\u2500\u2500 +page.ts                  # Dashboard / home page\n\u251c\u2500\u2500 auth/login/+page.svelte   # Login page\n\u251c\u2500\u2500 organizations/+page.svelte # Organization management\n\u251c\u2500\u2500 nodes/+page.svelte        # Node listing\n\u251c\u2500\u2500 nodes/[uuid]/+page.svelte # Node detail view\n\u251c\u2500\u2500 nodes/[uuid]/+page.ts     # Node detail data loading\n\u251c\u2500\u2500 users/+page.svelte        # User management\n\u251c\u2500\u2500 account/+page.svelte      # Current user account settings\n\u2514\u2500\u2500 unauthorized/+page.svelte # Access denied page\n</code></pre>"},{"location":"console/architecture/#api-proxy-development","title":"API Proxy (Development)","text":"<p>During development, the SvelteKit dev server at <code>:5173</code> proxies all <code>/api</code> requests to the Go backend at <code>:8000</code>, enabling hot-reload for frontend changes while using the real API.</p>"},{"location":"console/architecture/#database","title":"Database","text":"<p>Console uses SQLite as an embedded database, stored at <code>data/console.db</code>. This eliminates the need for external database infrastructure.</p> <ul> <li>Automatic Creation: The database file is created on first launch</li> <li>Migrations: Schema migrations run automatically at startup</li> <li>Session Storage: User sessions are persisted in SQLite</li> <li>Backup: Back up the <code>data/</code> directory to preserve all application state</li> </ul> <p>Important</p> <p>SQLite is designed for single-instance deployments. Do not run multiple Console instances against the same database file.</p>"},{"location":"console/architecture/#authentication-flow","title":"Authentication Flow","text":"<pre><code>sequenceDiagram\n    participant Browser\n    participant Console API\n    participant SQLite\n\n    Browser-&gt;&gt;Console API: POST /api/login {username, password}\n    Console API-&gt;&gt;SQLite: Validate credentials\n    SQLite--&gt;&gt;Console API: User record\n    Console API--&gt;&gt;Browser: Set-Cookie (encrypted session)\n    Browser-&gt;&gt;Console API: GET /api/auth/me (with cookie)\n    Console API-&gt;&gt;SQLite: Lookup session\n    Console API--&gt;&gt;Browser: {user, role, organization}</code></pre>"},{"location":"console/architecture/#session-management","title":"Session Management","text":"<ul> <li>Sessions are encrypted using a configurable <code>SECRET_KEY</code> (64-byte hex-encoded string)</li> <li>Session data is stored in the SQLite database</li> <li>The <code>POST /api/auth/logout</code> endpoint invalidates the current session</li> </ul> <p>Important</p> <p>In production, always set a unique <code>SECRET_KEY</code> environment variable. The default key is intended for development only.</p>"},{"location":"console/architecture/#static-asset-serving","title":"Static Asset Serving","text":"<p>The Go backend serves the pre-built SvelteKit files from the <code>static/</code> directory. Both the server binary and the <code>static/</code> directory must be co-located in the same working directory at runtime.</p>"},{"location":"console/architecture/#docker-deployment-model","title":"Docker Deployment Model","text":"<p>The production Docker image is built from a <code>scratch</code> base, containing only:</p> <ul> <li><code>/server</code> \u2014 Statically compiled Go binary (CGO disabled)</li> <li><code>/static/</code> \u2014 Pre-built SvelteKit frontend assets</li> <li>Total image size: ~30 MB</li> </ul> <p>The <code>/data</code> directory is expected to be mounted as a volume for persistent storage.</p>"},{"location":"console/configuration/","title":"System Configuration","text":"<p>WitFoo Console provides system-wide configuration options that control platform behavior, security settings, and integration with other WitFoo components. System configuration is accessible only to users with the Admin role.</p>"},{"location":"console/configuration/#configuration-hierarchy","title":"Configuration Hierarchy","text":"<pre><code>graph TD\n    A[System Configuration&lt;br/&gt;Global settings] --&gt; B[Organization Configuration&lt;br/&gt;Per-tenant overrides]\n    B --&gt; C[Node Configuration&lt;br/&gt;Per-node settings]</code></pre> <p>System-level settings establish defaults that can be overridden at the organization or node level where applicable.</p>"},{"location":"console/configuration/#environment-variables","title":"Environment Variables","text":"<p>Console is configured primarily through environment variables and the embedded database. The following environment variables are supported:</p> Variable Required Default Description <code>SECRET_KEY</code> Yes (production) Development default 64-byte hex-encoded string for session encryption <code>PORT</code> No <code>8000</code> HTTP server listen port"},{"location":"console/configuration/#secret_key-generation","title":"SECRET_KEY Generation","text":"<p>Generate a cryptographically secure secret key for production deployments:</p> <pre><code>openssl rand -hex 32\n</code></pre> <p>Important</p> <p>The default secret key is intended for development only. Always set a unique <code>SECRET_KEY</code> in production. Changing the secret key invalidates all existing user sessions.</p>"},{"location":"console/configuration/#session-security","title":"Session Security","text":"<p>Console uses encrypted cookies for session management, backed by the SQLite database for session state persistence.</p> Setting Value Encryption AES using <code>SECRET_KEY</code> Storage SQLite <code>data/console.db</code> Transport HTTP cookies <p>For production deployments behind a TLS-terminating reverse proxy, ensure that your proxy sets appropriate headers (<code>X-Forwarded-Proto</code>, <code>X-Forwarded-For</code>) so that Console can enforce secure cookie policies.</p>"},{"location":"console/configuration/#network-and-connectivity","title":"Network and Connectivity","text":""},{"location":"console/configuration/#server-binding","title":"Server Binding","text":"<p>By default, Console listens on port <code>8000</code> on all interfaces. You can customize the bind address and port:</p> <pre><code># Listen on a specific interface and port\n./bin/server 0.0.0.0 8080\n</code></pre>"},{"location":"console/configuration/#websocket-support","title":"WebSocket Support","text":"<p>Console uses WebSocket connections for real-time node status updates. Ensure that any reverse proxy or load balancer in front of Console supports WebSocket upgrades:</p> <pre><code># Example nginx configuration\nlocation / {\n    proxy_pass http://console:8000;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection \"upgrade\";\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n    proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n    proxy_set_header X-Forwarded-Proto $scheme;\n}\n</code></pre>"},{"location":"console/configuration/#tlsssl-configuration","title":"TLS/SSL Configuration","text":"<p>Console itself does not terminate TLS connections. TLS termination should be handled by a reverse proxy (nginx, Caddy, HAProxy, or a cloud load balancer) in front of Console.</p> <p>TLS Architecture</p> <pre><code>Client \u2192 [HTTPS] \u2192 Reverse Proxy \u2192 [HTTP] \u2192 Console :8000\n</code></pre> <p>This design keeps the Console container simple and delegates certificate management to infrastructure components purpose-built for TLS.</p>"},{"location":"console/configuration/#recommended-tls-settings","title":"Recommended TLS Settings","text":"<p>When configuring your reverse proxy:</p> <ul> <li>Minimum TLS version: 1.2</li> <li>Preferred TLS version: 1.3</li> <li>Disable weak cipher suites</li> <li>Enable HSTS headers</li> <li>Use certificates from a trusted CA or Let's Encrypt</li> </ul>"},{"location":"console/configuration/#logging-and-audit","title":"Logging and Audit","text":"<p>Console logs operational events to standard output, making it compatible with Docker logging drivers and centralized log collection systems.</p>"},{"location":"console/configuration/#log-categories","title":"Log Categories","text":"Category Description HTTP Access All API requests with method, path, status code, and duration Authentication Login attempts, session creation, and logout events Administrative Actions Organization, node, and user CRUD operations System Events Startup, shutdown, database migrations, and health checks"},{"location":"console/configuration/#viewing-logs","title":"Viewing Logs","text":"<pre><code># Docker Compose\ndocker-compose logs -f console-ui\n\n# Docker\ndocker logs -f console-ui\n\n# Direct execution\n./bin/server  # Logs to stdout/stderr\n</code></pre>"},{"location":"console/configuration/#integration-with-witfoo-components","title":"Integration with WitFoo Components","text":"<p>Console integrates with other WitFoo platform components:</p>"},{"location":"console/configuration/#witfoo-conductor","title":"WitFoo Conductor","text":"<ul> <li>Console registers and manages Conductor nodes</li> <li>Conductor nodes report status via WebSocket heartbeats</li> <li>Configuration changes are pushed from Console to Conductor nodes</li> </ul>"},{"location":"console/configuration/#witfoo-analytics","title":"WitFoo Analytics","text":"<ul> <li>Console registers and manages Analytics appliance nodes</li> <li>Analytics nodes report processing status and health metrics</li> <li>Organization-scoped data routing is configured through Console</li> </ul>"},{"location":"console/configuration/#integration-architecture","title":"Integration Architecture","text":"<pre><code>graph LR\n    A[Console] &lt;--&gt;|REST + WebSocket| B[Conductor Nodes]\n    A &lt;--&gt;|REST + WebSocket| C[Analytics Nodes]\n    B --&gt;|Data Pipeline| C\n    A --&gt;|Configuration| B\n    A --&gt;|Configuration| C</code></pre>"},{"location":"console/configuration/#database-configuration","title":"Database Configuration","text":"<p>The SQLite database is stored at <code>data/console.db</code> relative to the server's working directory. Inside a Docker container, this maps to <code>/data/console.db</code>.</p> Setting Value Database Engine SQLite File Location <code>data/console.db</code> Migrations Automatic at startup Backup Strategy File-level copy of <code>data/</code> directory <p>Important</p> <p>Always stop the Console server before performing file-level database backups to avoid data corruption. Alternatively, use SQLite's <code>.backup</code> command for online backups.</p>"},{"location":"console/deployment/","title":"Deployment Guide","text":"<p>This guide covers deploying WitFoo Console v0.9.1 in production environments using Docker Compose, including configuration, TLS termination, health monitoring, and upgrade procedures.</p>"},{"location":"console/deployment/#prerequisites","title":"Prerequisites","text":"Requirement Minimum Version Docker 20.10+ Docker Compose 2.0+ Available Port 8000 (configurable) Disk Space 500 MB (application + data) Memory 256 MB RAM"},{"location":"console/deployment/#docker-compose-deployment","title":"Docker Compose Deployment","text":""},{"location":"console/deployment/#1-create-the-deployment-directory","title":"1. Create the Deployment Directory","text":"<pre><code>mkdir -p /opt/witfoo-console\ncd /opt/witfoo-console\n</code></pre>"},{"location":"console/deployment/#2-create-docker-composeyml","title":"2. Create docker-compose.yml","text":"<pre><code>version: '3.8'\n\nservices:\n  console-ui:\n    image: ghcr.io/witfoo-dev/console-ui:main\n    container_name: console-ui\n    ports:\n      - \"8000:8000\"\n    volumes:\n      - ./data:/data\n    environment:\n      - SECRET_KEY=&lt;your-64-byte-hex-encoded-secret&gt;\n    restart: unless-stopped\n    healthcheck:\n      test: [\"CMD\", \"wget\", \"--quiet\", \"--tries=1\", \"--spider\", \"http://localhost:8000/api/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 10s\n</code></pre>"},{"location":"console/deployment/#3-generate-a-secret-key","title":"3. Generate a Secret Key","text":"<pre><code>export SECRET_KEY=$(openssl rand -hex 32)\necho \"SECRET_KEY=${SECRET_KEY}\" &gt;&gt; .env\n</code></pre>"},{"location":"console/deployment/#4-set-a-custom-admin-password-optional","title":"4. Set a Custom Admin Password (Optional)","text":"<pre><code>mkdir -p data\necho \"YourSecureAdminPassword\" &gt; data/.passwd\n</code></pre>"},{"location":"console/deployment/#5-start-the-service","title":"5. Start the Service","text":"<pre><code>docker-compose up -d\n</code></pre>"},{"location":"console/deployment/#6-verify-deployment","title":"6. Verify Deployment","text":"<pre><code># Check container status\ndocker-compose ps\n\n# Check health\ncurl -s http://localhost:8000/api/health\n\n# View logs\ndocker-compose logs -f\n</code></pre> <p>Console is now accessible at <code>http://localhost:8000</code>.</p> <p>Important</p> <p>Change the default admin password immediately after first login. The default credentials are:</p> <ul> <li>Username: <code>admin</code></li> <li>Password: Value from <code>data/.passwd</code> or <code>F00theN0ise!</code></li> </ul>"},{"location":"console/deployment/#environment-variables","title":"Environment Variables","text":"Variable Required Default Description <code>SECRET_KEY</code> Yes (production) Development default 64-byte hex-encoded session encryption key <p>Create a <code>.env</code> file alongside <code>docker-compose.yml</code> for environment variable management:</p> <pre><code>SECRET_KEY=a1b2c3d4e5f6...  # output of openssl rand -hex 32\n</code></pre>"},{"location":"console/deployment/#database-initialization-and-migration","title":"Database Initialization and Migration","text":"<p>Console handles database lifecycle automatically:</p> <pre><code>flowchart TD\n    A[Server Starts] --&gt; B{data/ directory exists?}\n    B --&gt;|No| C[Create data/ directory]\n    B --&gt;|Yes| D{console.db exists?}\n    C --&gt; D\n    D --&gt;|No| E[Create console.db]\n    D --&gt;|Yes| F[Run migrations]\n    E --&gt; F\n    F --&gt; G{Users exist?}\n    G --&gt;|No| H[Create default admin user&lt;br/&gt;Create mssp-admin org]\n    G --&gt;|Yes| I[Server ready]\n    H --&gt; I</code></pre> <ul> <li>Database file: <code>data/console.db</code></li> <li>Migrations: Applied automatically on every startup</li> <li>Default organization: <code>mssp-admin</code> created on first launch</li> <li>Default user: <code>admin</code> with password from <code>data/.passwd</code> or <code>F00theN0ise!</code></li> </ul> <p>Data Persistence</p> <p>The <code>data/</code> directory must be mounted as a Docker volume to persist data across container restarts. Without a volume mount, all data is lost when the container is removed.</p>"},{"location":"console/deployment/#reverse-proxy-and-tls-termination","title":"Reverse Proxy and TLS Termination","text":"<p>For production deployments, place Console behind a TLS-terminating reverse proxy.</p>"},{"location":"console/deployment/#nginx-example","title":"Nginx Example","text":"<pre><code>server {\n    listen 443 ssl http2;\n    server_name console.example.com;\n\n    ssl_certificate     /etc/ssl/certs/console.example.com.pem;\n    ssl_certificate_key /etc/ssl/private/console.example.com.key;\n    ssl_protocols       TLSv1.2 TLSv1.3;\n\n    location / {\n        proxy_pass http://127.0.0.1:8000;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection \"upgrade\";\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\nserver {\n    listen 80;\n    server_name console.example.com;\n    return 301 https://$host$request_uri;\n}\n</code></pre> <p>Important</p> <p>WebSocket support is required for real-time node status updates. Ensure your reverse proxy configuration includes the <code>Upgrade</code> and <code>Connection</code> headers as shown above.</p>"},{"location":"console/deployment/#caddy-example","title":"Caddy Example","text":"<pre><code>console.example.com {\n    reverse_proxy localhost:8000\n}\n</code></pre> <p>Caddy automatically provisions TLS certificates via Let's Encrypt.</p>"},{"location":"console/deployment/#health-check-endpoint","title":"Health Check Endpoint","text":"<p>Console exposes a health check endpoint for container orchestration and monitoring:</p> <pre><code>GET /api/health\n</code></pre> <p>Healthy Response: <code>200 OK</code></p> <p>The Docker Compose health check is configured to poll this endpoint every 30 seconds with a 10-second timeout and 3 retries after a 10-second startup grace period.</p>"},{"location":"console/deployment/#monitoring-integration","title":"Monitoring Integration","text":"<p>Use the health endpoint with external monitoring systems:</p> <pre><code># Nagios/Icinga check\ncurl -sf http://console:8000/api/health || exit 2\n\n# Prometheus blackbox exporter target\n- targets:\n  - http://console:8000/api/health\n</code></pre>"},{"location":"console/deployment/#upgrading","title":"Upgrading","text":""},{"location":"console/deployment/#standard-upgrade-procedure","title":"Standard Upgrade Procedure","text":"<ol> <li> <p>Back up the database:</p> <pre><code>docker-compose stop\ncp -r data/ data-backup-$(date +%Y%m%d)/\n</code></pre> </li> <li> <p>Pull the new image:</p> <pre><code>docker-compose pull\n</code></pre> </li> <li> <p>Start the updated service:</p> <pre><code>docker-compose up -d\n</code></pre> </li> <li> <p>Verify the upgrade:</p> <pre><code>docker-compose logs -f\ncurl -s http://localhost:8000/api/health\n</code></pre> </li> <li> <p>Test functionality:</p> <ul> <li>Log in to the Console UI</li> <li>Verify organizations, nodes, and users are intact</li> <li>Confirm node connectivity</li> </ul> </li> </ol>"},{"location":"console/deployment/#rollback-procedure","title":"Rollback Procedure","text":"<p>If an upgrade fails:</p> <pre><code># Stop the current version\ndocker-compose down\n\n# Restore the database backup\nrm -rf data/\ncp -r data-backup-YYYYMMDD/ data/\n\n# Pin the previous image version in docker-compose.yml\n# image: ghcr.io/witfoo-dev/console-ui:previous-branch\n\n# Start the previous version\ndocker-compose up -d\n</code></pre> <p>Important</p> <p>Database migrations may not be reversible. Always back up the <code>data/</code> directory before upgrading.</p>"},{"location":"console/deployment/#maintenance-procedures","title":"Maintenance Procedures","text":""},{"location":"console/deployment/#database-backup","title":"Database Backup","text":"<pre><code># Stop the service for a consistent backup\ndocker-compose stop\ncp data/console.db data/console.db.backup\ndocker-compose start\n\n# Or use sqlite3 for online backup (if available)\nsqlite3 data/console.db \".backup data/console.db.backup\"\n</code></pre>"},{"location":"console/deployment/#log-management","title":"Log Management","text":"<p>Console logs to stdout/stderr. Configure Docker's logging driver for log rotation:</p> <pre><code>services:\n  console-ui:\n    logging:\n      driver: json-file\n      options:\n        max-size: \"10m\"\n        max-file: \"3\"\n</code></pre>"},{"location":"console/deployment/#container-resource-limits","title":"Container Resource Limits","text":"<p>For production deployments, set resource limits:</p> <pre><code>services:\n  console-ui:\n    deploy:\n      resources:\n        limits:\n          memory: 512M\n          cpus: '1.0'\n        reservations:\n          memory: 128M\n          cpus: '0.25'\n</code></pre>"},{"location":"console/nodes/","title":"Node Management","text":"<p>WitFoo Console provides centralized management for all WitFoo nodes deployed across your MSSP infrastructure. Nodes are the distributed components that perform data collection, log analysis, and security analytics for each customer organization.</p>"},{"location":"console/nodes/#node-types","title":"Node Types","text":"<p>WitFoo deployments consist of two primary node types:</p> Node Type Role Description Conductor Data Collection Collects, normalizes, and forwards security telemetry from customer environments Analytics Analysis &amp; Detection Processes collected data, runs detection rules, and generates security findings <pre><code>graph LR\n    A[WitFoo Console] --&gt;|Manages| B[Conductor Node]\n    A --&gt;|Manages| C[Analytics Node]\n    B --&gt;|Forwards Data| C\n    C --&gt;|Reports Status| A\n    B --&gt;|Reports Status| A</code></pre>"},{"location":"console/nodes/#registering-a-node","title":"Registering a Node","text":"<p>New nodes must be registered with Console before they can participate in the WitFoo platform.</p> <p>Step-by-step:</p> <ol> <li>Log in to Console as an administrator</li> <li>Navigate to Nodes in the left navigation</li> <li>Click Register Node</li> <li>Enter the node details:<ul> <li>Name \u2014 A descriptive name for the node</li> <li>Type \u2014 Conductor or Analytics</li> <li>Organization \u2014 The customer organization this node serves</li> <li>Address \u2014 The node's network address</li> </ul> </li> <li>Click Save</li> </ol>"},{"location":"console/nodes/#api-reference","title":"API Reference","text":""},{"location":"console/nodes/#list-nodes","title":"List Nodes","text":"<pre><code>GET /api/nodes\n</code></pre> <p>Response: <pre><code>[\n  {\n    \"uuid\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n    \"name\": \"acme-conductor-01\",\n    \"type\": \"conductor\",\n    \"organization_uuid\": \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\",\n    \"status\": \"online\",\n    \"last_heartbeat\": \"2025-01-20T14:30:00Z\"\n  }\n]\n</code></pre></p>"},{"location":"console/nodes/#register-node","title":"Register Node","text":"<pre><code>POST /api/nodes\nContent-Type: application/json\n</code></pre> <p>Request Body: <pre><code>{\n  \"name\": \"acme-conductor-01\",\n  \"type\": \"conductor\",\n  \"organization_uuid\": \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\",\n  \"address\": \"10.0.1.50\"\n}\n</code></pre></p> <p>Response: <code>201 Created</code> <pre><code>{\n  \"uuid\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"name\": \"acme-conductor-01\",\n  \"type\": \"conductor\",\n  \"organization_uuid\": \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\",\n  \"status\": \"registered\",\n  \"address\": \"10.0.1.50\",\n  \"created_at\": \"2025-01-20T14:00:00Z\"\n}\n</code></pre></p>"},{"location":"console/nodes/#view-node-detail","title":"View Node Detail","text":"<pre><code>GET /api/nodes/:uuid\n</code></pre> <p>Navigate to a specific node's detail page at <code>/nodes/{uuid}</code> in the Console UI to view comprehensive status, configuration, and health information.</p>"},{"location":"console/nodes/#node-status-monitoring","title":"Node Status Monitoring","text":"<p>Console tracks node health through periodic heartbeat messages. Nodes report their status via WebSocket connections and REST API calls.</p>"},{"location":"console/nodes/#status-values","title":"Status Values","text":"Status Description <code>registered</code> Node has been registered but has not yet connected <code>online</code> Node is connected and reporting healthy heartbeats <code>degraded</code> Node is connected but reporting issues <code>offline</code> Node has not sent a heartbeat within the expected interval"},{"location":"console/nodes/#health-check-flow","title":"Health Check Flow","text":"<pre><code>sequenceDiagram\n    participant Node\n    participant Console\n\n    loop Every heartbeat interval\n        Node-&gt;&gt;Console: WebSocket heartbeat / status report\n        Console-&gt;&gt;Console: Update node status + last_heartbeat\n    end\n\n    Note over Console: If no heartbeat received&lt;br/&gt;within threshold \u2192 mark offline</code></pre> <p>WebSocket Connectivity</p> <p>Nodes maintain persistent WebSocket connections to Console for real-time status reporting and event delivery. Ensure that network firewalls and reverse proxies allow WebSocket upgrades on the Console port.</p>"},{"location":"console/nodes/#configuration-management","title":"Configuration Management","text":"<p>Each node's configuration can be managed centrally from Console:</p> <ol> <li>Navigate to Nodes</li> <li>Click on the node name to open its detail view at <code>/nodes/{uuid}</code></li> <li>Review and modify configuration parameters</li> <li>Save changes \u2014 the node will receive updated configuration on its next check-in</li> </ol>"},{"location":"console/nodes/#cross-organization-node-assignment","title":"Cross-Organization Node Assignment","text":"<p>In the MSSP model, each node is assigned to exactly one customer organization. MSSP administrators can:</p> <ul> <li>View all nodes across all organizations from the <code>mssp-admin</code> context</li> <li>Reassign nodes between organizations during customer onboarding or offboarding</li> <li>Monitor aggregate node health across the entire managed fleet</li> </ul> <p>Important</p> <p>Reassigning a node to a different organization may disrupt data collection for the original organization. Plan node reassignments during maintenance windows.</p>"},{"location":"console/nodes/#common-administrative-tasks","title":"Common Administrative Tasks","text":""},{"location":"console/nodes/#identifying-offline-nodes","title":"Identifying Offline Nodes","text":"<ol> <li>Navigate to Nodes</li> <li>Sort or filter by Status to identify nodes marked as <code>offline</code></li> <li>Investigate connectivity issues or restart the node service</li> </ol>"},{"location":"console/nodes/#viewing-node-details","title":"Viewing Node Details","text":"<ol> <li>Navigate to Nodes</li> <li>Click on any node row to open the detail view at <code>/nodes/{uuid}</code></li> <li>Review heartbeat history, configuration, and organization assignment</li> </ol>"},{"location":"console/organizations/","title":"Organization Management","text":"<p>Organizations are the foundational multi-tenant construct in WitFoo Console. Each organization represents a distinct customer or business unit in the MSSP model, providing complete data isolation and independent configuration.</p>"},{"location":"console/organizations/#mssp-multi-tenant-model","title":"MSSP Multi-Tenant Model","text":"<pre><code>graph TD\n    A[WitFoo Console] --&gt; B[mssp-admin&lt;br/&gt;Default MSSP Organization]\n    A --&gt; C[Customer Org A]\n    A --&gt; D[Customer Org B]\n    A --&gt; E[Customer Org N]\n    C --&gt; F[Nodes]\n    C --&gt; G[Users]\n    D --&gt; H[Nodes]\n    D --&gt; I[Users]</code></pre> <p>On first launch, Console automatically creates a default mssp-admin organization. This organization serves as the MSSP operator's administrative context and cannot be deleted.</p>"},{"location":"console/organizations/#organization-lifecycle","title":"Organization Lifecycle","text":""},{"location":"console/organizations/#1-provisioning","title":"1. Provisioning","text":"<p>Create a new customer organization to begin onboarding. Each organization receives a unique identifier and isolated configuration space.</p>"},{"location":"console/organizations/#2-configuration","title":"2. Configuration","text":"<p>Configure organization-specific settings including node assignments, user accounts, and operational parameters.</p>"},{"location":"console/organizations/#3-active-operations","title":"3. Active Operations","text":"<p>The organization is fully operational with assigned nodes collecting and analyzing security data.</p>"},{"location":"console/organizations/#4-deactivation","title":"4. Deactivation","text":"<p>When a customer relationship ends, deactivate the organization to disable access while preserving audit history.</p>"},{"location":"console/organizations/#creating-an-organization","title":"Creating an Organization","text":"<p>Step-by-step:</p> <ol> <li>Log in to Console as an MSSP administrator</li> <li>Navigate to Organizations in the left navigation</li> <li>Click Create Organization</li> <li>Enter the organization name and configuration details</li> <li>Click Save</li> </ol>"},{"location":"console/organizations/#api-reference","title":"API Reference","text":""},{"location":"console/organizations/#list-organizations","title":"List Organizations","text":"<pre><code>GET /api/organizations\n</code></pre> <p>Response: <pre><code>[\n  {\n    \"uuid\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"name\": \"mssp-admin\",\n    \"created_at\": \"2025-01-15T10:30:00Z\",\n    \"status\": \"active\"\n  },\n  {\n    \"uuid\": \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\",\n    \"name\": \"Acme Corporation\",\n    \"created_at\": \"2025-01-20T14:00:00Z\",\n    \"status\": \"active\"\n  }\n]\n</code></pre></p>"},{"location":"console/organizations/#create-organization","title":"Create Organization","text":"<pre><code>POST /api/organizations\nContent-Type: application/json\n</code></pre> <p>Request Body: <pre><code>{\n  \"name\": \"Acme Corporation\"\n}\n</code></pre></p> <p>Response: <code>201 Created</code> <pre><code>{\n  \"uuid\": \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\",\n  \"name\": \"Acme Corporation\",\n  \"created_at\": \"2025-01-20T14:00:00Z\",\n  \"status\": \"active\"\n}\n</code></pre></p>"},{"location":"console/organizations/#multi-tenant-data-isolation","title":"Multi-Tenant Data Isolation","text":"<p>WitFoo Console enforces strict tenant isolation at multiple levels:</p> Layer Isolation Mechanism API All requests are scoped to the authenticated user's organization context Database Organization UUID is a foreign key on all tenant-scoped records Nodes Each node is assigned to exactly one organization Users User accounts are scoped to their assigned organization UI The frontend filters all views by the current organization context <p>Important</p> <p>MSSP administrators operating in the <code>mssp-admin</code> organization have cross-tenant visibility. Ensure that only trusted operators are granted MSSP-level access.</p>"},{"location":"console/organizations/#organization-settings","title":"Organization Settings","text":"<p>Each organization supports the following configurable properties:</p> Setting Description Name Display name for the organization Status Active or deactivated Nodes Assigned WitFoo Conductor and Analytics nodes Users User accounts with organization-scoped access"},{"location":"console/organizations/#common-administrative-tasks","title":"Common Administrative Tasks","text":""},{"location":"console/organizations/#viewing-all-organizations","title":"Viewing All Organizations","text":"<p>Navigate to Organizations in the Console UI to see a table of all organizations with their status, node count, and user count.</p>"},{"location":"console/organizations/#editing-an-organization","title":"Editing an Organization","text":"<ol> <li>Navigate to Organizations</li> <li>Click on the organization name to open its detail view</li> <li>Modify settings as needed</li> <li>Click Save</li> </ol>"},{"location":"console/organizations/#deactivating-an-organization","title":"Deactivating an Organization","text":"<p>Deactivating an organization disables all user access and node communication for that tenant without deleting historical data.</p> <ol> <li>Navigate to Organizations</li> <li>Select the target organization</li> <li>Change the status to Deactivated</li> <li>Confirm the action</li> </ol> <p>Data Retention</p> <p>Deactivating an organization does not delete any data. All historical records, node configurations, and user accounts are preserved and can be reactivated if needed.</p>"},{"location":"console/users/","title":"User Management","text":"<p>WitFoo Console provides comprehensive user account management with role-based access control (RBAC) to ensure that operators, analysts, and administrators have appropriate access to platform resources.</p>"},{"location":"console/users/#user-account-model","title":"User Account Model","text":"<p>Every user account in Console is associated with:</p> <ul> <li>A unique username for authentication</li> <li>A role that determines access permissions</li> <li>An organization that scopes the user's visibility</li> </ul> <pre><code>graph TD\n    A[User Account] --&gt; B[Role]\n    A --&gt; C[Organization]\n    B --&gt; D[Permissions]\n    C --&gt; E[Scoped Resources:&lt;br/&gt;Nodes, Data, Settings]</code></pre>"},{"location":"console/users/#creating-a-user","title":"Creating a User","text":"<p>Step-by-step:</p> <ol> <li>Log in to Console as an administrator</li> <li>Navigate to Users in the left navigation</li> <li>Click Create User</li> <li>Complete the user form:<ul> <li>Username \u2014 Unique login identifier</li> <li>Password \u2014 Initial password (user should change on first login)</li> <li>Role \u2014 Select the appropriate access role</li> <li>Organization \u2014 Assign to a customer organization</li> </ul> </li> <li>Click Save</li> </ol>"},{"location":"console/users/#api-reference","title":"API Reference","text":""},{"location":"console/users/#list-users","title":"List Users","text":"<pre><code>GET /api/users\n</code></pre> <p>Response: <pre><code>[\n  {\n    \"uuid\": \"d4e5f6a7-b8c9-0123-4567-89abcdef0123\",\n    \"username\": \"admin\",\n    \"role\": \"admin\",\n    \"organization_uuid\": \"550e8400-e29b-41d4-a716-446655440000\",\n    \"created_at\": \"2025-01-15T10:30:00Z\",\n    \"status\": \"active\"\n  }\n]\n</code></pre></p>"},{"location":"console/users/#create-user","title":"Create User","text":"<pre><code>POST /api/users\nContent-Type: application/json\n</code></pre> <p>Request Body: <pre><code>{\n  \"username\": \"jsmith\",\n  \"password\": \"SecureP@ssw0rd!\",\n  \"role\": \"analyst\",\n  \"organization_uuid\": \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\"\n}\n</code></pre></p> <p>Response: <code>201 Created</code> <pre><code>{\n  \"uuid\": \"f1e2d3c4-b5a6-7890-1234-567890abcdef\",\n  \"username\": \"jsmith\",\n  \"role\": \"analyst\",\n  \"organization_uuid\": \"6ba7b810-9dad-11d1-80b4-00c04fd430c8\",\n  \"created_at\": \"2025-01-20T15:00:00Z\",\n  \"status\": \"active\"\n}\n</code></pre></p>"},{"location":"console/users/#role-based-access-control","title":"Role-Based Access Control","text":"<p>Console implements RBAC to control what actions users can perform and what data they can access.</p>"},{"location":"console/users/#roles","title":"Roles","text":"Role Scope Capabilities Admin MSSP-wide Full access to all organizations, nodes, users, and system configuration Org Admin Single organization Manage nodes and users within their assigned organization Analyst Single organization View nodes, dashboards, and security data; no administrative actions <p>Default Admin Account</p> <p>The initial <code>admin</code> user created on first launch has full MSSP-wide administrative privileges and belongs to the <code>mssp-admin</code> organization.</p>"},{"location":"console/users/#permission-matrix","title":"Permission Matrix","text":"Action Admin Org Admin Analyst View all organizations \u2705 \u274c \u274c Create organizations \u2705 \u274c \u274c Manage org nodes \u2705 \u2705 \u274c View org nodes \u2705 \u2705 \u2705 Manage org users \u2705 \u2705 \u274c View org users \u2705 \u2705 \u274c System configuration \u2705 \u274c \u274c View dashboards \u2705 \u2705 \u2705"},{"location":"console/users/#authentication-configuration","title":"Authentication Configuration","text":""},{"location":"console/users/#local-authentication","title":"Local Authentication","text":"<p>By default, Console uses local authentication with credentials stored in the embedded SQLite database. Passwords are hashed before storage.</p>"},{"location":"console/users/#authentication-flow","title":"Authentication Flow","text":"<pre><code>POST /api/login\nContent-Type: application/json\n</code></pre> <p>Request Body: <pre><code>{\n  \"username\": \"jsmith\",\n  \"password\": \"SecureP@ssw0rd!\"\n}\n</code></pre></p> <p>Success Response: <code>200 OK</code> with session cookie set.</p> <p>Failure Response: <code>401 Unauthorized</code></p>"},{"location":"console/users/#current-user-info","title":"Current User Info","text":"<pre><code>GET /api/auth/me\n</code></pre> <p>Returns the authenticated user's profile, role, and organization context. This endpoint is called by the frontend on page load to validate the session.</p>"},{"location":"console/users/#logout","title":"Logout","text":"<pre><code>POST /api/auth/logout\n</code></pre> <p>Invalidates the current session and clears the session cookie.</p>"},{"location":"console/users/#external-authentication","title":"External Authentication","text":"<p>Future Capability</p> <p>Support for LDAP and SAML authentication providers is planned for a future release. Contact the WitFoo development team for the current roadmap.</p>"},{"location":"console/users/#user-access-scoping","title":"User Access Scoping","text":"<p>All API requests are automatically scoped based on the authenticated user's organization and role:</p> <ul> <li>Admin users can specify an organization context to operate across tenants</li> <li>Org Admin and Analyst users are restricted to resources within their assigned organization</li> <li>The frontend enforces scoping in the UI, and the backend validates it on every API call</li> </ul>"},{"location":"console/users/#account-lifecycle","title":"Account Lifecycle","text":""},{"location":"console/users/#creation","title":"Creation","text":"<p>New accounts are created by administrators via the UI or API. An initial password is set at creation time.</p>"},{"location":"console/users/#modification","title":"Modification","text":"<p>Administrators can update user roles, reset passwords, and change organization assignments. Users can update their own account settings via the Account page (<code>/account</code>).</p>"},{"location":"console/users/#deactivation","title":"Deactivation","text":"<p>Deactivated accounts cannot authenticate but are retained for audit trail purposes.</p> <ol> <li>Navigate to Users</li> <li>Select the user account</li> <li>Change status to Deactivated</li> <li>Click Save</li> </ol> <p>Important</p> <p>Deactivating a user immediately invalidates all active sessions for that account. The user will be logged out on their next request.</p>"},{"location":"console/users/#unauthorized-access","title":"Unauthorized Access","text":"<p>Users who attempt to access resources outside their permission scope are redirected to the <code>/unauthorized</code> page with an appropriate error message.</p>"},{"location":"deployment/","title":"Deployment Overview","text":"<p>WitFoo Analytics v0.9.1 is an enterprise security operations platform deployed as a set of containerized microservices. This guide covers production deployment for DevOps engineers using either the WitFoo Appliance (WFA) daemon or Docker Compose.</p>"},{"location":"deployment/#architecture-overview","title":"Architecture Overview","text":"<p>WitFoo Analytics consists of interconnected services organized into three tiers: foundation (data and messaging), processing (analytics pipeline), and application (API, UI, and routing).</p> <pre><code>graph TB\n    subgraph Application Tier\n        RP[Reverse Proxy :443/:8081]\n        UI[UI :3000]\n        API[API :8080]\n        DISP[Dispatcher :8003]\n    end\n\n    subgraph Processing Tier\n        AI[Artifact Ingestion :8090]\n        GP[Graph Processor]\n        IE[Incident Engine :8082]\n    end\n\n    subgraph Foundation Tier\n        CASS[Cassandra :9042]\n        NATS[NATS :4222]\n    end\n\n    subgraph Observability\n        PROM[Prometheus :9090]\n        GRAF[Grafana :3001]\n    end\n\n    RP --&gt; API\n    RP --&gt; UI\n    RP --&gt; DISP\n    RP --&gt; IE\n    AI --&gt; NATS\n    GP --&gt; NATS\n    GP --&gt; CASS\n    IE --&gt; NATS\n    IE --&gt; CASS\n    API --&gt; CASS\n    DISP --&gt; NATS\n    DISP --&gt; CASS\n    PROM --&gt; API\n    PROM --&gt; AI\n    PROM --&gt; GP\n    PROM --&gt; IE\n    GRAF --&gt; PROM</code></pre>"},{"location":"deployment/#deployment-roles","title":"Deployment Roles","text":"<p>WitFoo Analytics supports four deployment roles to match different infrastructure requirements.</p> Role Services Description AIO + Conductor 15 All Analytics and Conductor services on a single node AIO 11 All Analytics services without Conductor Data Node 1 Dedicated Cassandra node for clustered storage Processing Node 10 All services except Cassandra; connects to external data nodes"},{"location":"deployment/#hardware-requirements","title":"Hardware Requirements","text":""},{"location":"deployment/#aio-conductor","title":"AIO + Conductor","text":"Resource Minimum Recommended CPU 8 cores 16 cores RAM 32 GB 64 GB Disk 200 GB SSD 1 TB SSD"},{"location":"deployment/#aio-analytics-only","title":"AIO (Analytics Only)","text":"Resource Minimum Recommended CPU 4 cores 16 cores RAM 16 GB 32 GB Disk 200 GB SSD 1 TB SSD"},{"location":"deployment/#data-node","title":"Data Node","text":"Resource Minimum Recommended CPU 4 cores 8 cores RAM 16 GB 32 GB Disk 500 GB SSD 2 TB SSD"},{"location":"deployment/#processing-node","title":"Processing Node","text":"Resource Minimum Recommended CPU 4 cores 16 cores RAM 16 GB 32 GB Disk 100 GB SSD 500 GB SSD <p>Disk Requirements</p> <p>All roles require SSD storage. Cassandra performance degrades significantly on spinning disks. Data nodes in production should use dedicated NVMe drives.</p>"},{"location":"deployment/#network-ports","title":"Network Ports","text":"Port Protocol Service Direction 443 TCP Reverse Proxy (HTTPS) Inbound 8081 TCP Reverse Proxy (HTTP) Inbound 8080 TCP API Internal 8082 TCP Incident Engine Internal 8090 TCP Artifact Ingestion Internal 3000 TCP UI Internal 9042 TCP Cassandra CQL Internal 7000 TCP Cassandra inter-node Internal (clustered) 4222 TCP NATS client Internal 6222 TCP NATS cluster Internal 8222 TCP NATS monitoring Internal 9090 TCP Prometheus Localhost 3001 TCP Grafana Localhost <p>Production Firewall Rules</p> <p>Only port 443 (HTTPS) should be exposed to end users. Bind all internal services to <code>127.0.0.1</code> or a private network interface using the <code>LISTEN_IP</code> environment variable.</p>"},{"location":"deployment/#prerequisites","title":"Prerequisites","text":"<ul> <li>Docker Engine 24.0+ with Compose V2</li> <li>Linux host (Ubuntu 22.04+ or RHEL 9+ recommended)</li> <li>Git credentials for private image builds (stored at <code>$HOME/.git-credentials</code>)</li> <li>TLS certificates for production HTTPS (see TLS Setup)</li> </ul>"},{"location":"deployment/#quick-start","title":"Quick Start","text":"<p>For a single-node evaluation deployment:</p> <pre><code>cd docker\n\n# Start AIO stack\ndocker compose -f docker-compose.aio.yml up -d --build\n\n# Wait for all services to become healthy\n./scripts/ci/wait-for-services.sh \\\n  --compose-file docker/docker-compose.aio.yml \\\n  --timeout 300\n\n# Verify\ndocker compose -f docker-compose.aio.yml ps\n</code></pre> <p>Access the platform at <code>https://localhost</code> (self-signed certificate) or <code>http://localhost:8081</code>.</p>"},{"location":"deployment/#next-steps","title":"Next Steps","text":"<ul> <li>Docker Compose Setup \u2014 Detailed service descriptions and compose file reference</li> <li>Configuration \u2014 Environment variables, secrets, and <code>.env</code> files</li> <li>WFA Integration \u2014 Production deployment with the WitFoo Appliance daemon</li> <li>Monitoring \u2014 Prometheus metrics and Grafana dashboards</li> <li>TLS Setup \u2014 Certificate management and HTTPS configuration</li> <li>Conductor Deployment \u2014 Signal collection pipeline setup</li> </ul>"},{"location":"deployment/conductor/","title":"Conductor Service Deployment","text":"<p>The Conductor suite is WitFoo's signal collection pipeline. It receives raw syslog, Beats, and TLS-encrypted log data, parses signals into structured artifacts, and exports them to the Analytics artifact-ingestion service. Conductor services are included in the AIO + Conductor role or can be deployed standalone alongside an existing Analytics stack.</p>"},{"location":"deployment/conductor/#signal-pipeline","title":"Signal Pipeline","text":"<pre><code>graph LR\n    SYSLOG[Syslog Sources&lt;br&gt;UDP/TCP 514] --&gt; SS[Signal Server]\n    TLS_SRC[TLS Sources&lt;br&gt;:6514] --&gt; SS\n    BEATS[Beats Agents&lt;br&gt;:5044] --&gt; SS\n    SS --&gt;|raw signals| BE[Broker Edge&lt;br&gt;NATS :4223]\n    BE --&gt; SP[Signal Parser]\n    SP --&gt;|parsed artifacts| BE\n    BE --&gt; AF[Artifact Filter]\n    AF --&gt;|enriched artifacts| BE\n    BE --&gt; AE[Artifact Exporter]\n    AE --&gt;|HTTP POST| AI[Analytics&lt;br&gt;Artifact Ingestion :8090]</code></pre>"},{"location":"deployment/conductor/#conductor-services","title":"Conductor Services","text":"Service Container Ports Description Broker Edge <code>conductor-broker-edge</code> 4223 (NATS), 8223 (monitoring) Dedicated NATS instance for Conductor message routing Signal Server <code>conductor-signal-server</code> 514/udp, 514/tcp, 5044, 6514 Receives syslog (UDP/TCP), Beats, and TLS-encrypted signals Signal Parser <code>conductor-signal-parser</code> \u2014 Parses raw signals into structured artifacts Artifact Filter <code>conductor-artifact-filter</code> \u2014 Filters and enriches artifacts (STIX, threat intelligence) Artifact Exporter <code>conductor-artifact-exporter</code> \u2014 Exports finalized artifacts to Analytics via HTTP Conductor UI <code>conductor-ui</code> 8000 Web management interface"},{"location":"deployment/conductor/#nats-topology","title":"NATS Topology","text":"<p>Conductor uses its own NATS instance (Broker Edge) on port 4223, separate from the Analytics NATS on port 4222. Both share the <code>witfoo-analytics-net</code> Docker network.</p> <pre><code>graph TB\n    subgraph Analytics NATS :4222\n        AI_NATS[nats]\n        AI[artifact-ingestion] --&gt; AI_NATS\n        GP[graph-processor] --&gt; AI_NATS\n        IE[incident-engine] --&gt; AI_NATS\n        DISP[dispatcher] --&gt; AI_NATS\n    end\n\n    subgraph Conductor NATS :4223\n        BE[broker-edge]\n        SS[signal-server] --&gt; BE\n        SP[signal-parser] --&gt; BE\n        AF[artifact-filter] --&gt; BE\n        AE[artifact-exporter] --&gt; BE\n    end\n\n    AE --&gt;|HTTP| AI</code></pre>"},{"location":"deployment/conductor/#standalone-deployment","title":"Standalone Deployment","text":"<p>If your Analytics stack is already running, deploy Conductor services separately using the standalone compose file:</p>"},{"location":"deployment/conductor/#prerequisites","title":"Prerequisites","text":"<p>The Analytics network must already exist:</p> <pre><code># Verify the network exists\ndocker network ls | grep witfoo-analytics-net\n</code></pre>"},{"location":"deployment/conductor/#build-and-start","title":"Build and Start","text":"<pre><code># Build Conductor binaries\n./scripts/conductor-build.sh all\n\n# Build container images\ndocker compose -f docker-compose-conductor.yml build\n\n# Start Conductor services\ndocker compose -f docker-compose-conductor.yml up -d\n</code></pre>"},{"location":"deployment/conductor/#standalone-compose-configuration","title":"Standalone Compose Configuration","text":"<p>The standalone compose file joins the existing Analytics network:</p> <pre><code>networks:\n  witfoo-analytics-net:\n    external: true\n\nservices:\n  conductor-broker-edge:\n    build:\n      context: ../conductor_suite/broker-edge\n    container_name: conductor-broker-edge-svc\n    ports:\n      - \"4223:4223\"\n      - \"8223:8223\"\n    environment:\n      - WF_NODE_CONFIG_FILE=/configs/node.json\n    volumes:\n      - ./conductor-node.json:/configs/node.json:ro\n    networks:\n      - witfoo-analytics-net\n    healthcheck:\n      test: [\"CMD\", \"nats\", \"server\", \"ping\", \"--server=nats://127.0.0.1:4223\"]\n      interval: 10s\n      timeout: 5s\n      retries: 5\n      start_period: 15s\n</code></pre>"},{"location":"deployment/conductor/#aio-conductor-deployment","title":"AIO + Conductor Deployment","text":"<p>For single-node deployments, use the combined compose file:</p> <pre><code>docker compose -f docker-compose.aio-conductor.yml up -d --build\n</code></pre> <p>This deploys all 15 services (11 Analytics + 6 Conductor) on a single <code>witfoo-analytics-net</code> bridge network. The Conductor services are defined in the same compose file:</p> <pre><code># Conductor services in docker-compose.aio-conductor.yml\n\nbroker-edge:\n  build:\n    context: ../conductor_suite/broker-edge\n  container_name: conductor-broker-edge\n  ports:\n    - \"4223:4223\"\n    - \"8223:8223\"\n  volumes:\n    - ../conductor_suite/test/configs:/configs:ro\n    - ../conductor_suite/test/certs:/certs:ro\n    - conductor-nats-data:/data/nats\n  environment:\n    - WF_NODE_CONFIG_FILE=/configs/node.json\n  networks:\n    witfoo-analytics-net:\n      aliases:\n        - broker-edge.lan\n\nartifact-exporter:\n  build:\n    context: ../conductor_suite/artifact-exporter\n  container_name: conductor-artifact-exporter\n  environment:\n    - WF_NODE_CONFIG_FILE=/configs/node.json\n    - ANALYTICS_INGESTION_URL=http://artifact-ingestion:8090\n    - ANALYTICS_SECRET=${ANALYTICS_SECRET:-}\n  depends_on:\n    broker-edge:\n      condition: service_healthy\n    artifact-ingestion:\n      condition: service_started\n</code></pre>"},{"location":"deployment/conductor/#configuration","title":"Configuration","text":""},{"location":"deployment/conductor/#node-configuration","title":"Node Configuration","text":"<p>All Conductor services read from a shared <code>node.json</code> configuration file:</p> <pre><code>{\n  \"node_id\": \"conductor-01\",\n  \"nats_url\": \"nats://broker-edge:4223\",\n  \"analytics_api_url\": \"http://reverse-proxy:8081\",\n  \"certs_dir\": \"/certs\"\n}\n</code></pre> <p>Mount this file as a read-only volume:</p> <pre><code>volumes:\n  - ./conductor-node.json:/configs/node.json:ro\n</code></pre>"},{"location":"deployment/conductor/#environment-variables","title":"Environment Variables","text":"Variable Service Default Description <code>WF_NODE_CONFIG_FILE</code> All Conductor <code>/configs/node.json</code> Path to node configuration <code>ANALYTICS_API_URL</code> signal-parser, conductor-ui <code>http://reverse-proxy:8081</code> Analytics API endpoint <code>ANALYTICS_INGESTION_URL</code> artifact-exporter <code>http://artifact-ingestion:8090</code> Artifact ingestion endpoint <code>ANALYTICS_SECRET</code> artifact-exporter (empty) Shared secret for artifact delivery <code>DEBUG</code> artifact-exporter <code>0</code> Enable debug logging <code>DEBUG_MODULES</code> artifact-exporter (empty) Comma-separated debug modules <p>Shared Secret</p> <p>If <code>ANALYTICS_SECRET</code> is set on the artifact-ingestion service, the same value must be configured on the artifact-exporter. Mismatched secrets cause artifact delivery failures.</p>"},{"location":"deployment/conductor/#signal-server-ports","title":"Signal Server Ports","text":"<p>The Signal Server listens on multiple ports for different log transport protocols:</p> Port Protocol Description 514/udp Syslog UDP Standard syslog (RFC 5424) 514/tcp Syslog TCP Reliable syslog delivery 1514 Syslog TCP Alternative syslog port (non-privileged) 5044 Beats Elastic Beats protocol (Filebeat, Winlogbeat) 6514 Syslog TLS Encrypted syslog (RFC 5425) <p>Privileged Ports</p> <p>Ports 514 require the <code>NET_BIND_SERVICE</code> capability. This is configured in the compose file via <code>cap_add</code>. On SELinux-enabled systems, additional policy configuration may be required.</p> <pre><code>signal-server:\n  ports:\n    - \"514:514/udp\"\n    - \"514:514/tcp\"\n    - \"5044:5044\"\n    - \"6514:6514\"\n  cap_add:\n    - NET_BIND_SERVICE\n</code></pre>"},{"location":"deployment/conductor/#volumes","title":"Volumes","text":"Volume Service Purpose <code>conductor-nats-data</code> broker-edge NATS JetStream persistence <code>conductor-exporters-data</code> artifact-exporter Export state and retry queue <code>conductor-integrations-data</code> \u2014 Integration configuration storage"},{"location":"deployment/conductor/#health-checks","title":"Health Checks","text":"<p>The Broker Edge service is the dependency anchor for all other Conductor services:</p> <pre><code>conductor-signal-server:\n  depends_on:\n    conductor-broker-edge:\n      condition: service_healthy\n</code></pre> <p>Verify Conductor health:</p> <pre><code># Check Broker Edge NATS\ncurl http://localhost:8223/healthz\n\n# Check all Conductor containers\ndocker ps --filter \"name=conductor-\" --format \"table {{.Names}}\\t{{.Status}}\"\n</code></pre>"},{"location":"deployment/conductor/#troubleshooting","title":"Troubleshooting","text":""},{"location":"deployment/conductor/#artifact-exporter-not-delivering","title":"Artifact Exporter Not Delivering","text":"<pre><code># Check exporter logs\ndocker logs conductor-artifact-exporter --tail=50\n\n# Verify connectivity to artifact-ingestion\ndocker exec conductor-artifact-exporter wget -q -O- http://artifact-ingestion:8090/health\n</code></pre>"},{"location":"deployment/conductor/#signal-server-not-receiving","title":"Signal Server Not Receiving","text":"<pre><code># Test syslog delivery\necho \"&lt;14&gt;Test message from deployment verification\" | nc -u localhost 514\n\n# Check signal-server logs\ndocker logs conductor-signal-server --tail=50\n</code></pre>"},{"location":"deployment/conductor/#broker-edge-connection-failures","title":"Broker Edge Connection Failures","text":"<pre><code># Verify NATS is healthy\ndocker exec conductor-broker-edge nats server ping --server=nats://127.0.0.1:4223\n\n# Check NATS monitoring\ncurl http://localhost:8223/varz\n</code></pre>"},{"location":"deployment/configuration/","title":"Configuration","text":"<p>WitFoo Analytics is configured through environment variables, <code>.env</code> files, and Docker secrets. This reference covers all required and optional variables for each service.</p>"},{"location":"deployment/configuration/#environment-variable-precedence","title":"Environment Variable Precedence","text":"<ol> <li>Shell environment \u2014 Variables exported in the current shell</li> <li><code>.env</code> file \u2014 Loaded automatically by Docker Compose from the <code>docker/</code> directory</li> <li>Compose file defaults \u2014 Inline defaults using <code>${VAR:-default}</code> syntax</li> <li>Image defaults \u2014 Baked into Dockerfiles via <code>ENV</code> directives</li> </ol>"},{"location":"deployment/configuration/#the-env-file","title":"The <code>.env</code> File","text":"<p>Create a <code>.env</code> file in the <code>docker/</code> directory alongside your compose file:</p> <pre><code># docker/.env\n\n# Secrets (required for production)\nJWT_SECRET=your-256-bit-secret-here\nWF_LICENSE=your-license-key\nAI_ENCRYPTION_KEY=your-ai-encryption-key\nAUTH_CONFIG_ENCRYPTION_KEY=your-base64-encoded-32-byte-key\n\n# Cassandra tuning\nCASSANDRA_HEAP=6G\nCASSANDRA_NEWSIZE=1200M\n\n# Network binding\nLISTEN_IP=0.0.0.0\n\n# TLS\nTLS_ENABLED=true\n\n# Grafana\nGF_ADMIN_PASSWORD=your-grafana-password\n\n# UI modules\nVITE_UI_MODULES=all\n</code></pre> <p>Protect the <code>.env</code> File</p> <p>The <code>.env</code> file contains secrets such as <code>JWT_SECRET</code> and encryption keys. Set restrictive permissions (<code>chmod 600 .env</code>) and never commit it to version control. Add <code>.env</code> to your <code>.gitignore</code>.</p>"},{"location":"deployment/configuration/#global-variables","title":"Global Variables","text":"<p>These variables are shared across multiple services:</p> Variable Required Default Description <code>JWT_SECRET</code> Yes Dev placeholder JWT signing secret; must be identical across API, incident-engine, dispatcher, and reverse-proxy <code>WF_LICENSE</code> No (empty) WitFoo license key <code>LOG_LEVEL</code> No <code>info</code> Log verbosity: <code>debug</code>, <code>info</code>, <code>warn</code>, <code>error</code> <code>LISTEN_IP</code> No <code>0.0.0.0</code> IP address for port bindings; set to <code>127.0.0.1</code> to restrict access <code>CASSANDRA_KEYSPACE</code> No <code>analytics_v2</code> Cassandra keyspace name <code>NATS_URL</code> No <code>nats://nats:4222</code> NATS connection URL <p>Change JWT_SECRET in Production</p> <p>The default value <code>witfoo-analytics-dev-secret-change-in-production</code> is for development only. Generate a cryptographically random secret of at least 256 bits for production deployments.</p>"},{"location":"deployment/configuration/#cassandra-variables","title":"Cassandra Variables","text":"Variable Required Default Description <code>CASSANDRA_CLUSTER_NAME</code> No <code>WitFoo-Analytics</code> Cluster identifier <code>CASSANDRA_DC</code> No <code>dc1</code> Data center name <code>MAX_HEAP_SIZE</code> / <code>CASSANDRA_HEAP</code> No <code>6G</code> JVM max heap size <code>HEAP_NEWSIZE</code> / <code>CASSANDRA_NEWSIZE</code> No <code>1200M</code> JVM young generation size <code>WF_CASSANDRA_PW</code> No <code>cassandra</code> Cassandra password <code>CASSANDRA_SEEDS</code> Clustered <code>cassandra</code> Comma-separated seed node IPs <code>CASSANDRA_LISTEN_ADDRESS</code> Clustered <code>0.0.0.0</code> Address for inter-node communication <code>NODE_IP</code> Clustered <code>0.0.0.0</code> Node's broadcast address <p>Cassandra Heap Sizing</p> <p>For CI environments with limited memory, reduce the heap: <code>CASSANDRA_HEAP=2G CASSANDRA_NEWSIZE=400M</code>. Never exceed 50% of available system RAM for the Cassandra heap.</p>"},{"location":"deployment/configuration/#api-service-variables","title":"API Service Variables","text":"Variable Required Default Description <code>PORT</code> No <code>8080</code> HTTP listen port <code>JWT_TOKEN_DURATION</code> No <code>24h</code> JWT token expiry duration <code>AI_ENCRYPTION_KEY</code> No (empty) Encryption key for AI configuration <code>AUTH_CONFIG_ENCRYPTION_KEY</code> No (empty) 32-byte base64 key for LDAP/SAML encryption <code>API_TTL_NODES</code> No <code>604800</code> Graph node cache TTL (seconds) <code>API_TTL_EDGES</code> No <code>604800</code> Graph edge cache TTL (seconds) <code>API_TTL_NODE_INDEX</code> No <code>604800</code> Node index cache TTL (seconds) <code>WF_CASSANDRA_SEED_NODES</code> No <code>cassandra</code> Cassandra contact points <code>WF_CASSANDRA_DATACENTER</code> No <code>dc1</code> Cassandra data center for connection"},{"location":"deployment/configuration/#incident-engine-variables","title":"Incident Engine Variables","text":"Variable Required Default Description <code>PORT</code> No <code>8082</code> HTTP listen port <code>CACHE_TTL</code> No <code>5m</code> In-memory cache TTL (<code>10s</code> for E2E testing) <code>MOS_DEFINITIONS_DIR</code> No <code>/meta-definitions/mos</code> Path to MOS rule definitions <code>ORG_ID</code> No <code>witfoo</code> Default organization ID <code>GIN_MODE</code> No <code>release</code> Gin framework mode (<code>release</code> or <code>debug</code>)"},{"location":"deployment/configuration/#graph-processor-variables","title":"Graph Processor Variables","text":"Variable Required Default Description <code>GRAPH_PROCESSOR_TTL_ARTIFACTS</code> No <code>2592000</code> Artifact TTL in seconds (30 days) <code>GRAPH_PROCESSOR_TTL_NODES</code> No <code>604800</code> Graph node TTL in seconds (7 days) <code>GRAPH_PROCESSOR_TTL_EDGES</code> No <code>604800</code> Graph edge TTL in seconds (7 days) <code>GRAPH_PROCESSOR_TTL_NODE_INDEX</code> No <code>604800</code> Node index TTL in seconds (7 days) <code>GRAPH_PROCESSOR_TTL_LEAD_RULES</code> No <code>86400</code> Lead rules cache TTL in seconds (24 hours) <code>CASSANDRA_HOSTS</code> No <code>cassandra:9042</code> Cassandra host:port pairs"},{"location":"deployment/configuration/#reverse-proxy-variables","title":"Reverse Proxy Variables","text":"Variable Required Default Description <code>API_URL</code> No <code>http://api:8080</code> Backend API URL <code>UI_URL</code> No <code>http://ui:3000</code> Frontend UI URL <code>DISPATCHER_URL</code> No <code>http://dispatcher:8003</code> Dispatcher service URL <code>INCIDENT_ENGINE_URL</code> No <code>http://incident-engine:8082</code> Incident engine URL <code>TLS_ENABLED</code> No <code>true</code> Enable HTTPS termination <code>TLS_PORT</code> No <code>443</code> HTTPS listen port <code>CERT_FILE</code> No <code>./certs/server.crt</code> Path to TLS certificate <code>KEY_FILE</code> No <code>./certs/server.key</code> Path to TLS private key"},{"location":"deployment/configuration/#ui-variables","title":"UI Variables","text":"Variable Required Default Description <code>PORT</code> No <code>3000</code> HTTP listen port <code>PUBLIC_BASE_PATH</code> No <code>/ui</code> URL base path <code>API_BASE_URL</code> No <code>http://api:8080</code> Backend API URL (server-side) <code>VITE_UI_MODULES</code> No <code>all</code> UI module visibility (build-time) <code>ORIGIN</code> No <code>http://localhost:3000</code> Allowed CORS origin"},{"location":"deployment/configuration/#ui-module-options","title":"UI Module Options","text":"Value Modules Enabled <code>all</code> Search, Observer, Reporter, CyberGrid, AI <code>search_only</code> Search <code>search_observer</code> Search, Observer <p>Build-Time Variable</p> <p><code>VITE_UI_MODULES</code> is a build-time argument. Changing it requires rebuilding the UI container image.</p>"},{"location":"deployment/configuration/#observability-variables","title":"Observability Variables","text":"Variable Required Default Description <code>GF_ADMIN_PASSWORD</code> No <code>admin</code> Grafana admin password <code>GRAFANA_REMOTE_WRITE_URL</code> No (empty) Remote write endpoint for Grafana Cloud <code>GRAFANA_REMOTE_WRITE_USER</code> No (empty) Remote write username <code>GRAFANA_REMOTE_WRITE_API_KEY</code> No (empty) Remote write API key"},{"location":"deployment/configuration/#docker-secrets","title":"Docker Secrets","text":"<p>For production deployments, use Docker secrets instead of environment variables for sensitive values:</p> <pre><code>services:\n  api:\n    secrets:\n      - jwt_secret\n\nsecrets:\n  jwt_secret:\n    file: ./secrets/jwt_secret.txt\n</code></pre> <p>Create the secrets directory:</p> <pre><code>mkdir -p docker/secrets\nchmod 700 docker/secrets\n\n# Generate a random JWT secret\nopenssl rand -base64 32 &gt; docker/secrets/jwt_secret.txt\nchmod 600 docker/secrets/jwt_secret.txt\n</code></pre>"},{"location":"deployment/configuration/#retention-configuration","title":"Retention Configuration","text":"<p>Data retention is configured via the Onboarding Wizard in the Analytics web UI after initial deployment. Default values:</p> Setting Environment Variable Default Artifact retention <code>RETENTION_ARTIFACTS_DAYS</code> 7 days Work unit retention <code>RETENTION_WORK_UNITS_DAYS</code> 365 days Work collection retention <code>RETENTION_WORK_COLLECTIONS_DAYS</code> 365 days Report retention <code>RETENTION_REPORTS_DAYS</code> 1825 days (5 years)"},{"location":"deployment/configuration/#configuration-files","title":"Configuration Files","text":"<p>WFA production deployments generate JSON configuration files:</p> <p><code>/witfoo/configs/analytics.json</code>:</p> <pre><code>{\n  \"role\": \"analytics-aio\",\n  \"retention\": {\n    \"artifacts_days\": 7,\n    \"work_units_days\": 365,\n    \"work_collections_days\": 365,\n    \"reports_days\": 1825\n  },\n  \"ui_modules\": \"all\",\n  \"cybergrid\": {\n    \"enabled\": false,\n    \"publish_enabled\": false\n  },\n  \"clustering\": {}\n}\n</code></pre> <p>See WFA Integration for details on the configuration wizard.</p>"},{"location":"deployment/docker-compose/","title":"Docker Compose Setup","text":"<p>WitFoo Analytics provides role-specific Docker Compose files for each deployment topology. In production, the WFA daemon manages containers directly; these compose files are used for development, CI/CD, and reference deployments.</p>"},{"location":"deployment/docker-compose/#compose-files","title":"Compose Files","text":"File Role Services <code>docker-compose.aio.yml</code> AIO 11 Analytics services <code>docker-compose.aio-conductor.yml</code> AIO + Conductor 15 Analytics + Conductor services <code>docker-compose.data-node.yml</code> Data Node 1 Cassandra instance <code>docker-compose.processing-node.yml</code> Processing Node 10 services (no Cassandra) <code>docker-compose.common.yml</code> Shared anchors YAML extension fields only"},{"location":"deployment/docker-compose/#service-descriptions","title":"Service Descriptions","text":""},{"location":"deployment/docker-compose/#foundation-services","title":"Foundation Services","text":"<p>Cassandra \u2014 Apache Cassandra 5.0 with Storage Attached Indexes (SAI). Primary data store for all analytics data.</p> <pre><code>cassandra:\n  build:\n    context: ..\n    dockerfile: cassandra/Dockerfile\n  container_name: witfoo-analytics-cassandra\n  ports:\n    - \"${LISTEN_IP:-0.0.0.0}:9042:9042\"\n  environment:\n    - CASSANDRA_CLUSTER_NAME=WitFoo-Analytics\n    - CASSANDRA_DC=dc1\n    - MAX_HEAP_SIZE=${CASSANDRA_HEAP:-6G}\n    - HEAP_NEWSIZE=${CASSANDRA_NEWSIZE:-1200M}\n  volumes:\n    - cassandra-data:/var/lib/cassandra\n  healthcheck:\n    test: [\"CMD-SHELL\", \"cqlsh --ssl -u cassandra -p cassandra -e 'DESCRIBE KEYSPACES' || exit 1\"]\n    interval: 30s\n    timeout: 10s\n    retries: 5\n    start_period: 60s\n</code></pre> <p>NATS \u2014 Message broker for inter-service event streaming. All processing services subscribe to NATS subjects for artifact flow.</p> <pre><code>nats:\n  build:\n    context: ..\n    dockerfile: nats/Dockerfile\n  container_name: witfoo-analytics-nats\n  ports:\n    - \"4222:4222\"   # Client connections\n    - \"8222:8222\"   # HTTP monitoring\n  volumes:\n    - nats-data:/data\n  healthcheck:\n    test: [\"CMD\", \"wget\", \"--no-verbose\", \"--tries=1\", \"--spider\", \"http://localhost:8222/healthz\"]\n    interval: 10s\n    timeout: 5s\n    retries: 3\n    start_period: 10s\n</code></pre>"},{"location":"deployment/docker-compose/#processing-services","title":"Processing Services","text":"Service Port Description artifact-ingestion 8090, 8443 (TLS) Receives artifacts from Conductor or external sources; publishes to NATS graph-processor \u2014 (no HTTP) Consumes NATS events; builds graph nodes and edges in Cassandra incident-engine 8082 Evaluates MOS (Method of Signal) rules; generates incidents and work units"},{"location":"deployment/docker-compose/#application-services","title":"Application Services","text":"Service Port Description api 8080 Core REST API; handles authentication, search, CRUD operations dispatcher 8003 Coordinates async workflows between incident-engine and NATS reverse-proxy 8081 (HTTP), 443 (HTTPS) Routes traffic to API, UI, dispatcher, and incident-engine ui 3000 Svelte 5 web application served via SvelteKit"},{"location":"deployment/docker-compose/#observability-services","title":"Observability Services","text":"Service Port Description prometheus 9090 Metrics collection with 30-day retention grafana 3001 Dashboard visualization (default credentials: <code>admin</code>/<code>admin</code>)"},{"location":"deployment/docker-compose/#starting-an-aio-deployment","title":"Starting an AIO Deployment","text":"<pre><code>cd docker\n\n# Standard start\ndocker compose -f docker-compose.aio.yml up -d --build\n\n# With reduced Cassandra heap for constrained environments\nCASSANDRA_HEAP=2G CASSANDRA_NEWSIZE=400M \\\n  docker compose -f docker-compose.aio.yml up -d --build\n</code></pre> <p>Cassandra Startup Time</p> <p>Cassandra requires 60\u2013120 seconds to initialize. All dependent services wait for the Cassandra health check before starting. Do not reduce <code>start_period</code> below 60 seconds.</p>"},{"location":"deployment/docker-compose/#starting-an-aio-conductor-deployment","title":"Starting an AIO + Conductor Deployment","text":"<pre><code>cd docker\ndocker compose -f docker-compose.aio-conductor.yml up -d --build\n</code></pre> <p>This deploys all 11 Analytics services plus Conductor services (broker-edge, signal-server, signal-parser, artifact-filter, artifact-exporter, conductor-ui) on a single network.</p>"},{"location":"deployment/docker-compose/#clustered-deployment","title":"Clustered Deployment","text":""},{"location":"deployment/docker-compose/#data-nodes","title":"Data Nodes","text":"<p>Deploy one or more Cassandra data nodes:</p> <pre><code># First data node\nNODE_IP=10.0.1.10 CASSANDRA_SEEDS=10.0.1.10,10.0.1.11 \\\n  docker compose -f docker-compose.data-node.yml up -d --build\n\n# Second data node\nNODE_IP=10.0.1.11 CASSANDRA_SEEDS=10.0.1.10,10.0.1.11 \\\n  docker compose -f docker-compose.data-node.yml up -d --build\n</code></pre> <p>The data node compose file exposes both CQL (9042) and inter-node (7000) ports:</p> <pre><code>cassandra:\n  ports:\n    - \"${NODE_IP:-0.0.0.0}:9042:9042\"\n    - \"${NODE_IP:-0.0.0.0}:7000:7000\"\n  environment:\n    - CASSANDRA_SEEDS=${CASSANDRA_SEEDS:-cassandra}\n    - CASSANDRA_LISTEN_ADDRESS=${NODE_IP:-0.0.0.0}\n    - CASSANDRA_BROADCAST_ADDRESS=${NODE_IP:-cassandra}\n</code></pre>"},{"location":"deployment/docker-compose/#processing-nodes","title":"Processing Nodes","text":"<p>Connect processing nodes to external data nodes:</p> <pre><code>DATA_NODE_HOSTS=10.0.1.10:9042,10.0.1.11:9042 \\\n  docker compose -f docker-compose.processing-node.yml up -d --build\n</code></pre> <p>Processing nodes use <code>DATA_NODE_HOSTS</code> to configure all Cassandra-dependent services:</p> <pre><code>graph-processor:\n  environment:\n    - CASSANDRA_HOSTS=${DATA_NODE_HOSTS:-cassandra:9042}\n\napi:\n  environment:\n    - WF_CASSANDRA_SEED_NODES=${DATA_NODE_HOSTS:-cassandra:9042}\n</code></pre>"},{"location":"deployment/docker-compose/#network-architecture","title":"Network Architecture","text":"<p>All services communicate over a single Docker bridge network:</p> <pre><code>networks:\n  witfoo-analytics-net:\n    driver: bridge\n</code></pre> <pre><code>graph LR\n    subgraph witfoo-analytics-net\n        RP[reverse-proxy] --&gt;|:8080| API[api]\n        RP --&gt;|:3000| UI[ui]\n        RP --&gt;|:8003| DISP[dispatcher]\n        RP --&gt;|:8082| IE[incident-engine]\n        AI[artifact-ingestion] --&gt;|:4222| NATS[nats]\n        GP[graph-processor] --&gt;|:4222| NATS\n        GP --&gt;|:9042| CASS[cassandra]\n        IE --&gt;|:4222| NATS\n        IE --&gt;|:9042| CASS\n        API --&gt;|:9042| CASS\n        DISP --&gt;|:4222| NATS\n        DISP --&gt;|:9042| CASS\n    end</code></pre>"},{"location":"deployment/docker-compose/#volumes","title":"Volumes","text":"Volume Service Purpose <code>cassandra-data</code> cassandra Persistent database storage <code>nats-data</code> nats JetStream message persistence <code>prometheus-data</code> prometheus Time-series metrics storage <code>grafana-data</code> grafana Dashboard and plugin storage <code>certs</code> reverse-proxy, artifact-ingestion TLS certificates"},{"location":"deployment/docker-compose/#logging","title":"Logging","text":"<p>All services use JSON file logging with rotation:</p> <pre><code>logging:\n  driver: \"json-file\"\n  options:\n    max-size: \"10m\"\n    max-file: \"3\"\n    compress: \"true\"\n</code></pre> <p>View logs for any service:</p> <pre><code>docker compose -f docker-compose.aio.yml logs --tail=100 -f api\n</code></pre>"},{"location":"deployment/docker-compose/#teardown","title":"Teardown","text":"<pre><code># Stop and remove containers, networks\ndocker compose -f docker-compose.aio.yml down\n\n# Stop, remove containers, AND delete all data volumes\ndocker compose -f docker-compose.aio.yml down -v --remove-orphans\n</code></pre> <p>Data Loss Warning</p> <p>The <code>-v</code> flag deletes all named volumes including Cassandra data, Prometheus metrics, and Grafana dashboards. Use only when you intend to destroy all persistent data.</p>"},{"location":"deployment/monitoring/","title":"Monitoring","text":"<p>WitFoo Analytics includes built-in observability with Prometheus for metrics collection and Grafana for visualization. Both services are included in the AIO, AIO + Conductor, and Processing Node deployment roles.</p>"},{"location":"deployment/monitoring/#architecture","title":"Architecture","text":"<pre><code>graph LR\n    API[API :8080] --&gt;|/metrics| PROM[Prometheus :9090]\n    AI[Artifact Ingestion] --&gt;|/metrics| PROM\n    GP[Graph Processor] --&gt;|/metrics| PROM\n    IE[Incident Engine :8082] --&gt;|/metrics| PROM\n    DISP[Dispatcher :8003] --&gt;|/metrics| PROM\n    PROM --&gt;|data source| GRAF[Grafana :3001]\n    GRAF --&gt;|dashboards| USER[Operator]</code></pre>"},{"location":"deployment/monitoring/#prometheus","title":"Prometheus","text":""},{"location":"deployment/monitoring/#configuration","title":"Configuration","text":"<p>Prometheus is deployed with a 30-day retention period and lifecycle API enabled:</p> <pre><code>prometheus:\n  image: prom/prometheus:v2.54.1\n  container_name: witfoo-analytics-prometheus\n  ports:\n    - \"${LISTEN_IP:-127.0.0.1}:9090:9090\"\n  command:\n    - '--config.file=/etc/prometheus/prometheus.yml'\n    - '--storage.tsdb.path=/prometheus'\n    - '--storage.tsdb.retention.time=30d'\n    - '--web.enable-lifecycle'\n  volumes:\n    - ./prometheus/prometheus.yml:/etc/prometheus/prometheus.yml:ro\n    - ./prometheus/alert-rules.yml:/etc/prometheus/alert-rules.yml:ro\n    - prometheus-data:/prometheus\n</code></pre> <p>Default Binding</p> <p>Prometheus binds to <code>127.0.0.1</code> by default. It is not accessible from external hosts unless you change <code>LISTEN_IP</code>. This is intentional \u2014 Prometheus should not be exposed to untrusted networks.</p>"},{"location":"deployment/monitoring/#scrape-targets","title":"Scrape Targets","text":"<p>Prometheus scrapes metrics from all Go services at their <code>/metrics</code> endpoint. The scrape configuration is defined in <code>docker/prometheus/prometheus.yml</code>:</p> Target Endpoint Scrape Interval API <code>api:8080/metrics</code> 15s Artifact Ingestion <code>artifact-ingestion:8090/metrics</code> 15s Graph Processor <code>graph-processor:8080/metrics</code> 15s Incident Engine <code>incident-engine:8082/metrics</code> 15s Dispatcher <code>dispatcher:8003/metrics</code> 15s"},{"location":"deployment/monitoring/#key-metrics","title":"Key Metrics","text":"<p>WitFoo Analytics services expose standard Go and application-specific Prometheus metrics:</p> <p>Artifact Pipeline:</p> Metric Type Description <code>artifacts_ingested_total</code> Counter Total artifacts received by ingestion service <code>artifacts_processed_total</code> Counter Total artifacts processed by graph processor <code>artifact_processing_duration_seconds</code> Histogram Time to process a single artifact <p>Incident Engine:</p> Metric Type Description <code>incidents_created_total</code> Counter Total incidents generated <code>mos_evaluations_total</code> Counter MOS rule evaluations performed <code>incident_engine_cache_hits_total</code> Counter Cache hit count <p>API:</p> Metric Type Description <code>http_requests_total</code> Counter Total HTTP requests by method, path, status <code>http_request_duration_seconds</code> Histogram Request latency distribution <code>cassandra_query_duration_seconds</code> Histogram Cassandra query latency <p>Runtime:</p> Metric Type Description <code>go_goroutines</code> Gauge Number of active goroutines <code>go_memstats_alloc_bytes</code> Gauge Current memory allocation <code>process_cpu_seconds_total</code> Counter Total CPU time consumed"},{"location":"deployment/monitoring/#accessing-prometheus","title":"Accessing Prometheus","text":"<pre><code># Local access (default binding)\ncurl http://localhost:9090/-/healthy\n\n# Query a metric\ncurl 'http://localhost:9090/api/v1/query?query=artifacts_ingested_total'\n</code></pre>"},{"location":"deployment/monitoring/#reloading-configuration","title":"Reloading Configuration","text":"<p>With <code>--web.enable-lifecycle</code>, reload Prometheus configuration without restart:</p> <pre><code>curl -X POST http://localhost:9090/-/reload\n</code></pre>"},{"location":"deployment/monitoring/#grafana","title":"Grafana","text":""},{"location":"deployment/monitoring/#configuration_1","title":"Configuration","text":"<p>Grafana is deployed with provisioned data sources and dashboards:</p> <pre><code>grafana:\n  image: grafana/grafana:11.3.0\n  container_name: witfoo-analytics-grafana\n  ports:\n    - \"${LISTEN_IP:-127.0.0.1}:3001:3000\"\n  environment:\n    - GF_SECURITY_ADMIN_USER=admin\n    - GF_SECURITY_ADMIN_PASSWORD=${GF_ADMIN_PASSWORD:-admin}\n    - GF_USERS_ALLOW_SIGN_UP=false\n    - GF_AUTH_ANONYMOUS_ENABLED=false\n  volumes:\n    - grafana-data:/var/lib/grafana\n    - ./grafana/provisioning:/etc/grafana/provisioning:ro\n</code></pre> <p>Change Default Credentials</p> <p>The default Grafana password is <code>admin</code>. Change it immediately after first login or set <code>GF_ADMIN_PASSWORD</code> in your <code>.env</code> file.</p>"},{"location":"deployment/monitoring/#accessing-grafana","title":"Accessing Grafana","text":"<p>Open <code>http://localhost:3001</code> in your browser. Default credentials:</p> <ul> <li>Username: <code>admin</code></li> <li>Password: <code>admin</code> (or the value of <code>GF_ADMIN_PASSWORD</code>)</li> </ul>"},{"location":"deployment/monitoring/#provisioned-dashboards","title":"Provisioned Dashboards","text":"<p>Grafana dashboards are auto-provisioned from <code>docker/grafana/provisioning/</code>. Available dashboards include:</p> Dashboard Description Analytics Overview High-level artifact throughput, incident counts, service health Artifact Pipeline Ingestion rates, processing latency, queue depth Incident Engine MOS evaluation rates, incident creation, cache performance API Performance Request rates, latency percentiles, error rates Infrastructure Go runtime metrics, memory usage, goroutine counts"},{"location":"deployment/monitoring/#data-source-configuration","title":"Data Source Configuration","text":"<p>The Prometheus data source is auto-provisioned at <code>docker/grafana/provisioning/datasources/</code>:</p> <pre><code>apiVersion: 1\ndatasources:\n  - name: Prometheus\n    type: prometheus\n    access: proxy\n    url: http://prometheus:9090\n    isDefault: true\n</code></pre>"},{"location":"deployment/monitoring/#grafana-cloud-integration","title":"Grafana Cloud Integration","text":""},{"location":"deployment/monitoring/#remote-write-prometheus","title":"Remote Write (Prometheus)","text":"<p>Forward metrics to Grafana Cloud by setting these environment variables:</p> <pre><code>GRAFANA_REMOTE_WRITE_URL=https://prometheus-prod-XX-prod-us-east-0.grafana.net/api/prom/push\nGRAFANA_REMOTE_WRITE_USER=123456\nGRAFANA_REMOTE_WRITE_API_KEY=your-api-key\n</code></pre>"},{"location":"deployment/monitoring/#log-shipping-alloy","title":"Log Shipping (Alloy)","text":"<p>Grafana Alloy ships Docker container logs to Grafana Cloud Loki. Enable it with the <code>monitoring</code> profile:</p> <pre><code>COMPOSE_PROFILES=monitoring \\\nGRAFANA_LOKI_URL=https://logs-prod-XX.grafana.net/loki/api/v1/push \\\nGRAFANA_LOKI_USER=123456 \\\nGRAFANA_LOKI_API_KEY=your-api-key \\\n  docker compose -f docker-compose.aio.yml up -d\n</code></pre> <p>Alloy is resource-constrained to minimize impact:</p> <pre><code>alloy:\n  deploy:\n    resources:\n      limits:\n        memory: 256M\n        cpus: \"0.25\"\n</code></pre>"},{"location":"deployment/monitoring/#health-check-endpoints","title":"Health Check Endpoints","text":"<p>All services expose health check endpoints used by Docker and monitoring:</p> Service Health Endpoint Port API <code>/health</code> 8080 Incident Engine <code>/health</code> 8082 Dispatcher <code>/health</code> 8003 Artifact Ingestion <code>/health</code> 8090 Reverse Proxy <code>/health</code> 8081 UI <code>/ui/health</code> 3000 NATS <code>/healthz</code> 8222 Prometheus <code>/-/healthy</code> 9090 Grafana <code>/api/health</code> 3000"},{"location":"deployment/monitoring/#alerting","title":"Alerting","text":"<p>Alert rules are defined in <code>docker/prometheus/alert-rules.yml</code> and loaded by Prometheus. Example alerts:</p> <ul> <li>Service Down \u2014 Any scrape target unreachable for &gt;2 minutes</li> <li>High Error Rate \u2014 HTTP 5xx rate exceeds 5% over 5 minutes</li> <li>Cassandra Latency \u2014 P99 query latency exceeds 500ms</li> <li>Disk Usage \u2014 Prometheus TSDB storage exceeds 80% capacity</li> </ul>"},{"location":"deployment/monitoring/#storage-considerations","title":"Storage Considerations","text":"Component Default Retention Estimated Disk Usage Prometheus 30 days 5\u201320 GB depending on cardinality Grafana Unlimited (dashboards) &lt;1 GB <p>To adjust Prometheus retention:</p> <pre><code>command:\n  - '--storage.tsdb.retention.time=90d'   # Increase to 90 days\n  - '--storage.tsdb.retention.size=50GB'  # Or cap by size\n</code></pre>"},{"location":"deployment/tls/","title":"TLS Setup","text":"<p>WitFoo Analytics uses TLS to encrypt all client-facing traffic. The reverse proxy terminates HTTPS connections and forwards requests to backend services over the internal Docker network.</p>"},{"location":"deployment/tls/#tls-architecture","title":"TLS Architecture","text":"<pre><code>graph LR\n    CLIENT[Client Browser] --&gt;|HTTPS :443| RP[Reverse Proxy]\n    RP --&gt;|HTTP :8080| API[API]\n    RP --&gt;|HTTP :3000| UI[UI]\n    RP --&gt;|HTTP :8003| DISP[Dispatcher]\n    RP --&gt;|HTTP :8082| IE[Incident Engine]\n    CONDUCTOR[Conductor] --&gt;|HTTPS :8443| AI[Artifact Ingestion]</code></pre> <p>TLS is terminated at two points:</p> <ol> <li>Reverse Proxy (port 443) \u2014 All user-facing HTTPS traffic</li> <li>Artifact Ingestion (port 8443) \u2014 Conductor-to-Analytics artifact delivery</li> </ol> <p>Internal Traffic Is Unencrypted</p> <p>Traffic between services on the <code>witfoo-analytics-net</code> Docker network is not encrypted. This is acceptable when all services run on the same host. For multi-host deployments, use an encrypted overlay network or a service mesh.</p>"},{"location":"deployment/tls/#certificate-requirements","title":"Certificate Requirements","text":"Attribute Requirement Format PEM-encoded X.509 Key type RSA 2048+ or ECDSA P-256+ Chain Full chain including intermediates SAN Must include the server's FQDN and/or IP Validity Recommended: 90 days (for automated renewal)"},{"location":"deployment/tls/#certificate-file-locations","title":"Certificate File Locations","text":"Service Certificate Path Key Path Reverse Proxy <code>./certs/server.crt</code> <code>./certs/server.key</code> Artifact Ingestion <code>/certs/server.crt</code> <code>/certs/server.key</code> <p>These paths are configured via environment variables:</p> <pre><code>reverse-proxy:\n  environment:\n    - TLS_ENABLED=true\n    - TLS_PORT=443\n    - CERT_FILE=./certs/server.crt\n    - KEY_FILE=./certs/server.key\n\nartifact-ingestion:\n  environment:\n    - TLS_ENABLED=true\n    - TLS_PORT=8443\n    - CERT_FILE=/certs/server.crt\n    - KEY_FILE=/certs/server.key\n  volumes:\n    - ../certs:/certs\n</code></pre>"},{"location":"deployment/tls/#generating-self-signed-certificates","title":"Generating Self-Signed Certificates","text":"<p>For development and evaluation environments:</p> <pre><code>mkdir -p certs\n\n# Generate a self-signed certificate valid for 365 days\nopenssl req -x509 -nodes -days 365 \\\n  -newkey rsa:2048 \\\n  -keyout certs/server.key \\\n  -out certs/server.crt \\\n  -subj \"/CN=witfoo-analytics\" \\\n  -addext \"subjectAltName=DNS:localhost,DNS:witfoo-analytics,IP:127.0.0.1\"\n\n# Set restrictive permissions\nchmod 600 certs/server.key\nchmod 644 certs/server.crt\n</code></pre> <p>Self-Signed Certificates</p> <p>Self-signed certificates trigger browser warnings and should only be used for development. Use certificates from a trusted CA (or an internal PKI) for production deployments.</p>"},{"location":"deployment/tls/#using-lets-encrypt-certificates","title":"Using Let's Encrypt Certificates","text":"<p>For internet-facing deployments with a public domain:</p> <pre><code># Install certbot\napt-get install certbot\n\n# Obtain certificate (standalone mode)\ncertbot certonly --standalone -d analytics.example.com\n\n# Copy to the certs directory\ncp /etc/letsencrypt/live/analytics.example.com/fullchain.pem certs/server.crt\ncp /etc/letsencrypt/live/analytics.example.com/privkey.pem certs/server.key\nchmod 600 certs/server.key\n</code></pre>"},{"location":"deployment/tls/#automated-renewal","title":"Automated Renewal","text":"<p>Create a renewal hook to copy updated certificates:</p> <pre><code>#!/bin/bash\n# /etc/letsencrypt/renewal-hooks/deploy/witfoo-analytics.sh\n\nDOMAIN=\"analytics.example.com\"\nCERT_DIR=\"/path/to/docker/certs\"\n\ncp /etc/letsencrypt/live/$DOMAIN/fullchain.pem $CERT_DIR/server.crt\ncp /etc/letsencrypt/live/$DOMAIN/privkey.pem $CERT_DIR/server.key\nchmod 600 $CERT_DIR/server.key\n</code></pre>"},{"location":"deployment/tls/#using-internal-ca-certificates","title":"Using Internal CA Certificates","text":"<p>For enterprise environments with an internal PKI:</p> <pre><code># Place your CA-signed certificate and key\ncp /path/to/signed-cert.pem certs/server.crt\ncp /path/to/private-key.pem certs/server.key\n\n# If your CA provides an intermediate chain, concatenate it\ncat /path/to/signed-cert.pem /path/to/intermediate-ca.pem &gt; certs/server.crt\n</code></pre>"},{"location":"deployment/tls/#hot-reload-of-certificates","title":"Hot-Reload of Certificates","text":"<p>The reverse proxy supports hot-reload of TLS certificates. When certificate files are updated on disk, the service detects the change and loads the new certificates without requiring a container restart.</p> <p>To trigger a certificate reload:</p> <ol> <li>Replace the certificate and key files in the <code>certs/</code> directory</li> <li>The reverse proxy's file watcher detects the change</li> <li>New TLS connections use the updated certificate</li> </ol> <p>If hot-reload is not available or you need to force a reload:</p> <pre><code># Restart only the reverse proxy\ndocker compose -f docker-compose.aio.yml restart reverse-proxy\n</code></pre> <p>Key File Permissions</p> <p>Ensure the private key file (<code>server.key</code>) has permissions <code>600</code> and is owned by the container's runtime user. The reverse proxy runs as a non-root user (UID 1000).</p>"},{"location":"deployment/tls/#disabling-tls","title":"Disabling TLS","text":"<p>For environments where TLS is terminated by an external load balancer:</p> <pre><code>TLS_ENABLED=false docker compose -f docker-compose.aio.yml up -d\n</code></pre> <p>Or in your <code>.env</code> file:</p> <pre><code>TLS_ENABLED=false\n</code></pre> <p>When TLS is disabled, the reverse proxy serves HTTP only on port 8081.</p> <p>Never Disable TLS Without External Termination</p> <p>If you disable TLS on the reverse proxy, ensure that an upstream load balancer or WAF provides HTTPS termination. Serving the Analytics UI over plain HTTP exposes authentication tokens and sensitive data to network interception.</p>"},{"location":"deployment/tls/#tls-environment-variables","title":"TLS Environment Variables","text":"Variable Service Default Description <code>TLS_ENABLED</code> reverse-proxy, artifact-ingestion <code>true</code> Enable/disable TLS <code>TLS_PORT</code> reverse-proxy <code>443</code> HTTPS listen port <code>CERT_FILE</code> reverse-proxy, artifact-ingestion <code>./certs/server.crt</code> Certificate file path <code>KEY_FILE</code> reverse-proxy, artifact-ingestion <code>./certs/server.key</code> Private key file path"},{"location":"deployment/tls/#verifying-tls-configuration","title":"Verifying TLS Configuration","text":"<p>After deployment, verify the TLS setup:</p> <pre><code># Check certificate details\nopenssl s_client -connect localhost:443 -servername analytics.example.com &lt; /dev/null 2&gt;/dev/null | \\\n  openssl x509 -noout -subject -dates -issuer\n\n# Verify the health endpoint over HTTPS\ncurl -k https://localhost/health\n\n# Test with certificate verification (requires trusted CA)\ncurl --cacert /path/to/ca-cert.pem https://analytics.example.com/health\n</code></pre>"},{"location":"deployment/tls/#cassandra-tls","title":"Cassandra TLS","text":"<p>Cassandra uses SSL for CQL client connections. The health check uses <code>cqlsh --ssl</code>:</p> <pre><code>healthcheck:\n  test: [\"CMD-SHELL\", \"cqlsh --ssl -u cassandra -p cassandra -e 'DESCRIBE KEYSPACES' || exit 1\"]\n</code></pre> <p>Cassandra TLS certificates are managed separately from the reverse proxy certificates. For clustered deployments, configure inter-node encryption in the Cassandra configuration.</p>"},{"location":"deployment/wfa/","title":"WFA Integration","text":"<p>In production environments, WitFoo Analytics is deployed and managed by the WitFoo Appliance (WFA) daemon. WFA handles container lifecycle, configuration generation, hardware validation, and upgrades. Docker Compose files serve as reference templates; WFA creates and manages containers programmatically.</p>"},{"location":"deployment/wfa/#wfa-deployment-roles","title":"WFA Deployment Roles","text":"<p>The <code>wfa configure</code> wizard presents six roles:</p> # Role Node Role ID RAM CPU Description 1 Conductor 12 8 GB 4 cores Central coordination and management 2 Console 14 8 GB 4 cores Web UI console (no processing) 3 AIO + Conductor 16 32 GB 8 cores Single-node with signal collection 4 AIO 11 16 GB 4 cores Single-node Analytics only 5 Processing 17 16 GB 4 cores Clustered compute without storage 6 Data 5 16 GB 4 cores Clustered Cassandra storage"},{"location":"deployment/wfa/#installation-workflow","title":"Installation Workflow","text":""},{"location":"deployment/wfa/#step-1-configure-the-node","title":"Step 1: Configure the Node","text":"<p>Run the interactive configuration wizard:</p> <pre><code>wfa configure\n</code></pre> <p>The wizard prompts for:</p> <ul> <li>Deployment role \u2014 Select from the six roles above</li> <li>License configuration \u2014 Enter your WitFoo license key</li> <li>Network settings \u2014 IP addresses, hostname, DNS</li> <li>Certificate settings \u2014 TLS certificate paths or auto-generation</li> <li>Web UI port and protocol \u2014 HTTPS port (default: 443)</li> <li>Admin credentials \u2014 Initial administrator username and password</li> <li>Optional features \u2014 Metrics collection, offline mode, auto-update</li> <li>Clustering settings \u2014 Seed nodes and data node addresses (for clustered roles)</li> </ul> <p>The wizard generates two configuration files:</p> File Purpose <code>/witfoo/configs/node.json</code> Node identity, networking, certificates <code>/witfoo/configs/analytics.json</code> Analytics-specific settings (role, retention, modules) <p>Post-Configuration Settings</p> <p>Data retention, UI modules, and CyberGrid settings are no longer configured during <code>wfa configure</code>. These are initialized with sensible defaults and customized later via the Onboarding Wizard in the Analytics web UI.</p>"},{"location":"deployment/wfa/#step-2-validate-hardware","title":"Step 2: Validate Hardware","text":"<pre><code>wfa analytics install\n</code></pre> <p>This command validates that the host meets minimum hardware requirements for the configured role. If the system does not meet requirements, the command exits with an error and a description of what is insufficient.</p>"},{"location":"deployment/wfa/#step-3-start-services","title":"Step 3: Start Services","text":"<pre><code>wfa start\n</code></pre> <p>The WFA daemon:</p> <ol> <li>Pulls container images for the configured role</li> <li>Creates containers with the correct environment variables</li> <li>Starts services in dependency order (Cassandra \u2192 NATS \u2192 processing \u2192 application)</li> <li>Waits for health checks to pass</li> </ol>"},{"location":"deployment/wfa/#step-4-verify-status","title":"Step 4: Verify Status","text":"<pre><code>wfa analytics status\n</code></pre> <p>Lists all expected services for the configured role and their current state:</p> <pre><code>Service                    Status      Container\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\ncassandra                  running     witfoo-analytics-cassandra\nnats                       running     witfoo-analytics-nats\nartifact-ingestion         running     witfoo-analytics-artifact-ingestion\ngraph-processor            running     witfoo-analytics-graph-processor\nincident-engine            running     witfoo-analytics-incident-engine\napi                        running     witfoo-analytics-api\ndispatcher                 running     witfoo-analytics-dispatcher\nreverse-proxy              running     witfoo-analytics-reverse-proxy\nui                         running     witfoo-analytics-ui\nprometheus                 running     witfoo-analytics-prometheus\ngrafana                    running     witfoo-analytics-grafana\n</code></pre>"},{"location":"deployment/wfa/#configuration-files","title":"Configuration Files","text":""},{"location":"deployment/wfa/#nodejson","title":"node.json","text":"<p>Generated by <code>wfa configure</code>, this file defines the node's identity and network configuration:</p> <pre><code>{\n  \"node_id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"hostname\": \"analytics-01.example.com\",\n  \"role\": 11,\n  \"ip_address\": \"10.0.1.10\",\n  \"certificates\": {\n    \"cert_file\": \"/witfoo/certs/server.crt\",\n    \"key_file\": \"/witfoo/certs/server.key\"\n  }\n}\n</code></pre>"},{"location":"deployment/wfa/#analyticsjson","title":"analytics.json","text":"<p>Analytics-specific configuration:</p> <pre><code>{\n  \"role\": \"analytics-aio\",\n  \"retention\": {\n    \"artifacts_days\": 7,\n    \"work_units_days\": 365,\n    \"work_collections_days\": 365,\n    \"reports_days\": 1825\n  },\n  \"ui_modules\": \"all\",\n  \"cybergrid\": {\n    \"enabled\": false,\n    \"publish_enabled\": false\n  },\n  \"clustering\": {}\n}\n</code></pre>"},{"location":"deployment/wfa/#clustering-configuration-data-node","title":"Clustering Configuration (Data Node)","text":"<pre><code>{\n  \"role\": \"analytics-data-node\",\n  \"clustering\": {\n    \"seed_nodes\": [\"10.0.1.10\", \"10.0.1.11\"],\n    \"listen_address\": \"10.0.1.10\"\n  }\n}\n</code></pre>"},{"location":"deployment/wfa/#clustering-configuration-processing-node","title":"Clustering Configuration (Processing Node)","text":"<pre><code>{\n  \"role\": \"analytics-processing-node\",\n  \"clustering\": {\n    \"data_node_addresses\": [\"10.0.1.10:9042\", \"10.0.1.11:9042\"]\n  }\n}\n</code></pre>"},{"location":"deployment/wfa/#upgrade-procedure","title":"Upgrade Procedure","text":""},{"location":"deployment/wfa/#1-validate-the-upgrade","title":"1. Validate the Upgrade","text":"<pre><code>wfa analytics upgrade --branch v7.1.0\n</code></pre> <p>This checks compatibility and downloads upgrade metadata without applying changes.</p>"},{"location":"deployment/wfa/#2-apply-the-upgrade","title":"2. Apply the Upgrade","text":"<pre><code>wfa stop\nwfa start\n</code></pre> <p>The WFA daemon automatically pulls new images on the next start.</p>"},{"location":"deployment/wfa/#3-verify","title":"3. Verify","text":"<pre><code>wfa analytics status\n</code></pre> <p>Backup Before Upgrading</p> <p>Always snapshot Cassandra data volumes before performing upgrades. Use <code>nodetool snapshot</code> or volume-level snapshots depending on your infrastructure.</p>"},{"location":"deployment/wfa/#cli-reference","title":"CLI Reference","text":"Command Description <code>wfa configure</code> Interactive configuration wizard <code>wfa analytics install</code> Validate hardware and prepare for deployment <code>wfa start</code> Start all services for the configured role <code>wfa stop</code> Stop all running services <code>wfa analytics status</code> Show service status for the current role <code>wfa analytics upgrade --branch &lt;version&gt;</code> Validate and prepare an upgrade"},{"location":"deployment/wfa/#wfa-vs-docker-compose","title":"WFA vs. Docker Compose","text":"Capability WFA Docker Compose Production deployment \u2705 \u274c (dev/CI only) Hardware validation \u2705 \u274c Automatic dependency ordering \u2705 \u2705 Configuration wizard \u2705 \u274c (manual <code>.env</code>) Rolling upgrades \u2705 \u274c Certificate management \u2705 Manual Appliance images \u2705 \u274c <p>For appliance downloads and installation scripts, see the witfoo-appliances repository.</p>"},{"location":"detection-rules/","title":"Detection Rules","text":"<p>WitFoo provides a comprehensive library of 68 detection rules written in the Sigma format \u2014 an open, platform-agnostic detection rule language. These rules are automatically converted to native query languages for three major SIEM platforms.</p>"},{"location":"detection-rules/#overview","title":"Overview","text":"Component Count Description Sigma Detection Rules 55 Platform-agnostic detection logic Sigma Correlation Rules 8 Multi-event behavioral detections Sigma Filter Rules 5 Noise reduction and tuning Splunk SPL Queries 55 Converted for Splunk Enterprise OpenSearch DQL Queries 55 Converted for OpenSearch / Elasticsearch Sentinel KQL Queries 55 Converted for Microsoft Sentinel Platform Dashboards 13 5 Splunk + 5 OpenSearch + 3 Sentinel"},{"location":"detection-rules/#rule-categories","title":"Rule Categories","text":"<p>Rules are organized into 9 security domains, each targeting specific threat vectors and telemetry types from WitFoo's artifact-exporter service.</p> Category Rules Focus Area Network Security 12 Traffic anomalies, tunneling, beaconing Authentication 8 Brute force, credential stuffing, MFA bypass Malware 8 C2 detection, ransomware indicators, persistence Data Loss Prevention 6 Exfiltration, large transfers, policy violations Cloud Security 6 Misconfiguration, privilege escalation, API abuse Compliance 5 Policy violations, unencrypted traffic, retention Infrastructure 5 Service health, certificate issues, config drift IDS/IPS 5 Signature-based alerts, evasion attempts Correlations 8 Multi-event behavioral detections Filters 5 Noise reduction and tuning"},{"location":"detection-rules/#platform-integration","title":"Platform Integration","text":"<p>All rules use field names from WitFoo's artifact-exporter service, which exports normalized security telemetry in a consistent JSON format. The same camelCase field names (<code>clientIP</code>, <code>serverIP</code>, <code>totalBytes</code>, <code>streamName</code>, etc.) are sent to all SIEM targets, so rules require no field mapping.</p> <pre><code>graph LR\n    A[Sigma Rules&lt;br/&gt;YAML] --&gt;|pySigma| B[Splunk SPL]\n    A --&gt;|pySigma| C[OpenSearch DQL]\n    A --&gt;|pySigma| D[Sentinel KQL]\n    B --&gt; E[Splunk App&lt;br/&gt;5 Dashboards]\n    C --&gt; F[OpenSearch&lt;br/&gt;5 Dashboards]\n    D --&gt; G[Sentinel Workbooks&lt;br/&gt;3 Workbooks]</code></pre>"},{"location":"detection-rules/#quick-start","title":"Quick Start","text":""},{"location":"detection-rules/#import-to-splunk","title":"Import to Splunk","text":"<ol> <li>Copy the <code>splunk/witfoo_siem_app/</code> directory to <code>$SPLUNK_HOME/etc/apps/</code></li> <li>Restart Splunk</li> <li>Enable desired saved searches in Settings \u2192 Searches, Reports, and Alerts</li> </ol>"},{"location":"detection-rules/#import-to-opensearch","title":"Import to OpenSearch","text":"<ol> <li>Apply the index template: Dev Tools \u2192 <code>PUT _index_template/witfoo</code> with <code>index_template.json</code></li> <li>Import dashboards: Stack Management \u2192 Saved Objects \u2192 Import each <code>.ndjson</code> file</li> <li>Verify the <code>witfoo-*</code> index pattern appears</li> </ol>"},{"location":"detection-rules/#import-to-microsoft-sentinel","title":"Import to Microsoft Sentinel","text":"<ol> <li>Deploy workbooks: Azure Portal \u2192 Sentinel \u2192 Workbooks \u2192 Add workbook \u2192 Advanced Editor and paste the ARM JSON</li> <li>Deploy analytics rules: Azure Portal \u2192 Deploy a custom template with <code>analytics_rules.json</code></li> <li>Enable desired rules in Analytics \u2192 Active rules</li> </ol>"},{"location":"detection-rules/#conversion-pipeline","title":"Conversion Pipeline","text":"<p>Rules are maintained as Sigma YAML and converted using pySigma with custom WitFoo processing pipelines.</p> <pre><code># Convert to all platforms\ncd utils/sigma-converter\nmake all\n\n# Convert for a single platform\nmake splunk\nmake opensearch\nmake sentinel\n\n# Validate without writing files\npython convert.py --target all --validate-only\n\n# Run tests\nmake test\n</code></pre>"},{"location":"detection-rules/#testing","title":"Testing","text":"<p>The rule library includes comprehensive automated tests:</p> <pre><code>cd utils/sigma-converter\n\n# Rule structure and field validation (860 tests)\npytest test_rules.py\n\n# Conversion pipeline tests (19 tests)\npytest test_convert.py\n\n# Dashboard structure tests (86 tests)\npytest test_dashboards.py\n\n# All tests together (965 tests)\npytest test_rules.py test_convert.py test_dashboards.py\n</code></pre>"},{"location":"detection-rules/platforms/opensearch/","title":"OpenSearch Integration","text":"<p>Deploy WitFoo detection rules and dashboards to OpenSearch or OpenSearch Dashboards.</p>"},{"location":"detection-rules/platforms/opensearch/#prerequisites","title":"Prerequisites","text":"<ul> <li>OpenSearch 2.x+ with OpenSearch Dashboards</li> <li>WitFoo Conductor with artifact-exporter configured to send to OpenSearch</li> <li>Admin access to manage index templates and saved objects</li> </ul>"},{"location":"detection-rules/platforms/opensearch/#architecture","title":"Architecture","text":"<pre><code>graph LR\n    A[WitFoo&lt;br/&gt;Conductor] --&gt;|REST API| B[OpenSearch&lt;br/&gt;Cluster]\n    B --&gt; C[witfoo-* indices]\n    C --&gt; D[Alerting&lt;br/&gt;55 monitors]\n    C --&gt; E[Dashboards&lt;br/&gt;5 NDJSON]</code></pre> <p>The artifact-exporter sends JSON documents to OpenSearch indices matching the <code>witfoo-*</code> pattern (e.g., <code>witfoo-2026.02.21</code>). All fields use camelCase naming.</p>"},{"location":"detection-rules/platforms/opensearch/#step-1-apply-index-template","title":"Step 1: Apply Index Template","text":"<p>Apply the index template to ensure correct field mappings:</p> Dev Toolscurl <pre><code>PUT _index_template/witfoo\n// Paste contents of opensearch/index_template.json\n</code></pre> <pre><code>curl -X PUT \"https://opensearch:9200/_index_template/witfoo\" \\\n  -H \"Content-Type: application/json\" \\\n  -d @opensearch/index_template.json\n</code></pre> <p>The template maps key fields with appropriate types:</p> <ul> <li><code>clientIP</code>, <code>serverIP</code> \u2192 <code>ip</code> type (enables CIDR queries)</li> <li><code>totalBytes</code>, <code>clientBytes</code>, <code>serverBytes</code> \u2192 <code>long</code> type</li> <li><code>startTimeUTC</code> \u2192 <code>date</code> type (used as time field)</li> <li><code>streamName</code>, <code>severity</code> \u2192 <code>keyword</code> type</li> <li><code>artifactName</code> \u2192 <code>text</code> + <code>keyword</code> (full-text + exact match)</li> </ul>"},{"location":"detection-rules/platforms/opensearch/#step-2-import-dashboards","title":"Step 2: Import Dashboards","text":"<p>Import the 5 NDJSON dashboard files via OpenSearch Dashboards:</p> <ol> <li>Navigate to Stack Management \u2192 Saved Objects</li> <li>Click Import</li> <li>Select each <code>.ndjson</code> file from <code>opensearch/dashboards/</code>:</li> </ol> Dashboard File Panels Description <code>witfoo_network_overview.ndjson</code> 8 Traffic volume, top IPs, protocols, geo <code>witfoo_security_alerts.ndjson</code> 7 Alert timeline, severity, ATT&amp;CK techniques <code>witfoo_attack_coverage.ndjson</code> 6 Technique count, tactic distribution <code>witfoo_top_talkers.ndjson</code> 6 Bandwidth consumers, user sessions <code>witfoo_protocol_analysis.ndjson</code> 5 Protocol breakdown, encrypted vs cleartext <p>Each NDJSON file includes:</p> <ul> <li>An index pattern for <code>witfoo-*</code></li> <li>The dashboard saved object</li> <li>All visualization saved objects referenced by the dashboard</li> </ul> <p>Index Pattern</p> <p>If you already have a <code>witfoo-*</code> index pattern, choose Check for existing objects during import to avoid duplicates.</p>"},{"location":"detection-rules/platforms/opensearch/#step-3-create-alerting-monitors","title":"Step 3: Create Alerting Monitors","text":"<p>Convert the 55 DQL rule files into OpenSearch alerting monitors:</p> ManualBulk API <ol> <li>Navigate to Alerting \u2192 Monitors \u2192 Create monitor</li> <li>Choose Per query monitor \u2192 Extraction query</li> <li>Set Index to <code>witfoo-*</code></li> <li>Paste the DQL query from any <code>.dql</code> file in <code>opensearch/rules/</code></li> <li>Configure trigger threshold and notification channel</li> </ol> <pre><code># Example: create a monitor from a DQL file\nfor f in opensearch/rules/*.dql; do\n  NAME=$(basename \"$f\" .dql)\n  QUERY=$(cat \"$f\")\n  curl -X POST \"https://opensearch:9200/_plugins/_alerting/monitors\" \\\n    -H \"Content-Type: application/json\" \\\n    -d \"{\n      \\\"name\\\": \\\"WitFoo - $NAME\\\",\n      \\\"type\\\": \\\"monitor\\\",\n      \\\"enabled\\\": false,\n      \\\"schedule\\\": {\\\"period\\\": {\\\"interval\\\": 15, \\\"unit\\\": \\\"MINUTES\\\"}},\n      \\\"inputs\\\": [{\\\"search\\\": {\\\"indices\\\": [\\\"witfoo-*\\\"], \\\"query\\\": {\\\"query_string\\\": {\\\"query\\\": \\\"$QUERY\\\"}}}}],\n      \\\"triggers\\\": [{\\\"name\\\": \\\"Alert\\\", \\\"severity\\\": \\\"3\\\", \\\"condition\\\": {\\\"script\\\": {\\\"source\\\": \\\"ctx.results[0].hits.total.value &gt; 0\\\"}}}]\n    }\"\ndone\n</code></pre>"},{"location":"detection-rules/platforms/opensearch/#field-reference","title":"Field Reference","text":"Field OpenSearch Type Description <code>clientIP</code> <code>ip</code> Source/client IP <code>serverIP</code> <code>ip</code> Destination/server IP <code>serverPort</code> <code>integer</code> Destination port <code>protocol</code> <code>keyword</code> Network protocol <code>totalBytes</code> <code>long</code> Total bytes transferred <code>streamName</code> <code>keyword</code> WitFoo stream classification <code>severity</code> <code>keyword</code> Alert severity <code>leadRuleIDs</code> <code>integer</code> (array) Triggered lead rule IDs <code>attackTechniqueIDs</code> <code>keyword</code> (array) ATT&amp;CK technique IDs <code>startTimeUTC</code> <code>date</code> Event timestamp"},{"location":"detection-rules/platforms/opensearch/#troubleshooting","title":"Troubleshooting","text":"<p>No Data in Dashboards</p> <p>Check that documents are flowing to the <code>witfoo-*</code> index: <pre><code>GET witfoo-*/_count\n</code></pre> If count is 0, verify the artifact-exporter endpoint and authentication.</p> <p>Field Type Conflicts</p> <p>If the index template was applied after data was already indexed, existing indices keep their original mapping. Reindex or wait for new index rotation.</p> <p>Performance</p> <p>For high-volume environments, consider:</p> <ul> <li>Increasing shard count in the index template</li> <li>Using ISM policies for index lifecycle management</li> <li>Adding <code>startTimeUTC</code> as the sort field for time-based queries</li> </ul>"},{"location":"detection-rules/platforms/sentinel/","title":"Microsoft Sentinel Integration","text":"<p>Deploy WitFoo detection rules and dashboards to Microsoft Sentinel using ARM templates.</p>"},{"location":"detection-rules/platforms/sentinel/#prerequisites","title":"Prerequisites","text":"<ul> <li>Microsoft Sentinel workspace (Log Analytics)</li> <li>WitFoo Conductor with artifact-exporter configured to send to Sentinel</li> <li>Azure CLI or portal access with Contributor role on the resource group</li> <li>Data flowing to <code>WitFoo_CL</code> custom log table</li> </ul>"},{"location":"detection-rules/platforms/sentinel/#architecture","title":"Architecture","text":"<pre><code>graph LR\n    A[WitFoo&lt;br/&gt;Conductor] --&gt;|Data Connector&lt;br/&gt;or Log Analytics API| B[Log Analytics&lt;br/&gt;Workspace]\n    B --&gt; C[WitFoo_CL&lt;br/&gt;Custom Table]\n    C --&gt; D[Analytics Rules&lt;br/&gt;55 KQL rules]\n    C --&gt; E[Workbooks&lt;br/&gt;3 ARM templates]</code></pre> <p>The artifact-exporter sends events to a Log Analytics workspace. Sentinel applies the <code>_CL</code> suffix to the custom table and field suffixes based on type: <code>_s</code> (string), <code>_d</code> (double), <code>_t</code> (datetime), <code>_b</code> (boolean).</p>"},{"location":"detection-rules/platforms/sentinel/#step-1-deploy-analytics-rules","title":"Step 1: Deploy Analytics Rules","text":"<p>The 55 scheduled analytics rules are packaged as a single ARM template.</p> Azure CLIAzure PortalPowerShell <pre><code>az deployment group create \\\n  --resource-group &lt;your-rg&gt; \\\n  --template-file sentinel/analytics_rules.json \\\n  --parameters workspaceName=&lt;your-workspace&gt;\n</code></pre> <ol> <li>Navigate to Deploy a custom template</li> <li>Click Build your own template in the editor</li> <li>Paste contents of <code>sentinel/analytics_rules.json</code></li> <li>Set <code>workspaceName</code> parameter to your Sentinel workspace name</li> <li>Select your subscription and resource group</li> <li>Click Review + create</li> </ol> <pre><code>New-AzResourceGroupDeployment `\n  -ResourceGroupName &lt;your-rg&gt; `\n  -TemplateFile sentinel/analytics_rules.json `\n  -workspaceName &lt;your-workspace&gt;\n</code></pre> <p>All 55 rules are deployed disabled by default. Enable rules individually:</p> <ol> <li>Navigate to Sentinel \u2192 Analytics \u2192 Active rules</li> <li>Filter by prefix <code>WitFoo -</code></li> <li>Select rules to enable \u2192 Enable</li> </ol>"},{"location":"detection-rules/platforms/sentinel/#rule-properties","title":"Rule Properties","text":"Property Value Type Scheduled Frequency 15 minutes Lookback 15 minutes Status Disabled (default) Entity mapping IP entities for <code>clientIP_s</code>, <code>serverIP_s</code>"},{"location":"detection-rules/platforms/sentinel/#step-2-deploy-workbooks","title":"Step 2: Deploy Workbooks","text":"<p>Three workbooks provide operational dashboards:</p> Workbook KQL Queries Description <code>witfoo_network_overview.json</code> 8 Traffic volume, top IPs, protocols, geo regions <code>witfoo_security_alerts.json</code> 7 Alert timeline, severity distribution, ATT&amp;CK mapping <code>witfoo_attack_coverage.json</code> 7 Coverage metrics, tactic distribution, technique trends <p>Deploy each workbook:</p> Azure CLIAzure Portal <pre><code>az deployment group create \\\n  --resource-group &lt;your-rg&gt; \\\n  --template-file sentinel/workbooks/witfoo_network_overview.json \\\n  --parameters workspaceName=&lt;your-workspace&gt;\n\naz deployment group create \\\n  --resource-group &lt;your-rg&gt; \\\n  --template-file sentinel/workbooks/witfoo_security_alerts.json \\\n  --parameters workspaceName=&lt;your-workspace&gt;\n\naz deployment group create \\\n  --resource-group &lt;your-rg&gt; \\\n  --template-file sentinel/workbooks/witfoo_attack_coverage.json \\\n  --parameters workspaceName=&lt;your-workspace&gt;\n</code></pre> <ol> <li>Navigate to Sentinel \u2192 Workbooks \u2192 Templates</li> <li>Click Add workbook \u2192 Advanced Editor</li> <li>Paste the ARM template JSON</li> <li>Set <code>workspaceName</code> parameter</li> <li>Click Apply \u2192 Done Editing \u2192 Save</li> </ol>"},{"location":"detection-rules/platforms/sentinel/#kql-field-naming","title":"KQL Field Naming","text":"<p>Sentinel appends type suffixes to custom log fields. Map WitFoo's camelCase fields to their Sentinel equivalents:</p> WitFoo Field Sentinel Column Type <code>clientIP</code> <code>clientIP_s</code> string <code>serverIP</code> <code>serverIP_s</code> string <code>serverPort</code> <code>serverPort_d</code> double <code>protocol</code> <code>protocol_s</code> string <code>totalBytes</code> <code>totalBytes_d</code> double <code>clientBytes</code> <code>clientBytes_d</code> double <code>serverBytes</code> <code>serverBytes_d</code> double <code>streamName</code> <code>streamName_s</code> string <code>severity</code> <code>severity_s</code> string <code>leadRuleIDs</code> <code>leadRuleIDs_s</code> string (JSON array) <code>attackTechniqueIDs</code> <code>attackTechniqueIDs_s</code> string (JSON array) <code>startTimeUTC</code> <code>TimeGenerated</code> datetime <code>artifactName</code> <code>artifactName_s</code> string <code>userName</code> <code>userName_s</code> string <code>eventAction</code> <code>eventAction_s</code> string <p>Array Fields</p> <p>Fields like <code>leadRuleIDs</code> and <code>attackTechniqueIDs</code> are stored as JSON strings in Sentinel. Use <code>mv-expand</code> or <code>parse_json()</code> in KQL: <pre><code>WitFoo_CL\n| extend techniques = parse_json(attackTechniqueIDs_s)\n| mv-expand techniques\n| summarize count() by tostring(techniques)\n</code></pre></p>"},{"location":"detection-rules/platforms/sentinel/#kql-query-examples","title":"KQL Query Examples","text":""},{"location":"detection-rules/platforms/sentinel/#recent-high-severity-alerts","title":"Recent High-Severity Alerts","text":"<pre><code>WitFoo_CL\n| where severity_s in (\"high\", \"critical\")\n| where TimeGenerated &gt; ago(1h)\n| project TimeGenerated, streamName_s, clientIP_s, serverIP_s, severity_s, artifactName_s\n| order by TimeGenerated desc\n| take 100\n</code></pre>"},{"location":"detection-rules/platforms/sentinel/#top-attck-techniques","title":"Top ATT&amp;CK Techniques","text":"<pre><code>WitFoo_CL\n| where isnotempty(attackTechniqueIDs_s)\n| extend techniques = parse_json(attackTechniqueIDs_s)\n| mv-expand techniques\n| summarize count() by tostring(techniques)\n| order by count_ desc\n| take 25\n</code></pre>"},{"location":"detection-rules/platforms/sentinel/#network-traffic-by-protocol","title":"Network Traffic by Protocol","text":"<pre><code>WitFoo_CL\n| where isnotempty(protocol_s)\n| summarize\n    TotalBytes = sum(totalBytes_d),\n    Connections = count()\n    by protocol_s\n| order by TotalBytes desc\n</code></pre>"},{"location":"detection-rules/platforms/sentinel/#troubleshooting","title":"Troubleshooting","text":"<p>No Data in WitFoo_CL</p> <p>Verify data ingestion: <pre><code>WitFoo_CL\n| take 10\n</code></pre> If empty, check:</p> <ul> <li>Artifact-exporter configuration in Conductor</li> <li>Data connector status in Sentinel</li> <li>Log Analytics workspace ID and key</li> </ul> <p>ARM Deployment Fails</p> <p>Common issues:</p> <ul> <li>Invalid workspace name: Must match the exact Log Analytics workspace   name, not the Sentinel display name</li> <li>Permission error: Ensure Contributor role on the resource group</li> <li>API version mismatch: The templates use <code>2022-11-01-preview</code> for   analytics rules and <code>2022-04-01</code> for workbooks</li> </ul> <p>Cost Optimization</p> <ul> <li>Start with rules disabled and enable based on relevance</li> <li>Use Analytics rule grouping to batch related alerts into single incidents</li> <li>Set entity mapping to correlate alerts by IP address across rules</li> <li>Consider Basic Logs tier for high-volume, low-priority streams</li> </ul>"},{"location":"detection-rules/platforms/splunk/","title":"Splunk Integration","text":"<p>Deploy WitFoo detection rules and dashboards to Splunk Enterprise or Splunk Cloud.</p>"},{"location":"detection-rules/platforms/splunk/#prerequisites","title":"Prerequisites","text":"<ul> <li>Splunk Enterprise 8.x+ or Splunk Cloud</li> <li>WitFoo Conductor with artifact-exporter configured to send to Splunk via HEC</li> <li>Admin access to install apps and create saved searches</li> </ul>"},{"location":"detection-rules/platforms/splunk/#architecture","title":"Architecture","text":"<pre><code>graph LR\n    A[WitFoo&lt;br/&gt;Conductor] --&gt;|HEC| B[Splunk&lt;br/&gt;Indexer]\n    B --&gt; C[witfoo index]\n    C --&gt; D[Saved Searches&lt;br/&gt;55 rules]\n    C --&gt; E[Dashboards&lt;br/&gt;5 views]</code></pre> <p>The artifact-exporter sends JSON events to Splunk's HTTP Event Collector (HEC). Events land in the <code>witfoo</code> index with sourcetype <code>witfoo:artifact</code>. All fields use camelCase naming from the artifact-exporter schema.</p>"},{"location":"detection-rules/platforms/splunk/#install-the-witfoo-siem-app","title":"Install the WitFoo SIEM App","text":""},{"location":"detection-rules/platforms/splunk/#option-1-copy-to-apps-directory","title":"Option 1: Copy to Apps Directory","text":"<pre><code># Copy the app directory\ncp -r splunk/witfoo_siem_app/ $SPLUNK_HOME/etc/apps/witfoo_siem_app/\n\n# Restart Splunk\n$SPLUNK_HOME/bin/splunk restart\n</code></pre>"},{"location":"detection-rules/platforms/splunk/#option-2-package-as-tgz","title":"Option 2: Package as .tgz","text":"<pre><code># Create a Splunk app package\ntar -czf witfoo_siem_app.tgz -C splunk/ witfoo_siem_app/\n\n# Install via Splunk CLI\n$SPLUNK_HOME/bin/splunk install app witfoo_siem_app.tgz -auth admin:changeme\n</code></pre>"},{"location":"detection-rules/platforms/splunk/#app-contents","title":"App Contents","text":""},{"location":"detection-rules/platforms/splunk/#dashboards-5","title":"Dashboards (5)","text":"Dashboard Panels Description Network Overview 8 Traffic volume, top IPs, protocol distribution, geo regions Security Alerts 7 Alert timeline, severity distribution, ATT&amp;CK techniques ATT&amp;CK Coverage 6 Technique count, tactic distribution, coverage trend Top Talkers 6 Bandwidth consumers, src-dst pairs, user sessions Protocol Analysis 5 Protocol breakdown, port usage, encrypted vs cleartext"},{"location":"detection-rules/platforms/splunk/#saved-searches-55","title":"Saved Searches (55)","text":"<p>All 55 detection rules are deployed as saved searches. They are disabled by default \u2014 enable the ones relevant to your environment.</p> <pre><code># Example saved search structure\n[WitFoo - DNS Tunneling Detection]\nsearch = index=witfoo sourcetype=\"witfoo:artifact\" | spath ...\ndisabled = 1\ncron_schedule = */15 * * * *\ndispatch.earliest_time = -15m\ndispatch.latest_time = now\n</code></pre> <p>To enable a saved search:</p> <ol> <li>Settings \u2192 Searches, Reports, and Alerts</li> <li>Find the search prefixed with \"WitFoo - \"</li> <li>Click Edit \u2192 Enable</li> </ol>"},{"location":"detection-rules/platforms/splunk/#index-configuration","title":"Index Configuration","text":"<p>Create the <code>witfoo</code> index if it doesn't exist:</p> <pre><code># indexes.conf\n[witfoo]\nhomePath = $SPLUNK_DB/witfoo/db\ncoldPath = $SPLUNK_DB/witfoo/colddb\nthawedPath = $SPLUNK_DB/witfoo/thaweddb\nmaxTotalDataSizeMB = 512000\nfrozenTimePeriodInSecs = 7776000\n</code></pre>"},{"location":"detection-rules/platforms/splunk/#hec-token-setup","title":"HEC Token Setup","text":"<pre><code># inputs.conf\n[http://witfoo-artifacts]\ndisabled = 0\ntoken = &lt;your-hec-token&gt;\nindex = witfoo\nsourcetype = witfoo:artifact\n</code></pre>"},{"location":"detection-rules/platforms/splunk/#field-reference","title":"Field Reference","text":"<p>All queries use <code>| spath</code> to extract JSON fields. Key fields:</p> Field Type Description <code>clientIP</code> IP Source/client IP address <code>serverIP</code> IP Destination/server IP address <code>serverPort</code> integer Destination port <code>protocol</code> string Network protocol (TCP, UDP, etc.) <code>totalBytes</code> long Total bytes transferred <code>streamName</code> string WitFoo stream classification <code>severity</code> string Alert severity level <code>leadRuleIDs</code> array Triggered lead rule IDs <code>attackTechniqueIDs</code> array MITRE ATT&amp;CK technique IDs <code>startTimeUTC</code> timestamp Event start time"},{"location":"detection-rules/platforms/splunk/#troubleshooting","title":"Troubleshooting","text":"<p>No Data in Dashboards</p> <p>Verify the artifact-exporter is sending to the correct HEC endpoint: <pre><code>index=witfoo | head 10\n</code></pre> If no results, check the HEC token configuration and network connectivity.</p> <p>Slow Dashboard Loads</p> <p>Reduce the time range or add summary indexing for frequently-queried fields: <pre><code>| tstats count where index=witfoo by clientIP, serverIP span=1h\n</code></pre></p>"},{"location":"detection-rules/rules/authentication/","title":"Authentication Rules","text":"<p>Detect authentication-based attacks including brute force, credential stuffing, and MFA bypass attempts.</p> <p>8 rules in this category.</p>"},{"location":"detection-rules/rules/authentication/#rule-summary","title":"Rule Summary","text":"ID Title Level ATT&amp;CK <code>wf-auth-001</code> Authentication Failure medium T1110 <code>wf-auth-002</code> Brute Force Indicator high T1110.001 <code>wf-auth-003</code> Credential Access Attempt high T1003 <code>wf-auth-004</code> Privilege Escalation critical T1068 <code>wf-auth-005</code> Administrative Account Activity medium T1078.002 <code>wf-auth-006</code> Malicious Session Detection high T1078 <code>wf-auth-007</code> Defense Evasion Activity high T1562 <code>wf-auth-008</code> Service Discovery Activity medium T1046"},{"location":"detection-rules/rules/authentication/#rule-details","title":"Rule Details","text":""},{"location":"detection-rules/rules/authentication/#authentication-failure","title":"Authentication Failure","text":"<p>ID: <code>wf-auth-001</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects individual authentication failure events. While a single failure may be benign, these events are the building blocks for brute force and credential spray correlation rules.</p> <p>Tags: <code>attack.credential_access</code>, <code>attack.t1110</code></p> Detection Logic <ul> <li>messageType: <code>auth_failure</code></li> </ul>"},{"location":"detection-rules/rules/authentication/#brute-force-indicator","title":"Brute Force Indicator","text":"<p>ID: <code>wf-auth-002</code> Level: high Status: stable Author: WitFoo</p> <p>Detects high-severity authentication failures that may indicate active brute force attempts. These single-event indicators are enriched by WitFoo's lead rule engine to flag repeated failures.</p> <p>Tags: <code>attack.credential_access</code>, <code>attack.t1110.001</code></p> Detection Logic <ul> <li>messageType: <code>auth_failure</code></li> <li>severityLabel: <code>['high', 'critical']</code></li> </ul>"},{"location":"detection-rules/rules/authentication/#credential-access-attempt","title":"Credential Access Attempt","text":"<p>ID: <code>wf-auth-003</code> Level: high Status: stable Author: WitFoo</p> <p>Detects credential access attempts including credential dumping, token theft, and keystroke logging indicators classified by WitFoo's artifact enrichment.</p> <p>Tags: <code>attack.credential_access</code>, <code>attack.t1003</code></p> Detection Logic <ul> <li>messageType: <code>credential_access</code></li> </ul>"},{"location":"detection-rules/rules/authentication/#privilege-escalation","title":"Privilege Escalation","text":"<p>ID: <code>wf-auth-004</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects privilege escalation events where a user or process gains elevated access beyond their normal permissions. This is a critical security event that may indicate exploitation of vulnerabilities or misconfigurations.</p> <p>Tags: <code>attack.privilege_escalation</code>, <code>attack.t1068</code></p> Detection Logic <ul> <li>messageType: <code>privilege_escalation</code></li> </ul>"},{"location":"detection-rules/rules/authentication/#administrative-account-activity","title":"Administrative Account Activity","text":"<p>ID: <code>wf-auth-005</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects activity by administrative or high-privilege accounts. While not inherently malicious, tracking admin actions provides audit trail for compliance and helps identify compromised privileged accounts.</p> <p>Tags: <code>attack.persistence</code>, <code>attack.t1078.002</code></p> Detection Logic <ul> <li>userName: <code>['admin', 'root', 'Administrator']</code></li> <li>severityLabel: <code>['high', 'critical']</code></li> </ul>"},{"location":"detection-rules/rules/authentication/#malicious-session-detection","title":"Malicious Session Detection","text":"<p>ID: <code>wf-auth-006</code> Level: high Status: stable Author: WitFoo</p> <p>Detects sessions classified as malicious by WitFoo's behavioral analysis. This includes sessions exhibiting characteristics of account takeover, session hijacking, or unauthorized access after credential compromise.</p> <p>Tags: <code>attack.defense_evasion</code>, <code>attack.t1078</code></p> Detection Logic <ul> <li>messageType: <code>malicious_session</code></li> </ul>"},{"location":"detection-rules/rules/authentication/#defense-evasion-activity","title":"Defense Evasion Activity","text":"<p>ID: <code>wf-auth-007</code> Level: high Status: stable Author: WitFoo</p> <p>Detects defense evasion techniques including log tampering, security tool disabling, indicator removal, and other actions intended to avoid detection by security monitoring systems.</p> <p>Tags: <code>attack.defense_evasion</code>, <code>attack.t1562</code></p> Detection Logic <ul> <li>messageType: <code>defense_evasion</code></li> </ul>"},{"location":"detection-rules/rules/authentication/#service-discovery-activity","title":"Service Discovery Activity","text":"<p>ID: <code>wf-auth-008</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects service discovery and network enumeration activity that may indicate reconnaissance by an attacker who has gained initial access. Includes port scanning, service fingerprinting, and network mapping.</p> <p>Tags: <code>attack.discovery</code>, <code>attack.t1046</code></p> Detection Logic <ul> <li>messageType: <code>service_discovery</code></li> </ul>"},{"location":"detection-rules/rules/cloud/","title":"Cloud Security Rules","text":"<p>Detect cloud infrastructure threats including misconfiguration, privilege escalation, and API abuse.</p> <p>6 rules in this category.</p>"},{"location":"detection-rules/rules/cloud/#rule-summary","title":"Rule Summary","text":"ID Title Level ATT&amp;CK <code>wf-cloud-001</code> Cloud Privilege Escalation critical T1078.004 <code>wf-cloud-002</code> Cloud Configuration Change high T1562.007 <code>wf-cloud-003</code> Cloud API Abuse high T1106 <code>wf-cloud-004</code> Phishing Email Detection high T1566 <code>wf-cloud-005</code> Phishing Link Click critical T1204.001 <code>wf-cloud-006</code> Policy Violation medium T1078"},{"location":"detection-rules/rules/cloud/#rule-details","title":"Rule Details","text":""},{"location":"detection-rules/rules/cloud/#cloud-privilege-escalation","title":"Cloud Privilege Escalation","text":"<p>ID: <code>wf-cloud-001</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects privilege escalation events in cloud environments including IAM role assumption, service account key creation, and permission boundary modifications.</p> <p>Tags: <code>attack.privilege_escalation</code>, <code>attack.t1078.004</code></p> Detection Logic <ul> <li>messageType: <code>privilege_escalation</code></li> <li>streamName: <code>['aws', 'azure', 'gcp', 'cloud']</code></li> </ul>"},{"location":"detection-rules/rules/cloud/#cloud-configuration-change","title":"Cloud Configuration Change","text":"<p>ID: <code>wf-cloud-002</code> Level: high Status: stable Author: WitFoo</p> <p>Detects infrastructure configuration changes in cloud environments that may weaken security posture, including security group modifications, firewall rule changes, and logging configuration alterations.</p> <p>Tags: <code>attack.defense_evasion</code>, <code>attack.t1562.007</code></p> Detection Logic <ul> <li>messageType: <code>config_change</code></li> <li>streamName: <code>['aws', 'azure', 'gcp', 'cloud']</code></li> </ul>"},{"location":"detection-rules/rules/cloud/#cloud-api-abuse","title":"Cloud API Abuse","text":"<p>ID: <code>wf-cloud-003</code> Level: high Status: stable Author: WitFoo</p> <p>Detects anomalous cloud API call patterns that may indicate compromised credentials, unauthorized automation, or adversary reconnaissance of cloud infrastructure.</p> <p>Tags: <code>attack.execution</code>, <code>attack.t1106</code></p> Detection Logic <ul> <li>streamName: <code>['aws_cloudtrail', 'azure_activity', 'gcp_audit']</code></li> <li>severityLabel: <code>['high', 'critical']</code></li> </ul>"},{"location":"detection-rules/rules/cloud/#phishing-email-detection","title":"Phishing Email Detection","text":"<p>ID: <code>wf-cloud-004</code> Level: high Status: stable Author: WitFoo</p> <p>Detects phishing emails identified by email security gateways or WitFoo's threat intelligence enrichment. Phishing is one of the most common initial access vectors for cyber attacks.</p> <p>Tags: <code>attack.initial_access</code>, <code>attack.t1566</code></p> Detection Logic <ul> <li>messageType: <code>phishing_email</code></li> </ul>"},{"location":"detection-rules/rules/cloud/#phishing-link-click","title":"Phishing Link Click","text":"<p>ID: <code>wf-cloud-005</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects when a user clicks on a phishing link, indicating potential credential compromise or malware delivery. This is a high-priority event requiring immediate user notification and credential reset evaluation.</p> <p>Tags: <code>attack.initial_access</code>, <code>attack.t1204.001</code></p> Detection Logic <ul> <li>messageType: <code>phishing_click</code></li> </ul>"},{"location":"detection-rules/rules/cloud/#policy-violation","title":"Policy Violation","text":"<p>ID: <code>wf-cloud-006</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects security policy violations including acceptable use violations, data handling policy breaches, and compliance control failures detected by DLP, CASB, or policy enforcement tools.</p> <p>Tags: <code>attack.defense_evasion</code>, <code>attack.t1078</code></p> Detection Logic <ul> <li>messageType: <code>policy_violation</code></li> </ul>"},{"location":"detection-rules/rules/compliance/","title":"Compliance Rules","text":"<p>Detect compliance policy violations including unencrypted traffic, retention issues, and regulatory control failures.</p> <p>5 rules in this category.</p>"},{"location":"detection-rules/rules/compliance/#rule-summary","title":"Rule Summary","text":"ID Title Level ATT&amp;CK <code>wf-comp-001</code> IDS Event Detection high T1190 <code>wf-comp-002</code> IPS Action Taken high T1190 <code>wf-comp-003</code> Content Filter Match medium T1071 <code>wf-comp-004</code> Indicator of Compromise Match critical T1071 <code>wf-comp-005</code> Indicator of Misconfiguration Match medium T1562"},{"location":"detection-rules/rules/compliance/#rule-details","title":"Rule Details","text":""},{"location":"detection-rules/rules/compliance/#ids-event-detection","title":"IDS Event Detection","text":"<p>ID: <code>wf-comp-001</code> Level: high Status: stable Author: WitFoo</p> <p>Detects intrusion detection system (IDS) alerts forwarded through WitFoo's artifact pipeline. These are network-based or host-based IDS signatures that matched suspicious or malicious traffic patterns.</p> <p>Tags: <code>attack.initial_access</code>, <code>attack.t1190</code></p> Detection Logic <ul> <li>messageType: <code>ids_event</code></li> </ul>"},{"location":"detection-rules/rules/compliance/#ips-action-taken","title":"IPS Action Taken","text":"<p>ID: <code>wf-comp-002</code> Level: high Status: stable Author: WitFoo</p> <p>Detects intrusion prevention system (IPS) events where protective action was taken (block, drop, reset). These indicate the IPS actively prevented a detected attack from succeeding.</p> <p>Tags: <code>attack.initial_access</code>, <code>attack.t1190</code></p> Detection Logic <ul> <li>messageType: <code>ids_action</code></li> </ul>"},{"location":"detection-rules/rules/compliance/#content-filter-match","title":"Content Filter Match","text":"<p>ID: <code>wf-comp-003</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects content filtering events where web content, email content, or file content matched a DLP or content inspection policy. May indicate sensitive data exposure or policy violations.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071</code></p> Detection Logic <ul> <li>messageType: <code>content_filter</code></li> </ul>"},{"location":"detection-rules/rules/compliance/#indicator-of-compromise-match","title":"Indicator of Compromise Match","text":"<p>ID: <code>wf-comp-004</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects matches against known indicators of compromise (IOCs) from threat intelligence feeds. This includes IP addresses, domain names, file hashes, and URLs associated with known threat actors or malware campaigns.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071</code></p> Detection Logic <ul> <li>messageType: <code>ioc_match</code></li> </ul>"},{"location":"detection-rules/rules/compliance/#indicator-of-misconfiguration-match","title":"Indicator of Misconfiguration Match","text":"<p>ID: <code>wf-comp-005</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects indicators of misconfiguration (IOMs) that may create security vulnerabilities. Includes open ports, weak encryption, missing patches, and non-compliant configurations detected by vulnerability scanners or configuration audit tools.</p> <p>Tags: <code>attack.defense_evasion</code>, <code>attack.t1562</code></p> Detection Logic <ul> <li>messageType: <code>iom_match</code></li> </ul>"},{"location":"detection-rules/rules/correlations/","title":"Correlation Rules","text":"<p>Multi-event behavioral detections using Sigma v2 correlation syntax for event counting, value counting, and temporal ordering.</p> <p>8 rules in this category.</p>"},{"location":"detection-rules/rules/correlations/#rule-summary","title":"Rule Summary","text":"ID Title Level ATT&amp;CK <code>wf-corr-001</code> Brute Force Attack Sequence high T1110 <code>wf-corr-002</code> Credential Spraying Attack high T1110.003 <code>wf-corr-003</code> Lateral Movement Chain critical T1021.002 <code>wf-corr-004</code> Data Exfiltration After Reconnaissance critical T1041, T1046 <code>wf-corr-005</code> Ransomware Kill Chain critical T1486 <code>wf-corr-006</code> Phishing to Account Compromise critical T1566, T1078 <code>wf-corr-007</code> Multi-Source C2 Beaconing critical T1071.001 <code>wf-corr-008</code> Repeated Policy Violations high T1078"},{"location":"detection-rules/rules/correlations/#rule-details","title":"Rule Details","text":""},{"location":"detection-rules/rules/correlations/#brute-force-attack-sequence","title":"Brute Force Attack Sequence","text":"<p>ID: <code>wf-corr-001</code> Level: high Status: stable Author: WitFoo</p> <p>Correlates multiple authentication failure events from the same source IP within a 5-minute window. Five or more failures indicate a likely brute force attack requiring investigation and potential IP blocking.</p> <p>Tags: <code>attack.credential_access</code>, <code>attack.t1110</code></p> <p>Type: <code>event_count</code> Group By: <code>clientIP</code> gte: <code>5</code> </p>"},{"location":"detection-rules/rules/correlations/#credential-spraying-attack","title":"Credential Spraying Attack","text":"<p>ID: <code>wf-corr-002</code> Level: high Status: stable Author: WitFoo</p> <p>Correlates authentication failures targeting the same server with 10 or more distinct usernames within 15 minutes. This pattern is characteristic of credential spraying attacks where an adversary tries common passwords across many accounts.</p> <p>Tags: <code>attack.credential_access</code>, <code>attack.t1110.003</code></p> <p>Type: <code>value_count</code> Group By: <code>serverIP</code> field: <code>userName</code> gte: <code>10</code> </p>"},{"location":"detection-rules/rules/correlations/#lateral-movement-chain","title":"Lateral Movement Chain","text":"<p>ID: <code>wf-corr-003</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects a lateral movement chain where SMB connections between workstations are followed by malicious session indicators from the same source IP within 30 minutes. This ordered sequence suggests an attacker moving through the network after initial compromise.</p> <p>Tags: <code>attack.lateral_movement</code>, <code>attack.t1021.002</code></p> <p>Type: <code>temporal_ordered</code> Group By: <code>clientIP</code> </p>"},{"location":"detection-rules/rules/correlations/#data-exfiltration-after-reconnaissance","title":"Data Exfiltration After Reconnaissance","text":"<p>ID: <code>wf-corr-004</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects the attack pattern of network reconnaissance (port scanning) followed by data exfiltration from the same source IP within 60 minutes. This ordered sequence indicates an adversary who has completed discovery and is actively extracting data.</p> <p>Tags: <code>attack.exfiltration</code>, <code>attack.t1041</code>, <code>attack.discovery</code>, <code>attack.t1046</code></p> <p>Type: <code>temporal_ordered</code> Group By: <code>clientIP</code> </p>"},{"location":"detection-rules/rules/correlations/#ransomware-kill-chain","title":"Ransomware Kill Chain","text":"<p>ID: <code>wf-corr-005</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects the complete ransomware kill chain: payload download followed by active encryption from the same source within 60 minutes. This is a critical alert indicating a ransomware attack has progressed from delivery to impact phase.</p> <p>Tags: <code>attack.impact</code>, <code>attack.t1486</code></p> <p>Type: <code>temporal_ordered</code> Group By: <code>clientIP</code> </p>"},{"location":"detection-rules/rules/correlations/#phishing-to-account-compromise","title":"Phishing to Account Compromise","text":"<p>ID: <code>wf-corr-006</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects the phishing attack chain where a user clicks a phishing link followed by a malicious session from the same user within 30 minutes. This indicates successful credential harvesting leading to account compromise.</p> <p>Tags: <code>attack.initial_access</code>, <code>attack.t1566</code>, <code>attack.t1078</code></p> <p>Type: <code>temporal_ordered</code> Group By: <code>userName</code> </p>"},{"location":"detection-rules/rules/correlations/#multi-source-c2-beaconing","title":"Multi-Source C2 Beaconing","text":"<p>ID: <code>wf-corr-007</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects a single C2 server receiving beaconing connections from 3 or more distinct internal hosts within 60 minutes. Multiple infections communicating with the same C2 infrastructure indicates a widespread compromise requiring coordinated response.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071.001</code></p> <p>Type: <code>value_count</code> Group By: <code>serverIP</code> field: <code>clientIP</code> gte: <code>3</code> </p>"},{"location":"detection-rules/rules/correlations/#repeated-policy-violations","title":"Repeated Policy Violations","text":"<p>ID: <code>wf-corr-008</code> Level: high Status: stable Author: WitFoo</p> <p>Detects users who trigger 5 or more security policy violations within a 24-hour period. Repeated violations may indicate a compromised account, insider threat activity, or a user systematically circumventing controls.</p> <p>Tags: <code>attack.defense_evasion</code>, <code>attack.t1078</code></p> <p>Type: <code>event_count</code> Group By: <code>userName</code> gte: <code>5</code> </p>"},{"location":"detection-rules/rules/data-loss/","title":"Data Loss Prevention Rules","text":"<p>Detect data exfiltration attempts, unusually large transfers, and policy violations related to data handling.</p> <p>6 rules in this category.</p>"},{"location":"detection-rules/rules/data-loss/#rule-summary","title":"Rule Summary","text":"ID Title Level ATT&amp;CK <code>wf-dlp-001</code> Data Staging Activity high T1074 <code>wf-dlp-002</code> Data Exfiltration critical T1041 <code>wf-dlp-003</code> Data Destruction critical T1485 <code>wf-dlp-004</code> Large Outbound Data Transfer high T1048 <code>wf-dlp-005</code> Suspicious HTTP POST Exfiltration high T1048.003 <code>wf-dlp-006</code> Unauthorized File Transfer high T1041"},{"location":"detection-rules/rules/data-loss/#rule-details","title":"Rule Details","text":""},{"location":"detection-rules/rules/data-loss/#data-staging-activity","title":"Data Staging Activity","text":"<p>ID: <code>wf-dlp-001</code> Level: high Status: stable Author: WitFoo</p> <p>Detects data staging activity where an adversary collects and stages data in preparation for exfiltration. This may include copying files to a central location, archiving data, or staging data on network shares.</p> <p>Tags: <code>attack.collection</code>, <code>attack.t1074</code></p> Detection Logic <ul> <li>messageType: <code>data_staging</code></li> </ul>"},{"location":"detection-rules/rules/data-loss/#data-exfiltration","title":"Data Exfiltration","text":"<p>ID: <code>wf-dlp-002</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects data exfiltration events where sensitive data is being transferred to unauthorized external destinations. This is a critical alert requiring immediate investigation and response.</p> <p>Tags: <code>attack.exfiltration</code>, <code>attack.t1041</code></p> Detection Logic <ul> <li>messageType: <code>data_exfiltration</code></li> </ul>"},{"location":"detection-rules/rules/data-loss/#data-destruction","title":"Data Destruction","text":"<p>ID: <code>wf-dlp-003</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects data destruction events including unauthorized file deletion, disk wiping, and database truncation. May indicate a disgruntled insider, ransomware cleanup phase, or adversary covering tracks.</p> <p>Tags: <code>attack.impact</code>, <code>attack.t1485</code></p> Detection Logic <ul> <li>messageType: <code>data_destruction</code></li> </ul>"},{"location":"detection-rules/rules/data-loss/#large-outbound-data-transfer","title":"Large Outbound Data Transfer","text":"<p>ID: <code>wf-dlp-004</code> Level: high Status: stable Author: WitFoo</p> <p>Detects large outbound data transfers that exceed typical thresholds, potentially indicating data exfiltration via network protocols. Focuses on client-originated bytes to external destinations.</p> <p>Tags: <code>attack.exfiltration</code>, <code>attack.t1048</code></p> Detection Logic <ul> <li>clientBytes: <code>52428800</code></li> </ul>"},{"location":"detection-rules/rules/data-loss/#suspicious-http-post-exfiltration","title":"Suspicious HTTP POST Exfiltration","text":"<p>ID: <code>wf-dlp-005</code> Level: high Status: stable Author: WitFoo</p> <p>Detects large HTTP POST requests to external servers that may indicate data exfiltration via web protocols. Attackers commonly use HTTP/HTTPS POST to exfiltrate data as it blends with normal web traffic.</p> <p>Tags: <code>attack.exfiltration</code>, <code>attack.t1048.003</code></p> Detection Logic <ul> <li>action: <code>POST</code></li> <li>clientBytes: <code>10485760</code></li> </ul>"},{"location":"detection-rules/rules/data-loss/#unauthorized-file-transfer","title":"Unauthorized File Transfer","text":"<p>ID: <code>wf-dlp-006</code> Level: high Status: stable Author: WitFoo</p> <p>Detects file transfer activity to destinations not on the approved list, including FTP, SCP, and other file transfer protocols carrying potentially sensitive data to unauthorized servers.</p> <p>Tags: <code>attack.exfiltration</code>, <code>attack.t1041</code></p>"},{"location":"detection-rules/rules/filters/","title":"Filter Rules","text":"<p>Noise reduction rules that suppress known benign activity to reduce false positives.</p> <p>5 rules in this category.</p>"},{"location":"detection-rules/rules/filters/#rule-summary","title":"Rule Summary","text":"ID Title Level ATT&amp;CK <code>wf-filter-001</code> Internal Scanner False Positive Filter medium T1046 <code>wf-filter-002</code> Backup Transfer False Positive Filter medium T1048 <code>wf-filter-003</code> Service Account Auth False Positive Filter medium T1110 <code>wf-filter-004</code> CDN/Health Check DNS False Positive Filter medium T1071.004 <code>wf-filter-005</code> Monitoring Agent Connection False Positive Filter medium T1071"},{"location":"detection-rules/rules/filters/#rule-details","title":"Rule Details","text":""},{"location":"detection-rules/rules/filters/#internal-scanner-false-positive-filter","title":"Internal Scanner False Positive Filter","text":"<p>ID: <code>wf-filter-001</code> Level: medium Status: stable Author: WitFoo</p> <p>Filters out port scan detections originating from known authorized vulnerability scanners and asset discovery tools. Customize the scanner IP list to match your environment.</p> <p>Tags: <code>attack.discovery</code>, <code>attack.t1046</code></p> Detection Logic <ul> <li>messageType: <code>service_discovery</code></li> </ul>"},{"location":"detection-rules/rules/filters/#backup-transfer-false-positive-filter","title":"Backup Transfer False Positive Filter","text":"<p>ID: <code>wf-filter-002</code> Level: medium Status: stable Author: WitFoo</p> <p>Filters out large data transfer alerts caused by authorized backup operations. Customize the backup server IPs and schedule windows to match your backup infrastructure.</p> <p>Tags: <code>attack.exfiltration</code>, <code>attack.t1048</code></p> Detection Logic <ul> <li>totalBytes: <code>104857600</code></li> </ul>"},{"location":"detection-rules/rules/filters/#service-account-auth-false-positive-filter","title":"Service Account Auth False Positive Filter","text":"<p>ID: <code>wf-filter-003</code> Level: medium Status: stable Author: WitFoo</p> <p>Filters out authentication failure events from known service accounts. Service accounts may generate periodic auth failures during credential rotation or configuration changes. Customize the service account list to match your environment.</p> <p>Tags: <code>attack.credential_access</code>, <code>attack.t1110</code></p> Detection Logic <ul> <li>messageType: <code>auth_failure</code></li> </ul>"},{"location":"detection-rules/rules/filters/#cdnhealth-check-dns-false-positive-filter","title":"CDN/Health Check DNS False Positive Filter","text":"<p>ID: <code>wf-filter-004</code> Level: medium Status: stable Author: WitFoo</p> <p>Filters out DNS tunneling false positives caused by CDN health check domains, cloud service discovery domains, and other legitimate long DNS names. Customize domain patterns to match your environment.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071.004</code></p> Detection Logic <ul> <li>protocol: <code>DNS</code></li> </ul>"},{"location":"detection-rules/rules/filters/#monitoring-agent-connection-false-positive-filter","title":"Monitoring Agent Connection False Positive Filter","text":"<p>ID: <code>wf-filter-005</code> Level: medium Status: stable Author: WitFoo</p> <p>Filters out long-lived connection alerts from known monitoring agents and management tools that maintain persistent connections by design. Customize agent patterns to match your monitoring infrastructure.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071</code></p> Detection Logic <ul> <li>messageType: <code>anomalous_behavior</code></li> </ul>"},{"location":"detection-rules/rules/ids/","title":"IDS/IPS Rules","text":"<p>Detect intrusion attempts using signature-based alert analysis and evasion detection techniques.</p> <p>5 rules in this category.</p>"},{"location":"detection-rules/rules/ids/#rule-summary","title":"Rule Summary","text":"ID Title Level ATT&amp;CK <code>wf-ids-001</code> Suricata High Severity Alert critical T1190 <code>wf-ids-002</code> Suricata ATT&amp;CK Mapped Alert high T1059 <code>wf-ids-003</code> Zeek Notice Event high T1046 <code>wf-ids-004</code> Deprecated TLS Version Usage medium T1573 <code>wf-ids-005</code> Anomalous Network Behavior medium T1071"},{"location":"detection-rules/rules/ids/#rule-details","title":"Rule Details","text":""},{"location":"detection-rules/rules/ids/#suricata-high-severity-alert","title":"Suricata High Severity Alert","text":"<p>ID: <code>wf-ids-001</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects high-severity Suricata IDS alerts (severity 1-2) forwarded through WitFoo's artifact pipeline. These represent the most critical network-based threat detections requiring immediate investigation.</p> <p>Tags: <code>attack.initial_access</code>, <code>attack.t1190</code></p> Detection Logic <ul> <li>streamName: <code>suricata</code></li> <li>severityCode: <code>['1', '2']</code></li> </ul>"},{"location":"detection-rules/rules/ids/#suricata-attck-mapped-alert","title":"Suricata ATT&amp;CK Mapped Alert","text":"<p>ID: <code>wf-ids-002</code> Level: high Status: stable Author: WitFoo</p> <p>Detects Suricata alerts that have been enriched with MITRE ATT&amp;CK technique mappings, indicating that the IDS signature corresponds to a known adversary technique. These are higher-confidence detections with tactical context.</p> <p>Tags: <code>attack.execution</code>, <code>attack.t1059</code></p> Detection Logic <ul> <li>streamName: <code>suricata</code></li> <li>attackTechniqueIds: <code>T\\d{4}</code></li> </ul>"},{"location":"detection-rules/rules/ids/#zeek-notice-event","title":"Zeek Notice Event","text":"<p>ID: <code>wf-ids-003</code> Level: high Status: stable Author: WitFoo</p> <p>Detects Zeek (formerly Bro) notice events, which are higher-level network analysis findings including protocol violations, certificate anomalies, and behavioral detections from Zeek's scripting engine.</p> <p>Tags: <code>attack.discovery</code>, <code>attack.t1046</code></p> Detection Logic <ul> <li>streamName: <code>['zeek_notice', 'zeek_weird']</code></li> </ul>"},{"location":"detection-rules/rules/ids/#deprecated-tls-version-usage","title":"Deprecated TLS Version Usage","text":"<p>ID: <code>wf-ids-004</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects usage of deprecated TLS versions (TLS 1.0 and TLS 1.1) that are no longer considered secure. These connections may be targeted for downgrade attacks and violate modern compliance requirements.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1573</code></p>"},{"location":"detection-rules/rules/ids/#anomalous-network-behavior","title":"Anomalous Network Behavior","text":"<p>ID: <code>wf-ids-005</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects anomalous network behavior events that deviate from established baselines. These behavioral anomalies may indicate novel attacks, insider threats, or compromised systems exhibiting unusual communication patterns.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071</code></p> Detection Logic <ul> <li>messageType: <code>anomalous_behavior</code></li> </ul>"},{"location":"detection-rules/rules/infrastructure/","title":"Infrastructure Rules","text":"<p>Detect infrastructure health issues including service degradation, certificate problems, and configuration drift.</p> <p>5 rules in this category.</p>"},{"location":"detection-rules/rules/infrastructure/#rule-summary","title":"Rule Summary","text":"ID Title Level ATT&amp;CK <code>wf-infra-001</code> Service Disruption high T1499 <code>wf-infra-002</code> Degraded Hardware Alert medium T1499 <code>wf-infra-003</code> Degraded Service Alert medium T1499 <code>wf-infra-004</code> Financial System Anomaly high T1565 <code>wf-infra-005</code> Infrastructure Exploit Attempt critical T1190"},{"location":"detection-rules/rules/infrastructure/#rule-details","title":"Rule Details","text":""},{"location":"detection-rules/rules/infrastructure/#service-disruption","title":"Service Disruption","text":"<p>ID: <code>wf-infra-001</code> Level: high Status: stable Author: WitFoo</p> <p>Detects service disruption events including denial of service indicators, service outages, and availability degradation. May indicate active DDoS attacks, resource exhaustion, or infrastructure failures.</p> <p>Tags: <code>attack.impact</code>, <code>attack.t1499</code></p> Detection Logic <ul> <li>messageType: <code>service_disruption</code></li> </ul>"},{"location":"detection-rules/rules/infrastructure/#degraded-hardware-alert","title":"Degraded Hardware Alert","text":"<p>ID: <code>wf-infra-002</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects hardware health degradation alerts from infrastructure monitoring systems. Includes disk failures, memory errors, CPU thermal events, and power supply issues that may affect system availability.</p> <p>Tags: <code>attack.impact</code>, <code>attack.t1499</code></p> Detection Logic <ul> <li>messageType: <code>degraded_hardware</code></li> </ul>"},{"location":"detection-rules/rules/infrastructure/#degraded-service-alert","title":"Degraded Service Alert","text":"<p>ID: <code>wf-infra-003</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects service health degradation including increased latency, elevated error rates, connection pool exhaustion, and service dependency failures reported by application performance monitoring tools.</p> <p>Tags: <code>attack.impact</code>, <code>attack.t1499</code></p> Detection Logic <ul> <li>messageType: <code>degraded_service</code></li> </ul>"},{"location":"detection-rules/rules/infrastructure/#financial-system-anomaly","title":"Financial System Anomaly","text":"<p>ID: <code>wf-infra-004</code> Level: high Status: stable Author: WitFoo</p> <p>Detects anomalous activity in financial systems including unauthorized transaction patterns, accounting system modifications, and payment processing irregularities that may indicate fraud or data manipulation.</p> <p>Tags: <code>attack.impact</code>, <code>attack.t1565</code></p> Detection Logic <ul> <li>messageType: <code>financial_anomaly</code></li> </ul>"},{"location":"detection-rules/rules/infrastructure/#infrastructure-exploit-attempt","title":"Infrastructure Exploit Attempt","text":"<p>ID: <code>wf-infra-005</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects exploit attempts targeting infrastructure components including web servers, application servers, databases, and network devices. Matches events classified as exploit attempts with associated CVE identifiers.</p> <p>Tags: <code>attack.initial_access</code>, <code>attack.t1190</code></p>"},{"location":"detection-rules/rules/malware/","title":"Malware Detection Rules","text":"<p>Detect malware indicators including command-and-control communication, ransomware behavior, and persistence mechanisms.</p> <p>8 rules in this category.</p>"},{"location":"detection-rules/rules/malware/#rule-summary","title":"Rule Summary","text":"ID Title Level ATT&amp;CK <code>wf-mal-001</code> Malicious Behavior Detection high T1027 <code>wf-mal-002</code> Botnet Connection critical T1071.001 <code>wf-mal-003</code> Ransomware Download Indicator critical T1486 <code>wf-mal-004</code> Ransomware Encryption Activity critical T1486 <code>wf-mal-005</code> Malicious Software Detection high T1204 <code>wf-mal-006</code> Blacklisted Process Execution critical T1059 <code>wf-mal-007</code> Threat Event Detection high T1204 <code>wf-mal-008</code> Endpoint Protection Alert medium T1027"},{"location":"detection-rules/rules/malware/#rule-details","title":"Rule Details","text":""},{"location":"detection-rules/rules/malware/#malicious-behavior-detection","title":"Malicious Behavior Detection","text":"<p>ID: <code>wf-mal-001</code> Level: high Status: stable Author: WitFoo</p> <p>Detects events classified as malicious behavior by WitFoo's enrichment engine. This covers a broad range of malware indicators including suspicious process execution, anomalous system calls, and behavioral analysis triggers.</p> <p>Tags: <code>attack.execution</code>, <code>attack.t1027</code></p> Detection Logic <ul> <li>messageType: <code>malicious_behavior</code></li> </ul>"},{"location":"detection-rules/rules/malware/#botnet-connection","title":"Botnet Connection","text":"<p>ID: <code>wf-mal-002</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects connections to known botnet command-and-control infrastructure. WitFoo's threat intelligence enrichment classifies these connections based on IOC matching and behavioral patterns.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071.001</code></p> Detection Logic <ul> <li>messageType: <code>botnet_connection</code></li> </ul>"},{"location":"detection-rules/rules/malware/#ransomware-download-indicator","title":"Ransomware Download Indicator","text":"<p>ID: <code>wf-mal-003</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects ransomware payload download activity identified by WitFoo's enrichment engine. This is the initial delivery phase of a ransomware attack chain, before encryption begins.</p> <p>Tags: <code>attack.impact</code>, <code>attack.t1486</code>, <code>attack.initial_access</code></p> Detection Logic <ul> <li>messageType: <code>ransomware_download</code></li> </ul>"},{"location":"detection-rules/rules/malware/#ransomware-encryption-activity","title":"Ransomware Encryption Activity","text":"<p>ID: <code>wf-mal-004</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects active ransomware encryption behavior. This critical alert indicates that ransomware is actively encrypting files on the network. Immediate incident response action is required.</p> <p>Tags: <code>attack.impact</code>, <code>attack.t1486</code></p> Detection Logic <ul> <li>messageType: <code>ransomware_encryption</code></li> </ul>"},{"location":"detection-rules/rules/malware/#malicious-software-detection","title":"Malicious Software Detection","text":"<p>ID: <code>wf-mal-005</code> Level: high Status: stable Author: WitFoo</p> <p>Detects malicious software identified by endpoint protection platforms (EPP) or endpoint detection and response (EDR) solutions forwarding alerts through WitFoo's artifact ingestion pipeline.</p> <p>Tags: <code>attack.execution</code>, <code>attack.t1204</code></p> Detection Logic <ul> <li>messageType: <code>malicious_software</code></li> </ul>"},{"location":"detection-rules/rules/malware/#blacklisted-process-execution","title":"Blacklisted Process Execution","text":"<p>ID: <code>wf-mal-006</code> Level: critical Status: stable Author: WitFoo</p> <p>Detects execution of processes on the organization's blacklist. These are known-bad executables, prohibited tools, or applications that violate security policy.</p> <p>Tags: <code>attack.execution</code>, <code>attack.t1059</code></p> Detection Logic <ul> <li>messageType: <code>blacklisted_process</code></li> </ul>"},{"location":"detection-rules/rules/malware/#threat-event-detection","title":"Threat Event Detection","text":"<p>ID: <code>wf-mal-007</code> Level: high Status: stable Author: WitFoo</p> <p>Detects generic threat events identified by security tools forwarded through WitFoo's ingestion pipeline. Covers threats not classified into more specific categories.</p> <p>Tags: <code>attack.execution</code>, <code>attack.t1204</code></p> Detection Logic <ul> <li>messageType: <code>threat_event</code></li> </ul>"},{"location":"detection-rules/rules/malware/#endpoint-protection-alert","title":"Endpoint Protection Alert","text":"<p>ID: <code>wf-mal-008</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects alerts forwarded from endpoint protection platforms (EPP/EDR) through WitFoo's artifact pipeline. These include antivirus detections, behavioral blocks, and exploit prevention alerts.</p> <p>Tags: <code>attack.execution</code>, <code>attack.t1027</code></p> Detection Logic <ul> <li>messageType: <code>endpoint_protection</code></li> </ul>"},{"location":"detection-rules/rules/network/","title":"Network Security Rules","text":"<p>Detect network-level threats including traffic anomalies, tunneling, beaconing, and suspicious connections.</p> <p>12 rules in this category.</p>"},{"location":"detection-rules/rules/network/#rule-summary","title":"Rule Summary","text":"ID Title Level ATT&amp;CK <code>wf-net-001</code> DNS Tunneling Detection high T1071.004, T1048 <code>wf-net-002</code> C2 Beaconing Activity high T1071.001 <code>wf-net-003</code> Unusual Port Activity medium T1571 <code>wf-net-004</code> Large Data Transfer high T1048 <code>wf-net-005</code> Port Scan Detection high T1046 <code>wf-net-006</code> ICMP Anomaly Detection medium T1095 <code>wf-net-007</code> Non-Standard HTTP/HTTPS Port Usage medium T1571 <code>wf-net-008</code> Long-Lived Network Connection medium T1071 <code>wf-net-009</code> Suspicious SSL/TLS Certificate medium T1071.001 <code>wf-net-010</code> Executable File Transfer Over Network high T1105 <code>wf-net-011</code> NXDOMAIN/DGA Detection high T1568.002 <code>wf-net-012</code> SMB Lateral Movement high T1021.002"},{"location":"detection-rules/rules/network/#rule-details","title":"Rule Details","text":""},{"location":"detection-rules/rules/network/#dns-tunneling-detection","title":"DNS Tunneling Detection","text":"<p>ID: <code>wf-net-001</code> Level: high Status: stable Author: WitFoo</p> <p>Detects potential DNS tunneling activity indicated by unusually long DNS query domain names (&gt;100 characters), which may indicate data exfiltration or C2 communication via DNS protocol.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071.004</code>, <code>attack.exfiltration</code>, <code>attack.t1048</code></p> Detection Logic <ul> <li>protocol: <code>DNS</code></li> </ul>"},{"location":"detection-rules/rules/network/#c2-beaconing-activity","title":"C2 Beaconing Activity","text":"<p>ID: <code>wf-net-002</code> Level: high Status: stable Author: WitFoo</p> <p>Detects potential command-and-control beaconing by identifying connections to external servers classified as botnet or C2 activity by WitFoo lead rules. Regular-interval check-ins are a hallmark of malware C2 communication.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071.001</code></p> Detection Logic <ul> <li>messageType: <code>botnet_connection</code></li> </ul>"},{"location":"detection-rules/rules/network/#unusual-port-activity","title":"Unusual Port Activity","text":"<p>ID: <code>wf-net-003</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects network connections on non-standard ports that may indicate evasion techniques, backdoor communication, or misconfigurations. Focuses on high-numbered ephemeral ports used as server-side listeners.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1571</code></p> Detection Logic <ul> <li>protocol: <code>['TCP', 'UDP']</code></li> </ul>"},{"location":"detection-rules/rules/network/#large-data-transfer","title":"Large Data Transfer","text":"<p>ID: <code>wf-net-004</code> Level: high Status: stable Author: WitFoo</p> <p>Detects unusually large outbound data transfers that may indicate data exfiltration. Triggers when total bytes transferred exceeds 100MB in a single connection/session.</p> <p>Tags: <code>attack.exfiltration</code>, <code>attack.t1048</code></p> Detection Logic <ul> <li>totalBytes: <code>104857600</code></li> </ul>"},{"location":"detection-rules/rules/network/#port-scan-detection","title":"Port Scan Detection","text":"<p>ID: <code>wf-net-005</code> Level: high Status: stable Author: WitFoo</p> <p>Detects network reconnaissance through port scanning activity. Identified by WitFoo's service discovery classification or IDS rule matches indicating systematic port probing.</p> <p>Tags: <code>attack.discovery</code>, <code>attack.t1046</code></p>"},{"location":"detection-rules/rules/network/#icmp-anomaly-detection","title":"ICMP Anomaly Detection","text":"<p>ID: <code>wf-net-006</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects anomalous ICMP traffic patterns that may indicate ICMP tunneling, covert channels, or network reconnaissance. Large ICMP payloads or unusual ICMP types can signify data exfiltration or C2 communication.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1095</code></p> Detection Logic <ul> <li>protocol: <code>ICMP</code></li> </ul>"},{"location":"detection-rules/rules/network/#non-standard-httphttps-port-usage","title":"Non-Standard HTTP/HTTPS Port Usage","text":"<p>ID: <code>wf-net-007</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects HTTP or HTTPS traffic on non-standard ports, which may indicate evasion of network security controls, malware C2 communication, or unauthorized web services.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1571</code></p>"},{"location":"detection-rules/rules/network/#long-lived-network-connection","title":"Long-Lived Network Connection","text":"<p>ID: <code>wf-net-008</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects network connections with abnormally long durations that may indicate persistent C2 channels, data exfiltration tunnels, or compromised hosts maintaining backdoor connections. Flags connections classified as anomalous behavior by WitFoo enrichment.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071</code></p> Detection Logic <ul> <li>messageType: <code>anomalous_behavior</code></li> <li>protocol: <code>['TCP', 'SSL', 'TLS']</code></li> </ul>"},{"location":"detection-rules/rules/network/#suspicious-ssltls-certificate","title":"Suspicious SSL/TLS Certificate","text":"<p>ID: <code>wf-net-009</code> Level: medium Status: stable Author: WitFoo</p> <p>Detects network connections involving suspicious SSL/TLS certificates, including self-signed, expired, or certificates with anomalous attributes. These may indicate man-in-the-middle attacks, malware C2 infrastructure, or compromised certificate authorities.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1071.001</code></p>"},{"location":"detection-rules/rules/network/#executable-file-transfer-over-network","title":"Executable File Transfer Over Network","text":"<p>ID: <code>wf-net-010</code> Level: high Status: stable Author: WitFoo</p> <p>Detects transfer of executable files over the network, which may indicate malware delivery, lateral movement tool staging, or unauthorized software distribution. Matches common executable extensions and binary content types.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1105</code>, <code>attack.lateral_movement</code></p>"},{"location":"detection-rules/rules/network/#nxdomaindga-detection","title":"NXDOMAIN/DGA Detection","text":"<p>ID: <code>wf-net-011</code> Level: high Status: stable Author: WitFoo</p> <p>Detects high rates of DNS resolution failures (NXDOMAIN) that may indicate domain generation algorithm (DGA) activity used by malware for C2 rendezvous. DGA malware generates pseudo-random domain names, most of which fail to resolve.</p> <p>Tags: <code>attack.command_and_control</code>, <code>attack.t1568.002</code></p> Detection Logic <ul> <li>protocol: <code>DNS</code></li> <li>action: <code>['NXDOMAIN', 'nxdomain', 'SERVFAIL']</code></li> </ul>"},{"location":"detection-rules/rules/network/#smb-lateral-movement","title":"SMB Lateral Movement","text":"<p>ID: <code>wf-net-012</code> Level: high Status: stable Author: WitFoo</p> <p>Detects SMB (Server Message Block) connections between workstations that may indicate lateral movement. Legitimate SMB traffic typically flows from workstations to file servers, not between workstations.</p> <p>Tags: <code>attack.lateral_movement</code>, <code>attack.t1021.002</code></p> Detection Logic <ul> <li>serverPort: <code>['445', '139']</code></li> </ul>"},{"location":"getting-started/","title":"Getting Started with WitFoo Analytics","text":"<p>Welcome to WitFoo Analytics \u2014 an enterprise security operations platform that provides investigation, correlation, reporting, and threat intelligence capabilities for your security team.</p> <p>This guide walks you through deploying WitFoo Analytics for the first time using a WitFoo Appliance (WFA).</p>"},{"location":"getting-started/#quick-start-overview","title":"Quick Start Overview","text":"<p>Getting WitFoo Analytics running involves three steps:</p> <ol> <li>Deploy a WitFoo Appliance from a VM image, cloud marketplace, or bare metal script</li> <li>Configure the appliance role and services using the <code>wfa configure</code> wizard</li> <li>Onboard by logging into the web UI and completing the setup wizard</li> </ol>"},{"location":"getting-started/#guides","title":"Guides","text":"Guide Description Architecture Service architecture, data flow, and component overview Deployment Roles Understand the three WFA node roles: Conductor, Console, and Analytics Installation Deploy a WitFoo Appliance via VM, cloud, or bare metal Configuration Wizard Detailed walkthrough of <code>sudo wfa configure</code> First Login &amp; Onboarding Access the web UI, change default passwords, and complete the 12-step onboarding wizard"},{"location":"getting-started/#hardware-requirements","title":"Hardware Requirements","text":"Tier CPU Cores RAM Disk Minimum 8 12 GB 220 GB Recommended 16 32 GB 1 TB <p>For per-role hardware requirements, see Deployment Roles.</p>"},{"location":"getting-started/#prerequisites","title":"Prerequisites","text":"<p>Before you begin, ensure you have:</p> <ul> <li>A supported hypervisor (VMware, Hyper-V, QEMU), cloud account (AWS, Azure, Google Cloud), or bare metal server running Ubuntu 24 or RHEL 10</li> <li>Network access to the appliance on HTTPS port 443</li> <li>A WitFoo license key (or request a 15-day trial during configuration)</li> </ul> <p>Evaluation Deployments</p> <p>For evaluation or small environments, a single Analytics node is the fastest path to a working deployment. Add Conductor nodes later as your data ingestion needs grow.</p>"},{"location":"getting-started/architecture/","title":"Architecture","text":"<p>WitFoo Analytics is a distributed security operations platform composed of specialized services organized across three node roles. This page describes the service architecture, component responsibilities, and data flow.</p>"},{"location":"getting-started/architecture/#system-architecture","title":"System Architecture","text":"<p>The following diagram shows how the three WFA node roles interact:</p> <pre><code>graph TB\n    subgraph External[\"External Sources\"]\n        DS[Data Sources&lt;br/&gt;Firewalls, IDS, EDR, Cloud]\n        Users[Security Analysts]\n    end\n\n    subgraph Conductor[\"Conductor Node\"]\n        BE[Broker Edge]\n        SS[Signal Server]\n        SP[Signal Parser]\n        AE[Artifact Exporter]\n        NB[NATS Broker]\n    end\n\n    subgraph Analytics[\"Analytics Node\"]\n        RP[Reverse Proxy&lt;br/&gt;Port 443]\n        UI[Web UI]\n        API[API Service]\n        IE[Incident Engine]\n        AI_SVC[Artifact Ingestion]\n        GP[Graph Processor]\n        DISP[Dispatcher]\n        CASS[(Cassandra)]\n        NATS_A[NATS]\n        PROM[Prometheus]\n        GRAF[Grafana]\n        REP[Reporter]\n        OBS[Observer]\n    end\n\n    subgraph Console[\"Console Node\"]\n        CUI[Console UI&lt;br/&gt;Port 443]\n    end\n\n    DS --&gt;|Syslog / API| SS\n    SS --&gt; SP\n    SP --&gt; AE\n    AE --&gt;|NATS Leaf| NB\n    NB --&gt;|Artifacts| NATS_A\n    NATS_A --&gt; AI_SVC\n    AI_SVC --&gt; GP\n    GP --&gt; CASS\n    GP --&gt; IE\n    IE --&gt; CASS\n    Users --&gt;|HTTPS| RP\n    RP --&gt; UI\n    RP --&gt; API\n    API --&gt; IE\n    API --&gt; CASS\n    DISP --&gt; NATS_A\n    CUI --&gt;|Manage| Conductor\n    CUI --&gt;|Manage| Analytics</code></pre>"},{"location":"getting-started/architecture/#data-flow","title":"Data Flow","text":"<p>The following diagram illustrates how security data moves through the platform from ingestion to analyst interaction:</p> <pre><code>flowchart LR\n    A[Data Sources] --&gt;|Syslog / API| B[Signal Server]\n    B --&gt;|Raw Signals| C[Signal Parser]\n    C --&gt;|Parsed Artifacts| D[Artifact Exporter]\n    D --&gt;|NATS Leaf Connection| E[NATS Broker]\n    E --&gt;|Artifact Stream| F[Artifact Ingestion]\n    F --&gt;|Enriched Artifacts| G[Graph Processor]\n    G --&gt;|Nodes &amp; Edges| H[(Cassandra)]\n    G --&gt;|Lead Rules Match| I[Incident Engine]\n    I --&gt;|Incidents &amp; MOs| H\n    H --&gt;|Query Results| J[API Service]\n    J --&gt;|JSON Responses| K[Reverse Proxy]\n    K --&gt;|HTTPS| L[Web UI]\n    L --&gt;|Dashboards &amp; Reports| M[Analyst]</code></pre>"},{"location":"getting-started/architecture/#data-flow-stages","title":"Data Flow Stages","text":"Stage Component Description Collection Signal Server Receives raw log data via syslog, API, or connector polling Parsing Signal Parser Normalizes raw signals into structured artifacts using 257+ fingerprints Export Artifact Exporter Forwards parsed artifacts over NATS leaf connections to the Analytics node Ingestion Artifact Ingestion Validates, deduplicates, and applies lead rules to incoming artifacts Graph Processing Graph Processor Builds the security knowledge graph \u2014 nodes, edges, and enrichments (GeoIP, ATT&amp;CK, threat intel) Detection Incident Engine Correlates artifacts into incidents using MO definitions, behavioral sets, and lead rules Storage Cassandra Persists artifacts, graph data, incidents, reports, and configuration Presentation API / UI Serves the analyst-facing web interface for investigation, reporting, and response"},{"location":"getting-started/architecture/#service-components-by-role","title":"Service Components by Role","text":""},{"location":"getting-started/architecture/#conductor-services","title":"Conductor Services","text":"Service Port Description Signal Server \u2014 Receives and queues raw log data Signal Parser \u2014 Parses raw signals into structured artifacts Artifact Exporter \u2014 Exports artifacts to Analytics via NATS Broker Edge \u2014 NATS leaf node for upstream connectivity NATS Broker 4223 (client), 4443 (leaf) Message broker for signal pipeline"},{"location":"getting-started/architecture/#analytics-services","title":"Analytics Services","text":"Service Port Description Reverse Proxy 443 (HTTPS) TLS termination, routing, security headers Web UI 3000 (internal) Svelte 5 analyst interface API Service 8080 (internal) REST API, authentication, authorization Incident Engine 8082 (internal) Incident correlation, MO detection, scheduling Artifact Ingestion 8081 (internal) Artifact validation and lead rule evaluation Graph Processor \u2014 Knowledge graph construction and enrichment Dispatcher 8083 (internal) WebSocket notifications and real-time events Reporter \u2014 Scheduled and on-demand report generation Observer \u2014 Continuous monitoring and health assessment Cassandra 9042 (internal) Distributed database (analytics_v2 keyspace) NATS 4222 (internal) Internal message bus Prometheus 9090 (internal) Metrics collection Grafana 3001 (internal) Metrics visualization"},{"location":"getting-started/architecture/#console-services","title":"Console Services","text":"Service Port Description Console UI 443 (HTTPS) Remote management and monitoring interface"},{"location":"getting-started/architecture/#network-ports","title":"Network Ports","text":"<p>The following ports must be accessible for inter-node communication:</p> Port Protocol Direction Purpose 443 HTTPS Inbound Web UI access (Analytics and Console) 4223 TCP Inbound to Conductor NATS client connections 4443 TCP Inbound to Conductor NATS leaf node connections 9042 TCP Internal Cassandra CQL (Analytics cluster only) <p>Firewall Configuration</p> <p>For single-node deployments, only port 443 needs to be exposed externally. All other ports are used for internal service communication or inter-node connectivity in multi-node deployments.</p>"},{"location":"getting-started/architecture/#multi-node-deployment","title":"Multi-Node Deployment","text":"<p>In production environments, WitFoo Analytics is typically deployed across multiple nodes:</p> <pre><code>graph LR\n    subgraph Network[\"Organization Network\"]\n        FW[Firewalls]\n        IDS[IDS/IPS]\n        EDR[EDR Agents]\n        CLOUD[Cloud Services]\n    end\n\n    subgraph Conductors[\"Conductor Nodes\"]\n        C1[Conductor 1&lt;br/&gt;Site A]\n        C2[Conductor 2&lt;br/&gt;Site B]\n    end\n\n    subgraph AnalyticsCluster[\"Analytics\"]\n        AN[Analytics Node]\n    end\n\n    subgraph Management[\"Management\"]\n        CON[Console Node]\n    end\n\n    FW --&gt; C1\n    IDS --&gt; C1\n    EDR --&gt; C2\n    CLOUD --&gt; C2\n    C1 --&gt;|NATS| AN\n    C2 --&gt;|NATS| AN\n    CON --&gt;|HTTPS| C1\n    CON --&gt;|HTTPS| C2\n    CON --&gt;|HTTPS| AN</code></pre> <ul> <li>Conductor nodes are deployed close to data sources (one per site or network segment)</li> <li>Analytics nodes centralize correlation, investigation, and reporting</li> <li>Console nodes provide a single pane of glass for managing all appliances</li> </ul>"},{"location":"getting-started/deployment-roles/","title":"Deployment Roles","text":"<p>Every WitFoo Appliance is configured with one of three roles during setup. Each role determines which services run on the node and what function it serves in your deployment.</p>"},{"location":"getting-started/deployment-roles/#role-overview","title":"Role Overview","text":"Role Purpose Primary Use Case Conductor Data ingestion and signal processing Collect and parse logs from data sources Console Remote management and monitoring Centralized management of all WFA nodes Analytics Security analytics platform Investigation, correlation, and reporting"},{"location":"getting-started/deployment-roles/#conductor","title":"Conductor","text":"<p>The Conductor is the data ingestion layer of WitFoo Analytics. It collects raw security data from your environment, parses it into structured artifacts, and forwards them to the Analytics node for processing.</p>"},{"location":"getting-started/deployment-roles/#when-to-choose-conductor","title":"When to Choose Conductor","text":"<ul> <li>You need to collect logs from firewalls, IDS, EDR, cloud services, or other data sources</li> <li>You want to deploy collection points close to your data sources across multiple sites</li> <li>You are building a distributed deployment with dedicated ingestion and analytics tiers</li> </ul>"},{"location":"getting-started/deployment-roles/#hardware-requirements","title":"Hardware Requirements","text":"Resource Minimum Recommended CPU 4 cores 8 cores RAM 8 GB 16 GB Disk 220 GB 500 GB"},{"location":"getting-started/deployment-roles/#services","title":"Services","text":"Service Description Signal Server Receives raw log data via syslog and API connectors Signal Parser Normalizes raw signals into structured artifacts (257+ fingerprints) Artifact Exporter Forwards parsed artifacts to Analytics via NATS Broker Edge NATS leaf node for upstream connectivity NATS Broker Message broker (client port 4223, leaf port 4443) Prometheus Local metrics collection (optional) Grafana Local metrics visualization (optional) <p>Scaling Conductors</p> <p>Deploy one Conductor per network segment or site. Each Conductor operates independently and forwards data to the central Analytics node. There is no limit to the number of Conductors in a deployment.</p>"},{"location":"getting-started/deployment-roles/#console","title":"Console","text":"<p>The Console provides a centralized management interface for monitoring and configuring all WitFoo Appliances in your deployment. It is a lightweight, single-container deployment.</p>"},{"location":"getting-started/deployment-roles/#when-to-choose-console","title":"When to Choose Console","text":"<ul> <li>You manage multiple Conductor and Analytics nodes across your organization</li> <li>You need a single pane of glass for appliance health, status, and configuration</li> <li>You want to separate management access from analyst access</li> </ul>"},{"location":"getting-started/deployment-roles/#hardware-requirements_1","title":"Hardware Requirements","text":"Resource Minimum Recommended CPU 4 cores 4 cores RAM 8 GB 8 GB Disk 220 GB 220 GB"},{"location":"getting-started/deployment-roles/#services_1","title":"Services","text":"Service Description Console UI Web-based management interface (HTTPS on port 443) <p>Console is Optional</p> <p>For small deployments with a single Analytics node and one or two Conductors, the Console is optional. You can manage individual appliances directly via SSH or their local web interfaces.</p>"},{"location":"getting-started/deployment-roles/#analytics","title":"Analytics","text":"<p>The Analytics node is the core of WitFoo Analytics. It performs security investigation, incident correlation, graph analysis, reporting, and provides the primary analyst-facing web interface.</p>"},{"location":"getting-started/deployment-roles/#when-to-choose-analytics","title":"When to Choose Analytics","text":"<ul> <li>You are deploying WitFoo Analytics for the first time (start here)</li> <li>You need the full security analytics platform: search, investigation, reporting, and response</li> <li>You are setting up the central analysis tier that receives data from Conductors</li> </ul>"},{"location":"getting-started/deployment-roles/#hardware-requirements_2","title":"Hardware Requirements","text":"Resource Minimum Recommended CPU 8 cores 16 cores RAM 12 GB 32 GB Disk 220 GB 1 TB"},{"location":"getting-started/deployment-roles/#services_2","title":"Services","text":"Service Description Cassandra Distributed database for all analytics data NATS Internal message bus Artifact Ingestion Validates and processes incoming artifacts Graph Processor Builds the security knowledge graph with enrichments Incident Engine Correlates artifacts into incidents using detection logic API Service REST API for authentication, authorization, and data access Dispatcher WebSocket server for real-time notifications Reverse Proxy TLS termination and request routing (port 443) Web UI Svelte 5 analyst interface Reporter Scheduled and on-demand report generation Observer Continuous monitoring and health assessment Prometheus Metrics collection Grafana Metrics visualization <p>Start with Analytics</p> <p>If you are evaluating WitFoo Analytics or deploying for the first time, start with a single Analytics node. You can add Conductor nodes for data ingestion and a Console node for centralized management as your deployment grows.</p>"},{"location":"getting-started/deployment-roles/#hardware-requirements-summary","title":"Hardware Requirements Summary","text":"Role CPU (min) RAM (min) Disk (min) Conductor 4 8 GB 220 GB Console 4 8 GB 220 GB Analytics 8 12 GB 220 GB"},{"location":"getting-started/deployment-roles/#choosing-a-deployment-topology","title":"Choosing a Deployment Topology","text":""},{"location":"getting-started/deployment-roles/#single-node-evaluation-small-team","title":"Single Node (Evaluation / Small Team)","text":"<p>Deploy a single Analytics node. Suitable for evaluation, small teams, or environments with low data volume.</p>"},{"location":"getting-started/deployment-roles/#two-nodes-standard","title":"Two Nodes (Standard)","text":"<p>Deploy one Conductor and one Analytics node. The Conductor collects data from your environment and forwards it to the Analytics node for processing.</p>"},{"location":"getting-started/deployment-roles/#multi-node-enterprise","title":"Multi-Node (Enterprise)","text":"<p>Deploy multiple Conductors (one per site or network segment), one or more Analytics nodes, and a Console for centralized management. This topology scales to large, distributed environments.</p>"},{"location":"getting-started/first-login/","title":"First Login &amp; Onboarding","text":"<p>After deploying and configuring your WitFoo Appliance, this guide walks you through your first login, changing default credentials, and completing the 12-step onboarding wizard.</p>"},{"location":"getting-started/first-login/#default-credentials","title":"Default Credentials","text":"<p>Change Default Passwords Immediately</p> <p>WitFoo Appliances ship with default credentials that are publicly documented. Change both the SSH and web UI passwords immediately after your first login to prevent unauthorized access.</p>"},{"location":"getting-started/first-login/#ssh-access","title":"SSH Access","text":"Setting Value Username <code>witfooadmin</code> Password <code>F00theN0ise!</code> <p>Change the SSH password immediately:</p> <pre><code>ssh witfooadmin@&lt;appliance-ip&gt;\npasswd\n</code></pre>"},{"location":"getting-started/first-login/#web-ui-access","title":"Web UI Access","text":"Setting Value URL <code>https://&lt;appliance-ip&gt;</code> (port 443) Email <code>admin@witfoo.com</code> Password <code>F00theN0ise!</code> <p>The default web UI credentials are replaced when you create your first admin user in the onboarding wizard (Step 1).</p>"},{"location":"getting-started/first-login/#first-login","title":"First Login","text":"<ol> <li> <p>Open a web browser and navigate to <code>https://&lt;appliance-ip&gt;</code>.</p> </li> <li> <p>If using self-signed certificates, accept the browser's security warning to proceed.</p> </li> <li> <p>Enter the default credentials:</p> <ul> <li>Email: <code>admin@witfoo.com</code></li> <li>Password: <code>F00theN0ise!</code></li> </ul> </li> <li> <p>Click Sign In.</p> </li> <li> <p>The onboarding wizard launches automatically as a full-screen modal.</p> </li> </ol> <p>HTTPS on Port 443</p> <p>The web UI is served exclusively over HTTPS on port 443. HTTP requests are automatically redirected to HTTPS.</p>"},{"location":"getting-started/first-login/#onboarding-wizard","title":"Onboarding Wizard","text":"<p>The onboarding wizard is a full-screen modal that guides you through first-time platform setup. It appears automatically on first login and walks you through 12 steps organized by priority.</p>"},{"location":"getting-started/first-login/#step-categories","title":"Step Categories","text":"Category Steps Description Critical 0\u20133 Must be completed for the platform to function correctly Recommended 5, 7, 8 Should be completed for a production deployment Optional 4, 6, 9, 10 Enhance functionality but can be configured later <p>Flexible Completion Order</p> <p>Steps can be completed in any order by clicking the step navigation on the left side of the wizard. However, we recommend completing the Critical steps (0\u20133) before using the platform.</p> <p>Skipped Steps</p> <p>Any steps you skip will display a persistent banner reminder after you log in. All settings configured in the wizard can be changed later from the Admin panel.</p>"},{"location":"getting-started/first-login/#step-0-welcome","title":"Step 0: Welcome","text":"<p>Category: Critical</p> <p>Configure your organization's basic settings.</p> Field Description Organization Name Display name for your organization (pre-populated from <code>wfa configure</code>) Timezone Default timezone for date/time display across the platform Date/Time Format Preferred format (e.g., <code>MM/DD/YYYY</code>, <code>DD/MM/YYYY</code>, <code>YYYY-MM-DD</code>) Enable Notifications Toggle platform-wide notification delivery <p>This step establishes the baseline settings that affect how data is displayed throughout the platform.</p>"},{"location":"getting-started/first-login/#step-1-create-admin","title":"Step 1: Create Admin","text":"<p>Category: Critical</p> <p>Create the first administrative user account.</p> Field Description Full Name Administrator's display name Email Address Login email (replaces the default <code>admin@witfoo.com</code>) Password Strong password (minimum 8 characters) <p>Replace Default Credentials</p> <p>This step creates a real admin account and replaces the default <code>admin@witfoo.com</code> credentials. After completing this step, the default credentials will no longer work.</p> <p>Skipped if Admin Exists</p> <p>If an admin user has already been created (e.g., via API or a previous partial onboarding), this step is automatically skipped.</p>"},{"location":"getting-started/first-login/#step-2-feature-selection","title":"Step 2: Feature Selection","text":"<p>Category: Critical</p> <p>Toggle platform modules between three states:</p> State Description Full Module is fully enabled with UI navigation and background processing Background Module runs background processing but is hidden from the UI navigation Disabled Module is completely disabled <p>Available modules:</p> Module Description Search Artifact search, graph exploration, and investigation Observer Continuous monitoring, dashboards, and health assessment Reporter Scheduled and on-demand compliance and operational reports CyberGrid Threat intelligence sharing and consumption Responder Incident response workflows and playbooks AI AI-assisted investigation and analysis <p>The wizard automatically resolves module dependencies. For example, enabling Reporter automatically enables Search (which provides the underlying data).</p> <p>Start with Defaults</p> <p>The default configuration enables all modules in Full mode. This is recommended for evaluation and most production deployments.</p>"},{"location":"getting-started/first-login/#step-3-data-retention","title":"Step 3: Data Retention","text":"<p>Category: Critical</p> <p>Configure how long each data type is retained in the platform. Retention periods are specified in days (1\u2013365).</p> Data Type Default Description Artifacts 7 days Raw security events and parsed log data Work Units 365 days Individual investigation work items Work Collections 365 days Grouped investigation collections (incidents) Reports 1,825 days (5 years) Generated compliance and operational reports <p>Storage Impact</p> <p>Longer retention periods require more disk space. For the recommended 1 TB disk, the defaults support approximately 10,000 events per second with 7-day artifact retention.</p>"},{"location":"getting-started/first-login/#step-4-cybergrid","title":"Step 4: CyberGrid","text":"<p>Category: Optional</p> <p>Configure participation in WitFoo's CyberGrid threat intelligence network.</p> Mode Description Consumer Receive threat intelligence from the CyberGrid network Contributor Share anonymized threat indicators with the network Full Both consume and contribute threat intelligence <p>CyberGrid provides community-sourced indicators of compromise (IOCs), threat actor profiles, and detection signatures.</p> <p>Privacy</p> <p>In Contributor and Full modes, only anonymized indicators are shared. No raw log data, organization-specific details, or personally identifiable information leaves your environment.</p>"},{"location":"getting-started/first-login/#step-5-general-settings-review","title":"Step 5: General Settings Review","text":"<p>Category: Recommended</p> <p>A read-only confirmation page displaying the settings configured in Step 0 (Welcome):</p> <ul> <li>Organization Name</li> <li>Timezone</li> <li>Date/Time Format</li> <li>Notification Status</li> </ul> <p>Review these settings and use the back navigation to return to Step 0 if changes are needed.</p>"},{"location":"getting-started/first-login/#step-6-business-metrics","title":"Step 6: Business Metrics","text":"<p>Category: Optional</p> <p>Configure business context for ROI reporting and operational metrics.</p> Field Description FTE Cost (Annual) Average fully-loaded cost of a full-time security employee Annual Revenue Organization's annual revenue (for risk calculations) Annual Security Spend Total annual security operations budget Mean Time to Detect (hours) Current average time to detect a security incident Mean Time to Respond (hours) Current average time to respond to a security incident <p>These values are used by the Reporter module to calculate return on investment, cost savings, and operational efficiency metrics.</p> <p>Estimates Are Fine</p> <p>Exact figures are not required. Reasonable estimates enable the ROI reports to provide directional value. You can refine these numbers later.</p>"},{"location":"getting-started/first-login/#step-7-compliance-frameworks","title":"Step 7: Compliance Frameworks","text":"<p>Category: Recommended</p> <p>Enable the compliance frameworks relevant to your organization.</p> <p>Available frameworks include CIS Controls, NIST Cybersecurity Framework, NIST 800-53, ISO 27001, PCI DSS, HIPAA, SOC 2, and others.</p> <p>For each framework you can:</p> <ul> <li>Enable/Disable \u2014 Toggle whether the framework appears in compliance reports</li> <li>Designate as Primary \u2014 Set one framework as the primary compliance standard for your organization</li> </ul> <p>The primary framework is used as the default in compliance dashboards and reports.</p>"},{"location":"getting-started/first-login/#step-8-authentication","title":"Step 8: Authentication","text":"<p>Category: Recommended</p> <p>Configure how users authenticate to the platform.</p> Method Description Local Username/password stored in the platform database LDAP Authenticate against an LDAP or Active Directory server SAML SSO Single sign-on via a SAML 2.0 identity provider Mixed Combine local accounts with LDAP or SAML for different user groups <p>For LDAP and SAML configurations, the wizard provides Test Connection buttons to validate connectivity before saving.</p> <p>LDAP Configuration Fields:</p> Field Description Server URL LDAP server URL (e.g., <code>ldaps://ldap.mycompany.com:636</code>) Bind DN Distinguished name for LDAP bind Bind Password Password for LDAP bind Search Base Base DN for user searches User Filter LDAP filter for user lookup <p>SAML Configuration Fields:</p> Field Description IdP Metadata URL URL to the identity provider's SAML metadata Entity ID Service provider entity ID ACS URL Assertion Consumer Service URL (auto-populated) <p>Start with Local Authentication</p> <p>If you are evaluating the platform, start with Local authentication. You can add LDAP or SAML later from the Admin panel without disrupting existing users.</p>"},{"location":"getting-started/first-login/#step-9-notifications","title":"Step 9: Notifications","text":"<p>Category: Optional</p> <p>Configure notification delivery channels.</p> <p>SMTP Email:</p> Field Description SMTP Server Mail server hostname (e.g., <code>smtp.mycompany.com</code>) SMTP Port Mail server port (e.g., 587 for STARTTLS) Username SMTP authentication username Password SMTP authentication password From Address Sender email address for notifications <p>Slack Webhook:</p> Field Description Webhook URL Slack incoming webhook URL Channel Default channel for notifications <p>Both channels provide a Test Send button to verify configuration before saving.</p>"},{"location":"getting-started/first-login/#step-10-ai-capabilities","title":"Step 10: AI Capabilities","text":"<p>Category: Optional</p> <p>Configure AI-assisted investigation and analysis.</p> Field Description AI Provider Select from Anthropic (Claude), OpenAI, Google (Gemini), or IBM watsonx API Key Provider API key for authentication Model Specific model to use (e.g., <code>claude-sonnet-4-20250514</code>, <code>gpt-4o</code>) Temperature Response creativity (0.0 = deterministic, 1.0 = creative) Max Tokens Maximum response length <p>API Key Security</p> <p>AI API keys are encrypted at rest using AES-256 encryption. Keys are never displayed in the UI after initial entry.</p>"},{"location":"getting-started/first-login/#step-11-summary","title":"Step 11: Summary","text":"<p>The final step displays a progress checklist showing the completion status of all previous steps.</p> Element Description Step Checklist Shows \u2705 completed, \u26a0\ufe0f skipped, or \u274c not started for each step Completion Percentage Overall progress toward full onboarding Launch Platform Button to close the wizard and enter the platform <p>Clicking Launch Platform closes the onboarding wizard and takes you to the main dashboard.</p> <p>Return to Onboarding</p> <p>If you close the wizard before completing all steps, a banner reminder appears on the dashboard. You can reopen the wizard from the Admin panel at any time.</p> <p>All Settings Are Editable</p> <p>Every setting configured during onboarding can be changed later from the Admin panel. The onboarding wizard is a convenience for initial setup \u2014 it does not lock any configuration.</p>"},{"location":"getting-started/first-login/#after-onboarding","title":"After Onboarding","text":"<p>Once you complete the onboarding wizard, you are ready to:</p> <ol> <li>Connect data sources \u2014 Configure Conductor nodes to collect logs from your environment</li> <li>Explore the dashboard \u2014 View the security operations overview</li> <li>Investigate artifacts \u2014 Use Search to explore ingested security data</li> <li>Review incidents \u2014 Check the Observer for correlated security incidents</li> <li>Generate reports \u2014 Use Reporter for compliance and operational reporting</li> </ol> <p>For next steps on connecting data sources, see the Conductor integration guides in the documentation.</p>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>This guide covers deploying a WitFoo Appliance (WFA) \u2014 the production deployment method for WitFoo Analytics. The WFA daemon manages containers, configuration, and lifecycle operations on each node.</p>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>A supported deployment target (see options below)</li> <li>Network access to the appliance on HTTPS port 443</li> <li>A WitFoo license key, or intent to request a 15-day trial</li> <li>Hardware meeting the minimum requirements for your chosen role</li> </ul>"},{"location":"getting-started/installation/#installation-overview","title":"Installation Overview","text":"<p>Deploying WitFoo Analytics involves three steps:</p> <ol> <li>Deploy a WitFoo Appliance image or run the install script</li> <li>Configure the appliance role using <code>sudo wfa configure</code></li> <li>Access the web UI and complete the onboarding wizard</li> </ol>"},{"location":"getting-started/installation/#step-1-deploy-a-witfoo-appliance","title":"Step 1: Deploy a WitFoo Appliance","text":"<p>Choose the deployment method that matches your infrastructure. All methods install the WFA daemon and prepare the system for configuration.</p> <p>Appliance images and scripts are available at: https://github.com/witfoo/witfoo-appliances</p>"},{"location":"getting-started/installation/#option-a-on-premises-vm","title":"Option A: On-Premises VM","text":"<p>Pre-built Ubuntu 24 VM images are available for the following hypervisors:</p> <ol> <li> <p>Download the appropriate image from the witfoo-appliances repository:</p> <ul> <li>VMware \u2014 OVA format</li> <li>Hyper-V \u2014 VHDX format</li> <li>QEMU/KVM \u2014 QCOW2 format</li> </ul> </li> <li> <p>Import the image into your hypervisor.</p> </li> <li> <p>Allocate resources according to your target role:</p> Role CPU (min) RAM (min) Disk (min) Conductor 4 8 GB 220 GB Console 4 8 GB 220 GB Analytics 8 12 GB 220 GB </li> <li> <p>Power on the VM and note the IP address assigned via DHCP, or configure a static IP.</p> </li> <li> <p>Connect via SSH:</p> <pre><code>ssh witfooadmin@&lt;appliance-ip&gt;\n</code></pre> </li> </ol> <p>Change Default SSH Password</p> <p>The default SSH credentials are <code>witfooadmin</code> / <code>F00theN0ise!</code>. Change this password immediately after first login: <pre><code>passwd\n</code></pre></p>"},{"location":"getting-started/installation/#option-b-cloud-marketplace","title":"Option B: Cloud Marketplace","text":"<p>WitFoo Appliances are available on the following cloud marketplaces:</p> <ol> <li>AWS Marketplace \u2014 Search for \"WitFoo\" in the AWS Marketplace and launch the AMI.</li> <li>Azure Marketplace \u2014 Search for \"WitFoo\" in the Azure Marketplace and deploy the VM image.</li> <li>Google Cloud Marketplace \u2014 Search for \"WitFoo\" in the Google Cloud Marketplace and deploy the instance.</li> </ol> <p>After launching the instance:</p> <ol> <li>Ensure the security group or firewall allows inbound HTTPS (port 443).</li> <li>For Conductor nodes, also allow inbound TCP on ports 4223 and 4443.</li> <li>Connect via SSH using the cloud provider's standard method (SSH key or serial console).</li> </ol> <p>Cloud Instance Sizing</p> <p>Use the hardware requirements table above to select the appropriate instance type. For Analytics nodes, we recommend at least 16 vCPUs and 32 GB RAM for production workloads.</p>"},{"location":"getting-started/installation/#option-c-bare-metal","title":"Option C: Bare Metal","text":"<p>For bare metal servers, use the provided install scripts:</p> <p>Ubuntu 24:</p> <ol> <li>Start with a fresh Ubuntu 24 server installation.</li> <li> <p>Download and run the install script:</p> <pre><code>curl -fsSL https://raw.githubusercontent.com/witfoo/witfoo-appliances/main/ubuntu-install.sh -o ubuntu-install.sh\nchmod +x ubuntu-install.sh\nsudo ./ubuntu-install.sh\n</code></pre> </li> <li> <p>The script installs all dependencies, creates the <code>witfooadmin</code> user, and installs the WFA daemon.</p> </li> </ol> <p>RHEL 10:</p> <ol> <li>Start with a fresh RHEL 10 server installation.</li> <li> <p>Download and run the install script:</p> <pre><code>curl -fsSL https://raw.githubusercontent.com/witfoo/witfoo-appliances/main/rhel-install.sh -o rhel-install.sh\nchmod +x rhel-install.sh\nsudo ./rhel-install.sh\n</code></pre> </li> <li> <p>The script installs all dependencies, creates the <code>witfooadmin</code> user, and installs the WFA daemon.</p> </li> </ol>"},{"location":"getting-started/installation/#step-2-configure-the-appliance","title":"Step 2: Configure the Appliance","text":"<p>Once the WFA daemon is installed, run the interactive configuration wizard:</p> <pre><code>sudo wfa configure\n</code></pre> <p>The wizard guides you through:</p> <ul> <li>Selecting the appliance role (Conductor, Console, or Analytics)</li> <li>Entering your license key or requesting a trial</li> <li>Configuring network settings and certificates</li> <li>Setting the admin password</li> <li>Enabling optional features</li> </ul> <p>The wizard writes its configuration to <code>/witfoo/configs/node.json</code>.</p> <p>For a detailed walkthrough of every wizard step, see Configuration Wizard.</p>"},{"location":"getting-started/installation/#step-3-start-services-and-access-the-web-ui","title":"Step 3: Start Services and Access the Web UI","text":"<p>After configuration completes, the WFA daemon pulls container images and starts services automatically. You can verify the status:</p> <pre><code>sudo wfa analytics status\n</code></pre> <p>Once all services are running, access the web UI:</p> <ol> <li>Open a browser and navigate to <code>https://&lt;appliance-ip&gt;</code>.</li> <li>Accept the self-signed certificate (or install your own \u2014 see Configuration Wizard).</li> <li>Log in with the default credentials and complete the onboarding wizard.</li> </ol> <p>For detailed first-login instructions, see First Login &amp; Onboarding.</p>"},{"location":"getting-started/installation/#verifying-the-installation","title":"Verifying the Installation","text":"<p>After completing all three steps, verify your deployment:</p> <pre><code># Check WFA service status\nsudo wfa analytics status\n\n# Verify the web UI is accessible\ncurl -k https://localhost/api/v1/status\n</code></pre> <p>A healthy deployment returns a JSON response with service version and status information.</p> <p>Troubleshooting</p> <p>If services fail to start, check the logs: <pre><code>sudo wfa logs\n</code></pre> Common issues include insufficient disk space, port conflicts, and network connectivity problems preventing container image pulls.</p>"},{"location":"getting-started/installation/#for-developers","title":"For Developers","text":"<p>This guide covers production deployment using the WitFoo Appliance. If you are a developer working on WitFoo Analytics and need to run the platform using Docker Compose for development or CI/CD, refer to the Deployment section of the documentation.</p>"},{"location":"getting-started/wfa-configure/","title":"Configuration Wizard","text":"<p>The <code>sudo wfa configure</code> command launches an interactive wizard that configures your WitFoo Appliance. This page documents every step of the wizard, including the exact prompts, options, and role-specific differences.</p>"},{"location":"getting-started/wfa-configure/#overview","title":"Overview","text":"<p>The wizard collects configuration for your appliance and writes the results to <code>/witfoo/configs/node.json</code>. The steps vary depending on the selected role.</p>"},{"location":"getting-started/wfa-configure/#step-applicability-by-role","title":"Step Applicability by Role","text":"Step Conductor Console Analytics 1. Organization Information \u2705 \u2705 \u2705 2. Role Selection \u2705 \u2705 \u2705 3. License Configuration \u2705 \u2705 \u2705 4. Appliance ID \u2705 \u2014 \u2705 5. Node Hostname and IP \u2705 \u2705 \u2705 6. Network Configuration \u2705 \u2014 \u2014 7. Registry Configuration \u2705 \u2705 \u2705 8. Certificate Configuration \u2705 \u2705 \u2705 9. Admin Password \u2705 \u2705 \u2705 10. Optional Features \u2705 \u2705 \u2705 11. Review and Save \u2705 \u2705 \u2705"},{"location":"getting-started/wfa-configure/#running-the-wizard","title":"Running the Wizard","text":"<p>Connect to your appliance via SSH and run:</p> <pre><code>sudo wfa configure\n</code></pre> <p>The wizard presents each step sequentially. You can accept defaults (shown in brackets) by pressing Enter, or type a new value.</p>"},{"location":"getting-started/wfa-configure/#step-1-organization-information","title":"Step 1: Organization Information","text":"<p>The wizard begins by collecting your organization details.</p> <pre><code>=== Organization Information ===\n\nOrganization ID [witfoo]: mycompany\nOrganization Name [WitFoo]: My Company Inc.\n</code></pre> <p>Organization ID \u2014 A DNS-valid, lowercase identifier for your organization. This is used internally for data partitioning and multi-tenant isolation. Use only lowercase letters, numbers, and hyphens.</p> <p>Organization Name \u2014 The human-readable display name for your organization. This appears in the web UI and reports.</p> <p>Organization ID Format</p> <p>The Organization ID must be DNS-valid: lowercase letters, numbers, and hyphens only. No spaces, underscores, or special characters. Examples: <code>acme-corp</code>, <code>mycompany</code>, <code>security-ops</code>.</p>"},{"location":"getting-started/wfa-configure/#step-2-role-selection","title":"Step 2: Role Selection","text":"<p>Select the role for this appliance.</p> <pre><code>=== Role Selection ===\n\nSelect the role for this appliance:\n\n  1. Conductor   \u2014 Data ingestion and signal processing (4 CPU / 8 GB RAM min)\n  2. Console     \u2014 Remote management and monitoring    (4 CPU / 8 GB RAM min)\n  3. Analytics   \u2014 Security analytics platform         (8 CPU / 12 GB RAM min)\n\nRole [3]:\n</code></pre> <p>After selecting a role, the wizard checks your hardware against the minimum requirements:</p> Role CPU (min) RAM (min) Disk (min) Conductor 4 8 GB 220 GB Console 4 8 GB 220 GB Analytics 8 12 GB 220 GB <p>If your hardware is below the minimum, the wizard displays a warning:</p> <pre><code>\u26a0 WARNING: This system has 4 CPU cores. The Analytics role requires a minimum\n  of 8 CPU cores. Performance may be degraded. Continue anyway? [y/N]:\n</code></pre> <p>Recommended Hardware for Analytics</p> <p>While the minimum for Analytics is 8 CPU / 12 GB RAM, production deployments should use 16 CPU cores, 32 GB RAM, and 1 TB disk for optimal performance with Cassandra, the graph processor, and the incident engine.</p>"},{"location":"getting-started/wfa-configure/#step-3-license-configuration","title":"Step 3: License Configuration","text":"<p>The wizard configures your WitFoo license.</p>"},{"location":"getting-started/wfa-configure/#cloud-deployments","title":"Cloud Deployments","text":"<p>For cloud marketplace deployments, the license is fetched automatically:</p> <pre><code>=== License Configuration ===\n\nFetching license from licensing.witfoo.com...\nLicense validated: My Company Inc. (Enterprise, 500 cores)\n</code></pre>"},{"location":"getting-started/wfa-configure/#on-premises-deployments","title":"On-Premises Deployments","text":"<p>For on-premises deployments, you have two options:</p> <pre><code>=== License Configuration ===\n\n  1. Enter license key\n  2. Request 15-day trial\n\nSelection [1]:\n</code></pre> <p>Option 1: Enter License Key</p> <pre><code>License Key: XXXX-XXXX-XXXX-XXXX\nValidating license... \u2713 License valid: My Company Inc. (Enterprise, 500 cores)\n</code></pre> <p>Option 2: Request 15-Day Trial</p> <pre><code>Company Name: My Company Inc.\nContact Name: Jane Smith\nContact Email: jane.smith@mycompany.com\nCore Count [16]: 16\n\nRequesting trial license... \u2713 Trial license activated (expires: 2026-03-15)\n</code></pre> <p>Trial Limitations</p> <p>The 15-day trial provides full platform functionality. Contact WitFoo sales to obtain a production license before the trial expires.</p>"},{"location":"getting-started/wfa-configure/#step-4-appliance-id","title":"Step 4: Appliance ID","text":"<p>An appliance ID is automatically generated for Conductor and Analytics nodes. This UUID uniquely identifies the appliance in multi-node deployments.</p> <pre><code>=== Appliance ID ===\n\nAppliance ID: a1b2c3d4-e5f6-7890-abcd-ef1234567890\n</code></pre> <p>Console Skips This Step</p> <p>The Console role does not require an Appliance ID and skips this step automatically.</p>"},{"location":"getting-started/wfa-configure/#step-5-node-hostname-and-ip","title":"Step 5: Node Hostname and IP","text":"<p>Configure the network identity of this node.</p> <pre><code>=== Node Hostname and IP ===\n\nHostname [wfa-analytics-01]: wfa-analytics-01\nDetected IP address: 10.0.1.50\nUse detected IP? [Y/n]: y\nIP Address: 10.0.1.50\n</code></pre> <p>If the auto-detected IP is incorrect (e.g., the system has multiple interfaces), select <code>n</code> and enter the correct IP manually:</p> <pre><code>Use detected IP? [Y/n]: n\nIP Address: 192.168.1.100\n</code></pre>"},{"location":"getting-started/wfa-configure/#step-6-network-configuration-conductor-only","title":"Step 6: Network Configuration (Conductor Only)","text":"<p>This step configures the NATS broker ports and data limits for the Conductor's signal processing pipeline.</p> <pre><code>=== Network Configuration ===\n\nNATS Client Port [4223]: 4223\nNATS Leaf Port [4443]: 4443\nMax Data Size (MB) [1024]: 1024\n</code></pre> Setting Default Description NATS Client Port 4223 Port for client connections to the NATS broker NATS Leaf Port 4443 Port for leaf node connections from other NATS nodes Max Data Size 1024 MB Maximum data payload size for NATS messages <p>Console and Analytics Skip This Step</p> <p>Network configuration for the NATS broker is only relevant to the Conductor role. Console and Analytics nodes skip this step.</p>"},{"location":"getting-started/wfa-configure/#step-7-registry-configuration","title":"Step 7: Registry Configuration","text":"<p>Configure credentials for the container image registry. These credentials are typically populated automatically from your license validation.</p> <pre><code>=== Registry Configuration ===\n\nRegistry URL [registry.witfoo.com]: registry.witfoo.com\nRegistry Username: mycompany\nRegistry Password: ********\nValidating registry credentials... \u2713 Authenticated\n</code></pre> <p>The registry credentials allow the WFA daemon to pull container images for the services required by your selected role.</p>"},{"location":"getting-started/wfa-configure/#step-8-certificate-configuration","title":"Step 8: Certificate Configuration","text":"<p>Optionally configure TLS certificates for secure communication. If you skip this step, the appliance generates self-signed certificates.</p> <pre><code>=== Certificate Configuration ===\n\nConfigure custom TLS certificates? [y/N]: y\n\nClient Certificate Path [/witfoo/certs/client.crt]: /witfoo/certs/client.crt\nClient Key Path [/witfoo/certs/client.key]: /witfoo/certs/client.key\nServer Certificate Path [/witfoo/certs/server.crt]: /witfoo/certs/server.crt\nServer Key Path [/witfoo/certs/server.key]: /witfoo/certs/server.key\nCA Certificate Path [/witfoo/certs/ca.crt]: /witfoo/certs/ca.crt\n\nValidating certificates... \u2713 Certificates valid\n</code></pre> Certificate Default Path Purpose Client Certificate <code>/witfoo/certs/client.crt</code> Client-side TLS authentication Client Key <code>/witfoo/certs/client.key</code> Client certificate private key Server Certificate <code>/witfoo/certs/server.crt</code> Server-side TLS for HTTPS Server Key <code>/witfoo/certs/server.key</code> Server certificate private key CA Certificate <code>/witfoo/certs/ca.crt</code> Certificate authority chain <p>Production Deployments</p> <p>Self-signed certificates are acceptable for evaluation but should be replaced with certificates from a trusted CA for production deployments. Browsers will display security warnings for self-signed certificates.</p>"},{"location":"getting-started/wfa-configure/#step-9-admin-password","title":"Step 9: Admin Password","text":"<p>Set the administrative password for the appliance. This password is used for local appliance management.</p> <pre><code>=== Admin Password ===\n\nEnter admin password (min 8 characters): ********\nConfirm admin password: ********\n\u2713 Password saved\n</code></pre> <ul> <li>Minimum 8 characters</li> <li>Input is masked (not displayed)</li> <li>Confirmation is required</li> <li>The password is saved to <code>/data/local/.passwd</code></li> </ul> <p>Choose a Strong Password</p> <p>This password provides administrative access to the appliance. Use a strong, unique password that is at least 12 characters with a mix of uppercase, lowercase, numbers, and symbols.</p>"},{"location":"getting-started/wfa-configure/#step-10-optional-features","title":"Step 10: Optional Features","text":"<p>The optional features presented depend on the selected role.</p>"},{"location":"getting-started/wfa-configure/#conductor-features","title":"Conductor Features","text":"<pre><code>=== Optional Features ===\n\nEnable local metrics (Prometheus/Grafana)? [Y/n]: y\nEnable offline mode? [y/N]: n\nEnable metrics export? [y/N]: n\nEnable auto-update? [Y/n]: y\nRemote Console FQDN []: console.mycompany.com\n</code></pre> Feature Default Description Local metrics Enabled Run Prometheus and Grafana locally for pipeline monitoring Offline mode Disabled Operate without internet connectivity (requires pre-staged images) Metrics export Disabled Export metrics to an external Prometheus/Grafana instance Auto-update Enabled Automatically pull and apply container image updates Remote Console FQDN Empty FQDN of the Console node managing this Conductor"},{"location":"getting-started/wfa-configure/#console-features","title":"Console Features","text":"<pre><code>=== Optional Features ===\n\nEnable offline mode? [y/N]: n\nEnable auto-update? [Y/n]: y\n</code></pre> Feature Default Description Offline mode Disabled Operate without internet connectivity Auto-update Enabled Automatically pull and apply updates"},{"location":"getting-started/wfa-configure/#analytics-features","title":"Analytics Features","text":"<pre><code>=== Optional Features ===\n\n=== Data Retention ===\nArtifact retention (days) [7]: 7\nWork unit retention (days) [365]: 365\nWork collection retention (days) [365]: 365\nReport retention (days) [1825]: 1825\n\n=== UI Module Visibility ===\nEnable all modules (Search, Observer, Reporter, CyberGrid, AI)? [Y/n]: y\n\n=== CyberGrid Integration ===\nEnable CyberGrid threat intelligence? [y/N]: n\n\n=== Clustering ===\nEnable clustering? [y/N]: n\n</code></pre> Feature Default Description Data retention 7/365/365/1825 days Per-feature retention periods for artifacts, work units, collections, and reports UI module visibility All enabled Toggle which modules appear in the web UI navigation CyberGrid integration Disabled Participate in WitFoo's threat intelligence sharing network Clustering Disabled Enable multi-node Cassandra clustering for horizontal scaling <p>Analytics Defaults Are Sensible</p> <p>The default retention and module settings work well for most deployments. These settings can also be customized later via the Onboarding Wizard in the web UI (see First Login &amp; Onboarding).</p>"},{"location":"getting-started/wfa-configure/#step-11-review-and-save","title":"Step 11: Review and Save","text":"<p>The wizard displays a summary of all configured settings for your review.</p> <pre><code>=== Configuration Summary ===\n\nOrganization:     My Company Inc. (mycompany)\nRole:             Analytics\nLicense:          Enterprise (500 cores, expires 2027-01-15)\nAppliance ID:     a1b2c3d4-e5f6-7890-abcd-ef1234567890\nHostname:         wfa-analytics-01\nIP Address:       10.0.1.50\nRegistry:         registry.witfoo.com\nTLS Certificates: Custom (/witfoo/certs/)\nAuto-Update:      Enabled\n\nData Retention:\n  Artifacts:         7 days\n  Work Units:        365 days\n  Work Collections:  365 days\n  Reports:           1825 days\n\nUI Modules:       All enabled\nCyberGrid:        Disabled\nClustering:       Disabled\n\nSave configuration? [Y/n]: y\n\n\u2713 Configuration saved to /witfoo/configs/node.json\n\u2713 Starting services...\n</code></pre> <p>After confirming, the wizard:</p> <ol> <li>Writes the configuration to <code>/witfoo/configs/node.json</code></li> <li>Pulls the required container images from the registry</li> <li>Starts all services for the configured role</li> </ol> <p>Re-Running the Wizard</p> <p>You can re-run <code>sudo wfa configure</code> at any time to change your configuration. The wizard pre-populates fields with your existing settings.</p>"},{"location":"getting-started/wfa-configure/#configuration-file-reference","title":"Configuration File Reference","text":"<p>The wizard generates <code>/witfoo/configs/node.json</code> with the following structure:</p> <pre><code>{\n  \"org_id\": \"mycompany\",\n  \"org_name\": \"My Company Inc.\",\n  \"role\": \"analytics\",\n  \"appliance_id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n  \"hostname\": \"wfa-analytics-01\",\n  \"ip_address\": \"10.0.1.50\",\n  \"registry\": {\n    \"url\": \"registry.witfoo.com\",\n    \"username\": \"mycompany\"\n  },\n  \"certificates\": {\n    \"client_cert\": \"/witfoo/certs/client.crt\",\n    \"client_key\": \"/witfoo/certs/client.key\",\n    \"server_cert\": \"/witfoo/certs/server.crt\",\n    \"server_key\": \"/witfoo/certs/server.key\",\n    \"ca_cert\": \"/witfoo/certs/ca.crt\"\n  },\n  \"features\": {\n    \"auto_update\": true,\n    \"offline_mode\": false\n  }\n}\n</code></pre>"},{"location":"reference/","title":"Reference","text":"<p>This section provides comprehensive reference tables for WitFoo Analytics v0.9.1. Use these pages for quick lookup of permissions, roles, configuration variables, and database schema details.</p>"},{"location":"reference/#contents","title":"Contents","text":"Page Description Permissions Complete 93-permission matrix across 18 categories Roles 8 predefined system roles with assigned permissions Environment Variables All configuration variables with defaults and descriptions Cassandra Schema Table definitions, column types, primary keys, and indexes Changelog Version history and release notes"},{"location":"reference/#quick-links","title":"Quick Links","text":""},{"location":"reference/#for-security-analysts","title":"For Security Analysts","text":"<ul> <li>Analyst role permissions \u2014 what you can access out of the box</li> <li>Signal permissions \u2014 search and export capabilities</li> </ul>"},{"location":"reference/#for-administrators","title":"For Administrators","text":"<ul> <li>Admin role permissions \u2014 full system access details</li> <li>Environment variables \u2014 service configuration reference</li> <li>User and role management permissions</li> </ul>"},{"location":"reference/#for-developers","title":"For Developers","text":"<ul> <li>Cassandra schema \u2014 table structures and indexing strategy</li> <li>Permission inclusion rules \u2014 how permission inheritance works</li> <li>Service-specific configuration</li> </ul> <p>Permission System Overview</p> <p>WitFoo Analytics uses a resource:action permission model with 93 permissions across 18 categories. The <code>admin</code> permission grants all permissions. For architectural details, see the Permissions and Roles reference pages.</p>"},{"location":"reference/cassandra-schema/","title":"Cassandra Schema Reference","text":"<p>WitFoo Analytics uses Apache Cassandra 5.0+ with Storage Attached Indexing (SAI) as its primary data store. All tables reside in the <code>analytics_v2</code> keyspace.</p> <pre><code>CREATE KEYSPACE IF NOT EXISTS analytics_v2\nWITH replication = {'class': 'SimpleStrategy', 'replication_factor': 1}\nAND durable_writes = true;\n</code></pre> <p>SAI Indexing</p> <p>All secondary indexes use Cassandra 5.0 Storage Attached Indexing (<code>StorageAttachedIndex</code>). SAI provides efficient filtering without the overhead of traditional secondary indexes. Map columns support both <code>VALUES()</code> and <code>ENTRIES()</code> index types.</p>"},{"location":"reference/cassandra-schema/#table-summary","title":"Table Summary","text":"Table Purpose Partition Key TTL <code>artifacts</code> Signal/artifact storage <code>(partition_key, time_bucket)</code> 30 days <code>objects</code> Licensing metadata (products, frameworks) <code>partition_key</code> \u2014 <code>graph_nodes</code> Graph entity nodes <code>partition_key</code> 7 days <code>node_index</code> Node identifier lookup index <code>partition_key</code> 7 days <code>graph_edges</code> Graph entity relationships <code>partition_key</code> 7 days <code>lead_rules</code> Pattern matching rule definitions <code>rule_category</code> \u2014 <code>leads</code> Pattern match results <code>org_id</code> 30 days <code>mo_definitions</code> Modus operandi definitions <code>org_id</code> \u2014 <code>behavioral_sets</code> Behavioral set definitions <code>org_id</code> \u2014 <code>mo_connection_defs</code> MO connection patterns <code>org_id</code> \u2014 <code>incidents_v2</code> Aggregated security incidents <code>(org_id, time_bucket)</code> 365 days <code>incident_notes</code> Incident collaboration notes <code>(org_id, incident_id)</code> \u2014 <code>incident_audit_log</code> Incident change audit trail <code>(org_id, incident_id)</code> 90 days <code>incident_naming</code> Incident name dictionaries <code>(org_id, dictionary_type)</code> \u2014 <code>incident_assignments</code> Multi-user incident assignments <code>(org_id, incident_id)</code> \u2014 <code>roles</code> RBAC role definitions <code>org_id</code> \u2014 <code>users</code> User accounts <code>user_id</code> \u2014 <code>system_settings</code> System configuration <code>(org_id, setting_category)</code> \u2014 <code>settings</code> Organization settings <code>org_id</code> \u2014 <code>audit_log</code> Administrative audit trail <code>org_id</code> 90 days <code>branding_config</code> White-label theme configuration <code>org_id</code> \u2014 <code>branding_assets</code> White-label binary assets <code>org_id</code> \u2014"},{"location":"reference/cassandra-schema/#artifacts","title":"artifacts","text":"<p>Core signal/artifact storage. Uses map-based columns for flexible field indexing.</p> <p>Compaction: TimeWindowCompactionStrategy (6-hour windows)</p> Column Type Description <code>partition_key</code> <code>text</code> Tenant/org identifier <code>time_bucket</code> <code>text</code> <code>YYYY-MM-DD-HH</code> time bucket <code>created_at</code> <code>timeuuid</code> Creation time (clustering, DESC) <code>artifact_id</code> <code>uuid</code> Unique artifact identifier <code>tags</code> <code>set&lt;text&gt;</code> Classification tags <code>artifact_json</code> <code>text</code> Full artifact JSON (backward compat) <code>created_at_time</code> <code>timestamp</code> Creation timestamp <code>updated_at</code> <code>timestamp</code> Last update timestamp <code>artifact_numbers</code> <code>map&lt;text, double&gt;</code> Numeric fields (severity, ports, bytes) <code>artifact_ipv4</code> <code>map&lt;text, inet&gt;</code> IPv4 address fields <code>artifact_ipv6</code> <code>map&lt;text, inet&gt;</code> IPv6 address fields <code>artifact_text</code> <code>map&lt;text, text&gt;</code> All text fields (message_type, action, etc.) <code>matched_lead_rules</code> <code>frozen&lt;list&lt;int&gt;&gt;</code> Matched lead rule IDs <code>matched_lead_rules_updated_at</code> <code>timestamp</code> Lead rules match timestamp <code>stix_indicator_ids</code> <code>frozen&lt;list&lt;text&gt;&gt;</code> STIX indicator references <code>attack_technique_ids</code> <code>frozen&lt;list&lt;text&gt;&gt;</code> MITRE ATT&amp;CK technique IDs <code>attack_tactic_ids</code> <code>frozen&lt;list&lt;text&gt;&gt;</code> MITRE ATT&amp;CK tactic IDs <code>attack_detection_strategy_ids</code> <code>frozen&lt;list&lt;text&gt;&gt;</code> Detection strategy IDs <code>node_index</code> <code>map&lt;text, text&gt;</code> Direct node_id references for graph enrichment <code>is_alarm</code> <code>boolean</code> Denormalized alarm flag <code>severity_level</code> <code>int</code> Denormalized severity for range queries <p>Primary Key: <code>((partition_key, time_bucket), created_at, artifact_id)</code></p> <p>SAI Indexes: <code>artifact_id</code>, <code>tags</code>, <code>VALUES(artifact_numbers)</code>, <code>VALUES(artifact_ipv4)</code>, <code>VALUES(artifact_ipv6)</code>, <code>VALUES(artifact_text)</code>, <code>ENTRIES(artifact_text)</code>, <code>ENTRIES(artifact_ipv4)</code>, <code>ENTRIES(artifact_numbers)</code>, <code>matched_lead_rules</code>, <code>matched_lead_rules_updated_at</code>, <code>stix_indicator_ids</code>, <code>attack_technique_ids</code>, <code>is_alarm</code>, <code>severity_level</code></p>"},{"location":"reference/cassandra-schema/#objects","title":"objects","text":"<p>Generic object storage for licensing metadata, products, and frameworks.</p> <p>Compaction: UnifiedCompactionStrategy</p> Column Type Description <code>partition_key</code> <code>text</code> Partition identifier <code>created_at</code> <code>timeuuid</code> Creation time (clustering, DESC) <code>object_type</code> <code>text</code> Object type discriminator <code>object_id</code> <code>uuid</code> Unique object identifier <code>object_json</code> <code>text</code> Full object JSON <p>Primary Key: <code>(partition_key, created_at, object_id)</code></p> <p>SAI Indexes: <code>object_type</code> (case-insensitive)</p>"},{"location":"reference/cassandra-schema/#graph_nodes","title":"graph_nodes","text":"<p>Graph entity nodes representing assets, users, files, processes, domains, and URLs.</p> <p>Compaction: TimeWindowCompactionStrategy (1-day windows)</p> Column Type Description <code>partition_key</code> <code>text</code> Org ID for multi-tenancy <code>node_id</code> <code>timeuuid</code> UUID v1 for time-ordering (clustering, DESC) <code>node_type</code> <code>text</code> Entity type: asset, user, file, process, domain, url <code>node_numbers</code> <code>map&lt;text, double&gt;</code> Numeric fields <code>node_text</code> <code>map&lt;text, text&gt;</code> Text fields (ip_address, hostname, etc.) <code>node_flags</code> <code>map&lt;text, boolean&gt;</code> Boolean fields (internal, managed, trusted) <code>node_times</code> <code>map&lt;text, timestamp&gt;</code> Timestamp fields <code>sets</code> <code>frozen&lt;set&lt;int&gt;&gt;</code> Set memberships <code>products</code> <code>frozen&lt;set&lt;int&gt;&gt;</code> Product associations <code>frameworks</code> <code>frozen&lt;set&lt;int&gt;&gt;</code> Framework tags <code>products_updated_at</code> <code>timestamp</code> Products last updated <code>frameworks_updated_at</code> <code>timestamp</code> Frameworks last updated <code>matched_lead_rules</code> <code>frozen&lt;list&lt;int&gt;&gt;</code> Matched lead rule IDs <code>vulns</code> <code>frozen&lt;set&lt;text&gt;&gt;</code> CVE identifiers <code>last_vuln_scan</code> <code>timestamp</code> Last vulnerability scan <code>created_at</code> <code>timestamp</code> Node creation time <code>updated_at</code> <code>timestamp</code> Last update time <code>observed_at</code> <code>timestamp</code> Last observation time <code>metadata</code> <code>text</code> Additional JSON metadata <p>Primary Key: <code>(partition_key, node_id)</code></p> <p>SAI Indexes: <code>VALUES(node_numbers)</code>, <code>VALUES(node_text)</code>, <code>VALUES(node_flags)</code>, <code>VALUES(node_times)</code>, <code>node_type</code>, <code>products_updated_at</code>, <code>frameworks_updated_at</code></p>"},{"location":"reference/cassandra-schema/#node_index","title":"node_index","text":"<p>O(1) lookup table mapping identifiers (IP addresses, hostnames, etc.) to node IDs.</p> Column Type Description <code>partition_key</code> <code>text</code> Org ID <code>index_type</code> <code>text</code> Identifier type: ip, hostname, credential, etc. <code>index_value</code> <code>text</code> Normalized identifier value <code>node_id</code> <code>timeuuid</code> References <code>graph_nodes.node_id</code> <code>node_type</code> <code>text</code> Denormalized entity type <code>updated_at</code> <code>timestamp</code> Last update time <p>Primary Key: <code>(partition_key, index_type, index_value)</code></p> <p>SAI Indexes: <code>node_id</code></p>"},{"location":"reference/cassandra-schema/#graph_edges","title":"graph_edges","text":"<p>Relationships between graph nodes (connections, sessions, presence, attribution).</p> <p>Compaction: TimeWindowCompactionStrategy (6-hour windows)</p> Column Type Description <code>partition_key</code> <code>text</code> Org ID <code>edge_id</code> <code>text</code> Composite: <code>{source_id}-{target_id}-{type}-{subtype}</code> <code>source_id</code> <code>timeuuid</code> Source node UUID <code>target_id</code> <code>timeuuid</code> Target node UUID <code>edge_type</code> <code>text</code> connection, session, presence, attribution <code>edge_subtype</code> <code>int</code> Type-specific subtype <code>edge_numbers</code> <code>map&lt;text, double&gt;</code> Numeric fields <code>edge_text</code> <code>map&lt;text, text&gt;</code> Text fields <code>edge_times</code> <code>map&lt;text, timestamp&gt;</code> Timestamp fields <code>bytes</code> <code>bigint</code> Data transfer volume <code>count</code> <code>bigint</code> Occurrence count <code>artifacts</code> <code>frozen&lt;list&lt;timeuuid&gt;&gt;</code> Evidence trail (last 100 artifacts) <code>matched_lead_rules</code> <code>frozen&lt;set&lt;int&gt;&gt;</code> Matched lead rule IDs <code>mo_id</code> <code>int</code> MO definition ID <code>incident_ids</code> <code>frozen&lt;set&lt;timeuuid&gt;&gt;</code> Associated incident IDs <code>started_at</code> <code>timestamp</code> First observation <code>ended_at</code> <code>timestamp</code> Last observation <code>created_at</code> <code>timestamp</code> Creation time <code>updated_at</code> <code>timestamp</code> Last update time <code>metadata</code> <code>text</code> Additional JSON metadata <p>Primary Key: <code>(partition_key, edge_id)</code></p> <p>SAI Indexes: <code>VALUES(edge_numbers)</code>, <code>VALUES(edge_text)</code>, <code>VALUES(edge_times)</code>, <code>source_id</code>, <code>target_id</code>, <code>edge_type</code>, <code>matched_lead_rules</code>, <code>mo_id</code>, <code>incident_ids</code></p>"},{"location":"reference/cassandra-schema/#lead_rules","title":"lead_rules","text":"<p>Global pattern matching rule definitions. Partitioned by category for efficient loading.</p> <p>Compaction: LeveledCompactionStrategy</p> Column Type Description <code>rule_category</code> <code>text</code> Partition: <code>artifact</code>, <code>node</code>, <code>edge</code>, <code>global</code> <code>rule_id</code> <code>int</code> Unique rule identifier (clustering, ASC) <code>description</code> <code>text</code> Rule description <code>rule_type</code> <code>int</code> 1=artifact, 2=node, 3=edge <code>enabled</code> <code>boolean</code> Whether rule is active <code>criteria</code> <code>text</code> Match criteria expression <code>suspicion_boost</code> <code>double</code> Suspicion score contribution (0.0\u20131.0) <code>client_set_id</code> <code>int</code> Client behavioral set reference <code>server_set_id</code> <code>int</code> Server behavioral set reference <code>file_set_id</code> <code>int</code> File behavioral set reference <code>user_set_id</code> <code>int</code> User behavioral set reference <code>service_set_id</code> <code>int</code> Service behavioral set reference <code>hardware_set_id</code> <code>int</code> Hardware behavioral set reference <code>foreign_id</code> <code>int</code> External reference ID <code>product_id</code> <code>int</code> Product association <code>criteria_type</code> <code>int</code> Criteria type discriminator <code>rule_source</code> <code>int</code> Rule source identifier <code>created_at</code> <code>timestamp</code> Creation time <code>updated_at</code> <code>timestamp</code> Last update time <p>Primary Key: <code>(rule_category, rule_id)</code></p> <p>SAI Indexes: <code>enabled</code>, <code>rule_type</code></p>"},{"location":"reference/cassandra-schema/#leads","title":"leads","text":"<p>Pattern match results linking rules to entities.</p> <p>Compaction: TimeWindowCompactionStrategy (1-day windows)</p> Column Type Description <code>org_id</code> <code>text</code> Organization identifier <code>lead_id</code> <code>timeuuid</code> Unique lead ID (clustering, DESC) <code>rule_id</code> <code>int</code> Matched rule reference <code>entity_type</code> <code>text</code> <code>artifact</code>, <code>node</code>, or <code>edge</code> <code>entity_id</code> <code>uuid</code> Matched entity ID <code>matched_at</code> <code>timestamp</code> Match timestamp <code>suspicion_contribution</code> <code>double</code> Score contribution <code>metadata</code> <code>text</code> JSON match details <code>incident_id</code> <code>timeuuid</code> Assigned incident <code>is_block_action</code> <code>boolean</code> Block/deny action flag <p>Primary Key: <code>(org_id, lead_id)</code></p> <p>SAI Indexes: <code>entity_id</code>, <code>rule_id</code>, <code>incident_id</code>, <code>entity_type</code></p>"},{"location":"reference/cassandra-schema/#incidents_v2","title":"incidents_v2","text":"<p>Aggregated security incidents with monthly time-bucket partitioning.</p> <p>Compaction: TimeWindowCompactionStrategy (7-day windows)</p> Column Type Description <code>org_id</code> <code>text</code> Organization identifier <code>time_bucket</code> <code>text</code> <code>YYYY-MM</code> monthly partition <code>incident_id</code> <code>timeuuid</code> Unique incident ID (clustering, DESC) <code>incident_name</code> <code>text</code> Generated memorable name <code>parent_incident_id</code> <code>uuid</code> Parent incident for splits <code>part_number</code> <code>int</code> Split part number <code>total_parts</code> <code>int</code> Total split parts <code>title</code> <code>text</code> Incident title <code>description</code> <code>text</code> Incident description <code>severity_level</code> <code>int</code> 1=low, 2=medium, 3=high, 4=critical <code>status_id</code> <code>int</code> 1=new, 2=investigating, 3=resolved, 4=closed <code>assigned_to</code> <code>text</code> Primary assignee <code>source_ips</code> <code>set&lt;text&gt;</code> Source IP addresses <code>dest_ips</code> <code>set&lt;text&gt;</code> Destination IP addresses <code>users</code> <code>set&lt;text&gt;</code> Associated users <code>tags</code> <code>int</code> MO definition ID <code>mo_name</code> <code>text</code> Denormalized MO name <code>suspicion_score</code> <code>double</code> Aggregate suspicion (0.0\u20131.0) <code>observation_results</code> <code>map&lt;int, text&gt;</code> Observation ID \u2192 JSON result <code>artifact_count</code> <code>int</code> Number of artifacts <code>lead_count</code> <code>int</code> Number of leads <code>graph_json</code> <code>text</code> Cytoscape visualization JSON <code>metadata</code> <code>text</code> Additional JSON metadata <code>created_at</code> <code>timestamp</code> Creation time <code>updated_at</code> <code>timestamp</code> Last update time <p>Primary Key: <code>((org_id, time_bucket), incident_id)</code></p> <p>SAI Indexes: <code>assigned_to</code>, <code>source_ips</code>, <code>dest_ips</code>, <code>users</code>, <code>tags</code>, <code>suspicion_score</code>, <code>node_ids</code>, <code>status_id</code>, <code>severity_level</code>, <code>mo_name</code></p>"},{"location":"reference/cassandra-schema/#roles","title":"roles","text":"<p>RBAC role definitions with permission lists.</p> Column Type Description <code>role_id</code> <code>uuid</code> Unique role identifier <code>org_id</code> <code>text</code> Organization scope <code>role_name</code> <code>text</code> Display name <code>description</code> <code>text</code> Role description <code>permissions</code> <code>frozen&lt;list&lt;text&gt;&gt;</code> Assigned permission keys <code>system_role</code> <code>boolean</code> Built-in role flag (cannot delete) <code>created_at</code> <code>timestamp</code> Creation time <code>updated_at</code> <code>timestamp</code> Last update time <code>created_by</code> <code>uuid</code> Creator user ID <code>updated_by</code> <code>uuid</code> Last updater user ID <p>Primary Key: <code>(org_id, role_id)</code></p> <p>SAI Indexes: <code>role_name</code> (case-insensitive), <code>system_role</code></p> <p>Predefined Roles</p> <p>See Roles Reference for the 8 system roles seeded on initialization.</p>"},{"location":"reference/cassandra-schema/#users","title":"users","text":"<p>User account storage for authentication and authorization.</p> Column Type Description <code>user_id</code> <code>uuid</code> Primary key <code>username</code> <code>text</code> Login username <code>email</code> <code>text</code> Email address <code>password_hash</code> <code>text</code> Bcrypt password hash <code>first_name</code> <code>text</code> First name <code>last_name</code> <code>text</code> Last name <code>role_ids</code> <code>frozen&lt;list&lt;uuid&gt;&gt;</code> Assigned role references <code>org_id</code> <code>text</code> Organization scope <code>active</code> <code>boolean</code> Account active flag <code>is_platform_admin</code> <code>boolean</code> Cross-tenant super admin flag <code>last_login</code> <code>timestamp</code> Last login timestamp <code>created_at</code> <code>timestamp</code> Creation time <code>updated_at</code> <code>timestamp</code> Last update time <code>created_by</code> <code>uuid</code> Creator user ID <code>updated_by</code> <code>uuid</code> Last updater user ID <code>locale</code> <code>text</code> User locale preference <p>Primary Key: <code>(user_id)</code></p> <p>SAI Indexes: <code>username</code> (case-insensitive), <code>email</code> (case-insensitive), <code>org_id</code>, <code>active</code>, <code>is_platform_admin</code></p>"},{"location":"reference/cassandra-schema/#settings","title":"settings","text":"<p>Organization-level configuration. One row per organization.</p> Column Type Description <code>org_id</code> <code>text</code> Primary key \u2014 organization identifier <code>org_name</code> <code>text</code> Organization name <code>org_display_name</code> <code>text</code> Display name <code>org_domain</code> <code>text</code> Organization domain <code>timezone</code> <code>text</code> Timezone setting <code>date_format</code> <code>text</code> Date format preference <code>severity_threshold</code> <code>int</code> Minimum severity for alerts <code>auto_close</code> <code>boolean</code> Auto-close incidents <code>auto_close_days</code> <code>int</code> Days before auto-close <code>saml2_enabled</code> <code>boolean</code> SAML2 SSO enabled <code>ldap_enabled</code> <code>boolean</code> LDAP authentication enabled <p>Primary Key: <code>(org_id)</code></p> <p>SAI Indexes: <code>org_name</code></p>"},{"location":"reference/cassandra-schema/#branding_config","title":"branding_config","text":"<p>Per-organization white-label theme configuration.</p> <p>Compaction: LeveledCompactionStrategy</p> Column Type Description <code>org_id</code> <code>text</code> Organization identifier <code>config_key</code> <code>text</code> Configuration key (clustering, ASC) <code>app_title</code> <code>text</code> Application title <code>primary_color</code> <code>text</code> Primary theme color <code>secondary_color</code> <code>text</code> Secondary theme color <code>accent_color</code> <code>text</code> Accent color <code>background_color</code> <code>text</code> Background color <code>surface_color</code> <code>text</code> Surface color <code>font_family</code> <code>text</code> Typography font family <code>custom_css</code> <code>text</code> Custom CSS (max 64KB, sanitized) <p>Primary Key: <code>(org_id, config_key)</code></p>"},{"location":"reference/cassandra-schema/#branding_assets","title":"branding_assets","text":"<p>Binary assets for white-label branding (logos, favicons, PWA icons). Max 2MB per asset.</p> <p>Compaction: LeveledCompactionStrategy</p> Column Type Description <code>org_id</code> <code>text</code> Organization identifier <code>asset_key</code> <code>text</code> Asset identifier (clustering, ASC) <code>data</code> <code>blob</code> Binary asset data <code>content_type</code> <code>text</code> MIME type <code>file_name</code> <code>text</code> Original file name <code>file_size</code> <code>int</code> File size in bytes <code>etag</code> <code>text</code> Cache control ETag <p>Primary Key: <code>(org_id, asset_key)</code></p>"},{"location":"reference/changelog/","title":"Changelog","text":"<p>All notable changes to WitFoo Analytics are documented in this file.</p> <p>The format is based on Keep a Changelog, and this project adheres to Semantic Versioning.</p>"},{"location":"reference/changelog/#unreleased","title":"[Unreleased]","text":""},{"location":"reference/changelog/#added","title":"Added","text":"<ul> <li>Placeholder for upcoming features</li> </ul>"},{"location":"reference/changelog/#changed","title":"Changed","text":"<ul> <li>Placeholder for changes in existing functionality</li> </ul>"},{"location":"reference/changelog/#fixed","title":"Fixed","text":"<ul> <li>Placeholder for bug fixes</li> </ul>"},{"location":"reference/changelog/#091-2026-xx-xx","title":"[0.9.1] - 2026-XX-XX","text":""},{"location":"reference/changelog/#added_1","title":"Added","text":"<ul> <li>Permissions: 93-permission catalog across 18 categories with resource:action naming convention (PR23a)</li> <li>Roles: 8 predefined system roles \u2014 Admin, Analyst, ReadOnly, Report Viewer, Report Admin, CyberGrid Viewer, CyberGrid Admin, Framework Manager</li> <li>Auditor: Configuration audit management with 5 permissions \u2014 read, write, delete, execute, manage (PR145)</li> <li>Platform Administration: 6 cross-tenant management permissions for multi-tenant deployments (PR130b)</li> <li>Branding: White-label branding support with per-org theme configuration and binary asset storage (PR146)</li> <li>Dashboards: Custom dashboard management with 4 permissions \u2014 read, write, delete, manage</li> <li>Playbooks: Playbook workflow management with 4 permissions \u2014 read, write, delete, manage</li> <li>Tasks: Task work item management with 4 permissions \u2014 read, write, delete, manage</li> <li>Responders: Custom Python response job management with 4 permissions \u2014 read, write, delete, manage</li> <li>Incident Naming: Auto-generated memorable incident names using adjective + noun dictionaries (PR11)</li> <li>Incident Assignments: Multi-user assignment support with primary and collaborator roles (PR11)</li> <li>Incident Notes: Collaboration notes with author tracking (PR10)</li> <li>Incident Audit Log: Full audit trail for incident changes with 90-day TTL (PR10)</li> <li>Behavioral Sets: Set definitions synced from Intel meta API for pattern matching (PR136)</li> <li>MO Connection Definitions: Connection patterns for modus operandi matching (PR136)</li> <li>STIX/ATT&amp;CK Integration: STIX indicator and MITRE ATT&amp;CK technique/tactic indexing on artifacts (PR4)</li> <li>SAI Indexes: Comprehensive Storage Attached Indexing for Cassandra 5.0+ across all tables</li> <li>Cache Configuration: Configurable cache sizes and TTLs for nodes, enrichments, facets, search, and permissions</li> <li>pprof Profiling: Per-service pprof endpoints for runtime performance analysis</li> </ul>"},{"location":"reference/changelog/#changed_1","title":"Changed","text":"<ul> <li>Incidents: Migrated to <code>incidents_v2</code> table with monthly time-bucket partitioning for improved query performance (PR5)</li> <li>Lead Rules: Partitioned by <code>rule_category</code> to eliminate <code>ALLOW FILTERING</code> queries (PR5)</li> <li>Artifacts: Added denormalized <code>is_alarm</code> and <code>severity_level</code> columns for SAI-indexed filtering (PR50, PR51)</li> <li>Artifacts: Added <code>ENTRIES()</code> indexes for map entry queries alongside <code>VALUES()</code> indexes (PR101)</li> <li>Graph Nodes: Added <code>node_index</code> map on artifacts for O(1) graph enrichment lookups (Phase 13)</li> </ul>"},{"location":"reference/changelog/#deprecated","title":"Deprecated","text":"<ul> <li><code>ReadOnly</code> role is functionally identical to <code>Analyst</code> and maintained only for backward compatibility</li> </ul>"},{"location":"reference/changelog/#version-history-format","title":"Version History Format","text":"<p>Each release entry follows this structure:</p> <pre><code>## [X.Y.Z] - YYYY-MM-DD\n\n### Added\n- New features\n\n### Changed\n- Changes in existing functionality\n\n### Deprecated\n- Features that will be removed in future versions\n\n### Removed\n- Features removed in this release\n\n### Fixed\n- Bug fixes\n\n### Security\n- Vulnerability fixes\n</code></pre>"},{"location":"reference/changelog/#categories","title":"Categories","text":"Category Description Added New features or capabilities Changed Changes to existing functionality Deprecated Features marked for future removal Removed Features removed in this release Fixed Bug fixes Security Vulnerability patches or security improvements"},{"location":"reference/changelog/#pr-reference-convention","title":"PR Reference Convention","text":"<p>Changes reference their pull request numbers in parentheses (e.g., <code>(PR23a)</code>, <code>(PR145)</code>) for traceability back to the source code.</p>"},{"location":"reference/environment-variables/","title":"Environment Variables Reference","text":"<p>All WitFoo Analytics services are configured through environment variables. This page documents every variable, its default value, and which services use it.</p> <p>Configuration Loading</p> <p>Services load configuration at startup and validate required fields. Invalid configuration causes the service to exit with a descriptive error message. See the source in <code>pkg/config/</code> for the Go loading pattern.</p>"},{"location":"reference/environment-variables/#common-variables","title":"Common Variables","text":"<p>These variables are shared across all services.</p> Name Default Required Description <code>PORT</code> Service-specific Yes HTTP server port <code>LOG_LEVEL</code> <code>INFO</code> No Logging level: <code>DEBUG</code>, <code>INFO</code>, <code>WARN</code>, <code>ERROR</code> <code>ENVIRONMENT</code> <code>development</code> No Runtime environment: <code>development</code>, <code>staging</code>, <code>production</code> <code>LISTEN_IP</code> <code>127.0.0.1</code> No IP address to bind to. Override via <code>.netrc</code> or this variable."},{"location":"reference/environment-variables/#nats-configuration","title":"NATS Configuration","text":"Name Default Required Description <code>NATS_URL</code> <code>nats://localhost:4222</code> Yes NATS server connection URL <code>NATS_MAX_RECONNECTS</code> <code>-1</code> (infinite) No Maximum reconnection attempts before giving up <code>NATS_RECONNECT_WAIT</code> <code>2s</code> No Duration to wait between reconnection attempts"},{"location":"reference/environment-variables/#cassandra-configuration","title":"Cassandra Configuration","text":"Name Default Required Description <code>CASSANDRA_HOSTS</code> <code>localhost</code> Yes Comma-separated list of Cassandra node hostnames or IPs <code>CASSANDRA_PORT</code> <code>9042</code> No CQL native transport port <code>CASSANDRA_KEYSPACE</code> <code>analytics_v2</code> Yes Cassandra keyspace name <code>CASSANDRA_CONSISTENCY</code> <code>LOCAL_QUORUM</code> No Query consistency level <code>CASSANDRA_TIMEOUT</code> <code>10s</code> No Query timeout duration"},{"location":"reference/environment-variables/#authentication","title":"Authentication","text":"Name Default Required Description <code>JWT_SECRET</code> (none) Yes (production) JWT signing key. Must be \u226532 characters in production. <code>CORS_ORIGINS</code> <code>*</code> No Comma-separated list of allowed CORS origins"},{"location":"reference/environment-variables/#service-specific-variables","title":"Service-Specific Variables","text":""},{"location":"reference/environment-variables/#api-service-port-8080","title":"API Service (Port 8080)","text":"Name Default Required Description <code>PORT</code> <code>8080</code> Yes HTTP server port <code>NATS_URL</code> <code>nats://localhost:4222</code> Yes NATS connection URL <code>CASSANDRA_HOSTS</code> <code>localhost</code> Yes Cassandra node addresses <code>CASSANDRA_KEYSPACE</code> <code>analytics_v2</code> Yes Database keyspace <code>JWT_SECRET</code> (none) Yes (production) JWT signing key <code>CORS_ORIGINS</code> <code>*</code> No Allowed CORS origins"},{"location":"reference/environment-variables/#artifact-ingestion-service-port-8081","title":"Artifact Ingestion Service (Port 8081)","text":"Name Default Required Description <code>PORT</code> <code>8081</code> Yes HTTP server port <code>NATS_URL</code> <code>nats://localhost:4222</code> Yes NATS connection URL"},{"location":"reference/environment-variables/#graph-processor-service-port-8082","title":"Graph Processor Service (Port 8082)","text":"Name Default Required Description <code>PORT</code> <code>8082</code> Yes HTTP server port (metrics) <code>NATS_URL</code> <code>nats://localhost:4222</code> Yes NATS connection URL <code>CASSANDRA_HOSTS</code> <code>localhost</code> Yes Cassandra node addresses <code>CASSANDRA_KEYSPACE</code> <code>analytics_v2</code> Yes Database keyspace <code>WORKER_COUNT</code> <code>4</code> No Number of worker goroutines for parallel processing"},{"location":"reference/environment-variables/#dispatcher-service-port-8083","title":"Dispatcher Service (Port 8083)","text":"Name Default Required Description <code>PORT</code> <code>8083</code> Yes HTTP/WebSocket server port <code>NATS_URL</code> <code>nats://localhost:4222</code> Yes NATS connection URL <code>JWT_SECRET</code> (none) Yes (production) JWT signing key for WebSocket auth"},{"location":"reference/environment-variables/#incident-engine-service-port-8084","title":"Incident Engine Service (Port 8084)","text":"Name Default Required Description <code>PORT</code> <code>8084</code> Yes HTTP server port <code>NATS_URL</code> <code>nats://localhost:4222</code> Yes NATS connection URL <code>CASSANDRA_HOSTS</code> <code>localhost</code> Yes Cassandra node addresses <code>CASSANDRA_KEYSPACE</code> <code>analytics_v2</code> Yes Database keyspace <code>RULE_CACHE_TTL</code> <code>5m</code> No Duration to cache lead rules before refresh <code>AGGREGATION_WINDOW</code> <code>5m</code> No Time window for incident aggregation"},{"location":"reference/environment-variables/#reverse-proxy-service-port-8081-443","title":"Reverse Proxy Service (Port 8081 / 443)","text":"Name Default Required Description <code>PORT</code> <code>8081</code> Yes HTTP server port <code>HTTPS_PORT</code> <code>443</code> No HTTPS server port <code>LISTEN_IP</code> <code>127.0.0.1</code> No IP address to bind to <code>API_URL</code> <code>http://api:8080</code> Yes Backend API service URL <code>DISPATCHER_URL</code> <code>http://dispatcher:8083</code> Yes Backend dispatcher service URL <code>INCIDENT_ENGINE_URL</code> <code>http://incident-engine:8084</code> Yes Backend incident engine service URL <code>JWT_SECRET</code> (none) Yes (production) JWT signing key"},{"location":"reference/environment-variables/#performance-and-profiling","title":"Performance and Profiling","text":""},{"location":"reference/environment-variables/#pprof-ports","title":"pprof Ports","text":"<p>Each service exposes a pprof HTTP endpoint for runtime profiling.</p> Name Service Default Description <code>PPROF_PORT</code> api <code>6060</code> pprof HTTP server port <code>PPROF_PORT</code> artifact-ingestion <code>6061</code> pprof HTTP server port <code>PPROF_PORT</code> graph-processor <code>6062</code> pprof HTTP server port <code>PPROF_PORT</code> incident-engine <code>6063</code> pprof HTTP server port <code>PPROF_PORT</code> dispatcher <code>6064</code> pprof HTTP server port"},{"location":"reference/environment-variables/#garbage-collection-tuning","title":"Garbage Collection Tuning","text":"Name Service Default Description <code>GOGC</code> artifact-ingestion <code>200</code> GC target percentage. Higher values reduce GC frequency. <code>GOGC</code> graph-processor <code>200</code> GC target percentage <code>GOGC</code> incident-engine <code>150</code> GC target percentage"},{"location":"reference/environment-variables/#cache-configuration","title":"Cache Configuration","text":"Name Service Default Description <code>CACHE_NODE_MAX_ENTRIES</code> graph-processor <code>50000</code> Maximum entries in the node cache <code>CACHE_NODE_TTL_SECONDS</code> graph-processor <code>300</code> Node cache entry TTL in seconds <code>CACHE_ENRICHMENT_MAX_ENTRIES</code> graph-processor <code>10000</code> Maximum entries in the enrichment cache <code>CACHE_ENRICHMENT_TTL_SECONDS</code> graph-processor <code>3600</code> Enrichment cache entry TTL in seconds <code>CACHE_FACET_MAX_ENTRIES</code> api <code>1000</code> Maximum entries in the facet cache <code>CACHE_FACET_TTL_SECONDS</code> api <code>30</code> Facet cache entry TTL in seconds <code>CACHE_SEARCH_MAX_ENTRIES</code> api <code>100</code> Maximum entries in the search result cache <code>CACHE_SEARCH_TTL_SECONDS</code> api <code>10</code> Search cache entry TTL in seconds <code>CACHE_PERMISSION_MAX_ENTRIES</code> api <code>5000</code> Maximum entries in the permission cache <code>CACHE_PERMISSION_TTL_SECONDS</code> api <code>900</code> Permission cache entry TTL in seconds"},{"location":"reference/environment-variables/#environment-specific-notes","title":"Environment-Specific Notes","text":""},{"location":"reference/environment-variables/#development","title":"Development","text":"<pre><code># .env\nENVIRONMENT=development\nLOG_LEVEL=DEBUG\nJWT_SECRET=dev-secret-not-for-production\nCORS_ORIGINS=*\n</code></pre>"},{"location":"reference/environment-variables/#production","title":"Production","text":"<pre><code># .env\nENVIRONMENT=production\nLOG_LEVEL=INFO\nJWT_SECRET=&lt;strong-secret-from-secrets-manager&gt;\nCORS_ORIGINS=https://app.example.com\nCASSANDRA_HOSTS=cassandra-node1,cassandra-node2,cassandra-node3\n</code></pre> <p>Production Requirements</p> <p>In production (<code>ENVIRONMENT=production</code>), <code>JWT_SECRET</code> is required and must be at least 32 characters. The service will refuse to start if this validation fails.</p>"},{"location":"reference/permissions/","title":"Permissions Reference","text":"<p>WitFoo Analytics uses a fine-grained, resource-based permission system following the <code>resource:action</code> naming convention. The platform defines 93 permissions across 18 categories.</p>"},{"location":"reference/permissions/#inclusion-rules","title":"Inclusion Rules","text":"<p>Permission inheritance reduces the need to assign every individual permission:</p> Rule Behavior Example <code>admin</code> Grants all permissions in the system User with <code>admin</code> can perform any action <code>{resource}:manage</code> Grants all <code>{resource}:*</code> permissions <code>signals:manage</code> grants <code>signals:read</code>, <code>signals:write</code>, <code>signals:delete</code>, <code>signals:export</code> <code>{resource}:write</code> Grants <code>{resource}:read</code> <code>signals:write</code> implicitly grants <code>signals:read</code> <p>Role Assignments</p> <p>Permissions are assigned to users through roles. See the Roles reference for predefined role definitions.</p>"},{"location":"reference/permissions/#signals","title":"Signals","text":"Permission Description Included By <code>signals:read</code> View signals page and search results <code>signals:write</code>, <code>signals:manage</code>, <code>admin</code> <code>signals:write</code> Create and modify signal data <code>signals:manage</code>, <code>admin</code> <code>signals:delete</code> Delete signal records <code>signals:manage</code>, <code>admin</code> <code>signals:export</code> Export signal data to CSV/JSON <code>signals:manage</code>, <code>admin</code> <code>signals:manage</code> All signal operations (includes read, write, delete, export) <code>admin</code>"},{"location":"reference/permissions/#graph-nodes","title":"Graph \u2014 Nodes","text":"Permission Description Included By <code>nodes:read</code> View graph nodes <code>nodes:write</code>, <code>nodes:manage</code>, <code>admin</code> <code>nodes:write</code> Create and modify graph nodes <code>nodes:manage</code>, <code>admin</code> <code>nodes:delete</code> Delete graph nodes <code>nodes:manage</code>, <code>admin</code> <code>nodes:export</code> Export node data <code>nodes:manage</code>, <code>admin</code> <code>nodes:manage</code> All node operations (includes read, write, delete, export) <code>admin</code>"},{"location":"reference/permissions/#graph-edges","title":"Graph \u2014 Edges","text":"Permission Description Included By <code>edges:read</code> View graph edges <code>edges:write</code>, <code>edges:manage</code>, <code>admin</code> <code>edges:write</code> Create and modify graph edges <code>edges:manage</code>, <code>admin</code> <code>edges:delete</code> Delete graph edges <code>edges:manage</code>, <code>admin</code> <code>edges:export</code> Export edge data <code>edges:manage</code>, <code>admin</code> <code>edges:manage</code> All edge operations (includes read, write, delete, export) <code>admin</code>"},{"location":"reference/permissions/#work-units","title":"Work Units","text":"Permission Description Included By <code>work_units:read</code> View work units and incidents <code>work_units:write</code>, <code>work_units:manage</code>, <code>admin</code> <code>work_units:write</code> Modify work unit status and assignments <code>work_units:manage</code>, <code>admin</code> <code>work_units:delete</code> Delete work units <code>work_units:manage</code>, <code>admin</code> <code>work_units:export</code> Export work unit data <code>work_units:manage</code>, <code>admin</code> <code>work_units:manage</code> All work unit operations (includes read, write, delete, export) <code>admin</code>"},{"location":"reference/permissions/#observer","title":"Observer","text":"Permission Description Included By <code>work_definitions:read</code> View MO definitions <code>work_definitions:write</code>, <code>work_definitions:manage</code>, <code>admin</code> <code>work_definitions:write</code> Create and modify MO definitions <code>work_definitions:manage</code>, <code>admin</code> <code>work_definitions:delete</code> Delete MO definitions <code>work_definitions:manage</code>, <code>admin</code> <code>work_definitions:manage</code> All work definition operations <code>admin</code> <code>observations:read</code> View observations <code>observations:write</code>, <code>observations:manage</code>, <code>admin</code> <code>observations:write</code> Create and modify observations <code>observations:manage</code>, <code>admin</code> <code>observations:delete</code> Delete observations <code>observations:manage</code>, <code>admin</code> <code>observations:manage</code> All observation operations <code>admin</code> <code>collections:read</code> View work collections <code>collections:write</code>, <code>admin</code> <code>collections:write</code> Create and modify work collections <code>admin</code>"},{"location":"reference/permissions/#reporter","title":"Reporter","text":"Permission Description Included By <code>reports:read</code> View all reporter dashboards <code>reports:write</code>, <code>admin</code> <code>reports:write</code> Modify report parameters <code>admin</code> <code>reports:generate</code> Generate new reports on demand <code>admin</code> <code>reports:export</code> Export reports to PDF/CSV <code>admin</code> <code>frameworks:read</code> View compliance frameworks <code>frameworks:write</code>, <code>frameworks:manage</code>, <code>admin</code> <code>frameworks:write</code> Modify framework assignments <code>frameworks:manage</code>, <code>admin</code> <code>frameworks:manage</code> Full framework administration <code>admin</code>"},{"location":"reference/permissions/#cybergrid","title":"CyberGrid","text":"Permission Description Included By <code>cybergrid:publications:read</code> View publications <code>cybergrid:manage</code>, <code>admin</code> <code>cybergrid:publications:write</code> Create and modify publications <code>cybergrid:manage</code>, <code>admin</code> <code>cybergrid:subscriptions:read</code> View subscriptions <code>cybergrid:manage</code>, <code>admin</code> <code>cybergrid:subscriptions:write</code> Create and modify subscriptions <code>cybergrid:manage</code>, <code>admin</code> <code>cybergrid:jobs:approve</code> Approve or reject pending jobs <code>cybergrid:manage</code>, <code>admin</code> <code>cybergrid:library:write</code> Submit IOCs to threat intelligence library <code>cybergrid:manage</code>, <code>admin</code> <code>cybergrid:queue:monitor</code> View queue statistics and health <code>cybergrid:manage</code>, <code>admin</code> <code>cybergrid:manage</code> Full CyberGrid administration <code>admin</code>"},{"location":"reference/permissions/#settings","title":"Settings","text":"Permission Description Included By <code>settings:read</code> View business settings <code>settings:write</code>, <code>settings:manage</code>, <code>admin</code> <code>settings:write</code> Modify business settings <code>settings:manage</code>, <code>admin</code> <code>settings:products:read</code> View product catalog and costs <code>settings:products:write</code>, <code>settings:manage</code>, <code>admin</code> <code>settings:products:write</code> Modify product costs <code>settings:manage</code>, <code>admin</code> <code>settings:manage</code> All settings operations <code>admin</code>"},{"location":"reference/permissions/#administration","title":"Administration","text":"Permission Description Included By <code>users:read</code> View user accounts <code>users:write</code>, <code>admin</code> <code>users:write</code> Create and modify user accounts <code>admin</code> <code>roles:read</code> View roles and permissions <code>roles:write</code>, <code>admin</code> <code>roles:write</code> Create and modify roles <code>admin</code> <code>admin</code> Global administrator \u2014 grants all permissions \u2014"},{"location":"reference/permissions/#health-dashboard","title":"Health Dashboard","text":"Permission Description Included By <code>health:read</code> View health dashboards and container status <code>health:manage</code>, <code>admin</code> <code>health:manage</code> Manage health alert configurations <code>admin</code> <code>metrics:read</code> Access Prometheus <code>/metrics</code> endpoint <code>admin</code> <code>metrics:export</code> Export historical metrics data <code>admin</code>"},{"location":"reference/permissions/#ai-assistant","title":"AI Assistant","text":"Permission Description Included By <code>ai:read</code> View AI features and use chat assistant <code>ai:write</code>, <code>ai:manage</code>, <code>admin</code> <code>ai:write</code> Send messages and create chat sessions <code>ai:manage</code>, <code>admin</code> <code>ai:manage</code> Configure AI providers, API keys, and MCP settings <code>admin</code> <code>ai:export</code> Export chat history and conversations <code>admin</code>"},{"location":"reference/permissions/#conductor","title":"Conductor","text":"Permission Description Included By <code>conductor:read</code> View Conductor UI and pipeline status <code>conductor:write</code>, <code>conductor:admin</code>, <code>admin</code> <code>conductor:write</code> Modify pipeline configuration <code>conductor:admin</code>, <code>admin</code> <code>conductor:admin</code> Full Conductor administration <code>admin</code>"},{"location":"reference/permissions/#dashboards","title":"Dashboards","text":"Permission Description Included By <code>dashboards:read</code> View custom dashboards <code>dashboards:write</code>, <code>dashboards:manage</code>, <code>admin</code> <code>dashboards:write</code> Create and modify custom dashboards <code>dashboards:manage</code>, <code>admin</code> <code>dashboards:delete</code> Delete custom dashboards <code>dashboards:manage</code>, <code>admin</code> <code>dashboards:manage</code> All dashboard operations (includes read, write, delete) <code>admin</code>"},{"location":"reference/permissions/#playbooks","title":"Playbooks","text":"Permission Description Included By <code>playbooks:read</code> View playbook definitions and execution history <code>playbooks:write</code>, <code>playbooks:manage</code>, <code>admin</code> <code>playbooks:write</code> Create and modify playbook definitions <code>playbooks:manage</code>, <code>admin</code> <code>playbooks:delete</code> Delete playbook definitions <code>playbooks:manage</code>, <code>admin</code> <code>playbooks:manage</code> All playbook operations (includes read, write, delete, execute) <code>admin</code>"},{"location":"reference/permissions/#tasks","title":"Tasks","text":"Permission Description Included By <code>tasks:read</code> View task work items <code>tasks:write</code>, <code>tasks:manage</code>, <code>admin</code> <code>tasks:write</code> Create and modify task work items <code>tasks:manage</code>, <code>admin</code> <code>tasks:delete</code> Delete task work items <code>tasks:manage</code>, <code>admin</code> <code>tasks:manage</code> All task operations (includes read, write, delete) <code>admin</code>"},{"location":"reference/permissions/#responders","title":"Responders","text":"Permission Description Included By <code>responders:read</code> View responder job definitions and execution history <code>responders:write</code>, <code>responders:manage</code>, <code>admin</code> <code>responders:write</code> Create and modify responder job definitions <code>responders:manage</code>, <code>admin</code> <code>responders:delete</code> Delete responder job definitions <code>responders:manage</code>, <code>admin</code> <code>responders:manage</code> All responder operations (includes read, write, delete, execute) <code>admin</code>"},{"location":"reference/permissions/#platform-administration","title":"Platform Administration","text":"Permission Description Included By <code>platform:read</code> View platform dashboards and tenant listings <code>platform:write</code>, <code>platform:manage</code>, <code>admin</code> <code>platform:write</code> Create and modify tenant configurations <code>platform:manage</code>, <code>admin</code> <code>platform:manage</code> Full platform administration (grants all <code>platform:*</code>) <code>admin</code> <code>platform:conductor:admin</code> Approve and reject Conductor registrations across tenants <code>platform:manage</code>, <code>admin</code> <code>platform:users:admin</code> Manage users across all tenants <code>platform:manage</code>, <code>admin</code> <code>platform:switch</code> Switch active tenant context for cross-tenant operations <code>platform:manage</code>, <code>admin</code>"},{"location":"reference/permissions/#auditor","title":"Auditor","text":"Permission Description Included By <code>auditor:read</code> View audit findings, runs, and check definitions <code>auditor:write</code>, <code>auditor:manage</code>, <code>admin</code> <code>auditor:write</code> Create and modify connector configurations <code>auditor:manage</code>, <code>admin</code> <code>auditor:delete</code> Delete connector configurations <code>auditor:manage</code>, <code>admin</code> <code>auditor:execute</code> Trigger audit runs and test connections <code>auditor:manage</code>, <code>admin</code> <code>auditor:manage</code> All auditor operations (includes read, write, delete, execute) <code>admin</code>"},{"location":"reference/permissions/#summary-by-category","title":"Summary by Category","text":"Category Count Manage Permission Signals 5 <code>signals:manage</code> Graph \u2014 Nodes 5 <code>nodes:manage</code> Graph \u2014 Edges 5 <code>edges:manage</code> Work Units 5 <code>work_units:manage</code> Observer 10 <code>work_definitions:manage</code>, <code>observations:manage</code> Reporter 7 <code>frameworks:manage</code> CyberGrid 8 <code>cybergrid:manage</code> Settings 5 <code>settings:manage</code> Administration 5 <code>admin</code> Health Dashboard 4 <code>health:manage</code> AI Assistant 4 <code>ai:manage</code> Conductor 3 <code>conductor:admin</code> Dashboards 4 <code>dashboards:manage</code> Playbooks 4 <code>playbooks:manage</code> Tasks 4 <code>tasks:manage</code> Responders 4 <code>responders:manage</code> Platform Administration 6 <code>platform:manage</code> Auditor 5 <code>auditor:manage</code> Total 93"},{"location":"reference/roles/","title":"Roles Reference","text":"<p>WitFoo Analytics ships with 8 predefined system roles. System roles cannot be deleted but can be supplemented with custom roles created through the Administration UI.</p> <p>Permission Inclusion Rules</p> <p>Roles benefit from automatic permission inclusion. For example, assigning <code>signals:manage</code> implicitly grants <code>signals:read</code>, <code>signals:write</code>, <code>signals:delete</code>, and <code>signals:export</code>. See Permissions \u2014 Inclusion Rules for details.</p>"},{"location":"reference/roles/#role-summary","title":"Role Summary","text":"Role Role ID Description Permission Count Admin <code>11111111-...-111111111111</code> Full system access \u2014 all permissions 93 (via <code>admin</code>) Analyst <code>22222222-...-222222222222</code> Read-only access to all data 14 ReadOnly <code>33333333-...-333333333333</code> Read-only access (backward compatibility alias) 14 Report Viewer <code>44444444-...-444444444444</code> View and export reports only 3 Report Admin <code>55555555-...-555555555555</code> Full reporter module administration 11 CyberGrid Viewer <code>66666666-...-666666666666</code> View CyberGrid resources only 3 CyberGrid Admin <code>77777777-...-777777777777</code> Full CyberGrid administration 8 Framework Manager <code>88888888-...-888888888888</code> Compliance framework administration 7 <p>All predefined roles have <code>system_role = true</code> and belong to the default <code>witfoo</code> organization.</p>"},{"location":"reference/roles/#admin","title":"Admin","text":"<p>Description: Full system access \u2014 all permissions.</p> <p>The Admin role includes the <code>admin</code> permission, which automatically grants every permission in the system. All 93 permissions are explicitly listed in the role definition for clarity.</p> Category Permissions Administration <code>admin</code>, <code>users:read</code>, <code>users:write</code>, <code>roles:read</code>, <code>roles:write</code> Signals <code>signals:read</code>, <code>signals:write</code>, <code>signals:delete</code>, <code>signals:export</code>, <code>signals:manage</code> Graph \u2014 Nodes <code>nodes:read</code>, <code>nodes:write</code>, <code>nodes:delete</code>, <code>nodes:export</code>, <code>nodes:manage</code> Graph \u2014 Edges <code>edges:read</code>, <code>edges:write</code>, <code>edges:delete</code>, <code>edges:export</code>, <code>edges:manage</code> Work Units <code>work_units:read</code>, <code>work_units:write</code>, <code>work_units:delete</code>, <code>work_units:export</code>, <code>work_units:manage</code> Observer <code>work_definitions:read</code>, <code>work_definitions:write</code>, <code>work_definitions:delete</code>, <code>work_definitions:manage</code>, <code>observations:read</code>, <code>observations:write</code>, <code>observations:delete</code>, <code>observations:manage</code>, <code>collections:read</code>, <code>collections:write</code> Reporter <code>reports:read</code>, <code>reports:write</code>, <code>reports:generate</code>, <code>reports:export</code>, <code>frameworks:read</code>, <code>frameworks:write</code>, <code>frameworks:manage</code> CyberGrid <code>cybergrid:publications:read</code>, <code>cybergrid:publications:write</code>, <code>cybergrid:subscriptions:read</code>, <code>cybergrid:subscriptions:write</code>, <code>cybergrid:jobs:approve</code>, <code>cybergrid:library:write</code>, <code>cybergrid:queue:monitor</code>, <code>cybergrid:manage</code> Settings <code>settings:read</code>, <code>settings:write</code>, <code>settings:products:read</code>, <code>settings:products:write</code>, <code>settings:manage</code> Conductor <code>conductor:read</code>, <code>conductor:write</code>, <code>conductor:admin</code> Health Dashboard <code>health:read</code>, <code>health:manage</code>, <code>metrics:read</code>, <code>metrics:export</code> AI Assistant <code>ai:read</code>, <code>ai:write</code>, <code>ai:manage</code>, <code>ai:export</code> Dashboards <code>dashboards:read</code>, <code>dashboards:write</code>, <code>dashboards:delete</code>, <code>dashboards:manage</code> Playbooks <code>playbooks:read</code>, <code>playbooks:write</code>, <code>playbooks:delete</code>, <code>playbooks:manage</code> Tasks <code>tasks:read</code>, <code>tasks:write</code>, <code>tasks:delete</code>, <code>tasks:manage</code> Responders <code>responders:read</code>, <code>responders:write</code>, <code>responders:delete</code>, <code>responders:manage</code>"},{"location":"reference/roles/#analyst","title":"Analyst","text":"<p>Description: Read-only access to all data. Intended for SOC analysts who need to investigate signals, incidents, and graph data without making modifications.</p> Permission Category <code>signals:read</code> Signals <code>nodes:read</code> Graph \u2014 Nodes <code>edges:read</code> Graph \u2014 Edges <code>work_units:read</code> Work Units <code>work_definitions:read</code> Observer <code>observations:read</code> Observer <code>collections:read</code> Observer <code>reports:read</code> Reporter <code>frameworks:read</code> Reporter <code>cybergrid:publications:read</code> CyberGrid <code>cybergrid:subscriptions:read</code> CyberGrid <code>settings:read</code> Settings <code>users:read</code> Administration <code>roles:read</code> Administration"},{"location":"reference/roles/#readonly","title":"ReadOnly","text":"<p>Description: Read-only access to all data. Functionally identical to the Analyst role; maintained for backward compatibility.</p> Permission Category <code>signals:read</code> Signals <code>nodes:read</code> Graph \u2014 Nodes <code>edges:read</code> Graph \u2014 Edges <code>work_units:read</code> Work Units <code>work_definitions:read</code> Observer <code>observations:read</code> Observer <code>collections:read</code> Observer <code>reports:read</code> Reporter <code>frameworks:read</code> Reporter <code>cybergrid:publications:read</code> CyberGrid <code>cybergrid:subscriptions:read</code> CyberGrid <code>settings:read</code> Settings <code>users:read</code> Administration <code>roles:read</code> Administration"},{"location":"reference/roles/#report-viewer","title":"Report Viewer","text":"<p>Description: View and export reports only. Suitable for stakeholders who need access to compliance and operational reports without broader platform access.</p> Permission Category <code>reports:read</code> Reporter <code>reports:export</code> Reporter <code>frameworks:read</code> Reporter"},{"location":"reference/roles/#report-admin","title":"Report Admin","text":"<p>Description: Full reporter module administration. Includes report generation, framework management, and product catalog access for cost-based reporting.</p> Permission Category <code>reports:read</code> Reporter <code>reports:write</code> Reporter <code>reports:generate</code> Reporter <code>reports:export</code> Reporter <code>frameworks:read</code> Reporter <code>frameworks:write</code> Reporter <code>frameworks:manage</code> Reporter <code>settings:read</code> Settings <code>settings:write</code> Settings <code>settings:products:read</code> Settings <code>settings:products:write</code> Settings"},{"location":"reference/roles/#cybergrid-viewer","title":"CyberGrid Viewer","text":"<p>Description: View CyberGrid resources only. Provides read-only access to threat intelligence publications, subscriptions, and queue health.</p> Permission Category <code>cybergrid:publications:read</code> CyberGrid <code>cybergrid:subscriptions:read</code> CyberGrid <code>cybergrid:queue:monitor</code> CyberGrid"},{"location":"reference/roles/#cybergrid-admin","title":"CyberGrid Admin","text":"<p>Description: Full CyberGrid administration. Includes the <code>cybergrid:manage</code> permission, which grants all CyberGrid operations.</p> Permission Category <code>cybergrid:manage</code> CyberGrid <code>cybergrid:publications:read</code> CyberGrid <code>cybergrid:publications:write</code> CyberGrid <code>cybergrid:subscriptions:read</code> CyberGrid <code>cybergrid:subscriptions:write</code> CyberGrid <code>cybergrid:jobs:approve</code> CyberGrid <code>cybergrid:library:write</code> CyberGrid <code>cybergrid:queue:monitor</code> CyberGrid"},{"location":"reference/roles/#framework-manager","title":"Framework Manager","text":"<p>Description: Compliance framework administration. Provides full control over framework definitions and report generation for compliance workflows.</p> Permission Category <code>frameworks:read</code> Reporter <code>frameworks:write</code> Reporter <code>frameworks:manage</code> Reporter <code>reports:read</code> Reporter <code>reports:write</code> Reporter <code>reports:generate</code> Reporter <code>reports:export</code> Reporter"},{"location":"reference/roles/#custom-roles","title":"Custom Roles","text":"<p>Administrators can create custom roles through the Administration &gt; Roles page or via the API. Custom roles:</p> <ul> <li>Can combine any of the 93 available permissions</li> <li>Are scoped to a single organization (<code>org_id</code>)</li> <li>Have <code>system_role = false</code></li> <li>Can be modified or deleted at any time</li> </ul> <p>API Reference</p> <p>Custom roles are managed through the <code>/api/v2/roles</code> endpoint. Users must have <code>roles:write</code> permission to create or modify roles.</p>"},{"location":"user-guide/","title":"WitFoo Analytics User Guide","text":"<p>WitFoo Analytics is an enterprise security operations platform that unifies signal ingestion, incident management, threat intelligence, compliance reporting, and infrastructure health monitoring into a single interface.</p> <p>This guide covers the core modules available to security analysts, SOC operators, and security leadership.</p>"},{"location":"user-guide/#platform-modules","title":"Platform Modules","text":""},{"location":"user-guide/#signals","title":"Signals","text":"<p>Signals are the raw security data flowing into WitFoo Analytics from your connected tools \u2014 IDS alerts, authentication logs, firewall events, DNS queries, and more. The Signals module provides search, filtering, lead rule configuration, classification rules, and enrichment settings.</p> <p>Navigate to: Signals in the left sidebar</p> <ul> <li>Signals Overview</li> <li>Search \u2014 Query syntax, filters, and saved searches</li> <li>Lead Rules \u2014 Automated signal promotion to incidents</li> <li>Classification Rules \u2014 Framework-based signal categorization</li> <li>Enrichment Settings \u2014 GeoIP, threat intel, and metadata enrichment</li> </ul>"},{"location":"user-guide/#graph","title":"Graph","text":"<p>The Graph module visualizes relationships between security entities \u2014 IP addresses, domains, users, hosts, and file hashes \u2014 as an interactive node-and-edge network.</p> <p>Navigate to: Graph in the left sidebar</p> <ul> <li>Graph Overview</li> <li>Nodes \u2014 Node types, properties, and classification</li> <li>Edges \u2014 Relationship types and filtering</li> </ul>"},{"location":"user-guide/#observer","title":"Observer","text":"<p>Observer is the incident management workspace where analysts triage, investigate, and resolve security incidents. It organizes work into units, collections, MO definitions, and observations.</p> <p>Navigate to: Observer in the left sidebar</p> <ul> <li>Observer Overview</li> <li>Work Units \u2014 Individual incident management</li> <li>Work Collections \u2014 Grouped incident campaigns</li> <li>MO Definitions \u2014 Modus operandi configuration</li> <li>Observations \u2014 Behavioral tracking and annotation</li> </ul>"},{"location":"user-guide/#reporter","title":"Reporter","text":"<p>Reporter generates executive dashboards, compliance readiness assessments, tool effectiveness analysis, and cost/savings projections for security leadership.</p> <p>Navigate to: Reporter in the left sidebar</p> <ul> <li>Reporter Overview</li> <li>Executive Summary \u2014 High-level security posture dashboard</li> <li>Compliance Readiness \u2014 Framework selector and compliance scoring</li> <li>Tool Effectiveness \u2014 Sankey diagrams, Venn analysis, tool metrics</li> <li>Cost &amp; Savings \u2014 FTE calculations, P&amp;L, and savings analysis</li> </ul>"},{"location":"user-guide/#cybergrid","title":"CyberGrid","text":"<p>CyberGrid is the distributed threat intelligence sharing platform. Share IOCs anonymously, subscribe to partner feeds, and manage intelligence jobs.</p> <p>Navigate to: CyberGrid in the left sidebar</p> <ul> <li>CyberGrid Overview</li> <li>Subscriptions \u2014 Subscribe to external intel feeds</li> <li>Publications \u2014 Publish intel to partners</li> <li>Jobs \u2014 Background job management and approval</li> <li>Library \u2014 Anonymous IOC search and submission</li> </ul>"},{"location":"user-guide/#health","title":"Health","text":"<p>The Health module monitors the operational status of WitFoo Analytics platform containers and services, with configurable alerting.</p> <p>Navigate to: Health in the left sidebar</p> <ul> <li>Health Overview</li> <li>Containers \u2014 Container status and resource monitoring</li> <li>Alerts \u2014 Health alert configuration and notification</li> </ul>"},{"location":"user-guide/#quick-navigation","title":"Quick Navigation","text":"Task Module Page Search for a suspicious IP Signals Search Triage a new incident Observer Work Units Check compliance posture Reporter Compliance Look up an IOC CyberGrid Library View system health Health Containers Investigate entity relationships Graph Nodes <p>Permissions</p> <p>Access to each module depends on your assigned role. Contact your administrator if you cannot access a module listed here. WitFoo Analytics uses role-based access control with 8 built-in roles across 16 permission categories.</p>"},{"location":"user-guide/cybergrid/","title":"CyberGrid","text":"<p>CyberGrid is WitFoo Analytics' threat intelligence sharing platform. Subscribe to curated feeds, publish indicators, and enrich security data with community intelligence.</p>"},{"location":"user-guide/cybergrid/#components","title":"Components","text":""},{"location":"user-guide/cybergrid/#subscriptions","title":"Subscriptions","text":"<p>Subscribe to threat intelligence feeds. Indicators are automatically used for artifact enrichment.</p>"},{"location":"user-guide/cybergrid/#publications","title":"Publications","text":"<p>Share your organization's threat indicators with the CyberGrid community.</p>"},{"location":"user-guide/cybergrid/#jobs","title":"Jobs","text":"<p>Monitor synchronization jobs for feed downloads, processing, and uploads.</p>"},{"location":"user-guide/cybergrid/#library","title":"Library","text":"<p>Browse available feeds and manage your intelligence library.</p>"},{"location":"user-guide/cybergrid/#how-cybergrid-works","title":"How CyberGrid Works","text":"<pre><code>graph LR\n    P[Publishers] --&gt; CG[CyberGrid Hub]\n    CG --&gt; S[Subscribers]\n    S --&gt; E[Enrichment Engine]\n    E --&gt; N[Node Scoring]</code></pre>"},{"location":"user-guide/cybergrid/#permissions","title":"Permissions","text":"Action Required Permission View CyberGrid <code>cybergrid:read</code> Manage subscriptions <code>cybergrid:write</code> Publish indicators <code>cybergrid:manage</code>"},{"location":"user-guide/cybergrid/jobs/","title":"Jobs","text":"<p>Background synchronization jobs for threat intelligence feeds.</p>"},{"location":"user-guide/cybergrid/jobs/#job-types","title":"Job Types","text":"Type Direction Description Sync Inbound Download from subscribed feed Publish Outbound Upload to a publication Enrich Internal Apply indicators to nodes"},{"location":"user-guide/cybergrid/jobs/#job-properties","title":"Job Properties","text":"Column Description Job ID Unique identifier Type Sync, Publish, or Enrich Status Pending, Running, Complete, Failed Started Start timestamp Duration Execution time Indicators Indicators processed <p>Failed jobs are automatically retried. Click Run Now on any subscription for immediate sync.</p>"},{"location":"user-guide/cybergrid/jobs/#job-history","title":"Job History","text":"<p>Retained for 30 days with automatic cleanup.</p>"},{"location":"user-guide/cybergrid/library/","title":"Library","text":"<p>Browse and manage threat intelligence content.</p>"},{"location":"user-guide/cybergrid/library/#browsing","title":"Browsing","text":"<ul> <li>Active feeds \u2014 Currently subscribed feeds</li> <li>Available feeds \u2014 Public feeds for subscription</li> <li>Local collections \u2014 Locally imported indicators</li> </ul>"},{"location":"user-guide/cybergrid/library/#feed-details","title":"Feed Details","text":"<p>View publisher, description, indicator types/count, update frequency, and confidence range.</p>"},{"location":"user-guide/cybergrid/library/#indicator-search","title":"Indicator Search","text":"<p>Search by value (IP, domain, hash), type, source, confidence threshold, or date range.</p>"},{"location":"user-guide/cybergrid/library/#local-collections","title":"Local Collections","text":"<p>Create local collections for internally-sourced intelligence. Import from CSV or add manually.</p>"},{"location":"user-guide/cybergrid/library/#intel-api-integration","title":"Intel API Integration","text":"<p>CyberGrid syncs with intel.witfoo.com when <code>WF_LICENSE</code> is configured. Without a license key, operates with local data only.</p>"},{"location":"user-guide/cybergrid/publications/","title":"Publications","text":"<p>Share threat indicators with the CyberGrid community.</p>"},{"location":"user-guide/cybergrid/publications/#creating-a-publication","title":"Creating a Publication","text":"<ol> <li>Navigate to CyberGrid &gt; Publications</li> <li>Click Create Publication</li> <li>Configure name, description, visibility (Public/Private), and indicator sources</li> </ol>"},{"location":"user-guide/cybergrid/publications/#publication-properties","title":"Publication Properties","text":"Field Description Name Publication title Status Active, Paused, or Draft Indicator count Published indicators Subscribers Organizations subscribed Visibility Public or Private"},{"location":"user-guide/cybergrid/publications/#what-gets-published","title":"What Gets Published","text":"<ul> <li>Indicators from confirmed (true-positive) incidents</li> <li>Nodes flagged as malicious during investigation</li> <li>Manually added indicators</li> </ul> <p>Review Before Publishing</p> <p>Published indicators are shared externally. Do not include internal IPs or legitimate domains.</p>"},{"location":"user-guide/cybergrid/subscriptions/","title":"Subscriptions","text":"<p>Connect to external threat intelligence feeds via CyberGrid.</p>"},{"location":"user-guide/cybergrid/subscriptions/#managing-subscriptions","title":"Managing Subscriptions","text":"<ol> <li>Navigate to CyberGrid &gt; Subscriptions</li> <li>Browse available feeds</li> <li>Click Subscribe and configure sync schedule</li> <li>Set confidence thresholds (optional)</li> </ol>"},{"location":"user-guide/cybergrid/subscriptions/#subscription-properties","title":"Subscription Properties","text":"Field Description Feed name Intelligence feed name Publisher Organization providing the feed Status Active, Paused, or Error Last sync Most recent successful sync Indicator count Indicators from this feed Sync schedule Update frequency"},{"location":"user-guide/cybergrid/subscriptions/#indicator-types","title":"Indicator Types","text":"<p>Feeds can include IPs, domains, file hashes, URLs, and email addresses.</p>"},{"location":"user-guide/cybergrid/subscriptions/#enrichment-integration","title":"Enrichment Integration","text":"<p>Matched indicators update node threat scores, affecting incident severity and compliance calculations.</p>"},{"location":"user-guide/graph/","title":"Graph","text":"<p>The Graph module visualizes relationships between security entities as an interactive network diagram. Nodes represent entities (IP addresses, domains, users, hosts, file hashes) and edges represent observed relationships between them.</p> <p>Navigate to: Graph in the left sidebar</p>"},{"location":"user-guide/graph/#purpose","title":"Purpose","text":"<p>The Graph module helps analysts:</p> <ul> <li>Visualize attack paths \u2014 See how an attacker moved through your network</li> <li>Identify clusters \u2014 Find groups of related entities involved in an incident</li> <li>Discover relationships \u2014 Uncover connections between seemingly unrelated events</li> <li>Assess asset classification \u2014 View which entities are managed, internal, trusted, or infrastructure</li> </ul>"},{"location":"user-guide/graph/#graph-architecture","title":"Graph Architecture","text":"<pre><code>flowchart TD\n    A[Signals] --&gt;|Extract Entities| B[Graph Processor]\n    B --&gt;|Create/Update| C[Nodes]\n    B --&gt;|Create/Update| D[Edges]\n    C --&gt; E[Interactive Visualization]\n    D --&gt; E\n    E --&gt; F[Node Detail]\n    E --&gt; G[Edge Detail]</code></pre> <p>The graph is built automatically as signals are ingested. The graph processor extracts entities from signals and creates nodes and edges representing the relationships observed in your security data.</p>"},{"location":"user-guide/graph/#module-pages","title":"Module Pages","text":""},{"location":"user-guide/graph/#nodes","title":"Nodes","text":"<p>Browse, search, and inspect all graph nodes. Each node represents a unique security entity with properties, classifications, and framework tags.</p> <p>Navigate to: Graph \u2192 Nodes</p> <p>Nodes documentation \u2192</p>"},{"location":"user-guide/graph/#edges","title":"Edges","text":"<p>Browse and filter relationships between nodes. Each edge represents an observed connection between two entities, with metadata about the type and frequency of the relationship.</p> <p>Navigate to: Graph \u2192 Edges</p> <p>Edges documentation \u2192</p>"},{"location":"user-guide/graph/#interactive-visualization","title":"Interactive Visualization","text":"<p>The graph visualization uses an interactive canvas powered by Cytoscape.js. You can:</p> <ul> <li>Pan \u2014 Click and drag the background to move the viewport</li> <li>Zoom \u2014 Scroll to zoom in and out</li> <li>Select nodes \u2014 Click a node to view its properties</li> <li>Select edges \u2014 Click an edge to view relationship details</li> <li>Multi-select \u2014 Hold <code>Shift</code> and click to select multiple elements</li> <li>Drag nodes \u2014 Click and drag a node to reposition it</li> </ul> <p>Large Graphs</p> <p>For graphs with many nodes, use the filter controls to narrow the visible set before exploring. Rendering thousands of nodes simultaneously can impact browser performance.</p>"},{"location":"user-guide/graph/#node-visual-indicators","title":"Node Visual Indicators","text":"<p>Nodes are rendered with visual cues that convey classification and status:</p> Visual Meaning Color Node type (IP = blue, domain = green, user = orange, host = purple, hash = red) Border Classification status (solid = classified, dashed = unclassified) Size Relative activity level (more signals = larger node) Icon Node type icon overlay"},{"location":"user-guide/graph/#graph-and-other-modules","title":"Graph and Other Modules","text":"<p>The Graph module connects to other parts of WitFoo Analytics:</p> <ul> <li>Signals \u2192 Graph: Click an entity in signal search results to view it in the graph</li> <li>Observer \u2192 Graph: Work unit detail pages link to related graph nodes</li> <li>Graph \u2192 Observer: Node detail pages show associated work units</li> <li>Graph \u2192 Reporter: Node classifications feed into compliance readiness scores</li> </ul> <p>Graph Processing Cycle</p> <p>The graph is updated periodically by the graph processor background service. New signals may take a few minutes to appear as nodes and edges in the graph.</p>"},{"location":"user-guide/graph/edges/","title":"Graph Edges","text":"<p>Graph edges represent observed relationships between nodes. Each edge connects two entities and carries metadata about the type, frequency, and timing of the relationship.</p> <p>Navigate to: Graph \u2192 Edges</p>"},{"location":"user-guide/graph/edges/#edge-types","title":"Edge Types","text":"<p>Edges are created automatically when signals reference multiple entities. The edge type is determined by the relationship observed in the signal data.</p> Edge Type Description Example communicated_with Network communication between two IPs <code>10.0.0.5 \u2192 203.0.113.50</code> resolved_to DNS resolution from domain to IP <code>evil.xyz \u2192 198.51.100.1</code> authenticated_as User authentication from a host <code>workstation01 \u2192 jsmith</code> accessed Entity accessed a resource <code>jsmith \u2192 fileserver01</code> contains Parent-child relationship <code>subnet-10.0.0.0 \u2192 10.0.0.5</code> associated_with General association <code>hash-abc123 \u2192 evil.xyz</code> triggered Alert triggered by entity <code>10.0.0.5 \u2192 IDS Alert #1234</code>"},{"location":"user-guide/graph/edges/#edge-properties","title":"Edge Properties","text":"<p>Click any edge to view its properties:</p> Property Description Source Node The originating entity Target Node The destination entity Edge Type The relationship type Signal Count Number of signals that established this relationship First Seen Timestamp of first observation Last Seen Timestamp of most recent observation Stream Names Data sources that reported this relationship"},{"location":"user-guide/graph/edges/#browsing-edges","title":"Browsing Edges","text":"<p>The Edges page displays a searchable, filterable table of all graph edges.</p>"},{"location":"user-guide/graph/edges/#searching","title":"Searching","text":"<p>Use the search bar to find edges by source or target node value:</p> <pre><code>192.168.1.100\n</code></pre> <p>This returns all edges where <code>192.168.1.100</code> is either the source or target.</p>"},{"location":"user-guide/graph/edges/#filtering","title":"Filtering","text":"<p>Filter edges using the controls above the table:</p> <ul> <li>Edge Type \u2014 Select one or more relationship types</li> <li>Source Node Type \u2014 Filter by source entity type (IP, domain, user, etc.)</li> <li>Target Node Type \u2014 Filter by target entity type</li> <li>Time Range \u2014 Filter by first/last seen timestamps</li> <li>Stream Name \u2014 Filter by originating data source</li> </ul>"},{"location":"user-guide/graph/edges/#sorting","title":"Sorting","text":"<p>Click column headers to sort by:</p> <ul> <li>Source or target node value</li> <li>Edge type</li> <li>Signal count (frequency)</li> <li>First Seen / Last Seen</li> </ul>"},{"location":"user-guide/graph/edges/#understanding-edge-direction","title":"Understanding Edge Direction","text":"<p>Edges are directional \u2014 they flow from source to target. The direction reflects the relationship observed in the signal data:</p> <pre><code>flowchart LR\n    A[10.0.0.5] --&gt;|communicated_with| B[203.0.113.50]\n    C[evil.xyz] --&gt;|resolved_to| D[198.51.100.1]\n    E[workstation01] --&gt;|authenticated_as| F[jsmith]</code></pre> <p>Bidirectional Communication</p> <p>Network communication between two IPs may create two edges (one in each direction) if signals report traffic in both directions.</p>"},{"location":"user-guide/graph/edges/#filtering-by-frequency","title":"Filtering by Frequency","text":"<p>High-frequency edges often indicate:</p> <ul> <li>Normal traffic patterns \u2014 Frequent communication with DNS servers, domain controllers</li> <li>Scanning activity \u2014 Many edges from a single source to multiple targets</li> <li>Data exfiltration \u2014 High signal count on edges to external IPs</li> </ul> <p>To find high-frequency edges:</p> <ol> <li>Sort the edges table by Signal Count (descending)</li> <li>Review the top results for anomalous patterns</li> <li>Click an edge to investigate the underlying signals</li> </ol>"},{"location":"user-guide/graph/edges/#common-analysis-patterns","title":"Common Analysis Patterns","text":""},{"location":"user-guide/graph/edges/#identify-lateral-movement","title":"Identify Lateral Movement","text":"<ol> <li>Filter edges by type: communicated_with</li> <li>Filter source node type: IP Address</li> <li>Filter target node type: IP Address</li> <li>Filter to internal IP ranges</li> <li>Look for unusual internal-to-internal communication patterns</li> </ol>"},{"location":"user-guide/graph/edges/#map-dns-resolution-chains","title":"Map DNS Resolution Chains","text":"<ol> <li>Filter edges by type: resolved_to</li> <li>Search for a suspicious domain</li> <li>Follow the resolution chain: domain \u2192 IP \u2192 other domains on the same IP</li> </ol>"},{"location":"user-guide/graph/edges/#trace-user-activity","title":"Trace User Activity","text":"<ol> <li>Filter edges by type: authenticated_as or accessed</li> <li>Search for a specific username</li> <li>Review all hosts and resources the user interacted with</li> </ol>"},{"location":"user-guide/graph/edges/#find-communication-with-external-entities","title":"Find Communication with External Entities","text":"<ol> <li>Filter edges by type: communicated_with</li> <li>Exclude internal IP ranges from the target node filter</li> <li>Sort by signal count to find the most active external connections</li> </ol>"},{"location":"user-guide/graph/edges/#edge-detail-view","title":"Edge Detail View","text":"<p>Click an edge row to open its detail view:</p> <ol> <li>Properties panel \u2014 Source, target, type, timestamps, signal count</li> <li>Signal list \u2014 All signals that contributed to this edge</li> <li>Source node link \u2014 Navigate to the source node detail page</li> <li>Target node link \u2014 Navigate to the target node detail page</li> </ol> <p>Pivot Between Nodes and Edges</p> <p>Use the node and edge detail pages to pivot between entities. Click a connected node to view its properties, then explore its other edges to trace activity paths.</p>"},{"location":"user-guide/graph/edges/#exporting-edge-data","title":"Exporting Edge Data","text":"<p>Click the Export CSV button to download the current filtered edge list. The export includes source node, target node, edge type, signal count, and timestamps.</p>"},{"location":"user-guide/graph/nodes/","title":"Graph Nodes","text":"<p>Graph nodes represent unique security entities observed in your environment. Each node is a distinct IP address, domain, user, host, file hash, or other entity extracted from ingested signals.</p> <p>Navigate to: Graph \u2192 Nodes</p>"},{"location":"user-guide/graph/nodes/#node-types","title":"Node Types","text":"Type Icon Description Example IP Address Network icon IPv4 or IPv6 address <code>192.168.1.100</code>, <code>2001:db8::1</code> Domain Globe icon DNS domain name <code>example.com</code>, <code>evil.xyz</code> Hostname Server icon System hostname <code>web-server-01</code>, <code>dc01.corp.local</code> User Person icon User account <code>jsmith</code>, <code>admin@corp.local</code> File Hash Document icon MD5, SHA1, or SHA256 hash <code>a1b2c3d4...</code> Email Mail icon Email address <code>user@example.com</code> URL Link icon Full URL <code>https://evil.xyz/payload</code> Process Gear icon Process name <code>powershell.exe</code>, <code>curl</code>"},{"location":"user-guide/graph/nodes/#node-properties","title":"Node Properties","text":"<p>Click any node to view its properties panel. Every node includes:</p>"},{"location":"user-guide/graph/nodes/#core-properties","title":"Core Properties","text":"Property Description Node ID Unique identifier Type Entity type (IP, domain, user, etc.) Value The entity value First Seen Timestamp of first observation Last Seen Timestamp of most recent observation Signal Count Number of signals referencing this entity"},{"location":"user-guide/graph/nodes/#classification-properties","title":"Classification Properties","text":"Property Description Managed Whether the entity is under organizational control Internal Whether the entity is within the network perimeter Trusted Whether the entity is known-good Infrastructure Whether the entity is network/security infrastructure Frameworks Applied compliance framework tags"},{"location":"user-guide/graph/nodes/#enrichment-properties","title":"Enrichment Properties","text":"Property Description GeoIP Country, city, ASN, organization (IP nodes only) Threat Intel Threat category, confidence, source ATT&amp;CK Techniques Associated MITRE ATT&amp;CK technique IDs DNS Resolved hostname or IP address"},{"location":"user-guide/graph/nodes/#browsing-nodes","title":"Browsing Nodes","text":"<p>The Nodes page displays a searchable, filterable table of all graph nodes.</p>"},{"location":"user-guide/graph/nodes/#searching","title":"Searching","text":"<p>Use the search bar to find nodes by value:</p> <pre><code>192.168.1.100\n</code></pre> <pre><code>evil.xyz\n</code></pre>"},{"location":"user-guide/graph/nodes/#filtering","title":"Filtering","text":"<p>Filter nodes using the controls above the table:</p> <ul> <li>Node Type \u2014 Select one or more entity types</li> <li>Classification \u2014 Filter by managed, internal, trusted, infrastructure</li> <li>Framework \u2014 Filter by applied framework tags</li> <li>Time Range \u2014 Filter by first/last seen timestamps</li> </ul>"},{"location":"user-guide/graph/nodes/#sorting","title":"Sorting","text":"<p>Click column headers to sort by:</p> <ul> <li>Value (alphabetical)</li> <li>Type</li> <li>First Seen / Last Seen</li> <li>Signal Count</li> </ul>"},{"location":"user-guide/graph/nodes/#node-classification","title":"Node Classification","text":"<p>Nodes are classified by Classification Rules configured in the Signals module. Classifications determine how nodes appear in the graph and how they contribute to compliance reporting.</p>"},{"location":"user-guide/graph/nodes/#viewing-classification-status","title":"Viewing Classification Status","text":"<p>The Classification column in the nodes table shows applied classifications as colored tags:</p> Tag Color Classification Blue Managed Green Internal Teal Trusted Purple Infrastructure Gray Unclassified"},{"location":"user-guide/graph/nodes/#unclassified-nodes","title":"Unclassified Nodes","text":"<p>Nodes without any classification appear with a gray \"Unclassified\" tag. To improve your security posture visibility:</p> <ol> <li>Filter the nodes table to show only unclassified nodes</li> <li>Review the entity values to determine appropriate classifications</li> <li>Create or update Classification Rules to cover these entities</li> </ol> <p>Prioritize Unclassified Internal IPs</p> <p>Start by classifying nodes in your internal IP ranges. Unclassified internal assets represent blind spots in your compliance posture.</p>"},{"location":"user-guide/graph/nodes/#node-detail-page","title":"Node Detail Page","text":"<p>Click a node row to open its detail page, which shows:</p> <ol> <li>Properties panel \u2014 All core, classification, and enrichment properties</li> <li>Connected edges \u2014 All relationships to other nodes</li> <li>Signal timeline \u2014 Chronological list of signals referencing this entity</li> <li>Related work units \u2014 Observer incidents involving this entity</li> <li>ATT&amp;CK techniques \u2014 Mapped MITRE ATT&amp;CK techniques</li> </ol>"},{"location":"user-guide/graph/nodes/#common-tasks","title":"Common Tasks","text":""},{"location":"user-guide/graph/nodes/#investigate-a-suspicious-ip","title":"Investigate a Suspicious IP","text":"<ol> <li>Navigate to Graph \u2192 Nodes</li> <li>Search for the IP address</li> <li>Click the node to view its detail page</li> <li>Check Threat Intel properties for known-bad indicators</li> <li>Review Connected Edges to see what the IP communicated with</li> <li>Check Related Work Units for existing incidents</li> </ol>"},{"location":"user-guide/graph/nodes/#find-all-unmanaged-assets","title":"Find All Unmanaged Assets","text":"<ol> <li>Navigate to Graph \u2192 Nodes</li> <li>Set the Classification filter to exclude \"Managed\"</li> <li>Set the Node Type filter to \"IP Address\" or \"Hostname\"</li> <li>Review the results to identify assets that should be classified</li> </ol>"},{"location":"user-guide/graph/nodes/#export-node-data","title":"Export Node Data","text":"<p>Click the Export CSV button to download the current filtered node list as a CSV file for offline analysis or reporting.</p>"},{"location":"user-guide/health/","title":"Health","text":"<p>Real-time monitoring of your WitFoo Analytics deployment.</p>"},{"location":"user-guide/health/#components","title":"Components","text":""},{"location":"user-guide/health/#containers","title":"Containers","text":"<p>Real-time and historical metrics for all Docker containers. Auto-refreshes every 15 seconds.</p>"},{"location":"user-guide/health/#alerts","title":"Alerts","text":"<p>Configurable alert rules for container metrics and service availability.</p>"},{"location":"user-guide/health/#dashboard-overview","title":"Dashboard Overview","text":"<ul> <li>Service status cards \u2014 Clickable tiles showing container state with CPU/memory gauges</li> <li>KPI tiles \u2014 Total containers, healthy count, average CPU/memory</li> <li>Historical charts \u2014 Time-series resource usage (limited to 100 data points)</li> </ul>"},{"location":"user-guide/health/#container-states","title":"Container States","text":"State Color Running Green Unhealthy Yellow Stopped Red Restarting Orange"},{"location":"user-guide/health/#auto-refresh","title":"Auto-Refresh","text":"<p>Updates every 15 seconds via silent background requests.</p>"},{"location":"user-guide/health/#permissions","title":"Permissions","text":"Action Required Permission View health data <code>health:read</code> Configure alerts <code>health:manage</code> View metrics <code>metrics:read</code>"},{"location":"user-guide/health/alerts/","title":"Alerts","text":"<p>Configurable notifications when container metrics exceed thresholds.</p>"},{"location":"user-guide/health/alerts/#alert-types","title":"Alert Types","text":"Type Triggers On CPU CPU exceeds threshold for duration Memory Memory exceeds threshold Disk Disk exceeds threshold Container State Container stops/unhealthy/restarting Restart Count Restarts exceed N in window"},{"location":"user-guide/health/alerts/#creating-alert-rules","title":"Creating Alert Rules","text":"<ol> <li>Navigate to Health &gt; Alerts</li> <li>Click Create Alert</li> <li>Select type, container, threshold, duration, severity</li> <li>Choose notification channels</li> <li>Click Save</li> </ol> <p>The form adapts based on alert type \u2014 CPU/Memory/Disk show threshold/duration; Container State shows state selector; Restart Count shows count/window fields.</p>"},{"location":"user-guide/health/alerts/#cooldown","title":"Cooldown","text":"<p>Default 15-minute cooldown per alert type + severity + container combination. Prevents notification spam during sustained issues.</p>"},{"location":"user-guide/health/alerts/#notification-channels","title":"Notification Channels","text":"Channel Format Email HTML with severity-colored header Slack Block Kit structured message Webhook JSON payload <p>Configure channels in Admin &gt; Settings &gt; Notifications.</p>"},{"location":"user-guide/health/alerts/#alert-history","title":"Alert History","text":"<p>Retained for 30 days with timestamp, type, severity, container, metric value, and notification status.</p>"},{"location":"user-guide/health/containers/","title":"Containers","text":"<p>Detailed metrics for every Docker container in your deployment.</p>"},{"location":"user-guide/health/containers/#container-list","title":"Container List","text":"<p>Each container displays as a clickable card with name, state, health, CPU %, memory, and uptime.</p>"},{"location":"user-guide/health/containers/#color-coded-metrics","title":"Color-Coded Metrics","text":"Threshold Color &lt; 70% Normal 70-90% Yellow &gt; 90% Red"},{"location":"user-guide/health/containers/#container-detail","title":"Container Detail","text":""},{"location":"user-guide/health/containers/#current-metrics","title":"Current Metrics","text":"Metric Source CPU % <code>(cpuDelta / systemDelta) * numCPUs * 100</code> Memory RSS from Docker stats Network I/O Bytes received/transmitted Disk I/O Bytes read/written PIDs Process count"},{"location":"user-guide/health/containers/#historical-charts","title":"Historical Charts","text":"<p>Time-series bar charts stored in Cassandra using TimeUUID ordering.</p>"},{"location":"user-guide/health/containers/#core-services","title":"Core Services","text":"Container Service <code>witfoo-analytics-cassandra</code> Cassandra database <code>witfoo-analytics-nats</code> NATS message broker <code>witfoo-analytics-incident-engine</code> Core business logic <code>witfoo-analytics-api</code> API gateway <code>witfoo-analytics-ui</code> SvelteKit frontend <code>witfoo-analytics-artifact-ingestion</code> Artifact receiver <code>witfoo-analytics-graph-processor</code> Graph builder <code>witfoo-analytics-dispatcher</code> Event dispatcher <code>witfoo-analytics-reverse-proxy</code> Request router"},{"location":"user-guide/health/containers/#prometheus-integration","title":"Prometheus Integration","text":"<p>Metrics exported at <code>/api/v1/metrics</code> with <code>witfoo_container_*</code> prefix.</p>"},{"location":"user-guide/observer/","title":"Observer","text":"<p>The Observer module is the incident management workspace in WitFoo Analytics. It organizes security incidents into work units, groups related incidents into collections, defines attacker behaviors through MO definitions, and tracks analyst observations throughout the investigation lifecycle.</p> <p>Navigate to: Observer in the left sidebar</p>"},{"location":"user-guide/observer/#observer-workflow","title":"Observer Workflow","text":"<pre><code>flowchart TD\n    A[Signal Matches Lead Rule] --&gt; B[Work Unit Created]\n    B --&gt; C{Analyst Triage}\n    C --&gt;|Investigate| D[Status: Investigating]\n    C --&gt;|False Positive| E[Status: Closed]\n    D --&gt; F{Resolution}\n    F --&gt;|Remediated| G[Status: Resolved]\n    F --&gt;|Business Impact| H[Status: Disrupted]\n    B --&gt; I[Work Collection]\n    I --&gt; J[Campaign Analysis]</code></pre>"},{"location":"user-guide/observer/#incident-statuses","title":"Incident Statuses","text":"<p>Work units progress through a defined lifecycle:</p> Status ID Description Classification New 1 Newly detected, not yet triaged Uncategorized Investigating 2 Under active analyst investigation Uncategorized Resolved 3 True positive, successfully remediated True Positive Closed 4 False positive or dismissed False Positive Disrupted 5 True positive with confirmed business impact True Positive <p>True Positive / False Positive</p> <p>Only Resolved and Disrupted incidents count as True Positives. Only Closed incidents count as False Positives. New and Investigating incidents are uncategorized until resolved. This aligns with NIST SP 800-61 guidance.</p>"},{"location":"user-guide/observer/#module-pages","title":"Module Pages","text":""},{"location":"user-guide/observer/#work-units","title":"Work Units","text":"<p>Individual incidents requiring analyst attention. Each work unit represents a detected security event with associated signals, entities, and analyst notes.</p> <p>Navigate to: Observer \u2192 Work Units</p> <p>Work Units documentation \u2192</p>"},{"location":"user-guide/observer/#work-collections","title":"Work Collections","text":"<p>Groups of related work units that represent a coordinated campaign, recurring pattern, or multi-stage attack.</p> <p>Navigate to: Observer \u2192 Work Collections</p> <p>Work Collections documentation \u2192</p>"},{"location":"user-guide/observer/#mo-definitions","title":"MO Definitions","text":"<p>Modus operandi definitions describe attacker behaviors and techniques. They categorize incidents by the type of activity observed.</p> <p>Navigate to: Observer \u2192 MO Definitions</p> <p>MO Definitions documentation \u2192</p>"},{"location":"user-guide/observer/#observations","title":"Observations","text":"<p>Analyst notes, behavioral annotations, and investigation findings attached to work units and collections.</p> <p>Navigate to: Observer \u2192 Observations</p> <p>Observations documentation \u2192</p>"},{"location":"user-guide/observer/#additional-observer-pages","title":"Additional Observer Pages","text":""},{"location":"user-guide/observer/#mitre-attck-matrix","title":"MITRE ATT&amp;CK Matrix","text":"<p>View your organization's detection coverage mapped to the MITRE ATT&amp;CK framework. The matrix shows which techniques are covered by your data sources and which have active detections.</p> <p>Navigate to: Observer \u2192 ATT&amp;CK</p>"},{"location":"user-guide/observer/#responders","title":"Responders","text":"<p>Manage automated response actions (SOAR integrations) that can be triggered from work units.</p> <p>Navigate to: Observer \u2192 Responders</p>"},{"location":"user-guide/observer/#playbooks","title":"Playbooks","text":"<p>Step-by-step investigation and response procedures that guide analysts through incident handling.</p> <p>Navigate to: Observer \u2192 Playbooks</p>"},{"location":"user-guide/observer/#my-tasks","title":"My Tasks","text":"<p>View work units assigned to you for investigation.</p> <p>Navigate to: Observer \u2192 My Tasks</p>"},{"location":"user-guide/observer/#key-metrics","title":"Key Metrics","text":"<p>The Observer module feeds data into the Reporter module for executive dashboards:</p> <ul> <li>Total incidents \u2014 Count of all work units in the reporting period</li> <li>TP/FP ratio \u2014 True Positive to False Positive ratio</li> <li>Mean time to resolution \u2014 Average time from New to Resolved/Closed</li> <li>FTE utilization \u2014 Analyst hours consumed by incident response</li> </ul>"},{"location":"user-guide/observer/mo-definitions/","title":"MO Definitions","text":"<p>MO (Modus Operandi) definitions describe categories of attacker behavior and incident types. Each work unit is assigned an MO definition that classifies the type of security event detected \u2014 such as brute force attack, malware infection, data exfiltration, or phishing.</p> <p>Navigate to: Observer \u2192 MO Definitions</p>"},{"location":"user-guide/observer/mo-definitions/#purpose","title":"Purpose","text":"<p>MO definitions provide:</p> <ul> <li>Incident categorization \u2014 Standardized labels for security event types</li> <li>Lead rule targets \u2014 Each lead rule specifies which MO definition to assign when triggered</li> <li>Reporting dimensions \u2014 Incident counts grouped by MO type in executive reports</li> <li>Playbook association \u2014 Link investigation procedures to specific incident types</li> </ul>"},{"location":"user-guide/observer/mo-definitions/#viewing-mo-definitions","title":"Viewing MO Definitions","text":"<p>The MO Definitions page displays all configured definitions:</p> Column Description Name MO definition name Description Detailed description of the behavior Category High-level grouping (e.g., Network, Authentication, Endpoint) Phases Attack phases associated with this MO Incident Count Number of work units assigned this MO"},{"location":"user-guide/observer/mo-definitions/#built-in-mo-definitions","title":"Built-In MO Definitions","text":"<p>WitFoo Analytics ships with pre-configured MO definitions covering common security event types:</p>"},{"location":"user-guide/observer/mo-definitions/#network-category","title":"Network Category","text":"MO Definition Description Port Scan Systematic probing of network ports Network Intrusion Unauthorized network access attempt DNS Tunneling Data exfiltration via DNS queries DDoS Distributed denial of service attack"},{"location":"user-guide/observer/mo-definitions/#authentication-category","title":"Authentication Category","text":"MO Definition Description Brute Force Repeated authentication attempts Credential Stuffing Automated login with stolen credentials Privilege Escalation Unauthorized elevation of access rights Account Compromise Confirmed unauthorized account access"},{"location":"user-guide/observer/mo-definitions/#endpoint-category","title":"Endpoint Category","text":"MO Definition Description Malware Infection Malicious software detected on endpoint Ransomware Encryption-based extortion malware Suspicious Process Anomalous process execution File Integrity Violation Unauthorized file modification"},{"location":"user-guide/observer/mo-definitions/#data-category","title":"Data Category","text":"MO Definition Description Data Exfiltration Unauthorized data transfer Phishing Social engineering via email Insider Threat Malicious activity by authorized user"},{"location":"user-guide/observer/mo-definitions/#mo-definition-detail","title":"MO Definition Detail","text":"<p>Click an MO definition to view its detail page:</p>"},{"location":"user-guide/observer/mo-definitions/#properties","title":"Properties","text":"<ul> <li>Name \u2014 Display name</li> <li>Description \u2014 Detailed behavior description</li> <li>Category \u2014 High-level grouping</li> <li>Phases \u2014 Attack lifecycle phases (reconnaissance, weaponization, delivery, exploitation, installation, command &amp; control, actions on objectives)</li> <li>Analysis configuration \u2014 JSON-based analysis parameters</li> </ul>"},{"location":"user-guide/observer/mo-definitions/#associated-lead-rules","title":"Associated Lead Rules","text":"<p>Lists all lead rules that assign this MO definition when triggered. This shows which signal patterns map to this incident type.</p>"},{"location":"user-guide/observer/mo-definitions/#associated-work-units","title":"Associated Work Units","text":"<p>Lists recent work units assigned this MO definition, with status and severity breakdowns.</p>"},{"location":"user-guide/observer/mo-definitions/#synced-mo-definitions","title":"Synced MO Definitions","text":"<p>MO definitions can be synced from the Intel API when a valid license is configured. Synced definitions are updated automatically at startup and include:</p> <ul> <li>Standardized behavior descriptions</li> <li>Phase mappings aligned with industry frameworks</li> <li>Analysis configurations optimized for each incident type</li> </ul> <p>Synced definitions display a Synced badge and cannot be edited locally.</p> <p>Offline Environments</p> <p>In disconnected network deployments without Intel API access, MO definitions are seeded from bundled data files. Contact your administrator about updating offline MO definitions.</p>"},{"location":"user-guide/observer/mo-definitions/#custom-mo-definitions","title":"Custom MO Definitions","text":"<p>Organizations can create custom MO definitions for environment-specific incident types.</p>"},{"location":"user-guide/observer/mo-definitions/#creating-a-custom-mo-definition","title":"Creating a Custom MO Definition","text":"<ol> <li>Navigate to Observer \u2192 MO Definitions</li> <li>Click Create MO Definition</li> <li>Fill in the configuration:<ul> <li>Name: Descriptive name for the behavior</li> <li>Description: Detailed explanation of what this MO represents</li> <li>Category: Select or create a category</li> <li>Phases: Select applicable attack phases</li> </ul> </li> <li>Click Save</li> </ol>"},{"location":"user-guide/observer/mo-definitions/#editing-an-mo-definition","title":"Editing an MO Definition","text":"<ol> <li>Click the MO definition row to open its detail page</li> <li>Modify the desired fields</li> <li>Click Save</li> </ol> <p>Editing Synced Definitions</p> <p>Synced MO definitions from the Intel API cannot be edited. To customize a synced definition, create a new custom definition with your modifications.</p>"},{"location":"user-guide/observer/mo-definitions/#best-practices","title":"Best Practices","text":"<ol> <li>Use built-in definitions first \u2014 The pre-configured MOs cover most common scenarios</li> <li>Create custom MOs sparingly \u2014 Only when built-in definitions don't adequately describe the behavior</li> <li>Map to lead rules \u2014 Every MO definition should have at least one lead rule that assigns it</li> <li>Review phase mappings \u2014 Ensure phases accurately reflect the attack lifecycle stage</li> </ol>"},{"location":"user-guide/observer/observations/","title":"Observations","text":"<p>Observations are analyst notes, behavioral annotations, and investigation findings attached to work units and work collections. They capture the human intelligence gathered during incident investigation and response.</p> <p>Navigate to: Observer \u2192 Observations</p>"},{"location":"user-guide/observer/observations/#purpose","title":"Purpose","text":"<p>Observations serve as the institutional memory of your security operations:</p> <ul> <li>Document findings \u2014 Record what analysts discover during investigation</li> <li>Track behavior patterns \u2014 Annotate recurring attacker techniques</li> <li>Support handoffs \u2014 Provide context when incidents transfer between analysts</li> <li>Build evidence \u2014 Create an audit trail of investigation steps</li> <li>Feed reporting \u2014 Observation data contributes to operational metrics</li> </ul>"},{"location":"user-guide/observer/observations/#viewing-observations","title":"Viewing Observations","text":"<p>The Observations page displays all observations across your organization:</p> Column Description Observation The observation text Type Observation category Work Unit Associated work unit (if any) Collection Associated work collection (if any) Author Analyst who created the observation Created Timestamp of creation"},{"location":"user-guide/observer/observations/#filtering","title":"Filtering","text":"<ul> <li>Type \u2014 Filter by observation category</li> <li>Author \u2014 Filter by creating analyst</li> <li>Work Unit \u2014 Filter by associated incident</li> <li>Time Range \u2014 Filter by creation timestamp</li> </ul>"},{"location":"user-guide/observer/observations/#observation-types","title":"Observation Types","text":"Type Description Use Case Finding Investigation result \"Source IP resolves to known C2 infrastructure\" Behavioral Attacker behavior pattern \"Attacker uses living-off-the-land techniques\" Recommendation Suggested action \"Block IP range at perimeter firewall\" Note General annotation \"Waiting for endpoint team to provide memory dump\" Evidence Forensic evidence reference \"PCAP captured and stored in case folder\""},{"location":"user-guide/observer/observations/#creating-observations","title":"Creating Observations","text":""},{"location":"user-guide/observer/observations/#from-the-observations-page","title":"From the Observations Page","text":"<ol> <li>Navigate to Observer \u2192 Observations</li> <li>Click Add Observation</li> <li>Fill in the form:<ul> <li>Type: Select the observation category</li> <li>Text: Enter the observation content</li> <li>Work Unit: Optionally associate with a work unit</li> <li>Collection: Optionally associate with a work collection</li> </ul> </li> <li>Click Save</li> </ol>"},{"location":"user-guide/observer/observations/#from-a-work-unit-detail-page","title":"From a Work Unit Detail Page","text":"<ol> <li>Open a work unit at Observer \u2192 Work Units \u2192 [id]</li> <li>Navigate to the Observations tab</li> <li>Click Add Observation</li> <li>Enter the observation type and text</li> <li>Click Save</li> </ol> <p>The observation is automatically associated with the current work unit.</p>"},{"location":"user-guide/observer/observations/#from-a-work-collection-detail-page","title":"From a Work Collection Detail Page","text":"<ol> <li>Open a collection at Observer \u2192 Work Collections \u2192 [id]</li> <li>Navigate to the Observations tab</li> <li>Click Add Observation</li> <li>Enter the observation type and text</li> <li>Click Save</li> </ol>"},{"location":"user-guide/observer/observations/#editing-observations","title":"Editing Observations","text":"<ol> <li>Click the observation row to open it</li> <li>Modify the text or type</li> <li>Click Save</li> </ol> <p>Edit History</p> <p>Observation edits are tracked. The original text and all modifications are preserved in the audit trail.</p>"},{"location":"user-guide/observer/observations/#observation-best-practices","title":"Observation Best Practices","text":""},{"location":"user-guide/observer/observations/#writing-effective-observations","title":"Writing Effective Observations","text":"<ol> <li>Be specific \u2014 Include entity values, timestamps, and tool names</li> <li>State conclusions \u2014 Don't just describe what you see; explain what it means</li> <li>Reference evidence \u2014 Link to signals, graph nodes, or external sources</li> <li>Use consistent terminology \u2014 Follow your organization's naming conventions</li> </ol>"},{"location":"user-guide/observer/observations/#example-observations","title":"Example Observations","text":"<p>Good Finding:</p> <p>Source IP 203.0.113.50 (AS12345, Example Hosting) has been observed in 3 separate brute force incidents over the past 7 days. GeoIP shows location in Eastern Europe. Threat intel confidence: 92%. Recommend adding to block list.</p> <p>Good Behavioral:</p> <p>Attacker demonstrates credential harvesting pattern: initial phishing email \u2192 credential capture \u2192 VPN login from anomalous location \u2192 lateral movement to file server. Consistent with APT group TTPs documented in ATT&amp;CK T1566 \u2192 T1078 \u2192 T1021.</p> <p>Weak Note (avoid):</p> <p>Looks suspicious.</p>"},{"location":"user-guide/observer/observations/#observation-workflow","title":"Observation Workflow","text":"<pre><code>flowchart TD\n    A[New Work Unit] --&gt; B[Initial Triage]\n    B --&gt; C[Add Finding: Initial assessment]\n    C --&gt; D[Deep Investigation]\n    D --&gt; E[Add Finding: Investigation results]\n    D --&gt; F[Add Behavioral: Pattern identified]\n    E --&gt; G[Resolution]\n    G --&gt; H[Add Recommendation: Remediation steps]\n    H --&gt; I[Close/Resolve Work Unit]</code></pre>"},{"location":"user-guide/observer/observations/#searching-observations","title":"Searching Observations","text":"<p>Use the search bar on the Observations page to search observation text:</p> <pre><code>C2 infrastructure\n</code></pre> <pre><code>brute force\n</code></pre> <p>This searches across all observation text, making it easy to find past findings related to current investigations.</p> <p>Cross-Reference Observations</p> <p>When investigating a new incident, search observations for related entity values (IPs, domains, usernames). Past findings from other analysts may provide valuable context.</p>"},{"location":"user-guide/observer/work-collections/","title":"Work Collections","text":"<p>Work collections group related work units into a single entity representing a coordinated campaign, recurring attack pattern, or multi-stage incident. Collections provide a higher-level view of security events that span multiple individual detections.</p> <p>Navigate to: Observer \u2192 Work Collections</p>"},{"location":"user-guide/observer/work-collections/#purpose","title":"Purpose","text":"<p>Work collections help analysts:</p> <ul> <li>Track campaigns \u2014 Group incidents that are part of the same attack campaign</li> <li>Correlate patterns \u2014 Link recurring incidents with common indicators</li> <li>Report on trends \u2014 Aggregate metrics across related incidents</li> <li>Coordinate response \u2014 Manage multi-stage incidents as a unified effort</li> </ul>"},{"location":"user-guide/observer/work-collections/#work-collection-table","title":"Work Collection Table","text":"<p>The main page displays all collections in a data table:</p> Column Description ID Unique collection identifier Name Collection name Description Summary of the collection's purpose Work Unit Count Number of associated work units Status Overall collection status Created Timestamp of creation Updated Timestamp of last modification"},{"location":"user-guide/observer/work-collections/#creating-a-work-collection","title":"Creating a Work Collection","text":"<ol> <li>Navigate to Observer \u2192 Work Collections</li> <li>Click Create Collection</li> <li>Fill in the collection details:<ul> <li>Name: Descriptive name (e.g., \"February Phishing Campaign\" or \"Lateral Movement \u2014 Finance Subnet\")</li> <li>Description: Summary of what ties these incidents together</li> </ul> </li> <li>Click Create</li> </ol>"},{"location":"user-guide/observer/work-collections/#adding-work-units-to-a-collection","title":"Adding Work Units to a Collection","text":""},{"location":"user-guide/observer/work-collections/#from-the-collection-detail-page","title":"From the Collection Detail Page","text":"<ol> <li>Open the collection detail page</li> <li>Click Add Work Units</li> <li>Search for or select work units to add</li> <li>Click Confirm</li> </ol>"},{"location":"user-guide/observer/work-collections/#from-a-work-unit-detail-page","title":"From a Work Unit Detail Page","text":"<ol> <li>Open a work unit detail page</li> <li>Click the Collection field</li> <li>Select an existing collection or create a new one</li> <li>The work unit is added to the collection</li> </ol>"},{"location":"user-guide/observer/work-collections/#collection-detail-page","title":"Collection Detail Page","text":"<p>Click a collection row to open its detail page at Observer \u2192 Work Collections \u2192 [id].</p>"},{"location":"user-guide/observer/work-collections/#overview-section","title":"Overview Section","text":"<ul> <li>Name and description</li> <li>Total work units \u2014 Count of associated incidents</li> <li>Status breakdown \u2014 How many work units are New, Investigating, Resolved, Closed, Disrupted</li> <li>Severity distribution \u2014 Severity levels across all work units</li> <li>Time span \u2014 From earliest to latest work unit</li> </ul>"},{"location":"user-guide/observer/work-collections/#work-units-tab","title":"Work Units Tab","text":"<p>Lists all work units in the collection with their current status, severity, and assigned analyst. Click any work unit to navigate to its detail page.</p>"},{"location":"user-guide/observer/work-collections/#entities-tab","title":"Entities Tab","text":"<p>Aggregated view of all entities (IPs, domains, users, hosts) across all work units in the collection. This helps identify common indicators across related incidents.</p>"},{"location":"user-guide/observer/work-collections/#timeline-tab","title":"Timeline Tab","text":"<p>Merged chronological view of events across all work units, showing the full scope of the campaign or pattern.</p>"},{"location":"user-guide/observer/work-collections/#attck-coverage","title":"ATT&amp;CK Coverage","text":"<p>If work units have MITRE ATT&amp;CK technique mappings, the collection detail page shows the combined technique coverage, helping analysts understand the full scope of attacker tactics.</p>"},{"location":"user-guide/observer/work-collections/#managing-collections","title":"Managing Collections","text":""},{"location":"user-guide/observer/work-collections/#removing-work-units","title":"Removing Work Units","text":"<ol> <li>Open the collection detail page</li> <li>In the Work Units tab, find the work unit to remove</li> <li>Click the Remove action</li> <li>The work unit is disassociated but not deleted</li> </ol>"},{"location":"user-guide/observer/work-collections/#deleting-a-collection","title":"Deleting a Collection","text":"<ol> <li>Open the collection detail page</li> <li>Click Delete Collection</li> <li>Confirm the deletion</li> </ol> <p>Deleting a Collection</p> <p>Deleting a collection removes the grouping only. The individual work units are not affected and remain in the Observer module.</p>"},{"location":"user-guide/observer/work-collections/#best-practices","title":"Best Practices","text":"<ol> <li>Name collections descriptively \u2014 Include the campaign type, date range, or target in the name</li> <li>Add context in the description \u2014 Explain the common thread linking the work units</li> <li>Review regularly \u2014 As new incidents arrive, check if they belong to an existing collection</li> <li>Use for reporting \u2014 Collections provide natural groupings for executive briefings and post-incident reviews</li> </ol>"},{"location":"user-guide/observer/work-units/","title":"Work Units","text":"<p>Work units are individual security incidents in WitFoo Analytics. Each work unit represents a detected security event that requires analyst attention, containing associated signals, entities, timeline data, and investigation notes.</p> <p>Navigate to: Observer \u2192 Work Units</p>"},{"location":"user-guide/observer/work-units/#work-unit-table","title":"Work Unit Table","text":"<p>The main Work Units page displays all incidents in a configurable data table.</p>"},{"location":"user-guide/observer/work-units/#default-columns","title":"Default Columns","text":"Column Description ID Unique work unit identifier Name Incident name (auto-generated or custom) Status Current lifecycle status (New, Investigating, Resolved, Closed, Disrupted) Severity Incident severity level MO Definition Assigned modus operandi type Created Timestamp of creation Updated Timestamp of last update Assigned To Analyst assigned to the incident"},{"location":"user-guide/observer/work-units/#additional-columns","title":"Additional Columns","text":"<p>Click the column settings icon to enable additional columns:</p> <ul> <li>Signal Count \u2014 Number of associated signals</li> <li>Source Org \u2014 For CyberGrid-sourced incidents, shows the originating organization (purple tag) or \"Local\"</li> <li>ATT&amp;CK Techniques \u2014 Mapped MITRE ATT&amp;CK technique IDs</li> <li>Collection \u2014 Parent work collection (if grouped)</li> </ul>"},{"location":"user-guide/observer/work-units/#viewing-work-units","title":"Viewing Work Units","text":""},{"location":"user-guide/observer/work-units/#filtering","title":"Filtering","text":"<p>Use the filter controls above the table:</p> <ul> <li>Status \u2014 Filter by one or more statuses</li> <li>Severity \u2014 Filter by severity level</li> <li>MO Definition \u2014 Filter by incident type</li> <li>Assigned To \u2014 Filter by assigned analyst</li> <li>Time Range \u2014 Filter by creation or update timestamp</li> </ul>"},{"location":"user-guide/observer/work-units/#searching","title":"Searching","text":"<p>Use the search bar to find work units by name, ID, or associated entity values.</p>"},{"location":"user-guide/observer/work-units/#sorting","title":"Sorting","text":"<p>Click any column header to sort. Default sort is by creation timestamp (newest first).</p>"},{"location":"user-guide/observer/work-units/#work-unit-detail-page","title":"Work Unit Detail Page","text":"<p>Click a work unit row to open its detail page at Observer \u2192 Work Units \u2192 [id].</p>"},{"location":"user-guide/observer/work-units/#header-section","title":"Header Section","text":"<ul> <li>Status badge \u2014 Current status with color indicator</li> <li>Severity \u2014 Severity level</li> <li>MO Definition \u2014 Assigned incident type</li> <li>Assigned analyst \u2014 Current owner</li> <li>Timestamps \u2014 Created, updated, resolved</li> </ul>"},{"location":"user-guide/observer/work-units/#tabs","title":"Tabs","text":"<p>The detail page organizes information into tabs:</p>"},{"location":"user-guide/observer/work-units/#signals-tab","title":"Signals Tab","text":"<p>Lists all signals associated with this work unit. Each signal row shows:</p> <ul> <li>Timestamp</li> <li>Source and destination entities</li> <li>Event type</li> <li>Severity</li> <li>Stream name</li> </ul> <p>Click a signal to navigate to its detail page in the Signals module.</p>"},{"location":"user-guide/observer/work-units/#entities-tab","title":"Entities Tab","text":"<p>Shows all graph nodes (IPs, domains, users, hosts) involved in the incident. Click an entity to view it in the Graph module.</p>"},{"location":"user-guide/observer/work-units/#timeline-tab","title":"Timeline Tab","text":"<p>Chronological view of all events related to the incident:</p> <ul> <li>Signal timestamps</li> <li>Status changes</li> <li>Analyst actions</li> <li>Observations added</li> </ul>"},{"location":"user-guide/observer/work-units/#observations-tab","title":"Observations Tab","text":"<p>Analyst notes and findings attached to this work unit. See Observations for details.</p>"},{"location":"user-guide/observer/work-units/#managing-work-units","title":"Managing Work Units","text":""},{"location":"user-guide/observer/work-units/#changing-status","title":"Changing Status","text":"<ol> <li>Open the work unit detail page</li> <li>Click the Status dropdown in the header</li> <li>Select the new status:<ul> <li>Investigating \u2014 Begin active investigation</li> <li>Resolved \u2014 Mark as true positive, remediated</li> <li>Closed \u2014 Mark as false positive</li> <li>Disrupted \u2014 Mark as true positive with business impact</li> </ul> </li> <li>The status change is recorded in the timeline</li> </ol> <p>Status Changes Are Permanent</p> <p>While you can change status multiple times, each change is logged in the audit trail. Use status changes deliberately to maintain accurate metrics.</p>"},{"location":"user-guide/observer/work-units/#assigning-an-analyst","title":"Assigning an Analyst","text":"<ol> <li>Open the work unit detail page</li> <li>Click the Assigned To field</li> <li>Select an analyst from the dropdown</li> <li>The assignment is recorded in the timeline</li> </ol>"},{"location":"user-guide/observer/work-units/#adding-observations","title":"Adding Observations","text":"<ol> <li>Open the work unit detail page</li> <li>Navigate to the Observations tab</li> <li>Click Add Observation</li> <li>Enter your finding or note</li> <li>Click Save</li> </ol>"},{"location":"user-guide/observer/work-units/#splitting-a-work-unit","title":"Splitting a Work Unit","text":"<p>If a work unit contains signals from multiple unrelated events:</p> <ol> <li>Open the work unit detail page</li> <li>Select the signals that belong to a separate incident</li> <li>Click Split to create a new work unit with the selected signals</li> </ol> <p>Scroll for Split Actions</p> <p>In work units with large signal sets, the split action controls may be below the visible area. Scroll down or use the tab navigation to access them.</p>"},{"location":"user-guide/observer/work-units/#merging-work-units","title":"Merging Work Units","text":"<p>If multiple work units represent the same incident:</p> <ol> <li>Open one of the work units</li> <li>Click Merge</li> <li>Select the other work unit(s) to merge</li> <li>Confirm the merge \u2014 signals from all selected work units are combined</li> </ol>"},{"location":"user-guide/observer/work-units/#cybergrid-sourced-incidents","title":"CyberGrid-Sourced Incidents","text":"<p>Work units received from CyberGrid subscriptions display a purple tag in the Source Org column showing the originating organization. Local incidents display \"Local\" in gray text.</p> <p>CyberGrid-sourced incidents are fully integrated into the Observer workflow \u2014 you can triage, investigate, and resolve them like any local incident.</p>"},{"location":"user-guide/observer/work-units/#keyboard-navigation","title":"Keyboard Navigation","text":"Key Action <code>\u2191</code> / <code>\u2193</code> Navigate between table rows <code>Enter</code> Open selected work unit Browser back Return to work unit list"},{"location":"user-guide/reporter/","title":"Reporter","text":"<p>The Reporter module generates executive dashboards, compliance assessments, tool effectiveness analysis, and cost/savings projections. It transforms raw security operations data into actionable intelligence for security leadership and stakeholders.</p> <p>Navigate to: Reporter in the left sidebar</p>"},{"location":"user-guide/reporter/#report-data-window","title":"Report Data Window","text":"<p>All Reporter dashboards analyze the most recent 30 days of incident data by default. This rolling window provides monthly trend visibility while remaining actionable.</p> <p>Report Refresh</p> <p>Report data is generated by a background scheduler. Dashboards reflect the most recent snapshot. Allow a few minutes after incident status changes for reports to update.</p>"},{"location":"user-guide/reporter/#reporter-modules","title":"Reporter Modules","text":""},{"location":"user-guide/reporter/#executive-summary","title":"Executive Summary","text":"<p>High-level security posture dashboard with key metrics, trend charts, and the Workforce Readiness Score (WRS).</p> <p>Navigate to: Reporter \u2192 Executive</p> <p>[Executive</p>"},{"location":"user-guide/reporter/compliance/","title":"Compliance Readiness","text":"<p>The Compliance Readiness report shows your organization's compliance posture against enabled security frameworks using focus-based scoring.</p>"},{"location":"user-guide/reporter/compliance/#framework-selection","title":"Framework Selection","text":"<p>Select a framework from the dropdown. The primary framework is selected by default.</p>"},{"location":"user-guide/reporter/compliance/#compliance-score","title":"Compliance Score","text":"<p>Overall score displayed as a gauge chart:</p> Score Range Color Status &gt; 75% Green Compliant &gt; 0% Yellow Partial 0% Red Unmet"},{"location":"user-guide/reporter/compliance/#focus-based-scoring","title":"Focus-Based Scoring","text":"<p>Each control has a focus type determining the compliance denominator:</p> Focus Denominator Computer Managed nodes User User nodes Infrastructure Device Infrastructure nodes Product Security products <p>Score = (green + yellow nodes) / auto-detectable nodes * 100. Manual-only controls excluded.</p>"},{"location":"user-guide/reporter/compliance/#per-control-table","title":"Per-Control Table","text":"Column Description Control ID Framework control identifier Control Name Human-readable name Focus Type (Computer=blue, User=purple, Infra=magenta, Product=green) Compliance % Calculated percentage Detection Product + confidence (e.g., \"Palo Alto (95%)\") Status Compliant / Partial / Unmet / Manual"},{"location":"user-guide/reporter/compliance/#filtering","title":"Filtering","text":"<p>Two combinable filter dimensions: Compliance status and Focus type.</p>"},{"location":"user-guide/reporter/compliance/#delta-indicator","title":"Delta Indicator","text":"<p>Shows compliance score change across date range snapshots.</p>"},{"location":"user-guide/reporter/compliance/#csv-export","title":"CSV Export","text":"<p>Exports per-control table with current filters. Filename: <code>{framework}_compliance_{date}.csv</code>.</p>"},{"location":"user-guide/reporter/cost-savings/","title":"Cost &amp; Savings","text":"<p>Financial analysis of security operations including FTE requirements and automation savings.</p>"},{"location":"user-guide/reporter/cost-savings/#fte-analysis","title":"FTE Analysis","text":"<p>Gauge chart showing calculated analyst headcount:</p> <pre><code>FTE Needed = (Total Incidents * Avg Hours per Incident) / 2,080\n</code></pre> <p>Avg Hours = Investigation Time + Restore Time (default: 2.25 hours). 2,080 = 40 hrs/week * 52 weeks.</p> <p>Shows surplus (green) or deficit (red) versus configured FTE count.</p>"},{"location":"user-guide/reporter/cost-savings/#profit-loss-table","title":"Profit &amp; Loss Table","text":"<p>Financial summary in monospace format (IBM Plex Mono):</p> Section Contents Revenue Annual revenue Security Spend Annual security budget Product Costs Sum of product costs Personnel Costs FTE count * analyst salary Net Position Revenue impact"},{"location":"user-guide/reporter/cost-savings/#security-spend-ratio","title":"Security Spend Ratio","text":"<pre><code>Security Spend % = (Annual Security Spend / Annual Revenue) * 100\n</code></pre>"},{"location":"user-guide/reporter/cost-savings/#savings-histogram","title":"Savings Histogram","text":"<p>Bar chart showing cost savings from automated vs manual investigation.</p>"},{"location":"user-guide/reporter/executive/","title":"Executive Summary","text":"<p>The Executive Summary provides high-level KPIs for security operations leadership.</p>"},{"location":"user-guide/reporter/executive/#key-metrics","title":"Key Metrics","text":"Metric Description Calculation Total Incidents Incidents in the date range Count of all incidents True Positives Confirmed security incidents Status: Disrupted (5) or Resolved (3) False Positives Non-incidents Status: Closed (4) TP/FP Ratio Classification accuracy True positives / false positives MTTD Mean time to detect Avg time from first artifact to incident creation MTTR Mean time to respond Avg time from creation to resolution"},{"location":"user-guide/reporter/executive/#dashboard-layout","title":"Dashboard Layout","text":"<ol> <li>KPI tiles \u2014 Large-format cards with trend indicators</li> <li>Incident timeline \u2014 Bar chart of incident creation over time</li> <li>Severity distribution \u2014 Breakdown by Critical, High, Medium, Low, Info</li> <li>Status distribution \u2014 Current status of incidents in the period</li> </ol>"},{"location":"user-guide/reporter/executive/#true-positive-classification","title":"True Positive Classification","text":"<p>TP/FP classification uses incident status IDs:</p> <ul> <li>True Positive: Status is <code>disrupted</code> (5) or <code>resolved</code> (3)</li> <li>False Positive: Status is <code>closed</code> (4)</li> </ul>"},{"location":"user-guide/reporter/executive/#trend-indicators","title":"Trend Indicators","text":"<p>Each KPI shows a trend arrow comparing the current period to the previous period of equal length.</p>"},{"location":"user-guide/reporter/tool-effectiveness/","title":"Tool Effectiveness","text":"<p>Analyzes how security products contribute to incident detection and response.</p>"},{"location":"user-guide/reporter/tool-effectiveness/#sankey-flow-diagram","title":"Sankey Flow Diagram","text":"<p>Shows artifact flows from products through types to incident severities. Products ranked by artifact count, top-N shown individually, remainder as \"Other\".</p>"},{"location":"user-guide/reporter/tool-effectiveness/#product-coverage-venn","title":"Product Coverage Venn","text":"<p>Overlap between security products. 1-4 products use fixed geometric layouts; 5-8 use radial layout.</p>"},{"location":"user-guide/reporter/tool-effectiveness/#product-metrics-table","title":"Product Metrics Table","text":"Column Description Product Security product name Artifacts Total artifacts generated Incidents Incidents from this product TP Rate True positive rate Coverage Compliance controls detected Cost Annual product cost Cost per Incident Product cost / incidents <p>Help tooltips explain calculations. Chart toolbars disabled for clean presentation.</p>"},{"location":"user-guide/signals/","title":"Signals","text":"<p>Signals are the foundational data layer in WitFoo Analytics. Every log entry, alert, and event ingested from your connected security tools arrives as a signal \u2014 a normalized, enriched record ready for analysis.</p>"},{"location":"user-guide/signals/#what-is-a-signal","title":"What Is a Signal?","text":"<p>A signal represents a single security-relevant event parsed from source data. Signals are created when the Conductor suite ingests data from connected tools (IDS, firewalls, authentication systems, DNS servers, endpoint agents, etc.) and normalizes it into WitFoo's unified schema.</p> <p>Each signal contains:</p> <ul> <li>Timestamp \u2014 When the event occurred</li> <li>Source and destination \u2014 IP addresses, hostnames, users involved</li> <li>Event type \u2014 The category of activity (authentication, network, file, etc.)</li> <li>Severity \u2014 Normalized severity level</li> <li>Raw data \u2014 The original log entry for reference</li> <li>Enrichment data \u2014 GeoIP, threat intel, MITRE ATT&amp;CK mappings</li> </ul>"},{"location":"user-guide/signals/#signals-workflow","title":"Signals Workflow","text":"<pre><code>flowchart LR\n    A[Security Tools] --&gt;|Ingest| B[Signal Parser]\n    B --&gt;|Normalize| C[Enrichment]\n    C --&gt;|Classify| D[Lead Rules]\n    D --&gt;|Promote| E[Incidents]\n    D --&gt;|Store| F[Signal Index]\n    F --&gt;|Query| G[Search]</code></pre>"},{"location":"user-guide/signals/#module-pages","title":"Module Pages","text":""},{"location":"user-guide/signals/#search","title":"Search","text":"<p>Query signals using WitFoo's search syntax with field-level filters, time ranges, and boolean operators. Save frequently used queries for quick access.</p> <p>Navigate to: Signals \u2192 Search</p> <p>Search documentation \u2192</p>"},{"location":"user-guide/signals/#lead-rules","title":"Lead Rules","text":"<p>Lead rules define the criteria that automatically promote signals into incidents. When a signal matches a lead rule, it creates or updates a work unit in the Observer module.</p> <p>Navigate to: Signals \u2192 Rules</p> <p>Lead rules documentation \u2192</p>"},{"location":"user-guide/signals/#classification-rules","title":"Classification Rules","text":"<p>Classification rules assign framework-based categories to signals, mapping them to compliance controls (CIS CSC, NIST CSF) and security domains.</p> <p>Navigate to: Signals \u2192 Classification Rules</p> <p>Classification rules documentation \u2192</p>"},{"location":"user-guide/signals/#enrichment-settings","title":"Enrichment Settings","text":"<p>Configure how signals are enriched with additional context \u2014 GeoIP lookups, threat intelligence feeds, DNS resolution, and MITRE ATT&amp;CK technique mapping.</p> <p>Navigate to: Signals \u2192 Enrichment Settings</p> <p>Enrichment settings documentation \u2192</p>"},{"location":"user-guide/signals/#signal-detail-view","title":"Signal Detail View","text":"<p>Click any signal in search results to open its detail view at Signals \u2192 [id].</p> <p>The detail page shows:</p> <ul> <li>Header \u2014 Signal ID, timestamp, severity, and source tool</li> <li>Event fields \u2014 All parsed fields in a structured table</li> <li>Raw log \u2014 The original log entry</li> <li>Enrichment \u2014 GeoIP data, threat intel matches, ATT&amp;CK techniques</li> <li>Related signals \u2014 Other signals sharing common entities (IPs, users, hosts)</li> <li>Graph link \u2014 Navigate to the Graph module to see entity relationships</li> </ul> <p>Keyboard Shortcut</p> <p>Use your browser's back button or the breadcrumb navigation at the top of the detail page to return to search results without losing your query.</p>"},{"location":"user-guide/signals/#key-concepts","title":"Key Concepts","text":"Concept Description Stream name The normalized data source identifier (e.g., <code>ids_alert</code>, <code>auth_login</code>, <code>fw_deny</code>) Fingerprint A unique parser signature that identifies the log format Lead A signal that matched a lead rule and was promoted to an incident Enrichment Additional context added to a signal after parsing (GeoIP, threat intel) Classification Framework-based categorization applied to signals <p>Data Retention</p> <p>Signal retention is governed by your Cassandra time-to-live (TTL) settings. Contact your administrator to verify your organization's retention policy.</p>"},{"location":"user-guide/signals/classification-rules/","title":"Classification Rules","text":"<p>Classification rules assign framework-based categories to signals and graph nodes, mapping security events to compliance controls and security domains. These rules determine how entities are tagged for compliance reporting and security posture assessment.</p> <p>Navigate to: Signals \u2192 Classification Rules</p>"},{"location":"user-guide/signals/classification-rules/#purpose","title":"Purpose","text":"<p>Classification rules serve two key functions:</p> <ol> <li>Compliance mapping \u2014 Tag signals and nodes with framework controls (CIS CSC v8, NIST CSF, etc.) for compliance readiness reporting</li> <li>Operational categorization \u2014 Mark nodes as managed, internal, trusted, or infrastructure to support graph analysis and incident triage</li> </ol>"},{"location":"user-guide/signals/classification-rules/#how-classification-works","title":"How Classification Works","text":"<pre><code>flowchart LR\n    A[Signal/Node] --&gt; B{Match Classification Rule?}\n    B --&gt;|Yes| C[Apply Framework Tags]\n    B --&gt;|No| D[No Classification]\n    C --&gt; E[Compliance Reports]\n    C --&gt; F[Graph Node Properties]</code></pre> <p>Classification rules evaluate properties of signals and graph nodes. When a match occurs, the rule applies one or more framework tags that flow into compliance reporting and graph visualization.</p>"},{"location":"user-guide/signals/classification-rules/#viewing-classification-rules","title":"Viewing Classification Rules","text":"<p>The Classification Rules page displays all configured rules:</p> Column Description Name Descriptive rule name Conditions The matching criteria Frameworks Applied framework tags Node Type Target node type (IP, domain, host, etc.) Classification Operational category (managed, internal, trusted, infrastructure) Enabled Whether the rule is active"},{"location":"user-guide/signals/classification-rules/#framework-tags","title":"Framework Tags","text":"<p>Classification rules reference frameworks by integer index. The index is assigned by sorting framework machine names alphabetically:</p> Index Framework 3 CIS CSC v7 4 CIS CSC v8 9 NIST CSF <p>Framework Index Mapping</p> <p>The <code>graph_nodes.frameworks</code> column stores 1-based integer indices, not string IDs. The index is determined by alphabetical sort of framework machine names. Check Admin \u2192 Settings \u2192 Frameworks for the current mapping in your deployment.</p>"},{"location":"user-guide/signals/classification-rules/#node-classifications","title":"Node Classifications","text":"<p>Rules can assign one or more operational classifications to nodes:</p> Classification Description Example Managed Assets under organizational control Corporate workstations, servers Internal Entities within the network perimeter Internal IP ranges, private DNS Trusted Known-good entities Approved SaaS providers, CDN IPs Infrastructure Network and security infrastructure Firewalls, routers, DNS servers"},{"location":"user-guide/signals/classification-rules/#creating-a-classification-rule","title":"Creating a Classification Rule","text":"<ol> <li>Navigate to Signals \u2192 Classification Rules</li> <li>Click Create Rule</li> <li>Configure the rule:<ul> <li>Name: Descriptive name (e.g., \"Internal RFC1918 Addresses\")</li> <li>Node Type: Select the target entity type</li> <li>Conditions: Define matching criteria<ul> <li>Example: <code>ip_address STARTS_WITH 10.</code> OR <code>ip_address STARTS_WITH 192.168.</code></li> </ul> </li> <li>Classification: Select operational categories</li> <li>Frameworks: Select applicable framework controls</li> <li>Enabled: Toggle activation</li> </ul> </li> <li>Click Save</li> </ol>"},{"location":"user-guide/signals/classification-rules/#common-classification-patterns","title":"Common Classification Patterns","text":""},{"location":"user-guide/signals/classification-rules/#mark-internal-ip-ranges","title":"Mark Internal IP Ranges","text":"<p>Classify RFC 1918 addresses as internal and managed:</p> <ul> <li>Condition: <code>ip_address IN 10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16</code></li> <li>Classification: Internal, Managed</li> <li>Frameworks: CIS CSC v8</li> </ul>"},{"location":"user-guide/signals/classification-rules/#mark-security-infrastructure","title":"Mark Security Infrastructure","text":"<p>Classify firewall and IDS appliances:</p> <ul> <li>Condition: <code>node_type EQUALS security_appliance</code></li> <li>Classification: Infrastructure, Managed, Trusted</li> <li>Frameworks: CIS CSC v8, NIST CSF</li> </ul>"},{"location":"user-guide/signals/classification-rules/#mark-cloud-provider-ranges","title":"Mark Cloud Provider Ranges","text":"<p>Classify known cloud provider IP ranges:</p> <ul> <li>Condition: <code>ip_address IN &lt;cloud-provider-ranges&gt;</code></li> <li>Classification: Trusted</li> <li>Frameworks: NIST CSF</li> </ul>"},{"location":"user-guide/signals/classification-rules/#impact-on-reporting","title":"Impact on Reporting","text":"<p>Classification rules directly affect:</p> <ul> <li>Compliance Readiness (Reporter \u2192 Compliance) \u2014 Framework tag coverage determines compliance scores</li> <li>Graph Visualization (Graph \u2192 Nodes) \u2014 Classified nodes display with distinct visual indicators</li> <li>Executive Summary (Reporter \u2192 Executive) \u2014 Managed asset counts and coverage metrics</li> </ul> <p>Classification Changes Require Reprocessing</p> <p>Modifying classification rules affects future signals. Existing graph nodes are reclassified during the next graph processing cycle. Allow time for changes to propagate through the system.</p>"},{"location":"user-guide/signals/classification-rules/#best-practices","title":"Best Practices","text":"<ol> <li>Start with internal ranges: Classify your known IP ranges first to establish a baseline</li> <li>Layer classifications: Apply multiple classifications where appropriate (e.g., a firewall is both Infrastructure and Managed)</li> <li>Review unclassified nodes: Periodically check the Graph module for unclassified nodes that should be categorized</li> <li>Align with frameworks: Ensure your classification rules cover the controls required by your compliance frameworks</li> <li>Document exceptions: Use rule names to explain why specific entities receive certain classifications</li> </ol>"},{"location":"user-guide/signals/enrichment-settings/","title":"Enrichment Settings","text":"<p>Enrichment settings control how WitFoo Analytics augments raw signals with additional context. Enrichment adds GeoIP data, threat intelligence matches, MITRE ATT&amp;CK technique mappings, and other metadata to signals during ingestion.</p> <p>Navigate to: Signals \u2192 Enrichment Settings</p>"},{"location":"user-guide/signals/enrichment-settings/#enrichment-pipeline","title":"Enrichment Pipeline","text":"<pre><code>flowchart LR\n    A[Raw Signal] --&gt; B[GeoIP Lookup]\n    B --&gt; C[Threat Intel Match]\n    C --&gt; D[ATT&amp;CK Mapping]\n    D --&gt; E[DNS Resolution]\n    E --&gt; F[Enriched Signal]</code></pre> <p>Enrichment occurs automatically during signal ingestion. Each enrichment stage adds context to the signal before it is stored and evaluated by lead rules.</p>"},{"location":"user-guide/signals/enrichment-settings/#enrichment-types","title":"Enrichment Types","text":""},{"location":"user-guide/signals/enrichment-settings/#geoip-enrichment","title":"GeoIP Enrichment","text":"<p>Maps IP addresses to geographic locations, autonomous system numbers (ASN), and organization names.</p> <p>Enriched fields:</p> Field Description Example <code>geo_country</code> Country code <code>US</code> <code>geo_city</code> City name <code>San Francisco</code> <code>geo_latitude</code> Latitude coordinate <code>37.7749</code> <code>geo_longitude</code> Longitude coordinate <code>-122.4194</code> <code>geo_asn</code> Autonomous system number <code>AS15169</code> <code>geo_org</code> Organization name <code>Google LLC</code> <p>GeoIP Data Source</p> <p>GeoIP lookups use the Intel API service. In disconnected network deployments, GeoIP data is served from locally bundled databases.</p>"},{"location":"user-guide/signals/enrichment-settings/#threat-intelligence-enrichment","title":"Threat Intelligence Enrichment","text":"<p>Matches signal entities (IPs, domains, file hashes) against known threat intelligence indicators.</p> <p>Enriched fields:</p> Field Description Example <code>threat_matched</code> Whether a threat match was found <code>true</code> <code>threat_category</code> Threat category <code>malware</code>, <code>phishing</code>, <code>botnet</code> <code>threat_confidence</code> Match confidence score (0\u2013100) <code>95</code> <code>threat_source</code> Intelligence source <code>CyberGrid</code>, <code>OSINT</code>"},{"location":"user-guide/signals/enrichment-settings/#mitre-attck-mapping","title":"MITRE ATT&amp;CK Mapping","text":"<p>Maps signals to MITRE ATT&amp;CK techniques based on stream name, event type, and signal content.</p> <p>Enriched fields:</p> Field Description Example <code>attack_technique_ids</code> Matched ATT&amp;CK technique IDs <code>[\"T1078\", \"T1078.001\"]</code> <code>attack_tactic</code> Associated tactic <code>Initial Access</code> <p>The ATT&amp;CK enricher uses a three-tier matching strategy:</p> <ol> <li>Taxonomy lookup \u2014 Direct technique ID from the ATT&amp;CK taxonomy database</li> <li>Stream-name mapping \u2014 Maps 319 stream names to technique IDs across 22 security categories</li> <li>Direct technique matching \u2014 Matches technique IDs found in signal fields</li> </ol>"},{"location":"user-guide/signals/enrichment-settings/#dns-resolution","title":"DNS Resolution","text":"<p>Resolves IP addresses to hostnames and domains to IP addresses for correlation.</p> <p>Enriched fields:</p> Field Description Example <code>resolved_hostname</code> Hostname for an IP <code>web01.example.com</code> <code>resolved_ip</code> IP address for a domain <code>93.184.216.34</code>"},{"location":"user-guide/signals/enrichment-settings/#configuring-enrichment","title":"Configuring Enrichment","text":""},{"location":"user-guide/signals/enrichment-settings/#enablingdisabling-enrichment-types","title":"Enabling/Disabling Enrichment Types","text":"<ol> <li>Navigate to Signals \u2192 Enrichment Settings</li> <li>Toggle individual enrichment types on or off:<ul> <li>GeoIP Enrichment \u2014 Enable/disable geographic lookups</li> <li>Threat Intel Enrichment \u2014 Enable/disable threat intelligence matching</li> <li>ATT&amp;CK Mapping \u2014 Enable/disable MITRE ATT&amp;CK technique mapping</li> <li>DNS Resolution \u2014 Enable/disable DNS lookups</li> </ul> </li> <li>Changes take effect on the next ingested signal</li> </ol> <p>Performance Consideration</p> <p>Each enabled enrichment type adds processing time to signal ingestion. In high-volume environments, consider disabling enrichment types you don't actively use.</p>"},{"location":"user-guide/signals/enrichment-settings/#threat-intelligence-sources","title":"Threat Intelligence Sources","text":"<p>Configure which threat intelligence feeds are used for enrichment:</p> <ol> <li>Navigate to Signals \u2192 Enrichment Settings</li> <li>Scroll to the Threat Intelligence Sources section</li> <li>Enable or disable individual feeds</li> <li>Configure feed-specific settings (API keys, refresh intervals)</li> </ol> <p>Available sources include:</p> <ul> <li>CyberGrid Library \u2014 Community-sourced IOCs from the CyberGrid anonymous library</li> <li>Intel API \u2014 WitFoo's curated threat intelligence feed (requires license)</li> <li>Custom feeds \u2014 Organization-specific threat lists</li> </ul>"},{"location":"user-guide/signals/enrichment-settings/#geoip-configuration","title":"GeoIP Configuration","text":"<p>GeoIP enrichment is configured at the platform level:</p> <ul> <li>Online mode: GeoIP lookups query the Intel API in real time</li> <li>Offline mode: GeoIP data is served from locally bundled databases (for disconnected networks)</li> </ul> <p>Disconnected Networks</p> <p>For air-gapped deployments, GeoIP databases are bundled with the platform. See your administrator about updating offline GeoIP data.</p>"},{"location":"user-guide/signals/enrichment-settings/#viewing-enrichment-data","title":"Viewing Enrichment Data","text":"<p>Enrichment data appears in several locations:</p> <ul> <li>Signal detail page \u2014 Full enrichment data in the Enrichment section</li> <li>Search results \u2014 Enriched fields are searchable (e.g., <code>geo_country:US</code>)</li> <li>Graph nodes \u2014 GeoIP and threat intel data displayed on node properties</li> <li>Reporter \u2014 ATT&amp;CK coverage matrix uses enrichment data</li> </ul>"},{"location":"user-guide/signals/enrichment-settings/#troubleshooting","title":"Troubleshooting","text":"Symptom Possible Cause Resolution No GeoIP data on signals GeoIP enrichment disabled Enable in Enrichment Settings Missing ATT&amp;CK mappings Stream name not in mapping table Check if your data source has ATT&amp;CK coverage Threat intel not matching Feed not enabled or expired Verify feed configuration and API keys Enrichment slowing ingestion Too many enrichment types enabled Disable unused enrichment types"},{"location":"user-guide/signals/lead-rules/","title":"Lead Rules","text":"<p>Lead rules are the automated detection logic that promotes signals into incidents. When an incoming signal matches a lead rule's criteria, WitFoo Analytics creates or updates a work unit in the Observer module, escalating the event for analyst review.</p> <p>Navigate to: Signals \u2192 Rules</p>"},{"location":"user-guide/signals/lead-rules/#how-lead-rules-work","title":"How Lead Rules Work","text":"<pre><code>flowchart TD\n    A[Signal Ingested] --&gt; B{Match Lead Rule?}\n    B --&gt;|Yes| C[Create/Update Work Unit]\n    B --&gt;|No| D[Store Signal Only]\n    C --&gt; E[Assign MO Definition]\n    E --&gt; F[Available in Observer]</code></pre> <p>When a signal is ingested:</p> <ol> <li>The signal is evaluated against all active lead rules in priority order</li> <li>The first matching rule determines the incident classification</li> <li>A work unit is created (or an existing one is updated) in Observer</li> <li>The work unit is assigned the MO definition specified by the rule</li> </ol> <p>First-Match-Wins</p> <p>Lead rules use a serial first-match-wins pipeline. Once a signal matches a rule, no further rules are evaluated for that signal. Order your rules from most specific to most general.</p>"},{"location":"user-guide/signals/lead-rules/#viewing-lead-rules","title":"Viewing Lead Rules","text":"<p>The Rules page displays all configured lead rules in a table:</p> Column Description ID Unique numeric identifier Name Descriptive rule name Criteria The matching conditions MO Definition The incident type assigned on match Enabled Whether the rule is active Priority Evaluation order (lower = higher priority)"},{"location":"user-guide/signals/lead-rules/#rule-criteria","title":"Rule Criteria","text":"<p>Lead rules use field-based criteria to match signals. Each criterion specifies a field, an operator, and one or more values.</p>"},{"location":"user-guide/signals/lead-rules/#supported-operators","title":"Supported Operators","text":"Operator Description Example <code>EQUALS</code> Exact match <code>severity EQUALS 10</code> <code>NOT_EQUALS</code> Negation <code>status NOT_EQUALS success</code> <code>CONTAINS</code> Substring match <code>message CONTAINS brute force</code> <code>CONTAINS_ANY</code> Array contains any value from list <code>attack_technique_ids CONTAINS_ANY T1078,T1110</code> <code>STARTS_WITH</code> Prefix match <code>src_ip STARTS_WITH 10.0</code> <code>GREATER_THAN</code> Numeric comparison <code>severity GREATER_THAN 7</code> <code>LESS_THAN</code> Numeric comparison <code>dst_port LESS_THAN 1024</code> <code>IN</code> Value in list <code>stream_name IN ids_alert,fw_deny</code> <code>REGEX</code> Regular expression <code>username REGEX ^admin.*</code>"},{"location":"user-guide/signals/lead-rules/#multiple-criteria","title":"Multiple Criteria","text":"<p>Rules can combine multiple criteria. All criteria must match for the rule to trigger (AND logic).</p> <pre><code>stream_name EQUALS ids_alert\nAND severity GREATER_THAN 7\nAND NOT src_ip STARTS_WITH 10.\n</code></pre>"},{"location":"user-guide/signals/lead-rules/#managing-lead-rules","title":"Managing Lead Rules","text":""},{"location":"user-guide/signals/lead-rules/#creating-a-lead-rule","title":"Creating a Lead Rule","text":"<ol> <li>Navigate to Signals \u2192 Rules</li> <li>Click Create Rule</li> <li>Fill in the rule configuration:<ul> <li>Name: A descriptive name (e.g., \"High-Severity External IDS Alerts\")</li> <li>Priority: Evaluation order (lower numbers evaluated first)</li> <li>MO Definition: Select the incident type from the dropdown</li> <li>Criteria: Add one or more matching conditions</li> <li>Enabled: Toggle to activate the rule</li> </ul> </li> <li>Click Save</li> </ol>"},{"location":"user-guide/signals/lead-rules/#editing-a-lead-rule","title":"Editing a Lead Rule","text":"<ol> <li>Find the rule in the table</li> <li>Click the rule row to open the editor</li> <li>Modify the desired fields</li> <li>Click Save</li> </ol>"},{"location":"user-guide/signals/lead-rules/#enablingdisabling-a-rule","title":"Enabling/Disabling a Rule","text":"<p>Toggle the Enabled switch in the rule row to activate or deactivate a rule without deleting it. Disabled rules are skipped during signal evaluation.</p> <p>Rule Changes Are Immediate</p> <p>Lead rule changes take effect immediately on new incoming signals. Existing signals and work units are not retroactively affected.</p>"},{"location":"user-guide/signals/lead-rules/#built-in-rule-ranges","title":"Built-In Rule Ranges","text":"<p>WitFoo Analytics ships with pre-configured lead rules organized by ID range:</p> ID Range Category Description 1\u201310 Core Fundamental detection rules 100\u2013113 MITRE ATT&amp;CK Tactic-based detection rules using <code>CONTAINS_ANY</code> on ATT&amp;CK technique IDs 200\u2013214 Malcolm/Zeek/Suricata Network telemetry rules for CISA Malcolm deployments <p>Custom Rule IDs</p> <p>When creating custom rules, use ID 300 or higher to avoid conflicts with built-in rules that may be updated in future releases.</p>"},{"location":"user-guide/signals/lead-rules/#best-practices","title":"Best Practices","text":"<ol> <li>Order by specificity: Place narrow, specific rules before broad catch-all rules</li> <li>Use meaningful names: Include the data source and detection intent in the rule name</li> <li>Test before enabling: Create rules in a disabled state, review matching signals, then enable</li> <li>Review regularly: Audit lead rules quarterly to remove obsolete rules and tune noisy ones</li> <li>Document criteria: Use the rule name and description to explain why the rule exists</li> </ol>"},{"location":"user-guide/signals/lead-rules/#synced-rules","title":"Synced Rules","text":"<p>Lead rules can be synced from the Intel API when a valid license is configured. Synced rules are updated automatically at startup and cannot be edited locally. They appear with a Synced badge in the rules table.</p> <p>To manage synced rules, contact your WitFoo administrator about license configuration.</p>"},{"location":"user-guide/signals/search/","title":"Signal Search","text":"<p>The Signal Search page is your primary interface for querying security events across all connected data sources. Use field-level filters, time ranges, and boolean operators to find specific signals.</p> <p>Navigate to: Signals \u2192 Search</p>"},{"location":"user-guide/signals/search/#search-interface","title":"Search Interface","text":"<p>The search page consists of:</p> <ol> <li>Search bar \u2014 Enter your query at the top of the page</li> <li>Time range selector \u2014 Choose a predefined or custom time window</li> <li>Filter panel \u2014 Refine results by field values</li> <li>Results table \u2014 Paginated signal list with sortable columns</li> <li>Signal detail \u2014 Click any row to view full signal details</li> </ol>"},{"location":"user-guide/signals/search/#search-syntax","title":"Search Syntax","text":""},{"location":"user-guide/signals/search/#basic-queries","title":"Basic Queries","text":"<p>Type any value into the search bar to perform a full-text search across all signal fields:</p> <pre><code>192.168.1.100\n</code></pre> <pre><code>failed authentication\n</code></pre>"},{"location":"user-guide/signals/search/#field-specific-queries","title":"Field-Specific Queries","text":"<p>Use <code>field:value</code> syntax to search specific fields:</p> <pre><code>src_ip:192.168.1.100\n</code></pre> <pre><code>dst_port:443\n</code></pre> <pre><code>username:jsmith\n</code></pre>"},{"location":"user-guide/signals/search/#boolean-operators","title":"Boolean Operators","text":"<p>Combine conditions with <code>AND</code>, <code>OR</code>, and <code>NOT</code>:</p> <pre><code>src_ip:10.0.0.50 AND dst_port:22\n</code></pre> <pre><code>event_type:authentication AND NOT status:success\n</code></pre> <pre><code>src_ip:192.168.1.100 OR src_ip:192.168.1.101\n</code></pre> <p>Operator Case Sensitivity</p> <p>Boolean operators must be uppercase: <code>AND</code>, <code>OR</code>, <code>NOT</code>. Lowercase <code>and</code>, <code>or</code>, <code>not</code> are treated as search terms.</p>"},{"location":"user-guide/signals/search/#wildcard-queries","title":"Wildcard Queries","text":"<p>Use <code>*</code> for wildcard matching:</p> <pre><code>src_ip:10.0.0.*\n</code></pre> <pre><code>hostname:web-server-*\n</code></pre>"},{"location":"user-guide/signals/search/#range-queries","title":"Range Queries","text":"<p>Use comparison operators for numeric fields:</p> <pre><code>severity:&gt;=7\n</code></pre> <pre><code>dst_port:&gt;1024\n</code></pre>"},{"location":"user-guide/signals/search/#quoted-strings","title":"Quoted Strings","text":"<p>Use double quotes for exact phrase matching:</p> <pre><code>message:\"login failed for user\"\n</code></pre>"},{"location":"user-guide/signals/search/#time-range-selection","title":"Time Range Selection","text":"<p>The time range selector offers predefined windows:</p> Option Description Last 15 minutes Most recent 15 minutes Last 1 hour Most recent hour Last 4 hours Most recent 4 hours Last 24 hours Most recent 24 hours Last 7 days Most recent week Last 30 days Most recent month Custom Specify start and end timestamps <p>Default Time Range</p> <p>The default time range is Last 24 hours. Adjust this before running broad queries to avoid long load times.</p>"},{"location":"user-guide/signals/search/#filters","title":"Filters","text":"<p>The filter panel on the left side provides faceted filtering:</p> <ul> <li>Stream Name \u2014 Filter by data source type (e.g., <code>ids_alert</code>, <code>auth_login</code>)</li> <li>Severity \u2014 Filter by severity level (Critical, High, Medium, Low, Info)</li> <li>Source IP \u2014 Filter by source IP address</li> <li>Destination IP \u2014 Filter by destination IP address</li> <li>Event Type \u2014 Filter by event category</li> <li>Product \u2014 Filter by originating security tool</li> </ul> <p>Click a filter value to add it to your query. Click again to remove it.</p>"},{"location":"user-guide/signals/search/#working-with-results","title":"Working with Results","text":""},{"location":"user-guide/signals/search/#sorting","title":"Sorting","text":"<p>Click any column header to sort results. Click again to reverse sort order. The default sort is by timestamp (newest first).</p>"},{"location":"user-guide/signals/search/#pagination","title":"Pagination","text":"<p>Results are paginated with configurable page sizes. Use the pagination controls at the bottom of the table to navigate between pages.</p>"},{"location":"user-guide/signals/search/#column-selection","title":"Column Selection","text":"<p>Click the column settings icon to show or hide columns in the results table.</p>"},{"location":"user-guide/signals/search/#saved-searches","title":"Saved Searches","text":"<p>Save frequently used queries for quick access.</p>"},{"location":"user-guide/signals/search/#saving-a-search","title":"Saving a Search","text":"<ol> <li>Enter your query and apply desired filters</li> <li>Click the Save button in the search toolbar</li> <li>Enter a descriptive name for the search</li> <li>Click Confirm</li> </ol>"},{"location":"user-guide/signals/search/#loading-a-saved-search","title":"Loading a Saved Search","text":"<ol> <li>Click the Saved Searches dropdown in the search toolbar</li> <li>Select a saved search from the list</li> <li>The query and filters are restored automatically</li> </ol>"},{"location":"user-guide/signals/search/#managing-saved-searches","title":"Managing Saved Searches","text":"<p>To delete a saved search, open the Saved Searches dropdown, hover over the search name, and click the delete icon.</p>"},{"location":"user-guide/signals/search/#common-search-patterns","title":"Common Search Patterns","text":""},{"location":"user-guide/signals/search/#find-failed-logins-from-external-ips","title":"Find Failed Logins from External IPs","text":"<pre><code>event_type:authentication AND status:failure AND NOT src_ip:10.0.0.*\n</code></pre>"},{"location":"user-guide/signals/search/#find-high-severity-ids-alerts","title":"Find High-Severity IDS Alerts","text":"<pre><code>stream_name:ids_alert AND severity:&gt;=7\n</code></pre>"},{"location":"user-guide/signals/search/#find-dns-queries-to-suspicious-domains","title":"Find DNS Queries to Suspicious Domains","text":"<pre><code>stream_name:dns_query AND dst_domain:*.xyz\n</code></pre>"},{"location":"user-guide/signals/search/#find-lateral-movement-indicators","title":"Find Lateral Movement Indicators","text":"<pre><code>dst_port:445 AND src_ip:10.* AND dst_ip:10.*\n</code></pre>"},{"location":"user-guide/signals/search/#find-signals-with-attck-technique-mapping","title":"Find Signals with ATT&amp;CK Technique Mapping","text":"<pre><code>attack_technique_ids:T1078\n</code></pre> <p>Search Performance</p> <p>Queries spanning more than 7 days across all stream names may take longer to return. Narrow your time range or add field filters to improve performance.</p>"},{"location":"user-guide/signals/search/#exporting-results","title":"Exporting Results","text":"<p>Click the Export CSV button in the toolbar to download the current result set as a CSV file. The export respects your current query, filters, and time range.</p>"}]}