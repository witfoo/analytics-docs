# Rule: Unauthorized File Transfer
# ID: b66c2977-3f6b-5d5f-a90b-f199836711a2
# Generated by WitFoo Sigma Converter


| rex field=fileName "(?<fileNameMatch>.+)"
| eval fileNameCondition=if(isnotnull(fileNameMatch), "true", "false")
| search protocol IN ("*FTP*", "*SCP*", "*SFTP*") OR (serverPort IN ("21", "22", "69") fileNameCondition="true") | table clientIP,serverIP,serverPort,protocol,fileName,totalBytes,userName
