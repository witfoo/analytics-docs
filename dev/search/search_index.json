{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"WitFoo Analytics Documentation","text":"<p>Welcome to the official documentation for WitFoo Analytics \u2014 a security operations platform that transforms raw security data into actionable intelligence.</p>"},{"location":"#platform-overview","title":"Platform Overview","text":"<p>WitFoo Analytics ingests security artifacts from your infrastructure, correlates them into incidents, and provides comprehensive reporting, compliance tracking, and threat intelligence capabilities.</p> <ul> <li> <p> Signals</p> <p>Search, classify, and enrich security artifacts with lead rules and automated classification.</p> <p> User Guide</p> </li> <li> <p> Graph</p> <p>Visualize relationships between network nodes and edges for threat mapping and asset management.</p> <p> User Guide</p> </li> <li> <p> Observer</p> <p>Monitor work units, collections, and observations with customizable MO definitions.</p> <p> User Guide</p> </li> <li> <p> Reporter</p> <p>Executive summaries, compliance readiness, tool effectiveness analysis, and cost/savings reports.</p> <p> User Guide</p> </li> <li> <p> CyberGrid</p> <p>Subscribe to and publish threat intelligence feeds across organizations.</p> <p> User Guide</p> </li> <li> <p> Health</p> <p>Monitor container health, system resources, and configure alerting thresholds.</p> <p> User Guide</p> </li> </ul>"},{"location":"#quick-links","title":"Quick Links","text":"Resource Description Getting Started Installation, first login, and architecture overview Admin Guide User management, roles, permissions, and system settings API Reference REST API documentation for 150+ endpoints AI &amp; MCP AI assistant configuration and MCP server integration Deployment Docker Compose, WFA, TLS, and monitoring setup Reference Permissions matrix, environment variables, and schema"},{"location":"#witfoo-resources","title":"WitFoo Resources","text":"Resource Access Notes Documentation Open All WitFoo Product, API, MCP, and User Documentation Discussions GitHub Account Public conversations on WitFoo Products Downloads Open Download or Launch WitFoo Appliances Release Notes Open WitFoo product release notes and changelogs Demo Open Live demo of WitFoo Analytics Platform Open Ticket Open Open a (private) ticket with the WitFoo team. Can be product or business related. Training Free Registration (click Sign Up) Official WitFoo training courses for users, engineers, and partners. Includes WitFoo Certifications (upon passing exams.) LinkedIn Open Public Updates and Social Engagement Videos Open WitFoo Public videos (training and marketing) WWW Open WitFoo official website"},{"location":"admin-guide/","title":"Admin Guide","text":"<p>The Admin Guide covers system configuration and user management for WitFoo Analytics administrators.</p>"},{"location":"admin-guide/#sections","title":"Sections","text":""},{"location":"admin-guide/#users","title":"Users","text":"<p>Create, edit, and manage user accounts.</p>"},{"location":"admin-guide/#roles","title":"Roles","text":"<p>Configure role-based access control with predefined and custom roles.</p>"},{"location":"admin-guide/#permissions","title":"Permissions","text":"<p>Understand the permission system \u2014 63 permissions across 11 categories.</p>"},{"location":"admin-guide/#settings","title":"Settings","text":"<p>Configure business metrics, compliance frameworks, authentication, notifications, and certificates.</p>"},{"location":"admin-guide/#conductor","title":"Conductor","text":"<p>Manage the Conductor signal pipeline for log collection.</p>"},{"location":"admin-guide/#quick-reference","title":"Quick Reference","text":"Task Location Create a user Admin &gt; Users &gt; Create User Change a role Admin &gt; Roles &gt; Edit Set primary framework Admin &gt; Settings &gt; Frameworks Configure SMTP Admin &gt; Settings &gt; Notifications Upload TLS cert Admin &gt; Settings &gt; Certificates"},{"location":"admin-guide/conductor/","title":"Conductor","text":"<p>Conductor is WitFoo's signal pipeline for collecting, parsing, and exporting security logs to WitFoo Analytics.</p>"},{"location":"admin-guide/conductor/#architecture","title":"Architecture","text":"<pre><code>graph LR\n    S[Syslog/Beats Sources] --&gt; SS[Signal Server]\n    SS --&gt; SP[Signal Parser]\n    SP --&gt; AF[Artifact Filter]\n    AF --&gt; AE[Artifact Exporter]\n    AE --&gt; AI[Analytics Artifact Ingestion]</code></pre>"},{"location":"admin-guide/conductor/#services","title":"Services","text":"Service Port Description Signal Server 514/udp, 514/tcp, 5044, 6514 Receives syslog and Beats input Signal Parser Internal Parses raw signals into structured data Artifact Filter Internal Filters and normalizes artifacts Artifact Exporter Internal Sends artifacts to Analytics via HMAC-authenticated HTTP Broker 4223, 8223 NATS JetStream for inter-service messaging"},{"location":"admin-guide/conductor/#hmac-authentication","title":"HMAC Authentication","text":"<p>The Artifact Exporter authenticates with Analytics using HMAC-SHA256:</p> <ol> <li>Body hash: <code>hex(SHA256(body))</code></li> <li>Message: <code>timestamp + \".\" + bodyHash</code></li> <li>Signature: <code>hex(HMAC-SHA256(secret, message))</code></li> </ol> <p>Configured via <code>ANALYTICS_SECRET</code> on both Conductor and Analytics.</p>"},{"location":"admin-guide/conductor/#management","title":"Management","text":""},{"location":"admin-guide/conductor/#startstop","title":"Start/Stop","text":"<pre><code># Using management script\n./scripts/dev-conductor.sh start\n./scripts/dev-conductor.sh stop\n./scripts/dev-conductor.sh status\n</code></pre>"},{"location":"admin-guide/conductor/#conductor-ui","title":"Conductor UI","text":"<p>Access the Conductor UI through the Analytics reverse proxy. Requires <code>conductor:read</code> permission. The UI uses JWT auth bridge \u2014 Analytics JWT tokens are validated and mapped to Conductor roles.</p>"},{"location":"admin-guide/conductor/#permissions","title":"Permissions","text":"Permission Access Level <code>conductor:read</code> View Conductor UI <code>conductor:write</code> Configure Conductor <code>conductor:admin</code> Full Conductor administration"},{"location":"admin-guide/permissions/","title":"Permissions","text":"<p>WitFoo Analytics uses a granular permission system with 63 permissions across 11 categories.</p>"},{"location":"admin-guide/permissions/#permission-categories","title":"Permission Categories","text":"Category Permissions Description signals read, write, manage Artifact search and incident management observer read, write, manage Work tracking and observations reports read, write, manage Reporter module access frameworks read, write, manage Compliance framework management cybergrid read, write, manage Threat intelligence operations health read, manage System health monitoring metrics read Prometheus metrics access settings read, manage System configuration admin (grants all) Full administrative access ai read, write, manage, export AI assistant features conductor read, write, admin Conductor pipeline management"},{"location":"admin-guide/permissions/#permission-hierarchy","title":"Permission Hierarchy","text":"<pre><code>manage \u2192 write \u2192 read\n</code></pre> <p>Granting <code>manage</code> automatically includes <code>write</code> and <code>read</code>. Granting <code>write</code> includes <code>read</code>.</p>"},{"location":"admin-guide/permissions/#service-level-rules","title":"Service-Level Rules","text":"<ul> <li>The <code>admin</code> permission grants all permissions in all categories</li> <li>Permission checks use constant-time comparison</li> <li>Permissions are stored in JWT tokens and validated on each request</li> </ul>"},{"location":"admin-guide/roles/","title":"Roles","text":"<p>Roles define what users can access in WitFoo Analytics. Each user is assigned exactly one role.</p>"},{"location":"admin-guide/roles/#built-in-roles","title":"Built-in Roles","text":"Role Description Key Permissions Admin Full system access All permissions Analyst Security analyst Signals, graph, observer, reports Auditor Compliance auditor Read-only reports and frameworks ReadOnly Stakeholder view Read-only dashboards HealthMonitor Operations staff Health and metrics CyberGridManager Intel analyst CyberGrid operations Reporter Report consumer Reports read-only AIUser AI assistant user AI chat and read access"},{"location":"admin-guide/roles/#permission-inclusion-rules","title":"Permission Inclusion Rules","text":"<ul> <li><code>admin</code> permission grants ALL other permissions</li> <li><code>resource:manage</code> grants <code>resource:write</code> and <code>resource:read</code></li> <li><code>resource:write</code> grants <code>resource:read</code></li> </ul>"},{"location":"admin-guide/roles/#custom-roles","title":"Custom Roles","text":"<ol> <li>Navigate to Admin &gt; Roles</li> <li>Click Create Role</li> <li>Enter a role name</li> <li>Select permissions from the checklist</li> <li>Click Save</li> </ol>"},{"location":"admin-guide/roles/#role-assignment","title":"Role Assignment","text":"<p>Change a user's role from Admin &gt; Users &gt; Edit user &gt; Role dropdown.</p>"},{"location":"admin-guide/users/","title":"Users","text":"<p>Manage user accounts for your WitFoo Analytics deployment.</p>"},{"location":"admin-guide/users/#user-properties","title":"User Properties","text":"Field Description Email Login identifier (unique) Name Display name Role Assigned role determining permissions Status Active or Disabled Last login Most recent authentication"},{"location":"admin-guide/users/#creating-users","title":"Creating Users","text":"<ol> <li>Navigate to Admin &gt; Users</li> <li>Click Create User</li> <li>Enter email, name, and temporary password</li> <li>Select a role</li> <li>Click Save</li> </ol> <p>The user must change their temporary password on first login.</p>"},{"location":"admin-guide/users/#editing-users","title":"Editing Users","text":"<p>Click a user row to edit. You can change:</p> <ul> <li>Name and email</li> <li>Assigned role</li> <li>Account status (active/disabled)</li> </ul>"},{"location":"admin-guide/users/#deleting-users","title":"Deleting Users","text":"<p>Click Delete on a user row. Deleted users cannot log in but their historical work data is preserved.</p>"},{"location":"admin-guide/users/#default-admin-account","title":"Default Admin Account","text":"Field Value Username <code>admin</code> Password <code>F00theN0ise!</code> <p>Change Default Password</p> <p>Change the default admin password immediately after first login.</p>"},{"location":"admin-guide/settings/","title":"Settings","text":"<p>System-wide configuration for WitFoo Analytics.</p>"},{"location":"admin-guide/settings/#settings-pages","title":"Settings Pages","text":""},{"location":"admin-guide/settings/#business-metrics","title":"Business Metrics","text":"<p>Configure financial and operational metrics used by the Reporter module.</p>"},{"location":"admin-guide/settings/#frameworks","title":"Frameworks","text":"<p>Enable compliance frameworks and set the primary framework.</p>"},{"location":"admin-guide/settings/#authentication","title":"Authentication","text":"<p>Configure LDAP, SAML, and local authentication settings.</p>"},{"location":"admin-guide/settings/#notifications","title":"Notifications","text":"<p>Set up email, Slack, and webhook notification channels.</p>"},{"location":"admin-guide/settings/#certificates","title":"Certificates","text":"<p>Manage TLS certificates for HTTPS and internal service communication.</p>"},{"location":"admin-guide/settings/#access","title":"Access","text":"<p>Navigate to Admin &gt; Settings from the main navigation. Requires <code>settings:read</code> permission to view, <code>settings:manage</code> to modify.</p>"},{"location":"admin-guide/settings/authentication/","title":"Authentication","text":"<p>Configure authentication methods for WitFoo Analytics.</p>"},{"location":"admin-guide/settings/authentication/#authentication-methods","title":"Authentication Methods","text":""},{"location":"admin-guide/settings/authentication/#local-authentication","title":"Local Authentication","text":"<p>Default method using username/password stored in Cassandra with bcrypt hashing.</p>"},{"location":"admin-guide/settings/authentication/#ldap","title":"LDAP","text":"<p>Connect to an LDAP directory (Active Directory, OpenLDAP) for centralized authentication.</p> Setting Description Server URL LDAP server address (ldap:// or ldaps://) Bind DN Distinguished name for LDAP queries Bind Password Password for the bind account Search Base Base DN for user searches User Filter LDAP filter for matching users"},{"location":"admin-guide/settings/authentication/#saml","title":"SAML","text":"<p>SAML 2.0 single sign-on integration for enterprise identity providers.</p> Setting Description Entity ID Service provider entity ID SSO URL Identity provider SSO endpoint Certificate IdP X.509 certificate for signature validation Attribute Mapping Map SAML attributes to user fields"},{"location":"admin-guide/settings/authentication/#configuration","title":"Configuration","text":"<p>Navigate to Admin &gt; Settings &gt; Authentication. Requires <code>settings:manage</code> permission.</p> <p>Encryption Required</p> <p>LDAP and SAML credentials are encrypted at rest using AES-256-GCM. Set <code>AUTH_CONFIG_ENCRYPTION_KEY</code> environment variable.</p>"},{"location":"admin-guide/settings/business-metrics/","title":"Business Metrics","text":"<p>Configure financial and operational parameters used by the Reporter module for cost/savings analysis.</p>"},{"location":"admin-guide/settings/business-metrics/#settings","title":"Settings","text":"Setting Default Description Annual Revenue $0 Organization's annual revenue Annual Security Spend $0 Total security budget FTE Count 3 Security team headcount Investigation Time 1.5 hours Average investigation time per incident Restore Time 0.75 hours Average remediation time per incident FTE Hourly Rate $75 Average analyst hourly rate"},{"location":"admin-guide/settings/business-metrics/#product-costs","title":"Product Costs","text":"<p>Configure annual costs for each security product. Products appear in the Tool Effectiveness report.</p> <ol> <li>Click Add Product</li> <li>Enter product name and annual cost</li> <li>Default cost: $100,000 if not specified</li> </ol>"},{"location":"admin-guide/settings/business-metrics/#how-settings-are-used","title":"How Settings Are Used","text":"<ul> <li>FTE Needed = (Incidents * (Investigation + Restore Time)) / 2,080 hours</li> <li>Security Spend % = Annual Security Spend / Annual Revenue * 100</li> <li>Cost per Incident = (Personnel + Product Costs) / Total Incidents</li> </ul>"},{"location":"admin-guide/settings/business-metrics/#configuration","title":"Configuration","text":"<p>Navigate to Admin &gt; Settings &gt; Business Metrics. Requires <code>settings:manage</code> permission.</p> <p>Financial Defaults</p> <p>Financial fields intentionally default to zero. The system does not auto-fill these values because organizations may set them to zero deliberately.</p>"},{"location":"admin-guide/settings/certificates/","title":"Certificates","text":"<p>Manage TLS certificates for HTTPS access and internal service communication.</p>"},{"location":"admin-guide/settings/certificates/#certificate-management","title":"Certificate Management","text":""},{"location":"admin-guide/settings/certificates/#upload-certificate","title":"Upload Certificate","text":"<ol> <li>Navigate to Admin &gt; Settings &gt; Certificates</li> <li>Click Upload Certificate</li> <li>Provide the certificate file (PEM format) and private key</li> <li>Click Save</li> </ol>"},{"location":"admin-guide/settings/certificates/#certificate-validation","title":"Certificate Validation","text":"<p>Uploaded certificates are validated before acceptance:</p> <ul> <li>X.509 format verification</li> <li>Key pair matching (certificate + private key)</li> <li>Expiration date check</li> </ul>"},{"location":"admin-guide/settings/certificates/#hot-reload","title":"Hot-Reload","text":"<p>The reverse proxy supports certificate hot-reload. When a new certificate is uploaded, it takes effect immediately without restarting services. This uses the <code>tls.Config.GetCertificate</code> callback pattern.</p>"},{"location":"admin-guide/settings/certificates/#self-signed-certificates","title":"Self-Signed Certificates","text":"<p>For development and testing, WitFoo Analytics generates a self-signed certificate on first boot. Replace it with a trusted certificate for production use.</p>"},{"location":"admin-guide/settings/certificates/#certificate-storage","title":"Certificate Storage","text":"<ul> <li>Certificates are stored in Cassandra</li> <li>Private keys are encrypted at rest using AES-256-GCM</li> <li>File permissions: private keys 0600, certificates 0644</li> </ul>"},{"location":"admin-guide/settings/frameworks/","title":"Frameworks","text":"<p>Enable and configure compliance frameworks for the Compliance Readiness report.</p>"},{"location":"admin-guide/settings/frameworks/#available-frameworks","title":"Available Frameworks","text":"Framework Description CIS CSC v8 Center for Internet Security Controls v8 NIST CSF NIST Cybersecurity Framework Custom Frameworks imported via Intel API"},{"location":"admin-guide/settings/frameworks/#enabling-frameworks","title":"Enabling Frameworks","text":"<ol> <li>Navigate to Admin &gt; Settings &gt; Frameworks</li> <li>Toggle frameworks on/off</li> <li>Click Save</li> </ol>"},{"location":"admin-guide/settings/frameworks/#primary-framework","title":"Primary Framework","text":"<p>Set one framework as Primary for default selection in compliance views:</p> <ol> <li>Click the Primary radio button next to the desired framework</li> <li>The primary framework is auto-selected in Reporter compliance views</li> </ol>"},{"location":"admin-guide/settings/frameworks/#framework-sync","title":"Framework Sync","text":"<p>Frameworks sync from intel.witfoo.com when <code>WF_LICENSE</code> is configured. Without a license, frameworks use locally seeded data.</p>"},{"location":"admin-guide/settings/frameworks/#control-structure","title":"Control Structure","text":"<p>Each framework contains controls with:</p> Field Description Control ID Unique identifier within the framework Name Human-readable control name Focus Type: computer, user, infrastructure device, or product Description What the control requires"},{"location":"admin-guide/settings/notifications/","title":"Notifications","text":"<p>Configure notification channels and rules for automated alerting.</p>"},{"location":"admin-guide/settings/notifications/#notification-channels","title":"Notification Channels","text":""},{"location":"admin-guide/settings/notifications/#email-smtp","title":"Email (SMTP)","text":"Setting Description SMTP Host Mail server hostname SMTP Port Mail server port (25, 465, 587) Username SMTP authentication username Password SMTP authentication password From Address Sender email address TLS Mode None, StartTLS, or TLS"},{"location":"admin-guide/settings/notifications/#slack","title":"Slack","text":"Setting Description Webhook URL Slack incoming webhook URL Channel Default channel (optional)"},{"location":"admin-guide/settings/notifications/#webhook","title":"Webhook","text":"Setting Description URL HTTP endpoint Method POST, PUT, or PATCH Auth Type None, Bearer token, or Basic auth Headers Custom HTTP headers"},{"location":"admin-guide/settings/notifications/#testing-channels","title":"Testing Channels","text":"<p>Click Test on any channel to send a test notification and verify connectivity.</p>"},{"location":"admin-guide/settings/notifications/#notification-rules","title":"Notification Rules","text":"<p>Create rules that trigger notifications on specific events:</p> <ul> <li><code>incident.created</code> \u2014 New incident detected</li> <li><code>incident.status_changed</code> \u2014 Incident status updated</li> <li><code>incident.severity_changed</code> \u2014 Severity escalation/de-escalation</li> <li><code>incident.assigned</code> \u2014 Incident assigned to analyst</li> <li><code>incident.note_added</code> \u2014 Note added to incident</li> </ul>"},{"location":"admin-guide/settings/notifications/#cooldown","title":"Cooldown","text":"<p>Each rule has a cooldown period (default: 15 minutes) preventing duplicate notifications for the same condition.</p>"},{"location":"admin-guide/settings/notifications/#configuration","title":"Configuration","text":"<p>Navigate to Admin &gt; Settings &gt; Notifications. Requires <code>settings:manage</code> permission.</p> <p>Encryption</p> <p>Channel credentials are encrypted at rest. Set <code>AUTH_CONFIG_ENCRYPTION_KEY</code> environment variable.</p>"},{"location":"ai/","title":"AI &amp; MCP","text":"<p>WitFoo Analytics includes an AI assistant powered by large language models, with a Model Context Protocol (MCP) server for tool-augmented conversations.</p>"},{"location":"ai/#components","title":"Components","text":""},{"location":"ai/#configuration","title":"Configuration","text":"<p>Configure AI providers, models, and API keys.</p>"},{"location":"ai/#chat-interface","title":"Chat Interface","text":"<p>Use the AI chat panel for security analysis assistance.</p>"},{"location":"ai/#mcp-server","title":"MCP Server","text":"<p>Technical reference for the MCP server providing tool access to AI models.</p>"},{"location":"ai/#overview","title":"Overview","text":"<p>The AI assistant helps analysts with:</p> <ul> <li>Incident investigation and triage guidance</li> <li>Artifact analysis and enrichment interpretation</li> <li>Report generation and summary</li> <li>Compliance mapping assistance</li> </ul>"},{"location":"ai/#permissions","title":"Permissions","text":"Permission Access <code>ai:read</code> Use AI chat <code>ai:write</code> Manage chat sessions <code>ai:manage</code> Configure AI providers <code>ai:export</code> Export chat transcripts"},{"location":"ai/chat/","title":"Chat Interface","text":"<p>The AI chat panel provides conversational access to AI-powered security analysis within WitFoo Analytics.</p>"},{"location":"ai/chat/#accessing-chat","title":"Accessing Chat","text":"<ul> <li>Chat Panel \u2014 Click the chat icon in the navigation bar or press <code>Ctrl+/</code> to toggle the side panel</li> <li>Chat Page \u2014 Navigate to the dedicated chat page for full-screen conversations</li> </ul>"},{"location":"ai/chat/#features","title":"Features","text":"<ul> <li>Context-aware \u2014 The AI has access to your current page context (incidents, nodes, reports)</li> <li>Multi-session \u2014 Maintain multiple chat sessions for different investigations</li> <li>Tool-augmented \u2014 The AI can query your data through MCP tools when enabled</li> <li>History \u2014 Chat sessions are persisted and can be resumed</li> </ul>"},{"location":"ai/chat/#chat-panel","title":"Chat Panel","text":"<p>The chat panel slides in from the right side of the screen (400px width). It renders on any page when the user has <code>ai:read</code> permission.</p>"},{"location":"ai/chat/#keyboard-shortcut","title":"Keyboard Shortcut","text":"<p>Press <code>Ctrl+/</code> to toggle the chat panel open/closed.</p>"},{"location":"ai/chat/#sessions","title":"Sessions","text":""},{"location":"ai/chat/#create-a-session","title":"Create a Session","text":"<p>Click New Chat to start a fresh conversation. Each session maintains its own context and history.</p>"},{"location":"ai/chat/#resume-a-session","title":"Resume a Session","text":"<p>Click any session in the session list to resume the conversation.</p>"},{"location":"ai/chat/#delete-a-session","title":"Delete a Session","text":"<p>Click the delete icon on a session to remove it and its message history.</p>"},{"location":"ai/chat/#permissions","title":"Permissions","text":"Action Required Permission Use chat <code>ai:read</code> Delete sessions <code>ai:write</code> Export transcripts <code>ai:export</code>"},{"location":"ai/configuration/","title":"AI Configuration","text":"<p>Configure AI providers and model settings for the WitFoo Analytics AI assistant.</p>"},{"location":"ai/configuration/#provider-setup","title":"Provider Setup","text":"<p>Navigate to Admin &gt; AI &gt; Configuration to manage AI providers.</p>"},{"location":"ai/configuration/#supported-providers","title":"Supported Providers","text":"Provider Models Description Anthropic Claude family Recommended for security analysis OpenAI GPT family Alternative provider"},{"location":"ai/configuration/#configuration-fields","title":"Configuration Fields","text":"Field Description Provider AI service provider API Key Provider API key (encrypted at rest) Model Specific model to use Temperature Response creativity (0.0 - 1.0) Max Tokens Maximum response length"},{"location":"ai/configuration/#mcp-configuration","title":"MCP Configuration","text":"<p>Configure which MCP tools are available to the AI assistant. See MCP Configuration for details.</p>"},{"location":"ai/configuration/#permissions","title":"Permissions","text":"<p>Requires <code>ai:manage</code> permission to access configuration pages.</p>"},{"location":"ai/mcp/","title":"MCP Server","text":"<p>WitFoo Analytics includes a Model Context Protocol (MCP) server that provides AI models with structured access to security data through well-defined tools.</p>"},{"location":"ai/mcp/#what-is-mcp","title":"What is MCP?","text":"<p>The Model Context Protocol is an open standard for connecting AI models to external data sources and tools. WitFoo's MCP server exposes platform capabilities as MCP tools that AI assistants can invoke during conversations.</p>"},{"location":"ai/mcp/#sections","title":"Sections","text":"<ul> <li>Architecture \u2014 How the MCP server integrates with Analytics</li> <li>Configuration \u2014 Enable and configure MCP tools</li> <li>Tools \u2014 Available tool reference</li> <li>Authentication \u2014 Security model for MCP access</li> <li>Errors \u2014 Error handling and troubleshooting</li> </ul>"},{"location":"ai/mcp/architecture/","title":"MCP Architecture","text":"<p>The MCP server runs as part of the Incident Engine service, providing tool access to AI models through the standardized MCP protocol.</p>"},{"location":"ai/mcp/architecture/#integration","title":"Integration","text":"<pre><code>graph LR\n    AI[AI Provider] --&gt; Chat[Chat Service]\n    Chat --&gt; MCP[MCP Server]\n    MCP --&gt; IE[Incident Engine]\n    IE --&gt; C[(Cassandra)]</code></pre> <ol> <li>User sends a message through the chat interface</li> <li>The chat service forwards the message to the AI provider with MCP tool definitions</li> <li>The AI model decides which tools to invoke</li> <li>Tool calls are executed against the Incident Engine API</li> <li>Results are returned to the AI for response generation</li> </ol>"},{"location":"ai/mcp/architecture/#tool-categories","title":"Tool Categories","text":"Category Examples Search Search artifacts, nodes, incidents Analysis Get incident details, node relationships Reports Retrieve report data and metrics Configuration Read system settings"},{"location":"ai/mcp/architecture/#security-model","title":"Security Model","text":"<p>All MCP tool invocations respect the user's permissions. A tool call is rejected if the user lacks the required permission for the underlying API endpoint.</p>"},{"location":"ai/mcp/authentication/","title":"MCP Authentication","text":"<p>MCP tool invocations are authenticated and authorized using the same JWT-based system as the REST API.</p>"},{"location":"ai/mcp/authentication/#authentication-flow","title":"Authentication Flow","text":"<ol> <li>User authenticates via the web UI (JWT token in session)</li> <li>Chat messages carry the user's JWT</li> <li>MCP tool invocations include the JWT for authorization</li> <li>Each tool checks the user's permissions before executing</li> </ol>"},{"location":"ai/mcp/authentication/#permission-enforcement","title":"Permission Enforcement","text":"<p>Every MCP tool maps to one or more API permissions. If the user lacks the required permission, the tool returns an error:</p> <pre><code>{\n  \"error\": \"permission_denied\",\n  \"message\": \"Requires signals:read permission\"\n}\n</code></pre>"},{"location":"ai/mcp/authentication/#org-isolation","title":"Org Isolation","text":"<p>MCP tools are scoped to the user's organization. A tool invocation can only access data belonging to the user's <code>org_id</code> from their JWT claims.</p>"},{"location":"ai/mcp/configuration/","title":"MCP Configuration","text":"<p>Configure which MCP tools are available to the AI assistant.</p>"},{"location":"ai/mcp/configuration/#enabling-mcp","title":"Enabling MCP","text":"<ol> <li>Navigate to Admin &gt; AI &gt; MCP Configuration</li> <li>Toggle MCP server on/off</li> <li>Select which tool categories to enable</li> <li>Click Save</li> </ol>"},{"location":"ai/mcp/configuration/#tool-categories","title":"Tool Categories","text":"<p>Enable or disable tool categories independently:</p> Category Default Description Search Enabled Artifact and node search Incidents Enabled Incident queries and details Reports Enabled Report data access Admin Disabled Administrative operations"},{"location":"ai/mcp/configuration/#configuration-via-api","title":"Configuration via API","text":"<pre><code>GET /api/v1/ai/mcp/config\nPUT /api/v1/ai/mcp/config\n</code></pre> <p>Requires <code>ai:manage</code> permission.</p>"},{"location":"ai/mcp/errors/","title":"MCP Errors","text":"<p>Error handling for MCP tool invocations.</p>"},{"location":"ai/mcp/errors/#error-format","title":"Error Format","text":"<pre><code>{\n  \"error\": \"error_code\",\n  \"message\": \"Human-readable description\"\n}\n</code></pre>"},{"location":"ai/mcp/errors/#error-codes","title":"Error Codes","text":"Code Description <code>permission_denied</code> User lacks required permission <code>not_found</code> Requested resource not found <code>invalid_input</code> Tool parameters are invalid <code>rate_limited</code> Too many tool invocations <code>internal_error</code> Server-side error <code>tool_disabled</code> Tool category is disabled in MCP config"},{"location":"ai/mcp/errors/#troubleshooting","title":"Troubleshooting","text":"Error Cause Solution Permission denied Insufficient role Admin assigns appropriate role Tool disabled MCP category off Admin enables category in MCP config Rate limited Excessive tool calls Wait and retry; reduce query frequency Internal error Backend issue Check Incident Engine logs"},{"location":"ai/mcp/tools/","title":"MCP Tools","text":"<p>Reference for available MCP tools that the AI assistant can invoke.</p>"},{"location":"ai/mcp/tools/#search-tools","title":"Search Tools","text":"Tool Description Permission <code>search_artifacts</code> Search artifacts by query <code>signals:read</code> <code>search_nodes</code> Search graph nodes <code>signals:read</code> <code>search_incidents</code> Search incidents <code>signals:read</code>"},{"location":"ai/mcp/tools/#analysis-tools","title":"Analysis Tools","text":"Tool Description Permission <code>get_incident</code> Get incident details <code>signals:read</code> <code>get_node</code> Get node details with edges <code>signals:read</code> <code>get_artifact</code> Get artifact details <code>signals:read</code>"},{"location":"ai/mcp/tools/#report-tools","title":"Report Tools","text":"Tool Description Permission <code>get_executive_summary</code> Executive report data <code>reports:read</code> <code>get_compliance</code> Compliance readiness data <code>reports:read</code> <code>get_tool_effectiveness</code> Tool effectiveness data <code>reports:read</code>"},{"location":"ai/mcp/tools/#tool-invocation","title":"Tool Invocation","text":"<p>Tools are invoked automatically by the AI model when relevant to the conversation. Users see tool invocations and results in the chat interface.</p>"},{"location":"api/","title":"API Reference","text":"<p>WitFoo Analytics exposes a RESTful API for all platform operations. The API follows consistent patterns for authentication, request/response format, pagination, and error handling.</p>"},{"location":"api/#base-url","title":"Base URL","text":"<pre><code>http://localhost:8080/api/v1\n</code></pre>"},{"location":"api/#request-flow","title":"Request Flow","text":"<pre><code>Browser/Client \u2192 Reverse Proxy (:8080) \u2192 API Gateway (:8090) \u2192 Incident Engine (:8082) \u2192 Cassandra\n</code></pre> <p>The API service acts as a gateway adding JWT authentication, permission checks, and request routing. The Incident Engine contains all business logic.</p>"},{"location":"api/#sections","title":"Sections","text":"<ul> <li>Authentication \u2014 JWT token management</li> <li>Standards \u2014 Request/response conventions</li> <li>Errors \u2014 Error codes and handling</li> <li>Endpoints \u2014 Full endpoint reference</li> </ul>"},{"location":"api/authentication/","title":"Authentication","text":"<p>WitFoo Analytics uses JWT (JSON Web Tokens) with HS256 signing for API authentication.</p>"},{"location":"api/authentication/#login","title":"Login","text":"<pre><code>POST /api/v1/auth/login\n</code></pre> <p>Request:</p> <pre><code>{\n  \"email\": \"admin@witfoo.com\",\n  \"password\": \"password\"\n}\n</code></pre> <p>Response:</p> <pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"token\": \"eyJhbG...\",\n    \"user\": {\n      \"id\": \"uuid\",\n      \"email\": \"admin@witfoo.com\",\n      \"role\": \"admin\"\n    }\n  }\n}\n</code></pre>"},{"location":"api/authentication/#using-tokens","title":"Using Tokens","text":"<p>Include the JWT in the <code>Authorization</code> header:</p> <pre><code>Authorization: Bearer eyJhbG...\n</code></pre>"},{"location":"api/authentication/#token-contents","title":"Token Contents","text":"Claim Description <code>sub</code> User ID <code>email</code> User email <code>org_id</code> Organization ID <code>role</code> User role name <code>permissions</code> Array of granted permissions <code>exp</code> Expiration timestamp"},{"location":"api/authentication/#token-refresh","title":"Token Refresh","text":"<p>Tokens expire after the configured duration (default: 24 hours). Obtain a new token by logging in again.</p>"},{"location":"api/errors/","title":"Errors","text":"<p>API errors follow standard HTTP status codes with descriptive messages.</p>"},{"location":"api/errors/#error-response-format","title":"Error Response Format","text":"<pre><code>{\n  \"success\": false,\n  \"message\": \"Human-readable error description\"\n}\n</code></pre>"},{"location":"api/errors/#status-codes","title":"Status Codes","text":"Code Meaning 200 Success 201 Created 400 Bad Request \u2014 invalid input 401 Unauthorized \u2014 missing or invalid token 403 Forbidden \u2014 insufficient permissions 404 Not Found \u2014 resource doesn't exist 409 Conflict \u2014 duplicate resource 422 Unprocessable Entity \u2014 validation error 500 Internal Server Error"},{"location":"api/errors/#common-errors","title":"Common Errors","text":"Error Cause Fix \"token expired\" JWT has expired Login again to get new token \"permission denied\" Insufficient role Contact admin for role change \"invalid UUID\" Malformed UUID parameter Use valid UUID v4 format \"not found\" Resource doesn't exist Verify the resource ID"},{"location":"api/standards/","title":"API Standards","text":"<p>All API endpoints follow consistent conventions.</p>"},{"location":"api/standards/#response-format","title":"Response Format","text":"<p>Every response uses this envelope:</p> <pre><code>{\n  \"success\": true,\n  \"message\": \"Optional message\",\n  \"data\": { }\n}\n</code></pre> <p>Error responses:</p> <pre><code>{\n  \"success\": false,\n  \"message\": \"Error description\"\n}\n</code></pre>"},{"location":"api/standards/#http-methods","title":"HTTP Methods","text":"Method Usage GET Retrieve resources POST Create resources PUT Update resources (full replacement) DELETE Remove resources"},{"location":"api/standards/#pagination","title":"Pagination","text":"<p>List endpoints support pagination:</p> Parameter Default Description <code>limit</code> 25 Items per page (max 100) <code>offset</code> 0 Number of items to skip"},{"location":"api/standards/#content-type","title":"Content Type","text":"<p>All requests and responses use <code>application/json</code> unless otherwise noted (e.g., CSV export uses <code>text/csv</code>).</p>"},{"location":"api/standards/#date-formats","title":"Date Formats","text":"<p>All timestamps use ISO 8601 format: <code>2026-01-15T10:30:00Z</code></p>"},{"location":"api/endpoints/admin-roles/","title":"Admin Roles","text":"<p>Manage role definitions and permission assignments.</p>"},{"location":"api/endpoints/admin-roles/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/roles</code> <code>admin</code> List all roles GET <code>/v1/roles/:id</code> <code>admin</code> Get role details POST <code>/v1/roles</code> <code>admin</code> Create role PUT <code>/v1/roles/:id</code> <code>admin</code> Update role DELETE <code>/v1/roles/:id</code> <code>admin</code> Delete role"},{"location":"api/endpoints/admin-roles/#role-object","title":"Role Object","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"name\": \"analyst\",\n  \"permissions\": [\"signals:read\", \"signals:write\", \"observer:read\"],\n  \"created_at\": \"2026-01-01T00:00:00Z\",\n  \"updated_at\": \"2026-01-01T00:00:00Z\"\n}\n</code></pre>"},{"location":"api/endpoints/admin-users/","title":"Admin Users","text":"<p>Manage user accounts, roles, and authentication status.</p>"},{"location":"api/endpoints/admin-users/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/users</code> <code>admin</code> List all users GET <code>/v1/users/:id</code> <code>admin</code> Get user details POST <code>/v1/users</code> <code>admin</code> Create user PUT <code>/v1/users/:id</code> <code>admin</code> Update user DELETE <code>/v1/users/:id</code> <code>admin</code> Delete user"},{"location":"api/endpoints/admin-users/#user-object","title":"User Object","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"email\": \"analyst@example.com\",\n  \"name\": \"Jane Smith\",\n  \"role_id\": \"uuid\",\n  \"role_name\": \"analyst\",\n  \"active\": true,\n  \"last_login\": \"2026-01-15T10:30:00Z\"\n}\n</code></pre>"},{"location":"api/endpoints/ai/","title":"AI","text":"<p>AI assistant configuration and chat session management.</p>"},{"location":"api/endpoints/ai/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/ai/configs</code> <code>ai:manage</code> List AI configurations POST <code>/v1/ai/configs</code> <code>ai:manage</code> Create AI config PUT <code>/v1/ai/configs/:id</code> <code>ai:manage</code> Update AI config DELETE <code>/v1/ai/configs/:id</code> <code>ai:manage</code> Delete AI config GET <code>/v1/ai/sessions</code> <code>ai:read</code> List chat sessions POST <code>/v1/ai/sessions</code> <code>ai:read</code> Create chat session GET <code>/v1/ai/sessions/:id</code> <code>ai:read</code> Get session with messages POST <code>/v1/ai/sessions/:id/messages</code> <code>ai:read</code> Send chat message DELETE <code>/v1/ai/sessions/:id</code> <code>ai:write</code> Delete session GET <code>/v1/ai/mcp/config</code> <code>ai:manage</code> Get MCP server config PUT <code>/v1/ai/mcp/config</code> <code>ai:manage</code> Update MCP config"},{"location":"api/endpoints/artifacts/","title":"Artifacts","text":"<p>Artifacts represent raw security signals ingested into the analytics pipeline. They include IDS alerts, authentication events, firewall logs, DNS queries, and other telemetry collected from security tools and infrastructure.</p>"},{"location":"api/endpoints/artifacts/#endpoints","title":"Endpoints","text":"Method Path Description Permission POST <code>/v1/artifacts</code> Ingest new artifacts <code>signals:write</code> GET <code>/v1/artifacts</code> Search artifacts with filters <code>signals:read</code>"},{"location":"api/endpoints/artifacts/#post-v1artifacts","title":"POST /v1/artifacts","text":"<p>Ingest one or more security artifacts into the processing pipeline. Artifacts are queued for parsing, enrichment, and correlation via the data pipeline.</p>"},{"location":"api/endpoints/artifacts/#request-body","title":"Request Body","text":"Field Type Required Description <code>artifacts</code> array Yes Array of artifact objects <code>artifacts[].source</code> string Yes Source identifier (e.g., <code>suricata</code>, <code>auth</code>, <code>firewall</code>) <code>artifacts[].raw</code> string Yes Raw log or event data <code>artifacts[].timestamp</code> string No ISO 8601 timestamp; defaults to server time <code>artifacts[].metadata</code> object No Additional key-value metadata"},{"location":"api/endpoints/artifacts/#example-request","title":"Example Request","text":"<pre><code>curl -X POST https://analytics.example.com/api/v1/artifacts \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"artifacts\": [\n      {\n        \"source\": \"suricata\",\n        \"raw\": \"ET MALWARE Trickbot Checkin\",\n        \"timestamp\": \"2026-02-14T10:30:00Z\",\n        \"metadata\": {\"sensor\": \"ids-01\"}\n      }\n    ]\n  }'\n</code></pre>"},{"location":"api/endpoints/artifacts/#example-response","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"Artifacts accepted for processing\",\n  \"data\": {\n    \"accepted\": 1,\n    \"rejected\": 0\n  }\n}\n</code></pre>"},{"location":"api/endpoints/artifacts/#get-v1artifacts","title":"GET /v1/artifacts","text":"<p>Search and filter ingested artifacts. Results are paginated and sorted by timestamp descending.</p>"},{"location":"api/endpoints/artifacts/#query-parameters","title":"Query Parameters","text":"Parameter Type Required Description <code>source</code> string No Filter by artifact source <code>start</code> string No Start of time range (ISO 8601) <code>end</code> string No End of time range (ISO 8601) <code>query</code> string No Full-text search query <code>limit</code> integer No Max results to return (default: 50, max: 1000) <code>offset</code> integer No Pagination offset"},{"location":"api/endpoints/artifacts/#example-request_1","title":"Example Request","text":"<pre><code>curl -X GET \"https://analytics.example.com/api/v1/artifacts?source=suricata&amp;limit=10\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/artifacts/#example-response_1","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"OK\",\n  \"data\": {\n    \"artifacts\": [\n      {\n        \"id\": \"a1b2c3d4-e5f6-7890-abcd-ef1234567890\",\n        \"org_id\": \"witfoo\",\n        \"source\": \"suricata\",\n        \"raw\": \"ET MALWARE Trickbot Checkin\",\n        \"timestamp\": \"2026-02-14T10:30:00Z\",\n        \"metadata\": {\"sensor\": \"ids-01\"},\n        \"created_at\": \"2026-02-14T10:30:01Z\"\n      }\n    ],\n    \"total\": 1,\n    \"limit\": 10,\n    \"offset\": 0\n  }\n}\n</code></pre>"},{"location":"api/endpoints/artifacts/#error-responses","title":"Error Responses","text":"Status Description 400 Invalid request body or query parameters 401 Missing or invalid JWT token 403 Insufficient permissions (<code>signals:read</code> or <code>signals:write</code> required) 500 Internal server error"},{"location":"api/endpoints/auth-settings/","title":"Authentication Settings","text":"<p>Configure LDAP, SAML, and local authentication.</p>"},{"location":"api/endpoints/auth-settings/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/settings/auth</code> <code>settings:read</code> Get auth configuration PUT <code>/v1/settings/auth</code> <code>settings:manage</code> Update auth configuration POST <code>/v1/settings/auth/test</code> <code>settings:manage</code> Test auth connection"},{"location":"api/endpoints/auth-settings/#auth-config-object","title":"Auth Config Object","text":"<pre><code>{\n  \"method\": \"local\",\n  \"ldap\": {\n    \"server_url\": \"ldaps://ldap.example.com\",\n    \"bind_dn\": \"cn=admin,dc=example,dc=com\",\n    \"search_base\": \"ou=users,dc=example,dc=com\",\n    \"user_filter\": \"(uid=%s)\"\n  },\n  \"saml\": {\n    \"entity_id\": \"witfoo-analytics\",\n    \"sso_url\": \"https://idp.example.com/sso\",\n    \"certificate\": \"...\"\n  }\n}\n</code></pre> <p>Note</p> <p>Credentials are encrypted at rest. API responses redact sensitive fields.</p>"},{"location":"api/endpoints/classification-rules/","title":"Classification Rules","text":"<p>Manage automatic incident classification rules.</p>"},{"location":"api/endpoints/classification-rules/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/classification-rules</code> <code>signals:read</code> List rules GET <code>/v1/classification-rules/:id</code> <code>signals:read</code> Get rule POST <code>/v1/classification-rules</code> <code>signals:write</code> Create rule PUT <code>/v1/classification-rules/:id</code> <code>signals:write</code> Update rule DELETE <code>/v1/classification-rules/:id</code> <code>signals:manage</code> Delete rule"},{"location":"api/endpoints/classification-rules/#rule-object","title":"Rule Object","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"name\": \"Critical Infrastructure Alert\",\n  \"priority\": 10,\n  \"enabled\": true,\n  \"severity\": \"critical\",\n  \"target_infrastructure\": true,\n  \"conditions\": {}\n}\n</code></pre>"},{"location":"api/endpoints/conductor/","title":"Conductor","text":"<p>Manage the Conductor signal pipeline.</p>"},{"location":"api/endpoints/conductor/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/conductor/status</code> <code>conductor:read</code> Pipeline status GET <code>/v1/conductor/services</code> <code>conductor:read</code> List Conductor services POST <code>/v1/conductor/restart</code> <code>conductor:admin</code> Restart pipeline"},{"location":"api/endpoints/conductor/#proxy-routes","title":"Proxy Routes","text":"<p>Conductor UI requests are proxied through the Analytics reverse proxy at <code>/conductor/</code>. JWT tokens are validated and mapped to Conductor roles via the ConductorAuth middleware.</p> Analytics Permission Conductor Role <code>conductor:admin</code> Superuser <code>conductor:write</code> Admin <code>conductor:read</code> Staff"},{"location":"api/endpoints/cybergrid/","title":"CyberGrid","text":"<p>Threat intelligence feed management.</p>"},{"location":"api/endpoints/cybergrid/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/cybergrid/subscriptions</code> <code>cybergrid:read</code> List subscriptions POST <code>/v1/cybergrid/subscriptions</code> <code>cybergrid:write</code> Subscribe to feed DELETE <code>/v1/cybergrid/subscriptions/:id</code> <code>cybergrid:write</code> Unsubscribe GET <code>/v1/cybergrid/publications</code> <code>cybergrid:read</code> List publications POST <code>/v1/cybergrid/publications</code> <code>cybergrid:manage</code> Create publication GET <code>/v1/cybergrid/jobs</code> <code>cybergrid:read</code> List sync jobs POST <code>/v1/cybergrid/sync</code> <code>cybergrid:write</code> Trigger manual sync GET <code>/v1/cybergrid/library</code> <code>cybergrid:read</code> Browse library GET <code>/v1/cybergrid/search</code> <code>cybergrid:read</code> Search indicators"},{"location":"api/endpoints/edges/","title":"Edges","text":"<p>Edges represent relationships between nodes in the security knowledge graph. Each edge connects a source node to a target node with a typed relationship such as communication, authentication, or DNS resolution.</p>"},{"location":"api/endpoints/edges/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/edges</code> List edges with filters <code>graph:read</code> GET <code>/v1/edges/:id</code> Get edge details <code>graph:read</code>"},{"location":"api/endpoints/edges/#get-v1edges","title":"GET /v1/edges","text":"<p>List edges in the knowledge graph, optionally filtered by source node, target node, or relationship type.</p>"},{"location":"api/endpoints/edges/#query-parameters","title":"Query Parameters","text":"Parameter Type Required Description <code>source_id</code> UUID No Filter by source node ID <code>target_id</code> UUID No Filter by target node ID <code>type</code> string No Filter by edge type (e.g., <code>communicates_with</code>, <code>resolved_to</code>) <code>start</code> string No Start of time range (ISO 8601) <code>end</code> string No End of time range (ISO 8601) <code>limit</code> integer No Max results (default: 50, max: 1000) <code>offset</code> integer No Pagination offset"},{"location":"api/endpoints/edges/#example-request","title":"Example Request","text":"<pre><code>curl -X GET \"https://analytics.example.com/api/v1/edges?source_id=node-abc-123&amp;limit=10\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/edges/#example-response","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"OK\",\n  \"data\": {\n    \"edges\": [\n      {\n        \"id\": \"edge-001\",\n        \"org_id\": \"witfoo\",\n        \"source_id\": \"node-abc-123\",\n        \"target_id\": \"node-def-456\",\n        \"type\": \"communicates_with\",\n        \"weight\": 15,\n        \"first_seen\": \"2026-02-10T08:00:00Z\",\n        \"last_seen\": \"2026-02-14T10:30:00Z\",\n        \"artifact_count\": 15\n      }\n    ],\n    \"total\": 1,\n    \"limit\": 10,\n    \"offset\": 0\n  }\n}\n</code></pre>"},{"location":"api/endpoints/edges/#get-v1edgesid","title":"GET /v1/edges/:id","text":"<p>Retrieve details for a single edge including the connected source and target nodes.</p>"},{"location":"api/endpoints/edges/#path-parameters","title":"Path Parameters","text":"Parameter Type Description <code>id</code> UUID Edge ID"},{"location":"api/endpoints/edges/#example-request_1","title":"Example Request","text":"<pre><code>curl -X GET \"https://analytics.example.com/api/v1/edges/edge-001\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/edges/#example-response_1","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"OK\",\n  \"data\": {\n    \"id\": \"edge-001\",\n    \"org_id\": \"witfoo\",\n    \"source_id\": \"node-abc-123\",\n    \"target_id\": \"node-def-456\",\n    \"source\": {\"id\": \"node-abc-123\", \"type\": \"IP\", \"value\": \"10.0.1.50\"},\n    \"target\": {\"id\": \"node-def-456\", \"type\": \"domain\", \"value\": \"malware.example.com\"},\n    \"type\": \"communicates_with\",\n    \"weight\": 15,\n    \"first_seen\": \"2026-02-10T08:00:00Z\",\n    \"last_seen\": \"2026-02-14T10:30:00Z\",\n    \"artifact_count\": 15\n  }\n}\n</code></pre>"},{"location":"api/endpoints/edges/#edge-types","title":"Edge Types","text":"Type Description <code>communicates_with</code> Network communication between nodes <code>resolved_to</code> DNS resolution from domain to IP <code>authenticated_as</code> Authentication event linking user to host <code>member_of</code> Group or organizational membership <code>related_to</code> General correlation relationship"},{"location":"api/endpoints/edges/#error-responses","title":"Error Responses","text":"Status Description 400 Invalid query parameters or malformed UUID 401 Missing or invalid JWT token 403 Insufficient permissions (<code>graph:read</code> required) 404 Edge not found 500 Internal server error"},{"location":"api/endpoints/enrichment-settings/","title":"Enrichment Settings","text":"<p>Configure artifact and node enrichment.</p>"},{"location":"api/endpoints/enrichment-settings/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/enrichment-settings</code> <code>signals:read</code> Get settings PUT <code>/v1/enrichment-settings</code> <code>signals:manage</code> Update settings"},{"location":"api/endpoints/enrichment-settings/#settings-object","title":"Settings Object","text":"<pre><code>{\n  \"geoip_enabled\": true,\n  \"dns_enabled\": true,\n  \"whois_enabled\": false,\n  \"threat_intel_enabled\": true,\n  \"rate_limit\": 60,\n  \"cache_ttl_hours\": 24\n}\n</code></pre>"},{"location":"api/endpoints/frameworks/","title":"Frameworks","text":"<p>Compliance framework management.</p>"},{"location":"api/endpoints/frameworks/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/frameworks</code> <code>frameworks:read</code> List all frameworks GET <code>/v1/frameworks/enabled</code> <code>frameworks:read</code> List enabled frameworks PUT <code>/v1/frameworks/:id/enable</code> <code>frameworks:manage</code> Enable framework PUT <code>/v1/frameworks/:id/disable</code> <code>frameworks:manage</code> Disable framework PUT <code>/v1/frameworks/:id/primary</code> <code>frameworks:manage</code> Set as primary GET <code>/v1/frameworks/:id/controls</code> <code>frameworks:read</code> List controls POST <code>/v1/frameworks/sync</code> <code>frameworks:manage</code> Sync from Intel API"},{"location":"api/endpoints/frameworks/#framework-object","title":"Framework Object","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"name\": \"CIS CSC v8\",\n  \"machine_name\": \"cis_csc_v8\",\n  \"enabled\": true,\n  \"is_primary\": true,\n  \"control_count\": 153\n}\n</code></pre>"},{"location":"api/endpoints/health-dashboard/","title":"Health Dashboard","text":"<p>Container metrics and system health monitoring.</p>"},{"location":"api/endpoints/health-dashboard/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/health/containers</code> <code>health:read</code> List container metrics GET <code>/v1/health/containers/:name</code> <code>health:read</code> Container detail GET <code>/v1/health/containers/:name/history</code> <code>health:read</code> Historical metrics GET <code>/v1/health/alerts</code> <code>health:read</code> List active alerts POST <code>/v1/health/alerts</code> <code>health:manage</code> Create alert rule PUT <code>/v1/health/alerts/:id</code> <code>health:manage</code> Update alert rule DELETE <code>/v1/health/alerts/:id</code> <code>health:manage</code> Delete alert rule GET <code>/v1/metrics</code> <code>metrics:read</code> Prometheus metrics"},{"location":"api/endpoints/incidents/","title":"Incidents","text":"<p>Incidents represent correlated security events that require investigation. The incident engine aggregates related artifacts, nodes, and observations into actionable incidents with severity ratings and status tracking.</p>"},{"location":"api/endpoints/incidents/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/incidents</code> List incidents with filters <code>incidents:read</code> GET <code>/v1/incidents/:id</code> Get incident details <code>incidents:read</code> PUT <code>/v1/incidents/:id/status</code> Update incident status <code>incidents:write</code>"},{"location":"api/endpoints/incidents/#status-values","title":"Status Values","text":"ID Name Classification 1 New -- 2 Investigating -- 3 Resolved True Positive 4 Closed False Positive 5 Disrupted True Positive"},{"location":"api/endpoints/incidents/#get-v1incidents","title":"GET /v1/incidents","text":"<p>List incidents for the organization, with optional filtering and pagination.</p>"},{"location":"api/endpoints/incidents/#query-parameters","title":"Query Parameters","text":"Parameter Type Required Description <code>status</code> integer No Filter by status ID (1-5) <code>severity</code> string No Filter by severity (<code>low</code>, <code>medium</code>, <code>high</code>, <code>critical</code>) <code>start</code> string No Start of time range (ISO 8601) <code>end</code> string No End of time range (ISO 8601) <code>limit</code> integer No Max results (default: 50, max: 1000) <code>offset</code> integer No Pagination offset"},{"location":"api/endpoints/incidents/#example-request","title":"Example Request","text":"<pre><code>curl -X GET \"https://analytics.example.com/api/v1/incidents?status=1&amp;limit=10\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/incidents/#example-response","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"OK\",\n  \"data\": {\n    \"incidents\": [\n      {\n        \"id\": \"d290f1ee-6c54-4b01-90e6-d701748f0851\",\n        \"org_id\": \"witfoo\",\n        \"title\": \"Suspicious Outbound Traffic Detected\",\n        \"severity\": \"high\",\n        \"status\": 1,\n        \"status_name\": \"New\",\n        \"artifact_count\": 12,\n        \"node_count\": 3,\n        \"created_at\": \"2026-02-14T08:15:00Z\",\n        \"updated_at\": \"2026-02-14T08:15:00Z\"\n      }\n    ],\n    \"total\": 1,\n    \"limit\": 10,\n    \"offset\": 0\n  }\n}\n</code></pre>"},{"location":"api/endpoints/incidents/#get-v1incidentsid","title":"GET /v1/incidents/:id","text":"<p>Retrieve full details for a single incident, including associated nodes and observations.</p>"},{"location":"api/endpoints/incidents/#path-parameters","title":"Path Parameters","text":"Parameter Type Description <code>id</code> UUID Incident ID"},{"location":"api/endpoints/incidents/#example-request_1","title":"Example Request","text":"<pre><code>curl -X GET \"https://analytics.example.com/api/v1/incidents/d290f1ee-6c54-4b01-90e6-d701748f0851\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/incidents/#example-response_1","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"OK\",\n  \"data\": {\n    \"id\": \"d290f1ee-6c54-4b01-90e6-d701748f0851\",\n    \"org_id\": \"witfoo\",\n    \"title\": \"Suspicious Outbound Traffic Detected\",\n    \"severity\": \"high\",\n    \"status\": 1,\n    \"status_name\": \"New\",\n    \"artifact_count\": 12,\n    \"node_count\": 3,\n    \"nodes\": [\n      {\"id\": \"abc-123\", \"type\": \"IP\", \"value\": \"10.0.1.50\"}\n    ],\n    \"observations\": [\n      {\"id\": \"obs-456\", \"type\": \"network\", \"description\": \"C2 beacon pattern\"}\n    ],\n    \"created_at\": \"2026-02-14T08:15:00Z\",\n    \"updated_at\": \"2026-02-14T08:15:00Z\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/incidents/#put-v1incidentsidstatus","title":"PUT /v1/incidents/:id/status","text":"<p>Update the status of an incident. Status transitions drive true positive and false positive classification.</p>"},{"location":"api/endpoints/incidents/#path-parameters_1","title":"Path Parameters","text":"Parameter Type Description <code>id</code> UUID Incident ID"},{"location":"api/endpoints/incidents/#request-body","title":"Request Body","text":"Field Type Required Description <code>status</code> integer Yes New status ID (1-5)"},{"location":"api/endpoints/incidents/#example-request_2","title":"Example Request","text":"<pre><code>curl -X PUT \"https://analytics.example.com/api/v1/incidents/d290f1ee-6c54-4b01-90e6-d701748f0851/status\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"status\": 3}'\n</code></pre>"},{"location":"api/endpoints/incidents/#example-response_2","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"Incident status updated to Resolved\",\n  \"data\": {\n    \"id\": \"d290f1ee-6c54-4b01-90e6-d701748f0851\",\n    \"status\": 3,\n    \"status_name\": \"Resolved\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/incidents/#error-responses","title":"Error Responses","text":"Status Description 400 Invalid status value or malformed UUID 401 Missing or invalid JWT token 403 Insufficient permissions 404 Incident not found 500 Internal server error"},{"location":"api/endpoints/lead-rules/","title":"Lead Rules","text":"<p>Lead rules define the criteria for promoting observations into investigative leads. Each rule specifies matching conditions on artifact attributes, and when triggered, generates a lead that feeds into the incident correlation engine.</p>"},{"location":"api/endpoints/lead-rules/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/lead-rules</code> List lead rules <code>signals:read</code> GET <code>/v1/lead-rules/:id</code> Get rule details <code>signals:read</code> POST <code>/v1/lead-rules</code> Create a lead rule <code>signals:manage</code> PUT <code>/v1/lead-rules/:id</code> Update a lead rule <code>signals:manage</code> DELETE <code>/v1/lead-rules/:id</code> Delete a lead rule <code>signals:manage</code>"},{"location":"api/endpoints/lead-rules/#get-v1lead-rules","title":"GET /v1/lead-rules","text":"<p>List all lead rules for the organization.</p>"},{"location":"api/endpoints/lead-rules/#query-parameters","title":"Query Parameters","text":"Parameter Type Required Description <code>enabled</code> boolean No Filter by enabled/disabled status <code>limit</code> integer No Max results (default: 50) <code>offset</code> integer No Pagination offset"},{"location":"api/endpoints/lead-rules/#example-request","title":"Example Request","text":"<pre><code>curl -X GET \"https://analytics.example.com/api/v1/lead-rules?enabled=true\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/lead-rules/#example-response","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"OK\",\n  \"data\": {\n    \"rules\": [\n      {\n        \"id\": \"rule-001\",\n        \"org_id\": \"witfoo\",\n        \"name\": \"Brute Force Detection\",\n        \"description\": \"Triggers on repeated failed authentication attempts\",\n        \"enabled\": true,\n        \"conditions\": {\n          \"source\": \"auth\",\n          \"pattern\": \"failed_login\",\n          \"threshold\": 10,\n          \"window\": \"5m\"\n        },\n        \"severity\": \"high\",\n        \"created_at\": \"2026-01-10T12:00:00Z\",\n        \"updated_at\": \"2026-02-01T09:30:00Z\"\n      }\n    ],\n    \"total\": 1,\n    \"limit\": 50,\n    \"offset\": 0\n  }\n}\n</code></pre>"},{"location":"api/endpoints/lead-rules/#post-v1lead-rules","title":"POST /v1/lead-rules","text":"<p>Create a new lead rule.</p>"},{"location":"api/endpoints/lead-rules/#request-body","title":"Request Body","text":"Field Type Required Description <code>name</code> string Yes Rule name <code>description</code> string No Human-readable description <code>enabled</code> boolean No Whether the rule is active (default: <code>true</code>) <code>conditions</code> object Yes Matching conditions <code>conditions.source</code> string No Artifact source filter <code>conditions.pattern</code> string Yes Pattern to match <code>conditions.threshold</code> integer No Event count threshold <code>conditions.window</code> string No Time window (e.g., <code>5m</code>, <code>1h</code>) <code>severity</code> string No Severity assigned to generated leads"},{"location":"api/endpoints/lead-rules/#example-request_1","title":"Example Request","text":"<pre><code>curl -X POST \"https://analytics.example.com/api/v1/lead-rules\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"name\": \"Port Scan Detection\",\n    \"description\": \"Detects horizontal port scanning activity\",\n    \"conditions\": {\n      \"source\": \"firewall\",\n      \"pattern\": \"port_scan\",\n      \"threshold\": 50,\n      \"window\": \"10m\"\n    },\n    \"severity\": \"medium\"\n  }'\n</code></pre>"},{"location":"api/endpoints/lead-rules/#example-response_1","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"Lead rule created\",\n  \"data\": {\n    \"id\": \"rule-002\",\n    \"name\": \"Port Scan Detection\",\n    \"enabled\": true,\n    \"created_at\": \"2026-02-14T11:00:00Z\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/lead-rules/#put-v1lead-rulesid","title":"PUT /v1/lead-rules/:id","text":"<p>Update an existing lead rule. Only provided fields are modified.</p>"},{"location":"api/endpoints/lead-rules/#example-request_2","title":"Example Request","text":"<pre><code>curl -X PUT \"https://analytics.example.com/api/v1/lead-rules/rule-002\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"enabled\": false}'\n</code></pre>"},{"location":"api/endpoints/lead-rules/#delete-v1lead-rulesid","title":"DELETE /v1/lead-rules/:id","text":"<p>Delete a lead rule by ID.</p>"},{"location":"api/endpoints/lead-rules/#example-response_2","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"Lead rule deleted\",\n  \"data\": null\n}\n</code></pre>"},{"location":"api/endpoints/lead-rules/#error-responses","title":"Error Responses","text":"Status Description 400 Invalid request body or parameters 401 Missing or invalid JWT token 403 Insufficient permissions (<code>signals:read</code> or <code>signals:manage</code> required) 404 Rule not found 500 Internal server error"},{"location":"api/endpoints/monitoring/","title":"Monitoring","text":"<p>System monitoring and Prometheus metrics export.</p>"},{"location":"api/endpoints/monitoring/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/metrics</code> <code>metrics:read</code> Prometheus format metrics GET <code>/v1/status</code> (none) Basic health check"},{"location":"api/endpoints/monitoring/#prometheus-metrics","title":"Prometheus Metrics","text":"<p>Metrics are exported with the <code>witfoo_container_*</code> prefix:</p> <ul> <li><code>witfoo_container_cpu_percent</code> \u2014 Container CPU usage</li> <li><code>witfoo_container_memory_bytes</code> \u2014 Container memory usage</li> <li><code>witfoo_container_network_rx_bytes</code> \u2014 Network received</li> <li><code>witfoo_container_network_tx_bytes</code> \u2014 Network transmitted</li> </ul>"},{"location":"api/endpoints/monitoring/#grafana-integration","title":"Grafana Integration","text":"<p>Metrics can be scraped by Prometheus or forwarded to Grafana Cloud via remote write. Configure the <code>GRAFANA_REMOTE_WRITE_URL</code> environment variable.</p>"},{"location":"api/endpoints/nodes/","title":"Nodes","text":"<p>Nodes represent entities in the security knowledge graph. Each node is a distinct object such as an IP address, domain name, hostname, user account, or email address. Nodes are connected by edges and may be flagged with classification attributes.</p>"},{"location":"api/endpoints/nodes/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/nodes</code> Search nodes with filters <code>graph:read</code> GET <code>/v1/nodes/:id</code> Get node details <code>graph:read</code> PUT <code>/v1/nodes/:id/flags</code> Update node flags <code>graph:write</code>"},{"location":"api/endpoints/nodes/#node-types","title":"Node Types","text":"Type Description <code>IP</code> IPv4 or IPv6 address <code>domain</code> DNS domain name <code>host</code> Hostname or FQDN <code>user</code> User account identifier <code>email</code> Email address"},{"location":"api/endpoints/nodes/#get-v1nodes","title":"GET /v1/nodes","text":"<p>Search the knowledge graph for nodes matching specified criteria.</p>"},{"location":"api/endpoints/nodes/#query-parameters","title":"Query Parameters","text":"Parameter Type Required Description <code>type</code> string No Filter by node type <code>value</code> string No Search by node value (partial match) <code>managed</code> boolean No Filter by managed flag <code>internal</code> boolean No Filter by internal flag <code>trusted</code> boolean No Filter by trusted flag <code>infrastructure</code> boolean No Filter by infrastructure flag <code>frameworks</code> string No Comma-separated framework indices <code>limit</code> integer No Max results (default: 50, max: 1000) <code>offset</code> integer No Pagination offset"},{"location":"api/endpoints/nodes/#example-request","title":"Example Request","text":"<pre><code>curl -X GET \"https://analytics.example.com/api/v1/nodes?type=IP&amp;managed=true&amp;limit=20\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/nodes/#example-response","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"OK\",\n  \"data\": {\n    \"nodes\": [\n      {\n        \"id\": \"node-abc-123\",\n        \"org_id\": \"witfoo\",\n        \"type\": \"IP\",\n        \"value\": \"10.0.1.50\",\n        \"flags\": {\n          \"managed\": true,\n          \"internal\": true,\n          \"trusted\": false,\n          \"infrastructure\": false\n        },\n        \"frameworks\": [3, 4],\n        \"edge_count\": 7,\n        \"created_at\": \"2026-01-15T12:00:00Z\"\n      }\n    ],\n    \"total\": 1,\n    \"limit\": 20,\n    \"offset\": 0\n  }\n}\n</code></pre>"},{"location":"api/endpoints/nodes/#get-v1nodesid","title":"GET /v1/nodes/:id","text":"<p>Retrieve detailed information for a single node, including its flags and connected edges.</p>"},{"location":"api/endpoints/nodes/#path-parameters","title":"Path Parameters","text":"Parameter Type Description <code>id</code> UUID Node ID"},{"location":"api/endpoints/nodes/#example-request_1","title":"Example Request","text":"<pre><code>curl -X GET \"https://analytics.example.com/api/v1/nodes/node-abc-123\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/nodes/#example-response_1","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"OK\",\n  \"data\": {\n    \"id\": \"node-abc-123\",\n    \"org_id\": \"witfoo\",\n    \"type\": \"IP\",\n    \"value\": \"10.0.1.50\",\n    \"flags\": {\n      \"managed\": true,\n      \"internal\": true,\n      \"trusted\": false,\n      \"infrastructure\": false\n    },\n    \"frameworks\": [3, 4],\n    \"edges\": [\n      {\"id\": \"edge-001\", \"target_id\": \"node-def-456\", \"type\": \"communicates_with\"}\n    ],\n    \"edge_count\": 7,\n    \"created_at\": \"2026-01-15T12:00:00Z\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/nodes/#put-v1nodesidflags","title":"PUT /v1/nodes/:id/flags","text":"<p>Update classification flags on a node. Flags control how the node is treated in compliance calculations and graph analysis.</p>"},{"location":"api/endpoints/nodes/#path-parameters_1","title":"Path Parameters","text":"Parameter Type Description <code>id</code> UUID Node ID"},{"location":"api/endpoints/nodes/#request-body","title":"Request Body","text":"Field Type Required Description <code>managed</code> boolean No Node is managed by the organization <code>internal</code> boolean No Node is on the internal network <code>trusted</code> boolean No Node is explicitly trusted <code>infrastructure</code> boolean No Node is an infrastructure device"},{"location":"api/endpoints/nodes/#example-request_2","title":"Example Request","text":"<pre><code>curl -X PUT \"https://analytics.example.com/api/v1/nodes/node-abc-123/flags\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"managed\": true, \"infrastructure\": true}'\n</code></pre>"},{"location":"api/endpoints/nodes/#example-response_2","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"Node flags updated\",\n  \"data\": {\n    \"id\": \"node-abc-123\",\n    \"flags\": {\n      \"managed\": true,\n      \"internal\": true,\n      \"trusted\": false,\n      \"infrastructure\": true\n    }\n  }\n}\n</code></pre>"},{"location":"api/endpoints/nodes/#error-responses","title":"Error Responses","text":"Status Description 400 Invalid query parameters or malformed UUID 401 Missing or invalid JWT token 403 Insufficient permissions (<code>graph:read</code> or <code>graph:write</code> required) 404 Node not found 500 Internal server error"},{"location":"api/endpoints/notifications/","title":"Notifications","text":"<p>Notification channel and rule management.</p>"},{"location":"api/endpoints/notifications/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/notification-channels</code> <code>settings:manage</code> List channels POST <code>/v1/notification-channels</code> <code>settings:manage</code> Create channel PUT <code>/v1/notification-channels/:id</code> <code>settings:manage</code> Update channel DELETE <code>/v1/notification-channels/:id</code> <code>settings:manage</code> Delete channel POST <code>/v1/notification-channels/:id/test</code> <code>settings:manage</code> Test channel GET <code>/v1/notification-rules</code> <code>settings:manage</code> List rules POST <code>/v1/notification-rules</code> <code>settings:manage</code> Create rule PUT <code>/v1/notification-rules/:id</code> <code>settings:manage</code> Update rule DELETE <code>/v1/notification-rules/:id</code> <code>settings:manage</code> Delete rule"},{"location":"api/endpoints/notifications/#channel-types","title":"Channel Types","text":"<ul> <li>email \u2014 SMTP configuration</li> <li>slack \u2014 Webhook URL</li> <li>webhook \u2014 Custom HTTP endpoint</li> </ul>"},{"location":"api/endpoints/observations/","title":"Observations","text":"<p>Observations are structured analytical findings derived from artifact analysis. They capture specific behaviors, patterns, or indicators discovered during the security analysis pipeline and serve as building blocks for incident correlation.</p>"},{"location":"api/endpoints/observations/#endpoints","title":"Endpoints","text":"Method Path Description Permission GET <code>/v1/observations</code> List observations <code>observations:read</code> GET <code>/v1/observations/:id</code> Get observation details <code>observations:read</code> POST <code>/v1/observations</code> Create an observation <code>observations:write</code> PUT <code>/v1/observations/:id</code> Update an observation <code>observations:write</code> DELETE <code>/v1/observations/:id</code> Delete an observation <code>observations:write</code>"},{"location":"api/endpoints/observations/#get-v1observations","title":"GET /v1/observations","text":"<p>List observations with optional filtering by type, severity, or time range.</p>"},{"location":"api/endpoints/observations/#query-parameters","title":"Query Parameters","text":"Parameter Type Required Description <code>type</code> string No Filter by observation type (e.g., <code>network</code>, <code>auth</code>, <code>malware</code>) <code>severity</code> string No Filter by severity level <code>start</code> string No Start of time range (ISO 8601) <code>end</code> string No End of time range (ISO 8601) <code>limit</code> integer No Max results (default: 50, max: 1000) <code>offset</code> integer No Pagination offset"},{"location":"api/endpoints/observations/#example-request","title":"Example Request","text":"<pre><code>curl -X GET \"https://analytics.example.com/api/v1/observations?type=network&amp;limit=10\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/observations/#example-response","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"OK\",\n  \"data\": {\n    \"observations\": [\n      {\n        \"id\": \"obs-456\",\n        \"org_id\": \"witfoo\",\n        \"type\": \"network\",\n        \"description\": \"C2 beacon pattern detected\",\n        \"severity\": \"high\",\n        \"node_ids\": [\"node-abc-123\"],\n        \"artifact_ids\": [\"art-789\"],\n        \"created_at\": \"2026-02-14T09:00:00Z\"\n      }\n    ],\n    \"total\": 1,\n    \"limit\": 10,\n    \"offset\": 0\n  }\n}\n</code></pre>"},{"location":"api/endpoints/observations/#get-v1observationsid","title":"GET /v1/observations/:id","text":"<p>Retrieve a single observation with full details.</p>"},{"location":"api/endpoints/observations/#example-request_1","title":"Example Request","text":"<pre><code>curl -X GET \"https://analytics.example.com/api/v1/observations/obs-456\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/observations/#post-v1observations","title":"POST /v1/observations","text":"<p>Create a new observation.</p>"},{"location":"api/endpoints/observations/#request-body","title":"Request Body","text":"Field Type Required Description <code>type</code> string Yes Observation type <code>description</code> string Yes Human-readable description <code>severity</code> string No Severity level (default: <code>medium</code>) <code>node_ids</code> array No Related node IDs <code>artifact_ids</code> array No Related artifact IDs"},{"location":"api/endpoints/observations/#example-request_2","title":"Example Request","text":"<pre><code>curl -X POST \"https://analytics.example.com/api/v1/observations\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\n    \"type\": \"network\",\n    \"description\": \"Repeated DNS queries to known DGA domain\",\n    \"severity\": \"high\",\n    \"node_ids\": [\"node-abc-123\"]\n  }'\n</code></pre>"},{"location":"api/endpoints/observations/#example-response_1","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"Observation created\",\n  \"data\": {\n    \"id\": \"obs-789\",\n    \"type\": \"network\",\n    \"description\": \"Repeated DNS queries to known DGA domain\",\n    \"severity\": \"high\",\n    \"created_at\": \"2026-02-14T11:00:00Z\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/observations/#put-v1observationsid","title":"PUT /v1/observations/:id","text":"<p>Update an existing observation. Only provided fields are modified.</p>"},{"location":"api/endpoints/observations/#example-request_3","title":"Example Request","text":"<pre><code>curl -X PUT \"https://analytics.example.com/api/v1/observations/obs-789\" \\\n  -H \"Authorization: Bearer $TOKEN\" \\\n  -H \"Content-Type: application/json\" \\\n  -d '{\"severity\": \"critical\"}'\n</code></pre>"},{"location":"api/endpoints/observations/#delete-v1observationsid","title":"DELETE /v1/observations/:id","text":"<p>Delete an observation by ID.</p>"},{"location":"api/endpoints/observations/#example-request_4","title":"Example Request","text":"<pre><code>curl -X DELETE \"https://analytics.example.com/api/v1/observations/obs-789\" \\\n  -H \"Authorization: Bearer $TOKEN\"\n</code></pre>"},{"location":"api/endpoints/observations/#example-response_2","title":"Example Response","text":"<pre><code>{\n  \"success\": true,\n  \"message\": \"Observation deleted\",\n  \"data\": null\n}\n</code></pre>"},{"location":"api/endpoints/observations/#error-responses","title":"Error Responses","text":"Status Description 400 Invalid request body or parameters 401 Missing or invalid JWT token 403 Insufficient permissions 404 Observation not found 500 Internal server error"},{"location":"api/endpoints/reports/","title":"Reports","text":"<p>Report data and snapshot management.</p>"},{"location":"api/endpoints/reports/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/reports/executive</code> <code>reports:read</code> Executive summary data GET <code>/v1/reports/compliance</code> <code>reports:read</code> Compliance readiness data GET <code>/v1/reports/tool-effectiveness</code> <code>reports:read</code> Tool effectiveness data GET <code>/v1/reports/cost-savings</code> <code>reports:read</code> Cost &amp; savings data GET <code>/v1/reports/snapshots</code> <code>reports:read</code> List report snapshots"},{"location":"api/endpoints/reports/#query-parameters","title":"Query Parameters","text":"Parameter Description <code>start</code> Start date (ISO 8601) <code>end</code> End date (ISO 8601) <code>framework_id</code> Framework filter (compliance only) <code>format</code> Response format: <code>json</code> (default) or <code>csv</code>"},{"location":"api/endpoints/saved-searches/","title":"Saved Searches","text":"<p>Manage saved search queries for quick access.</p>"},{"location":"api/endpoints/saved-searches/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/saved-searches</code> <code>signals:read</code> List saved searches GET <code>/v1/saved-searches/:id</code> <code>signals:read</code> Get saved search POST <code>/v1/saved-searches</code> <code>signals:write</code> Create saved search PUT <code>/v1/saved-searches/:id</code> <code>signals:write</code> Update saved search DELETE <code>/v1/saved-searches/:id</code> <code>signals:write</code> Delete saved search"},{"location":"api/endpoints/saved-searches/#saved-search-object","title":"Saved Search Object","text":"<pre><code>{\n  \"id\": \"uuid\",\n  \"name\": \"Critical Firewall Alerts\",\n  \"query\": \"severity:critical AND source:firewall\",\n  \"filters\": {},\n  \"created_by\": \"uuid\",\n  \"shared\": false\n}\n</code></pre>"},{"location":"api/endpoints/settings/","title":"Settings","text":"<p>Organization-wide configuration management.</p>"},{"location":"api/endpoints/settings/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/settings/business</code> <code>settings:read</code> Get business settings PUT <code>/v1/settings/business</code> <code>settings:manage</code> Update business settings GET <code>/v1/settings/products</code> <code>settings:read</code> List product costs PUT <code>/v1/settings/products</code> <code>settings:manage</code> Update product costs"},{"location":"api/endpoints/settings/#business-settings-object","title":"Business Settings Object","text":"<pre><code>{\n  \"annual_revenue\": 50000000,\n  \"annual_security_spend\": 2500000,\n  \"fte_count\": 5,\n  \"investigation_time_hours\": 1.5,\n  \"restore_time_hours\": 0.75,\n  \"fte_hourly_rate\": 75.0,\n  \"product_costs\": {\n    \"Palo Alto\": 150000,\n    \"CrowdStrike\": 200000\n  }\n}\n</code></pre>"},{"location":"api/endpoints/tls/","title":"TLS","text":"<p>Certificate management for HTTPS configuration.</p>"},{"location":"api/endpoints/tls/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/tls/certificates</code> <code>settings:read</code> List certificates POST <code>/v1/tls/certificates</code> <code>settings:manage</code> Upload certificate DELETE <code>/v1/tls/certificates/:id</code> <code>settings:manage</code> Delete certificate GET <code>/v1/tls/status</code> <code>settings:read</code> Current TLS status"},{"location":"api/endpoints/tls/#certificate-upload","title":"Certificate Upload","text":"<pre><code>POST /v1/tls/certificates\nContent-Type: multipart/form-data\n\ncert: (PEM file)\nkey: (PEM private key file)\n</code></pre> <p>Certificates are validated (X.509 format, key pair match) before acceptance. Private keys are encrypted at rest.</p>"},{"location":"api/endpoints/wfa/","title":"WFA","text":"<p>WitFoo Appliance (WFA) management endpoints.</p>"},{"location":"api/endpoints/wfa/#endpoints","title":"Endpoints","text":"Method Path Permission Description GET <code>/v1/wfa/health</code> <code>health:read</code> WFA health status GET <code>/v1/wfa/stats</code> <code>metrics:read</code> WFA statistics GET <code>/v1/wfa/config</code> <code>settings:read</code> Current WFA configuration PUT <code>/v1/wfa/config</code> <code>settings:manage</code> Update WFA configuration"},{"location":"api/endpoints/wfa/#wfa-health-response","title":"WFA Health Response","text":"<pre><code>{\n  \"success\": true,\n  \"data\": {\n    \"status\": \"healthy\",\n    \"role\": \"analytics-aio\",\n    \"uptime\": \"7d 12h 30m\",\n    \"version\": \"1.0.0\"\n  }\n}\n</code></pre>"},{"location":"api/endpoints/wfa/#wfa-metrics","title":"WFA Metrics","text":"<p>Metrics use the <code>witfoo_wfa_*</code> Prometheus prefix, distinct from <code>witfoo_container_*</code> infrastructure metrics.</p>"},{"location":"deployment/","title":"Deployment Overview","text":"<p>WitFoo Analytics is a containerized security analytics platform deployed via Docker Compose or the WFA (WitFoo Appliance) CLI. This section covers all deployment methods, service configuration, monitoring, TLS, and the Conductor signal pipeline.</p>"},{"location":"deployment/#supported-environments","title":"Supported Environments","text":"OS Version Architecture Status Ubuntu 22.04 LTS amd64 Fully supported Ubuntu 24.04 LTS amd64 Fully supported <p>Hardware Requirements</p> <p>Minimum hardware depends on the deployment role. See the WFA Deployment page for per-role specifications. All-in-One deployments require at least 8 CPU cores, 32 GB RAM, and 500 GB SSD storage.</p>"},{"location":"deployment/#deployment-methods","title":"Deployment Methods","text":""},{"location":"deployment/#docker-compose","title":"Docker Compose","text":"<p>The standard deployment method for development and production environments. Five compose files support different deployment topologies.</p> <pre><code># All-in-One (most common for single-node deployments)\ndocker compose -f docker/docker-compose.aio.yml up -d --build\n</code></pre> <p>See Docker Compose Reference for full details on all compose files and service definitions.</p>"},{"location":"deployment/#wfa-cli","title":"WFA CLI","text":"<p>The WFA (WitFoo Appliance) CLI automates installation, configuration, and upgrades for appliance-based deployments.</p> <pre><code>wfa analytics install --role analytics-aio\n</code></pre> <p>See WFA Deployment for the interactive configuration wizard and all CLI commands.</p>"},{"location":"deployment/#deployment-roles","title":"Deployment Roles","text":"<p>WitFoo Analytics supports four deployment roles that scale from a single node to a distributed cluster.</p> Role Description Services Use Case AIO All-in-One 11 Analytics services Single-node deployments AIO + Conductor All-in-One with signal pipeline 11 Analytics + 5 Conductor services Single-node with log collection Data Node Cassandra storage node Cassandra only Distributed storage cluster Processing Node Application services 10 services (no local Cassandra) Connects to external data nodes"},{"location":"deployment/#single-node-architecture","title":"Single-Node Architecture","text":"<p>The AIO role runs all services on a single machine. This is the simplest deployment and suitable for most organizations.</p> <pre><code>Browser --&gt; Reverse Proxy (443/8081) --&gt; API (8080) --&gt; Incident Engine (8082)\n                                    --&gt; UI (3000)\n                                    --&gt; Dispatcher (8003)\n</code></pre>"},{"location":"deployment/#distributed-architecture","title":"Distributed Architecture","text":"<p>For larger deployments, separate data nodes (Cassandra) from processing nodes (application services).</p> <pre><code>Processing Node                    Data Node(s)\n+-------------------+             +-------------------+\n| API, UI, Engine   |  -------&gt;  | Cassandra (9042)  |\n| Proxy, Dispatcher |             +-------------------+\n| NATS, Ingestion   |             +-------------------+\n| Graph Processor   |  -------&gt;  | Cassandra (9042)  |\n| Prometheus, Grafana|            +-------------------+\n+-------------------+\n</code></pre>"},{"location":"deployment/#service-overview","title":"Service Overview","text":"<p>WitFoo Analytics consists of the following core services:</p> Service Port Description reverse-proxy 443, 8081 HTTPS/HTTP entry point, routes to all backend services api 8080 REST API, authentication, user management incident-engine 8082 Incident analysis, work units, reporting dispatcher 8003 Background job orchestration artifact-ingestion 8090 Receives security artifacts via HTTP graph-processor -- Background processor for graph node/edge creation ui 3000 Svelte 5 web application cassandra 9042 Primary data store (Cassandra 5.0) nats 4222 Internal message broker prometheus 9090 Metrics collection and storage grafana 3001 Metrics dashboards and visualization"},{"location":"deployment/#quick-start","title":"Quick Start","text":"<ol> <li> <p>Clone the repository and ensure Docker is installed.</p> </li> <li> <p>Start all services with the AIO compose file:</p> <pre><code>cd docker\ndocker compose -f docker-compose.aio.yml up -d --build\n</code></pre> </li> <li> <p>Wait for all health checks to pass (approximately 2-3 minutes):</p> <pre><code>docker compose -f docker-compose.aio.yml ps\n</code></pre> </li> <li> <p>Access the web UI at <code>https://localhost</code> or <code>http://localhost:8081</code>.</p> </li> </ol> <p>Default Credentials</p> <p>The default administrator account is <code>admin</code> / <code>F00theN0ise!</code>. Change this password immediately after first login.</p>"},{"location":"deployment/#next-steps","title":"Next Steps","text":"<ul> <li>Docker Compose Reference -- Compose file details, service definitions, and ports</li> <li>Configuration -- Environment variables for all services</li> <li>WFA Deployment -- Automated appliance deployment via CLI</li> <li>Monitoring -- Prometheus metrics, Grafana dashboards, and alerting</li> <li>TLS Configuration -- HTTPS setup and certificate management</li> <li>Conductor Pipeline -- Log collection and signal processing</li> </ul>"},{"location":"deployment/conductor/","title":"Conductor Deployment","text":"<p>Deploy the Conductor signal pipeline alongside WitFoo Analytics for log collection.</p>"},{"location":"deployment/conductor/#architecture","title":"Architecture","text":"<p>Conductor runs as a separate Docker Compose stack connected to Analytics via an external Docker network.</p> <pre><code>graph LR\n    Sources[Log Sources] --&gt; SS[Signal Server]\n    SS --&gt; SP[Signal Parser]\n    SP --&gt; AF[Artifact Filter]\n    AF --&gt; AE[Artifact Exporter]\n    AE --&gt;|HMAC Auth| AI[Analytics Artifact Ingestion]</code></pre>"},{"location":"deployment/conductor/#prerequisites","title":"Prerequisites","text":"<ul> <li>WitFoo Analytics running with <code>witfoo-analytics-net</code> Docker network</li> <li>Conductor binaries built via <code>scripts/conductor-build.sh</code></li> </ul>"},{"location":"deployment/conductor/#deployment","title":"Deployment","text":"<pre><code># Build Conductor binaries\n./scripts/conductor-build.sh\n\n# Start Conductor services\n./scripts/dev-conductor.sh start\n\n# Verify status\n./scripts/dev-conductor.sh status\n</code></pre>"},{"location":"deployment/conductor/#services","title":"Services","text":"Service Ports Description broker-edge 4223, 8223 NATS JetStream broker signal-server 514/udp, 514/tcp, 5044, 6514 Log receiver signal-parser Internal Signal parsing artifact-filter Internal Artifact filtering artifact-exporter Internal HTTP export to Analytics"},{"location":"deployment/conductor/#hmac-authentication","title":"HMAC Authentication","text":"<p>Configure the shared secret in both stacks:</p> <pre><code># Analytics docker/.env\nANALYTICS_SECRET=your-shared-secret\n\n# Conductor config\n# Same secret in conductor-node.json\n</code></pre>"},{"location":"deployment/conductor/#docker-network","title":"Docker Network","text":"<p>Both stacks share an external network:</p> <pre><code>docker network create witfoo-analytics-net\n</code></pre>"},{"location":"deployment/configuration/","title":"Configuration","text":"<p>WitFoo Analytics is configured through environment variables in <code>docker/.env</code>.</p>"},{"location":"deployment/configuration/#core-variables","title":"Core Variables","text":"Variable Default Description <code>CASSANDRA_HOST</code> <code>cassandra</code> Cassandra hostname <code>NATS_URL</code> <code>nats://nats:4222</code> NATS connection URL <code>JWT_SECRET</code> (required) Secret key for JWT signing <code>ORG_ID</code> <code>witfoo</code> Organization identifier"},{"location":"deployment/configuration/#service-ports","title":"Service Ports","text":"Variable Default Service <code>REVERSE_PROXY_PORT</code> <code>8080</code> Web UI and API access <code>API_PORT</code> <code>8090</code> API gateway <code>IE_PORT</code> <code>8082</code> Incident Engine <code>UI_PORT</code> <code>5173</code> SvelteKit dev server"},{"location":"deployment/configuration/#security-variables","title":"Security Variables","text":"Variable Description <code>JWT_SECRET</code> HS256 signing key for JWT tokens <code>AUTH_CONFIG_ENCRYPTION_KEY</code> AES-256-GCM key for credential encryption (base64) <code>ANALYTICS_SECRET</code> HMAC-SHA256 shared secret for Conductor auth"},{"location":"deployment/configuration/#feature-flags","title":"Feature Flags","text":"Variable Default Description <code>WF_LICENSE</code> (empty) Intel API license key for framework sync <code>VITE_UI_MODULES</code> <code>all</code> UI module visibility: <code>all</code>, <code>search_only</code>, <code>search_observer</code> <code>GRAFANA_REMOTE_WRITE_URL</code> (empty) Enable Prometheus remote write to Grafana"},{"location":"deployment/configuration/#cassandra-tuning","title":"Cassandra Tuning","text":"Variable Default Description <code>CASSANDRA_HEAP</code> <code>1G</code> JVM heap size <code>CASSANDRA_NEWSIZE</code> <code>200M</code> JVM new generation size <code>DATA_NODE_HOSTS</code> (empty) External Cassandra hosts for processing nodes"},{"location":"deployment/configuration/#example-env","title":"Example .env","text":"<pre><code>JWT_SECRET=your-secret-key-here\nORG_ID=my-org\nCASSANDRA_HOST=cassandra\nNATS_URL=nats://nats:4222\nAUTH_CONFIG_ENCRYPTION_KEY=base64-encoded-32-byte-key\n</code></pre>"},{"location":"deployment/docker-compose/","title":"Docker Compose Reference","text":"<p>WitFoo Analytics provides five Docker Compose files for different deployment topologies. All compose files are located in the <code>docker/</code> directory.</p>"},{"location":"deployment/docker-compose/#compose-files","title":"Compose Files","text":"File Role Services Description <code>docker-compose.aio.yml</code> AIO 11 All-in-One single-node deployment <code>docker-compose.aio-conductor.yml</code> AIO + Conductor 16 All services including Conductor pipeline <code>docker-compose.data-node.yml</code> Data Node 1 Cassandra-only storage node for clusters <code>docker-compose.processing-node.yml</code> Processing Node 10 All services except Cassandra <code>docker-compose-conductor.yml</code> Conductor add-on 6 Conductor services only (joins existing network) <p>Choosing a Compose File</p> <p>For most deployments, start with <code>docker-compose.aio.yml</code>. Add Conductor services later if you need log collection from syslog, Beats, or TLS sources.</p>"},{"location":"deployment/docker-compose/#all-in-one-aio","title":"All-in-One (AIO)","text":"<p>The most common deployment. Runs all 11 Analytics services on a single node.</p> <pre><code>cd docker\ndocker compose -f docker-compose.aio.yml up -d --build\n</code></pre>"},{"location":"deployment/docker-compose/#services-included","title":"Services Included","text":"Service Container Name Port(s) Health Check cassandra witfoo-analytics-cassandra 9042 cqlsh DESCRIBE KEYSPACES nats witfoo-analytics-nats 4222, 8222 wget /healthz artifact-ingestion witfoo-analytics-artifact-ingestion 8090 -- graph-processor witfoo-analytics-graph-processor -- -- incident-engine witfoo-analytics-incident-engine 8082 wget /health api witfoo-analytics-api 8080 wget /health dispatcher witfoo-analytics-dispatcher 8003 wget /health reverse-proxy witfoo-analytics-reverse-proxy 443, 8081 wget /health ui witfoo-analytics-ui 3000 wget /ui/health prometheus witfoo-analytics-prometheus 9090 wget /-/healthy grafana witfoo-analytics-grafana 3001 wget /api/health"},{"location":"deployment/docker-compose/#startup-order","title":"Startup Order","text":"<p>Services start in dependency order enforced by health checks:</p> <pre><code>cassandra, nats (foundation)\n    --&gt; artifact-ingestion, graph-processor, incident-engine (processing)\n        --&gt; api, dispatcher (application)\n            --&gt; reverse-proxy (routing)\n                --&gt; ui (frontend)\n                    prometheus --&gt; grafana (observability)\n</code></pre>"},{"location":"deployment/docker-compose/#aio-conductor","title":"AIO + Conductor","text":"<p>Combines all Analytics and Conductor services in a single compose file for single-node deployments with log collection.</p> <pre><code>cd docker\ndocker compose -f docker-compose.aio-conductor.yml up -d --build\n</code></pre> <p>This adds five Conductor services to the standard AIO deployment. See Conductor Pipeline for details on the Conductor services.</p>"},{"location":"deployment/docker-compose/#data-node","title":"Data Node","text":"<p>Deploys a single Cassandra instance configured for multi-node clustering.</p> <pre><code>NODE_IP=10.0.1.10 CASSANDRA_SEEDS=10.0.1.10,10.0.1.11 \\\n  docker compose -f docker-compose.data-node.yml up -d --build\n</code></pre> Variable Default Description <code>NODE_IP</code> <code>0.0.0.0</code> Listen and broadcast address for this Cassandra node <code>CASSANDRA_SEEDS</code> <code>cassandra</code> Comma-separated seed node addresses <code>CASSANDRA_DC</code> <code>dc1</code> Datacenter name <code>CASSANDRA_HEAP</code> <code>6G</code> Cassandra JVM heap size <code>CASSANDRA_NEWSIZE</code> <code>1200M</code> Cassandra JVM new generation size <p>Ports exposed: <code>9042</code> (CQL), <code>7000</code> (inter-node communication).</p>"},{"location":"deployment/docker-compose/#processing-node","title":"Processing Node","text":"<p>Runs all application services except Cassandra, connecting to external data nodes for storage.</p> <pre><code>DATA_NODE_HOSTS=10.0.1.10:9042,10.0.1.11:9042 \\\n  docker compose -f docker-compose.processing-node.yml up -d --build\n</code></pre> Variable Default Description <code>DATA_NODE_HOSTS</code> <code>cassandra:9042</code> Comma-separated Cassandra contact points <code>CASSANDRA_DC</code> <code>dc1</code> Datacenter to connect to <p>Network Connectivity</p> <p>Processing nodes must be able to reach all data node addresses on port 9042. Ensure firewall rules allow this traffic.</p>"},{"location":"deployment/docker-compose/#conductor-add-on","title":"Conductor Add-on","text":"<p>Adds Conductor services to an existing Analytics deployment by joining the external <code>witfoo-analytics-net</code> network.</p> <pre><code># Analytics stack must be running first\ncd docker\ndocker compose -f docker-compose-conductor.yml up -d --build\n</code></pre> <p>Prerequisite</p> <p>The <code>witfoo-analytics-net</code> Docker network must already exist. Start the Analytics stack first.</p>"},{"location":"deployment/docker-compose/#common-configuration","title":"Common Configuration","text":""},{"location":"deployment/docker-compose/#network","title":"Network","text":"<p>All services communicate over the <code>witfoo-analytics-net</code> bridge network. No inter-service traffic is exposed to the host unless explicitly mapped via port bindings.</p>"},{"location":"deployment/docker-compose/#logging","title":"Logging","text":"<p>All services use the same JSON file logging driver:</p> <pre><code>logging:\n  driver: \"json-file\"\n  options:\n    max-size: \"10m\"\n    max-file: \"3\"\n    compress: \"true\"\n</code></pre>"},{"location":"deployment/docker-compose/#volumes","title":"Volumes","text":"Volume Service Purpose <code>cassandra-data</code> cassandra Persistent database storage <code>nats-data</code> nats JetStream message persistence <code>certs</code> reverse-proxy TLS certificate storage <code>prometheus-data</code> prometheus Metrics time-series data <code>grafana-data</code> grafana Dashboard definitions and settings"},{"location":"deployment/docker-compose/#health-checks","title":"Health Checks","text":"<p>All application services expose a <code>/health</code> endpoint. Health check configuration:</p> Parameter Value Description <code>interval</code> 30s Time between health checks <code>timeout</code> 5-10s Maximum time for a health check response <code>retries</code> 3-5 Failures before marking unhealthy <code>start_period</code> 10-120s Grace period during startup <p>Cassandra has the longest start period (60-120s) due to JVM warm-up and schema initialization.</p>"},{"location":"deployment/docker-compose/#restart-policy","title":"Restart Policy","text":"<p>All services except initialization containers use <code>restart: unless-stopped</code>. This ensures services restart after crashes but stay stopped if intentionally brought down.</p>"},{"location":"deployment/docker-compose/#listen_ip","title":"LISTEN_IP","text":"<p>The <code>LISTEN_IP</code> environment variable controls which network interface services bind to:</p> <pre><code># Bind to all interfaces (default for most services)\nLISTEN_IP=0.0.0.0\n\n# Bind to localhost only (default for Prometheus/Grafana)\nLISTEN_IP=127.0.0.1\n\n# Bind to a specific interface\nLISTEN_IP=10.0.1.10\n</code></pre>"},{"location":"deployment/docker-compose/#build-secrets","title":"Build Secrets","text":"<p>Go services use BuildKit secrets to access private Git dependencies during build:</p> <pre><code>secrets:\n  git_credentials:\n    file: ${HOME}/.git-credentials\n</code></pre> <p>Ensure your <code>~/.git-credentials</code> file contains a valid GitHub personal access token.</p>"},{"location":"deployment/docker-compose/#port-summary","title":"Port Summary","text":"Port Service Protocol Description 443 reverse-proxy HTTPS Primary TLS entry point 3000 ui HTTP Svelte web application 3001 grafana HTTP Metrics dashboards 4222 nats TCP NATS client connections 8003 dispatcher HTTP Job dispatch API 8080 api HTTP REST API 8081 reverse-proxy HTTP HTTP entry point 8082 incident-engine HTTP Incident analysis API 8090 artifact-ingestion HTTP Artifact submission 8222 nats HTTP NATS monitoring 9042 cassandra CQL Cassandra native protocol 9090 prometheus HTTP Prometheus web UI"},{"location":"deployment/monitoring/","title":"Monitoring","text":"<p>Monitor WitFoo Analytics using built-in Prometheus metrics and optional Grafana integration.</p>"},{"location":"deployment/monitoring/#prometheus-metrics","title":"Prometheus Metrics","text":"<p>Metrics are available at <code>/api/v1/metrics</code> (requires <code>metrics:read</code> permission).</p>"},{"location":"deployment/monitoring/#container-metrics","title":"Container Metrics","text":"<p>Prefix: <code>witfoo_container_*</code></p> Metric Type Description <code>cpu_percent</code> Gauge Container CPU usage percentage <code>memory_bytes</code> Gauge Container memory usage <code>memory_percent</code> Gauge Container memory percentage <code>network_rx_bytes</code> Counter Network bytes received <code>network_tx_bytes</code> Counter Network bytes transmitted"},{"location":"deployment/monitoring/#wfa-metrics","title":"WFA Metrics","text":"<p>Prefix: <code>witfoo_wfa_*</code></p> <p>WFA metrics track appliance-level statistics distinct from container metrics.</p>"},{"location":"deployment/monitoring/#grafana-integration","title":"Grafana Integration","text":""},{"location":"deployment/monitoring/#remote-write","title":"Remote Write","text":"<p>Enable Prometheus remote write to Grafana Cloud:</p> <pre><code>GRAFANA_REMOTE_WRITE_URL=https://prometheus-us-central1.grafana.net/api/prom/push\nGRAFANA_INSTANCE_ID=123456\nGRAFANA_API_KEY=your-api-key\n</code></pre>"},{"location":"deployment/monitoring/#dashboard","title":"Dashboard","text":"<p>A pre-built Grafana dashboard JSON is available for import. It includes:</p> <ul> <li>Container CPU/memory panels with threshold coloring</li> <li>Network I/O rate graphs</li> <li>Service health status indicators</li> <li>Alert history timeline</li> </ul>"},{"location":"deployment/tls/","title":"TLS Configuration","text":"<p>Configure HTTPS for WitFoo Analytics.</p>"},{"location":"deployment/tls/#quick-setup","title":"Quick Setup","text":""},{"location":"deployment/tls/#self-signed-development","title":"Self-Signed (Development)","text":"<p>WitFoo Analytics generates a self-signed certificate on first boot. This is suitable for development but will show browser warnings.</p>"},{"location":"deployment/tls/#custom-certificate","title":"Custom Certificate","text":"<p>Upload a trusted certificate through the web UI or API:</p> <ol> <li>Navigate to Admin &gt; Settings &gt; Certificates</li> <li>Upload your certificate (PEM) and private key</li> <li>The reverse proxy hot-reloads the new certificate</li> </ol>"},{"location":"deployment/tls/#lets-encrypt","title":"Let's Encrypt","text":"<p>Use an external reverse proxy (nginx, Caddy, Traefik) with Let's Encrypt in front of WitFoo Analytics.</p>"},{"location":"deployment/tls/#hot-reload","title":"Hot-Reload","text":"<p>The reverse proxy supports zero-downtime certificate rotation using the <code>tls.Config.GetCertificate</code> callback. When a certificate is uploaded via the API, it takes effect immediately.</p>"},{"location":"deployment/tls/#internal-tls","title":"Internal TLS","text":"<p>Inter-service communication within the Docker network uses plaintext by default. For enhanced security, configure TLS between services using the certificate management API.</p>"},{"location":"deployment/wfa/","title":"WFA Deployment","text":"<p>The WitFoo Appliance (WFA) CLI provides automated deployment and management of WitFoo Analytics.</p>"},{"location":"deployment/wfa/#installation","title":"Installation","text":"<pre><code>wfa analytics install --role &lt;role&gt;\n</code></pre>"},{"location":"deployment/wfa/#available-roles","title":"Available Roles","text":"Role Description <code>aio</code> All-in-One: all analytics services <code>aio-conductor</code> AIO + Conductor signal pipeline <code>data-node</code> Dedicated Cassandra database node <code>processing-node</code> Dedicated processing (external Cassandra)"},{"location":"deployment/wfa/#configuration","title":"Configuration","text":"<pre><code>wfa analytics configure\n</code></pre> <p>The interactive wizard configures:</p> <ul> <li>Retention \u2014 Data retention periods</li> <li>UI Modules \u2014 Which modules to enable (all, search-only, search+observer)</li> <li>CyberGrid \u2014 Intelligence feed settings</li> <li>Clustering \u2014 Multi-node Cassandra configuration</li> </ul>"},{"location":"deployment/wfa/#management-commands","title":"Management Commands","text":"Command Description <code>wfa analytics start</code> Start all services <code>wfa analytics stop</code> Stop all services <code>wfa analytics status</code> Show service status <code>wfa analytics upgrade</code> Upgrade to new version"},{"location":"deployment/wfa/#hardware-validation","title":"Hardware Validation","text":"<p>The <code>install</code> command validates hardware against the role's minimum requirements before proceeding:</p> Role Min CPU Min RAM Min Disk AIO 4 cores 8 GB 50 GB AIO + Conductor 8 cores 16 GB 100 GB Data Node 4 cores 8 GB 200 GB Processing Node 4 cores 8 GB 50 GB"},{"location":"getting-started/","title":"Getting Started","text":"<p>Welcome to WitFoo Analytics v1.0.0 \u2014 an enterprise security operations platform for investigation, correlation, and reporting. This guide walks you through deploying your first WitFoo Appliance and completing initial configuration.</p>"},{"location":"getting-started/#quick-start-path","title":"Quick Start Path","text":"<p>Follow these steps to go from zero to a running WitFoo Analytics instance:</p> <ul> <li> <p> 1. Install a WitFoo Appliance</p> <p>Deploy a WitFoo Appliance via VM image, cloud marketplace, or bare metal script.</p> <p> Installation</p> </li> <li> <p> 2. Choose a Deployment Role</p> <p>Understand the three node roles: Conductor, Console, and Analytics.</p> <p> Deployment Roles</p> </li> <li> <p> 3. Configure the Appliance</p> <p>Run <code>sudo wfa configure</code> to select a role and configure services.</p> <p> WFA Configure Wizard</p> </li> <li> <p> 4. Log In and Onboard</p> <p>Access the web UI, change default passwords, and complete the onboarding wizard.</p> <p> First Login</p> </li> <li> <p> 5. Understand the Architecture</p> <p>Learn how services, data, and nodes work together.</p> <p> Architecture</p> </li> </ul>"},{"location":"getting-started/#hardware-requirements-at-a-glance","title":"Hardware Requirements at a Glance","text":"Tier CPU Cores RAM Disk Minimum 8 12 GB 220 GB Recommended 16 32 GB 1 TB <p>See Deployment Roles for per-role hardware requirements.</p>"},{"location":"getting-started/#what-youll-need","title":"What You'll Need","text":"<p>Before you begin, ensure you have:</p> <ul> <li>A supported hypervisor (VMware, Hyper-V, QEMU), cloud account (AWS, Azure, Google Cloud), or bare metal server running Ubuntu 24 or RHEL 10</li> <li>Network access to the appliance on port 443 (HTTPS)</li> <li>A WitFoo license key (or request a 15-day trial during configuration)</li> </ul> <p>Evaluation Deployments</p> <p>For evaluation purposes, a single Analytics node is the fastest path to a working platform. You can add Conductor and Console nodes later as your deployment grows.</p>"},{"location":"getting-started/architecture/","title":"Architecture","text":"<p>WitFoo Analytics uses a distributed, containerized architecture where each node role runs a specific set of services. This page describes the service architecture, inter-node communication, and data flow.</p>"},{"location":"getting-started/architecture/#deployment-topology","title":"Deployment Topology","text":"<p>A complete WitFoo Analytics deployment consists of up to three node roles working together:</p> <pre><code>graph TB\n    subgraph \"Data Sources\"\n        DS1[Firewalls]\n        DS2[IDS/IPS]\n        DS3[Endpoints]\n        DS4[Cloud Services]\n    end\n\n    subgraph \"Conductor Node\"\n        NATS_B[NATS Broker]\n        SS[Signal Server]\n        SP[Signal Parser]\n        AE[Artifact Exporter]\n        BE[Broker Edge]\n    end\n\n    subgraph \"Analytics Node\"\n        RP[Reverse Proxy&lt;br/&gt;Port 443]\n        UI[Web UI]\n        API[API Service]\n        IE[Incident Engine]\n        GP[Graph Processor]\n        AI_SVC[Artifact Ingestion]\n        DISP[Dispatcher]\n        NATS_A[NATS]\n        CASS[(Cassandra)]\n        PROM[Prometheus]\n        GRAF[Grafana]\n    end\n\n    subgraph \"Console Node\"\n        CON_UI[Console UI&lt;br/&gt;Port 443]\n    end\n\n    DS1 &amp; DS2 &amp; DS3 &amp; DS4 --&gt;|Signals| NATS_B\n    NATS_B --&gt; SS --&gt; SP --&gt; AE\n    AE --&gt;|Artifacts| NATS_A\n\n    NATS_A --&gt; AI_SVC --&gt; GP --&gt; CASS\n    GP --&gt; IE --&gt; CASS\n    IE --&gt; DISP\n    API --&gt; CASS\n    RP --&gt; UI\n    RP --&gt; API\n    PROM --&gt; GRAF\n\n    CON_UI -.-&gt;|Manages| NATS_B\n    CON_UI -.-&gt;|Manages| RP</code></pre>"},{"location":"getting-started/architecture/#service-architecture-analytics-node","title":"Service Architecture \u2014 Analytics Node","text":"<p>The Analytics node is the primary platform, running all services required for investigation, correlation, and reporting.</p> <pre><code>graph LR\n    subgraph \"External Access\"\n        Browser[Web Browser]\n    end\n\n    subgraph \"Edge Layer\"\n        RP[Reverse Proxy&lt;br/&gt;:443 HTTPS]\n    end\n\n    subgraph \"Presentation Layer\"\n        UI[Web UI&lt;br/&gt;:3000]\n        API[API Service&lt;br/&gt;:8080]\n    end\n\n    subgraph \"Processing Layer\"\n        IE[Incident Engine&lt;br/&gt;:8082]\n        GP[Graph Processor]\n        AI_SVC[Artifact Ingestion&lt;br/&gt;:8081]\n        DISP[Dispatcher&lt;br/&gt;:8083]\n    end\n\n    subgraph \"Messaging Layer\"\n        NATS[NATS&lt;br/&gt;:4222]\n    end\n\n    subgraph \"Storage Layer\"\n        CASS[(Cassandra&lt;br/&gt;:9042)]\n    end\n\n    subgraph \"Observability\"\n        PROM[Prometheus&lt;br/&gt;:9090]\n        GRAF[Grafana&lt;br/&gt;:3001]\n    end\n\n    Browser --&gt;|HTTPS :443| RP\n    RP --&gt; UI\n    RP --&gt; API\n    API --&gt; IE\n    API --&gt; CASS\n    IE --&gt; CASS\n    IE --&gt; NATS\n    GP --&gt; CASS\n    GP --&gt; NATS\n    AI_SVC --&gt; NATS\n    AI_SVC --&gt; GP\n    DISP --&gt; NATS\n    PROM --&gt; GRAF\n    PROM -.-&gt;|Scrape| API\n    PROM -.-&gt;|Scrape| IE\n    PROM -.-&gt;|Scrape| GP</code></pre>"},{"location":"getting-started/architecture/#analytics-services","title":"Analytics Services","text":"Service Port Description Reverse Proxy 443 TLS termination, routes requests to UI and API Web UI 3000 Svelte-based user interface API Service 8080 REST API, authentication, RBAC Incident Engine 8082 Incident correlation, scoring, status management Graph Processor \u2014 Builds and maintains the security knowledge graph Artifact Ingestion 8081 Receives and normalizes incoming artifacts Dispatcher 8083 WebSocket notifications and real-time event delivery NATS 4222 Internal message bus for service communication Cassandra 9042 Primary data store for all analytics data Prometheus 9090 Metrics collection (bound to localhost) Grafana 3001 Metrics visualization dashboards"},{"location":"getting-started/architecture/#service-architecture-conductor-node","title":"Service Architecture \u2014 Conductor Node","text":"<p>The Conductor node handles data ingestion from remote networks and forwards processed signals to the Analytics node.</p> <pre><code>graph LR\n    subgraph \"Data Sources\"\n        SRC[Syslog / API / Agents]\n    end\n\n    subgraph \"Conductor Services\"\n        NATS_B[NATS Broker&lt;br/&gt;:4223 client&lt;br/&gt;:4443 leaf]\n        SS[Signal Server]\n        SP[Signal Parser]\n        AE[Artifact Exporter]\n        BE[Broker Edge]\n    end\n\n    subgraph \"Analytics Node\"\n        NATS_A[NATS :4222]\n    end\n\n    SRC --&gt;|Signals| NATS_B\n    NATS_B --&gt; SS\n    SS --&gt; SP\n    SP --&gt; AE\n    AE --&gt;|Leaf Connection :4443| NATS_A\n    BE --&gt; NATS_B</code></pre>"},{"location":"getting-started/architecture/#conductor-services","title":"Conductor Services","text":"Service Port Description NATS Broker 4223 (client), 4443 (leaf) Message broker for signal ingestion and forwarding Signal Server \u2014 Receives raw signals from data sources Signal Parser \u2014 Parses and normalizes signals into structured artifacts Artifact Exporter \u2014 Forwards processed artifacts to the Analytics node Broker Edge \u2014 Manages broker cluster connectivity"},{"location":"getting-started/architecture/#service-architecture-console-node","title":"Service Architecture \u2014 Console Node","text":"<p>The Console node is a lightweight management interface for monitoring and configuring remote Conductor and Analytics nodes.</p> <pre><code>graph LR\n    subgraph \"Admin Browser\"\n        Browser[Web Browser]\n    end\n\n    subgraph \"Console Services\"\n        CON[Console Container&lt;br/&gt;:443 HTTPS]\n    end\n\n    subgraph \"Managed Nodes\"\n        C1[Conductor 1]\n        C2[Conductor 2]\n        A1[Analytics 1]\n    end\n\n    Browser --&gt;|HTTPS :443| CON\n    CON -.-&gt;|Management API| C1\n    CON -.-&gt;|Management API| C2\n    CON -.-&gt;|Management API| A1</code></pre>"},{"location":"getting-started/architecture/#console-services","title":"Console Services","text":"Service Port Description Console 443 Single-container management UI and API"},{"location":"getting-started/architecture/#data-flow","title":"Data Flow","text":"<p>The following diagram shows how security data flows from ingestion to investigation:</p> <pre><code>flowchart TD\n    A[Data Sources&lt;br/&gt;Firewalls, IDS, Endpoints] --&gt;|Raw Signals| B[Conductor&lt;br/&gt;NATS Broker]\n    B --&gt;|Parsed Signals| C[Signal Parser]\n    C --&gt;|Normalized Artifacts| D[Artifact Exporter]\n    D --&gt;|NATS Leaf Connection| E[Analytics&lt;br/&gt;Artifact Ingestion]\n    E --&gt;|Structured Artifacts| F[Graph Processor]\n    F --&gt;|Nodes &amp; Edges| G[(Cassandra&lt;br/&gt;Knowledge Graph)]\n    F --&gt;|Events| H[Incident Engine]\n    H --&gt;|Correlated Incidents| G\n    H --&gt;|Notifications| I[Dispatcher]\n    I --&gt;|WebSocket| J[Web UI]\n    G --&gt;|Query Results| K[API Service]\n    K --&gt;|REST API| J\n    J --&gt;|HTTPS :443| L[Analyst Browser]\n\n    style A fill:#f9f,stroke:#333\n    style G fill:#bbf,stroke:#333\n    style L fill:#bfb,stroke:#333</code></pre>"},{"location":"getting-started/architecture/#data-flow-summary","title":"Data Flow Summary","text":"<ol> <li>Ingestion \u2014 Data sources send raw signals (syslog, API, agents) to the Conductor's NATS broker.</li> <li>Parsing \u2014 The Signal Server and Signal Parser normalize raw signals into structured artifacts.</li> <li>Export \u2014 The Artifact Exporter forwards normalized artifacts to the Analytics node via a NATS leaf connection.</li> <li>Processing \u2014 Artifact Ingestion receives artifacts and passes them to the Graph Processor, which builds a security knowledge graph in Cassandra.</li> <li>Correlation \u2014 The Incident Engine analyzes graph data to detect, score, and correlate security incidents.</li> <li>Notification \u2014 The Dispatcher delivers real-time updates to connected web UI sessions via WebSocket.</li> <li>Investigation \u2014 Analysts access the platform through the web UI (HTTPS on port 443), querying the API for incidents, graph data, and reports.</li> </ol>"},{"location":"getting-started/architecture/#network-ports","title":"Network Ports","text":"Port Protocol Service Direction Description 443 HTTPS Reverse Proxy / Console Inbound Web UI and API access 4223 TCP NATS Broker (Conductor) Inbound Signal ingestion from data sources 4443 TCP NATS Broker (Conductor) Inbound/Outbound Leaf node connections to Analytics 9042 TCP Cassandra Internal Database communication (not exposed externally) 4222 TCP NATS (Analytics) Internal Internal message bus <p>Minimal Firewall Configuration</p> <p>For a single Analytics node deployment, only port 443 needs to be open to users. Ports 4223 and 4443 are only required when deploying Conductor nodes for remote data collection.</p>"},{"location":"getting-started/deployment-roles/","title":"Deployment Roles","text":"<p>WitFoo Appliances support three node roles, each designed for a specific function within your security operations infrastructure. This page helps you understand each role and choose the right deployment topology.</p>"},{"location":"getting-started/deployment-roles/#role-overview","title":"Role Overview","text":"Role Purpose Typical Deployment Conductor Data ingestion and signal processing Remote offices, network segments, cloud VPCs Console Centralized management and monitoring Headquarters or management network Analytics Security analytics, investigation, and reporting SOC or data center"},{"location":"getting-started/deployment-roles/#analytics","title":"Analytics","text":"<p>The Analytics node is the primary WitFoo platform. It performs security investigation, incident correlation, compliance reporting, and provides the main user interface for security analysts.</p>"},{"location":"getting-started/deployment-roles/#purpose-and-use-case","title":"Purpose and Use Case","text":"<ul> <li>Core security operations platform for your SOC</li> <li>Receives processed artifacts from Conductor nodes (or ingests directly)</li> <li>Correlates events into incidents using the knowledge graph and incident engine</li> <li>Generates compliance reports, executive summaries, and operational metrics</li> <li>Provides the web UI for analysts, investigators, and management</li> </ul>"},{"location":"getting-started/deployment-roles/#hardware-requirements","title":"Hardware Requirements","text":"Resource Minimum Recommended CPU 8 cores 16 cores RAM 12 GB 32 GB Disk 220 GB 1 TB"},{"location":"getting-started/deployment-roles/#services","title":"Services","text":"<p>The Analytics node runs the full service stack:</p> Service Description Cassandra Primary data store and knowledge graph NATS Internal message bus Artifact Ingestion Receives and normalizes artifacts Graph Processor Builds the security knowledge graph Incident Engine Correlates events into scored incidents API Service REST API with authentication and RBAC Dispatcher Real-time WebSocket notifications Reverse Proxy TLS termination and request routing Web UI Analyst-facing user interface Prometheus Metrics collection Grafana Metrics visualization"},{"location":"getting-started/deployment-roles/#when-to-choose-analytics","title":"When to Choose Analytics","text":"<ul> <li>Always \u2014 Every WitFoo deployment requires at least one Analytics node</li> <li>You need a single-node deployment for evaluation or small environments</li> <li>You are building a SOC and need investigation, correlation, and reporting capabilities</li> </ul> <p>Start Here</p> <p>If you're deploying WitFoo for the first time, start with a single Analytics node. You can add Conductor and Console nodes later as your deployment grows.</p>"},{"location":"getting-started/deployment-roles/#conductor","title":"Conductor","text":"<p>The Conductor node handles data ingestion and signal processing. It collects signals from data sources, parses them into structured artifacts, and forwards them to the Analytics node for analysis.</p>"},{"location":"getting-started/deployment-roles/#purpose-and-use-case_1","title":"Purpose and Use Case","text":"<ul> <li>Deployed at the network edge or in remote locations where data sources reside</li> <li>Collects syslog, API feeds, and agent data from firewalls, IDS/IPS, endpoints, and cloud services</li> <li>Parses and normalizes raw signals before forwarding to Analytics</li> <li>Reduces bandwidth by processing data locally and sending only structured artifacts</li> </ul>"},{"location":"getting-started/deployment-roles/#hardware-requirements_1","title":"Hardware Requirements","text":"Resource Minimum Recommended CPU 4 cores 8 cores RAM 8 GB 16 GB Disk 220 GB 500 GB"},{"location":"getting-started/deployment-roles/#services_1","title":"Services","text":"Service Description NATS Broker Message broker for signal ingestion (ports 4223, 4443) Signal Server Receives raw signals from data sources Signal Parser Parses and normalizes signals into artifacts Artifact Exporter Forwards processed artifacts to Analytics via NATS leaf Broker Edge Manages broker cluster connectivity"},{"location":"getting-started/deployment-roles/#when-to-choose-conductor","title":"When to Choose Conductor","text":"<ul> <li>You have data sources in remote offices, branch locations, or separate network segments</li> <li>You want to process and filter data locally before sending it to Analytics</li> <li>You need to collect data from cloud VPCs (AWS, Azure, Google Cloud)</li> <li>You want to reduce WAN bandwidth usage between sites</li> </ul> <p>Multiple Conductors</p> <p>Deploy one Conductor per network segment or remote location. All Conductors forward their processed artifacts to a central Analytics node.</p>"},{"location":"getting-started/deployment-roles/#console","title":"Console","text":"<p>The Console node provides a centralized management and monitoring interface for your entire WitFoo deployment. It is a lightweight, single-container deployment.</p>"},{"location":"getting-started/deployment-roles/#purpose-and-use-case_2","title":"Purpose and Use Case","text":"<ul> <li>Centralized dashboard for monitoring the health and status of all Conductor and Analytics nodes</li> <li>Remote configuration and management of appliances</li> <li>Deployment oversight for multi-site environments</li> </ul>"},{"location":"getting-started/deployment-roles/#hardware-requirements_2","title":"Hardware Requirements","text":"Resource Minimum Recommended CPU 4 cores 4 cores RAM 8 GB 8 GB Disk 220 GB 220 GB"},{"location":"getting-started/deployment-roles/#services_2","title":"Services","text":"Service Description Console Single container providing management UI and API (port 443)"},{"location":"getting-started/deployment-roles/#when-to-choose-console","title":"When to Choose Console","text":"<ul> <li>You manage multiple Conductor and/or Analytics nodes across different sites</li> <li>You need centralized visibility into appliance health and configuration</li> <li>You want a single pane of glass for deployment management</li> </ul> <p>Console Is Optional</p> <p>The Console node is not required for single-site deployments. A single Analytics node (or Analytics + Conductor) works without a Console. Add a Console when you manage three or more appliances.</p>"},{"location":"getting-started/deployment-roles/#deployment-topologies","title":"Deployment Topologies","text":""},{"location":"getting-started/deployment-roles/#single-node-evaluation-small","title":"Single Node (Evaluation / Small)","text":"<p>Deploy a single Analytics node for evaluation, lab environments, or small organizations.</p> <pre><code>[Data Sources] \u2192 [Analytics]\n</code></pre> <ul> <li>Simplest deployment</li> <li>All ingestion and analysis on one node</li> <li>Recommended hardware: 16 CPU, 32 GB RAM, 1 TB disk</li> </ul>"},{"location":"getting-started/deployment-roles/#two-nodes-small-medium","title":"Two Nodes (Small / Medium)","text":"<p>Deploy a Conductor for data collection and an Analytics node for analysis.</p> <pre><code>[Data Sources] \u2192 [Conductor] \u2192 [Analytics]\n</code></pre> <ul> <li>Separates ingestion from analysis</li> <li>Conductor can be placed in a DMZ or remote network</li> <li>Analytics node is dedicated to processing and UI</li> </ul>"},{"location":"getting-started/deployment-roles/#multi-site-enterprise","title":"Multi-Site (Enterprise)","text":"<p>Deploy Conductors at each site, a central Analytics node, and a Console for management.</p> <pre><code>[Site A Sources] \u2192 [Conductor A] \u2500\u2500\u2510\n[Site B Sources] \u2192 [Conductor B] \u2500\u2500\u2524\u2192 [Analytics] \u2190 [Console]\n[Cloud Sources]  \u2192 [Conductor C] \u2500\u2500\u2518\n</code></pre> <ul> <li>Conductors at each remote site or cloud VPC</li> <li>Central Analytics node for correlation and reporting</li> <li>Console for centralized management of all nodes</li> </ul>"},{"location":"getting-started/deployment-roles/#hardware-summary","title":"Hardware Summary","text":"Role CPU (min) RAM (min) Disk (min) Conductor 4 8 GB 220 GB Console 4 8 GB 220 GB Analytics 8 12 GB 220 GB <p>Right-Sizing Your Deployment</p> <p>Start with the minimum requirements and scale up based on data volume. Monitor resource usage from the Admin &gt; Health dashboard (Analytics) or Grafana (if local metrics are enabled on Conductor). The recommended specs for Analytics (16 CPU, 32 GB RAM, 1 TB disk) support most production workloads.</p>"},{"location":"getting-started/first-login/","title":"First Login","text":"<p>After deploying and configuring your WitFoo Appliance, this page guides you through your first login, changing default credentials, and completing the 12-step onboarding wizard.</p>"},{"location":"getting-started/first-login/#default-credentials","title":"Default Credentials","text":"<p>Change All Default Passwords Immediately</p> <p>WitFoo Appliances ship with default credentials that are publicly documented. You must change these immediately after first login to prevent unauthorized access.</p>"},{"location":"getting-started/first-login/#ssh-access","title":"SSH Access","text":"Field Value Username <code>witfooadmin</code> Password <code>F00theN0ise!</code> <p>Connect via SSH and change the password:</p> <pre><code>ssh witfooadmin@&lt;appliance-ip&gt;\npasswd\n</code></pre>"},{"location":"getting-started/first-login/#web-ui-access","title":"Web UI Access","text":"Field Value URL <code>https://&lt;appliance-ip&gt;</code> Email <code>admin@witfoo.com</code> Password <code>F00theN0ise!</code> <p>The web UI is accessible via HTTPS on port 443.</p> <p>Self-Signed Certificate Warning</p> <p>If you are using the default self-signed certificates, your browser will display a security warning. Accept the warning to proceed, and plan to install trusted certificates for production use.</p>"},{"location":"getting-started/first-login/#changing-the-web-ui-password","title":"Changing the Web UI Password","text":"<ol> <li>Open your browser and navigate to <code>https://&lt;appliance-ip&gt;</code>.</li> <li>Log in with the default credentials (<code>admin@witfoo.com</code> / <code>F00theN0ise!</code>).</li> <li>The onboarding wizard will appear on first login. Step 1 (Create Admin) prompts you to create a new admin user with a secure password.</li> <li>After creating your admin account, log out and log back in with your new credentials.</li> <li>Optionally, disable or delete the default <code>admin@witfoo.com</code> account from Admin &gt; Users.</li> </ol>"},{"location":"getting-started/first-login/#onboarding-wizard","title":"Onboarding Wizard","text":"<p>On first login to an Analytics node, a full-screen onboarding wizard guides you through initial platform configuration. The wizard consists of 12 steps organized by priority.</p>"},{"location":"getting-started/first-login/#step-categories","title":"Step Categories","text":"Category Meaning Critical Must be completed for the platform to function correctly Recommended Strongly suggested for production deployments Optional Enhance functionality but can be configured later <p>Flexible Completion Order</p> <p>Steps can be completed in any order \u2014 use the step navigation on the left side of the wizard to jump between steps. However, Critical steps (0\u20133) should be completed before using the platform for security operations.</p> <p>Persistent Reminders</p> <p>If you skip steps and close the wizard, a persistent banner appears after login reminding you of incomplete configuration. All settings can be changed later from the Admin panel.</p>"},{"location":"getting-started/first-login/#step-overview","title":"Step Overview","text":"Step Name Category Description 0 Welcome Critical Organization settings and preferences 1 Create Admin Critical First admin user account 2 Feature Selection Critical Enable/disable platform modules 3 Data Retention Critical Data lifecycle policies 4 CyberGrid Optional Threat intelligence sharing 5 General Settings Review Recommended Confirm organization settings 6 Business Metrics Optional ROI and cost reporting inputs 7 Compliance Frameworks Recommended Regulatory framework selection 8 Authentication Recommended Identity provider configuration 9 Notifications Optional Email and Slack alerting 10 AI Capabilities Optional AI assistant configuration 11 Summary \u2014 Completion checklist and launch"},{"location":"getting-started/first-login/#step-0-welcome-critical","title":"Step 0: Welcome (Critical)","text":"<p>Configure your organization's basic settings and preferences.</p> Field Description Organization Name Display name for your organization (pre-populated from <code>wfa configure</code>) Timezone Primary timezone for date/time display across the platform Date/Time Format Choose between 12-hour and 24-hour formats, and date ordering (MM/DD/YYYY, DD/MM/YYYY, YYYY-MM-DD) Enable Notifications Toggle platform-wide notification delivery <p>Timezone Matters</p> <p>The timezone setting affects how timestamps are displayed throughout the platform, including in reports and incident timelines. Choose the timezone where your primary SOC operates.</p>"},{"location":"getting-started/first-login/#step-1-create-admin-critical","title":"Step 1: Create Admin (Critical)","text":"<p>Create the first administrative user account. This replaces the default <code>admin@witfoo.com</code> account for day-to-day use.</p> Field Description Full Name Administrator's display name Email Login email address (must be unique) Password Minimum 8 characters; strong password recommended <p>If an admin user already exists (e.g., from a previous configuration), this step is automatically skipped.</p> <p>Create a Personal Admin Account</p> <p>Always create a named admin account for audit trail purposes. The default <code>admin@witfoo.com</code> account should be disabled after your personal account is created.</p>"},{"location":"getting-started/first-login/#step-2-feature-selection-critical","title":"Step 2: Feature Selection (Critical)","text":"<p>Toggle platform modules between three states:</p> State Behavior Full Module is fully enabled with UI navigation, background processing, and API access Background Module runs background processing but is hidden from the UI navigation Disabled Module is completely disabled \u2014 no processing, no UI, no API <p>Available modules:</p> Module Description Search Signal search, graph exploration, and artifact investigation Observer Real-time monitoring dashboards and alert management Reporter Compliance reports, executive summaries, and operational metrics CyberGrid Threat intelligence sharing and IOC enrichment Responder Incident response workflows and playbook automation AI AI-powered analysis assistant and natural language queries <p>The wizard automatically resolves dependencies between modules. For example, enabling Reporter requires Search to be at least in Background mode.</p>"},{"location":"getting-started/first-login/#step-3-data-retention-critical","title":"Step 3: Data Retention (Critical)","text":"<p>Configure how long different categories of data are retained in the database. Set retention periods between 1 and 365 days for each feature area.</p> Data Type Default Description Artifacts 7 days Raw ingested data (logs, events, signals) Work Units 365 days Incidents, investigations, cases Work Collections 365 days Grouped work items and campaigns Reports 1,825 days (5 years) Generated compliance and operational reports <p>Disk Space Planning</p> <p>Longer retention periods require more disk space. Monitor disk usage from the Admin &gt; Health dashboard and adjust retention policies as needed. For high-volume environments, start with shorter artifact retention and increase as you understand your storage consumption.</p>"},{"location":"getting-started/first-login/#step-4-cybergrid-optional","title":"Step 4: CyberGrid (Optional)","text":"<p>Configure participation in WitFoo's CyberGrid threat intelligence network.</p> Mode Description Consumer Receive threat intelligence from the CyberGrid network Contributor Share anonymized threat data and receive intelligence Full Full bidirectional sharing with attribution <p>Select your participation level or skip this step to disable CyberGrid.</p>"},{"location":"getting-started/first-login/#step-5-general-settings-review-recommended","title":"Step 5: General Settings Review (Recommended)","text":"<p>A read-only confirmation screen displaying the settings configured in Step 0 (Welcome). Review your organization name, timezone, date/time format, and notification preferences.</p> <p>No input is required \u2014 confirm the settings are correct and proceed.</p>"},{"location":"getting-started/first-login/#step-6-business-metrics-optional","title":"Step 6: Business Metrics (Optional)","text":"<p>Provide business context for ROI calculations and executive reporting. These values are used by the Reporter module to generate cost-savings and efficiency reports.</p> Field Description FTE Annual Cost Fully loaded cost per full-time security employee Annual Revenue Organization's annual revenue (for risk calculations) Annual Security Spend Total annual security operations budget Mean Time to Detect Average time to detect a security incident (hours) Mean Time to Respond Average time to respond to a security incident (hours) <p>Estimate If Unsure</p> <p>These values are used for reporting only and can be updated at any time. Reasonable estimates are better than skipping this step entirely, as they enable ROI dashboards from day one.</p>"},{"location":"getting-started/first-login/#step-7-compliance-frameworks-recommended","title":"Step 7: Compliance Frameworks (Recommended)","text":"<p>Enable the compliance frameworks relevant to your organization and designate a primary framework.</p> <p>Available frameworks include industry standards such as:</p> <ul> <li>CIS Controls (CSC v7, CSC v8)</li> <li>NIST Cybersecurity Framework (CSF)</li> <li>NIST 800-53</li> <li>ISO 27001</li> <li>PCI DSS</li> <li>HIPAA</li> <li>SOC 2</li> </ul> <p>Toggle each framework on or off, then select one as your primary framework. The primary framework determines the default compliance view in Reporter dashboards.</p>"},{"location":"getting-started/first-login/#step-8-authentication-recommended","title":"Step 8: Authentication (Recommended)","text":"<p>Configure how users authenticate to the platform.</p> Method Description Local Username/password stored in the WitFoo database LDAP Authenticate against an LDAP or Active Directory server SAML SSO Single sign-on via a SAML 2.0 identity provider Mixed Local accounts for admins, LDAP/SAML for standard users <p>For LDAP and SAML configurations, the wizard provides Test Connection buttons to validate connectivity before saving.</p> LDAP Fields Description Server URL LDAP server address (e.g., <code>ldaps://ldap.mycompany.com:636</code>) Bind DN Distinguished name for LDAP binding Bind Password Password for the bind DN Search Base Base DN for user searches User Filter LDAP filter for user lookup SAML Fields Description IdP Metadata URL URL to the identity provider's SAML metadata Entity ID Service provider entity ID ACS URL Assertion Consumer Service URL (auto-populated)"},{"location":"getting-started/first-login/#step-9-notifications-optional","title":"Step 9: Notifications (Optional)","text":"<p>Configure notification channels for alerts, incident updates, and system events.</p> <p>SMTP Email:</p> Field Description SMTP Server Mail server hostname and port From Address Sender email address Username SMTP authentication username Password SMTP authentication password Use TLS Enable TLS encryption <p>Slack Webhook:</p> Field Description Webhook URL Slack incoming webhook URL Default Channel Channel for notifications (overridden by webhook config) <p>Both channels provide a Test Send button to verify configuration before saving.</p>"},{"location":"getting-started/first-login/#step-10-ai-capabilities-optional","title":"Step 10: AI Capabilities (Optional)","text":"<p>Configure the AI assistant for natural language investigation queries and automated analysis.</p> Field Description AI Provider Select from Anthropic, OpenAI, or Google API Key Your API key for the selected provider Model Specific model to use (e.g., <code>claude-sonnet-4-20250514</code>, <code>gpt-4o</code>) Temperature Response creativity (0.0 = deterministic, 1.0 = creative) Max Tokens Maximum response length <p>AI API Keys</p> <p>AI features require an API key from a supported provider. Your API key is encrypted at rest and never shared. You can change providers or disable AI at any time from Admin &gt; AI Settings.</p>"},{"location":"getting-started/first-login/#step-11-summary","title":"Step 11: Summary","text":"<p>The final step displays a progress checklist showing the completion status of all previous steps.</p> Element Description Step Checklist Each step shown with \u2705 (complete) or \u26a0\ufe0f (skipped/incomplete) Completion Percentage Overall configuration progress Launch Platform Button to close the wizard and enter the platform <p>Clicking Launch Platform closes the wizard and takes you to the main dashboard. Any incomplete steps will trigger a persistent banner reminder.</p> <p>All Settings Are Editable</p> <p>Every setting configured in the onboarding wizard can be modified later from the Admin panel. The wizard is a convenience for initial setup \u2014 it does not lock in any configuration permanently.</p>"},{"location":"getting-started/installation/","title":"Installation","text":"<p>This guide covers deploying a WitFoo Appliance (WFA) \u2014 the production deployment method for WitFoo Analytics. The WFA daemon manages containers, configuration, and lifecycle for all node roles.</p>"},{"location":"getting-started/installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Network access to the target host via SSH (port 22) and HTTPS (port 443)</li> <li>A WitFoo license key, or plan to request a 15-day trial during configuration</li> <li>Hardware meeting the minimum requirements for your chosen deployment role</li> </ul>"},{"location":"getting-started/installation/#hardware-requirements","title":"Hardware Requirements","text":"Tier CPU Cores RAM Disk Minimum 8 12 GB 220 GB Recommended 16 32 GB 1 TB"},{"location":"getting-started/installation/#per-role-minimums","title":"Per-Role Minimums","text":"Role CPU (min) RAM (min) Disk (min) Conductor 4 8 GB 220 GB Console 4 8 GB 220 GB Analytics 8 12 GB 220 GB"},{"location":"getting-started/installation/#installation-overview","title":"Installation Overview","text":"<p>Deploying WitFoo Analytics follows three steps regardless of your infrastructure:</p> <ol> <li>Deploy a WitFoo Appliance image or run an install script</li> <li>Configure the appliance role with <code>sudo wfa configure</code></li> <li>Access the web UI via HTTPS (port 443) and complete the onboarding wizard</li> </ol>"},{"location":"getting-started/installation/#step-1-deploy-a-witfoo-appliance","title":"Step 1: Deploy a WitFoo Appliance","text":"<p>Choose the deployment method that matches your infrastructure. All appliance images and scripts are available from the witfoo-appliances repository.</p>"},{"location":"getting-started/installation/#option-a-on-premises-vm","title":"Option A: On-Premises VM","text":"<p>Pre-built Ubuntu 24 virtual machine images are available for the following hypervisors:</p> <ol> <li> <p>Download the appropriate image from github.com/witfoo/witfoo-appliances:</p> <ul> <li>VMware \u2014 OVA format</li> <li>Hyper-V \u2014 VHDX format</li> <li>QEMU/KVM \u2014 QCOW2 format</li> </ul> </li> <li> <p>Import the image into your hypervisor and allocate resources according to the hardware requirements for your intended role.</p> </li> <li> <p>Boot the virtual machine. The appliance will start with a default network configuration using DHCP.</p> </li> <li> <p>Connect via SSH to the appliance:</p> <pre><code>ssh witfooadmin@&lt;appliance-ip&gt;\n</code></pre> </li> </ol> <p>Change Default Credentials Immediately</p> <p>The default SSH credentials are <code>witfooadmin</code> / <code>F00theN0ise!</code>. Change these immediately after first login. See First Login for details.</p>"},{"location":"getting-started/installation/#option-b-cloud-marketplace","title":"Option B: Cloud Marketplace","text":"<p>WitFoo Appliances are available on major cloud marketplaces:</p> <ol> <li> <p>Launch a WitFoo Appliance instance from your cloud provider's marketplace:</p> <ul> <li>AWS Marketplace \u2014 Search for \"WitFoo Appliance\"</li> <li>Azure Marketplace \u2014 Search for \"WitFoo Appliance\"</li> <li>Google Cloud Marketplace \u2014 Search for \"WitFoo Appliance\"</li> </ul> </li> <li> <p>Select an instance size that meets the hardware requirements for your intended role.</p> </li> <li> <p>Configure your security group or firewall rules to allow:</p> <ul> <li>Port 22 \u2014 SSH (administration)</li> <li>Port 443 \u2014 HTTPS (web UI)</li> </ul> </li> <li> <p>Connect via SSH using your cloud provider's key pair or the default credentials.</p> </li> </ol> <p>Cloud Instance Sizing</p> <p>For an Analytics node, start with at least 8 vCPUs and 12 GB RAM. For production workloads, 16 vCPUs and 32 GB RAM with 1 TB disk is recommended.</p>"},{"location":"getting-started/installation/#option-c-bare-metal","title":"Option C: Bare Metal","text":"<p>Install the WitFoo Appliance directly on a physical or virtual server using the provided install scripts:</p> <p>Ubuntu 24:</p> <ol> <li> <p>Start with a fresh Ubuntu 24 server installation.</p> </li> <li> <p>Download and run the install script:</p> <pre><code>curl -fsSL https://raw.githubusercontent.com/witfoo/witfoo-appliances/main/ubuntu-install.sh -o ubuntu-install.sh\nchmod +x ubuntu-install.sh\nsudo ./ubuntu-install.sh\n</code></pre> </li> <li> <p>The script installs all dependencies, creates the <code>witfooadmin</code> user, and installs the WFA daemon.</p> </li> </ol> <p>RHEL 10:</p> <ol> <li> <p>Start with a fresh RHEL 10 server installation.</p> </li> <li> <p>Download and run the install script:</p> <pre><code>curl -fsSL https://raw.githubusercontent.com/witfoo/witfoo-appliances/main/rhel-install.sh -o rhel-install.sh\nchmod +x rhel-install.sh\nsudo ./rhel-install.sh\n</code></pre> </li> <li> <p>The script installs all dependencies, creates the <code>witfooadmin</code> user, and installs the WFA daemon.</p> </li> </ol>"},{"location":"getting-started/installation/#step-2-configure-the-appliance","title":"Step 2: Configure the Appliance","text":"<p>Once the appliance is deployed, run the interactive configuration wizard to select a role and configure services:</p> <pre><code>sudo wfa configure\n</code></pre> <p>The wizard walks you through organization setup, role selection, licensing, networking, and optional features. It generates the configuration file at <code>/witfoo/configs/node.json</code>.</p> <p>For a detailed walkthrough of every prompt and option, see WFA Configure Wizard.</p>"},{"location":"getting-started/installation/#step-3-access-the-web-ui","title":"Step 3: Access the Web UI","text":"<p>After configuration completes, the WFA daemon starts all services for your selected role. For Analytics nodes:</p> <ol> <li> <p>Open a web browser and navigate to:</p> <pre><code>https://&lt;appliance-ip&gt;\n</code></pre> </li> <li> <p>Log in with the default web UI credentials:</p> <ul> <li>Email: <code>admin@witfoo.com</code></li> <li>Password: <code>F00theN0ise!</code></li> </ul> </li> <li> <p>Complete the 12-step onboarding wizard to configure your organization, users, and integrations.</p> </li> </ol> <p>See First Login for detailed instructions on the onboarding process.</p> <p>Change Default Passwords</p> <p>Both the SSH and web UI default passwords must be changed immediately after first login. See First Login for instructions.</p>"},{"location":"getting-started/installation/#verifying-the-installation","title":"Verifying the Installation","text":"<p>After completing configuration, verify that services are running:</p> <pre><code>sudo wfa analytics status\n</code></pre> <p>This command lists all expected services and their current state. All services should report as running within a few minutes of configuration completing.</p> <p>Cassandra Startup Time</p> <p>The Cassandra database may take 2\u20135 minutes to fully initialize on first boot. Other services will wait for Cassandra before becoming available.</p>"},{"location":"getting-started/installation/#next-steps","title":"Next Steps","text":"<ul> <li>Choose a deployment role if you haven't already</li> <li>Walk through the configure wizard in detail</li> <li>Complete first login and onboarding</li> <li>Understand the architecture</li> </ul> <p>For Developers</p> <p>This guide covers production deployment via WitFoo Appliances. If you are a developer working on WitFoo Analytics itself, see the Deployment section of the documentation for Docker Compose development workflows.</p>"},{"location":"getting-started/wfa-configure/","title":"WFA Configure Wizard","text":"<p>The <code>sudo wfa configure</code> command launches an interactive wizard that configures a WitFoo Appliance for its intended role. This page documents every step of the wizard, including the exact prompts, options, and role-specific differences.</p>"},{"location":"getting-started/wfa-configure/#overview","title":"Overview","text":"<p>The wizard generates the configuration file <code>/witfoo/configs/node.json</code>, which the WFA daemon uses to determine which services to run and how to configure them. Run the wizard as root:</p> <pre><code>sudo wfa configure\n</code></pre>"},{"location":"getting-started/wfa-configure/#step-applicability-by-role","title":"Step Applicability by Role","text":"<p>Not every step applies to every role. Use this table as a quick reference:</p> Step Conductor Console Analytics 1. Organization Information \u2705 \u2705 \u2705 2. Role Selection \u2705 \u2705 \u2705 3. License Configuration \u2705 \u2705 \u2705 4. Appliance ID \u2705 \u2014 \u2705 5. Node Hostname and IP \u2705 \u2705 \u2705 6. Network Configuration \u2705 \u2014 \u2014 7. Registry Configuration \u2705 \u2705 \u2705 8. Certificate Configuration \u2705 \u2705 \u2705 9. Admin Password \u2705 \u2705 \u2705 10. Optional Features \u2705 \u2705 \u2705 11. Review and Save \u2705 \u2705 \u2705"},{"location":"getting-started/wfa-configure/#step-1-organization-information","title":"Step 1: Organization Information","text":"<p>The wizard begins by collecting your organization details.</p> <pre><code>=== Organization Information ===\nOrganization ID: mycompany\nOrganization Name: My Company Inc.\n</code></pre> <ul> <li>Organization ID \u2014 A DNS-valid, lowercase identifier for your organization (e.g., <code>mycompany</code>). This is used internally for data partitioning and must be consistent across all nodes in your deployment.</li> <li>Organization Name \u2014 The human-readable display name for your organization.</li> </ul> <p>Organization ID Format</p> <p>The Organization ID must be lowercase, contain only letters, numbers, and hyphens, and be valid as a DNS label. Choose this carefully \u2014 it cannot be changed after deployment without data migration.</p>"},{"location":"getting-started/wfa-configure/#step-2-role-selection","title":"Step 2: Role Selection","text":"<p>Select the role this appliance will perform in your deployment.</p> <pre><code>=== Role Selection ===\nSelect appliance role:\n  1) Conductor\n  2) Console\n  3) Analytics\n\nEnter selection [1-3]: 3\n</code></pre> <p>After selection, the wizard performs a hardware check against the minimum requirements for the chosen role:</p> Role CPU (min) RAM (min) Disk (min) Conductor 4 8 GB 220 GB Console 4 8 GB 220 GB Analytics 8 12 GB 220 GB <p>If the host does not meet the minimum requirements, the wizard displays a warning:</p> <pre><code>\u26a0 WARNING: This host has 4 CPU cores but the Analytics role requires a minimum of 8.\n  Performance may be degraded. Continue anyway? [y/N]:\n</code></pre> <p>Choosing a Role</p> <ul> <li>Analytics is the primary platform \u2014 choose this for investigation, correlation, and reporting.</li> <li>Conductor handles data ingestion from remote networks and forwards signals to Analytics.</li> <li>Console provides centralized management of multiple Conductor and Analytics nodes.</li> </ul> <p>See Deployment Roles for detailed guidance.</p>"},{"location":"getting-started/wfa-configure/#step-3-license-configuration","title":"Step 3: License Configuration","text":"<p>The wizard configures your WitFoo license, which determines available features and container registry access.</p> <p>Cloud deployments (AWS, Azure, Google Cloud marketplace instances):</p> <pre><code>=== License Configuration ===\nCloud deployment detected. Fetching license from licensing.witfoo.com...\nLicense validated successfully.\n  Organization: My Company Inc.\n  Tier: Enterprise\n  Expiration: 2026-03-15\n</code></pre> <p>The license is automatically retrieved from <code>licensing.witfoo.com</code> based on the cloud instance metadata.</p> <p>On-premises deployments:</p> <pre><code>=== License Configuration ===\nSelect license method:\n  1) Enter license key\n  2) Request 15-day trial\n\nEnter selection [1-2]:\n</code></pre> <p>Option 1 \u2014 Enter license key:</p> <pre><code>License Key: XXXX-XXXX-XXXX-XXXX\nValidating license... \u2713\n</code></pre> <p>Option 2 \u2014 Request 15-day trial:</p> <pre><code>Company Name: My Company Inc.\nContact Name: Jane Smith\nContact Email: jane@mycompany.com\nCPU Core Count: 16\n\nRequesting trial license... \u2713\nTrial license activated. Expires: 2026-02-01\n</code></pre> <p>Trial Licenses</p> <p>Trial licenses provide full functionality for 15 days. Contact WitFoo sales to convert to a permanent license before the trial expires.</p>"},{"location":"getting-started/wfa-configure/#step-4-appliance-id","title":"Step 4: Appliance ID","text":"<p>An Appliance ID uniquely identifies this node within your deployment. This step is skipped for Console nodes, which manage other appliances rather than processing data directly.</p> <pre><code>=== Appliance ID ===\nAuto-generated Appliance ID: a1b2c3d4-e5f6-7890-abcd-ef1234567890\nAccept this ID? [Y/n]:\n</code></pre> <p>The wizard auto-generates a UUID. Accept the default or enter a custom UUID if replacing an existing node.</p> <p>Console Nodes</p> <p>Console nodes skip this step because they do not have their own Appliance ID \u2014 they manage the IDs of the Conductor and Analytics nodes they monitor.</p>"},{"location":"getting-started/wfa-configure/#step-5-node-hostname-and-ip","title":"Step 5: Node Hostname and IP","text":"<p>Configure the network identity of this node.</p> <pre><code>=== Node Hostname and IP ===\nHostname [wfa-analytics-01]: wfa-analytics-01\nDetected IP address: 10.0.1.50\nUse detected IP? [Y/n]:\n</code></pre> <ul> <li>Hostname \u2014 The hostname for this node. Auto-detected from the system hostname.</li> <li>IP Address \u2014 The primary IP address. Auto-detected from the active network interface with an option to override manually.</li> </ul> <p>If you decline the detected IP:</p> <pre><code>Enter IP address: 10.0.1.100\n</code></pre> <p>Static IP Recommended</p> <p>For production deployments, assign a static IP address to the appliance before running the wizard. DHCP-assigned addresses may change, breaking inter-node communication.</p>"},{"location":"getting-started/wfa-configure/#step-6-network-configuration-conductor-only","title":"Step 6: Network Configuration (Conductor Only)","text":"<p>This step configures the NATS message broker ports and limits. It appears only for Conductor nodes.</p> <pre><code>=== Network Configuration ===\nBroker client port [4223]: 4223\nBroker leaf node port [4443]: 4443\nMax data size (MB) [1024]: 1024\n</code></pre> <ul> <li>Broker client port \u2014 The port that data sources connect to for signal submission (default: <code>4223</code>).</li> <li>Broker leaf node port \u2014 The port used for leaf node connections between Conductor and Analytics nodes (default: <code>4443</code>).</li> <li>Max data size \u2014 Maximum message payload size in megabytes (default: <code>1024</code> MB).</li> </ul> <p>Firewall Rules for Conductor</p> <p>Ensure your firewall allows inbound connections on the broker client port (default 4223) from data sources, and on the leaf node port (default 4443) from Analytics nodes.</p>"},{"location":"getting-started/wfa-configure/#step-7-registry-configuration","title":"Step 7: Registry Configuration","text":"<p>Configure access to the WitFoo container registry for pulling service images.</p> <pre><code>=== Registry Configuration ===\nContainer registry credentials populated from license validation.\n  Registry: registry.witfoo.com\n  Username: mycompany\n  Status: \u2713 Authenticated\n</code></pre> <p>Registry credentials are automatically populated from the license validation performed in Step 3. If credentials need to be entered manually:</p> <pre><code>Registry URL [registry.witfoo.com]: registry.witfoo.com\nRegistry Username: mycompany\nRegistry Password: ********\nValidating credentials... \u2713\n</code></pre>"},{"location":"getting-started/wfa-configure/#step-8-certificate-configuration","title":"Step 8: Certificate Configuration","text":"<p>Configure TLS certificates for secure communication between nodes and with the web UI.</p> <pre><code>=== Certificate Configuration ===\nConfigure custom TLS certificates? [y/N]:\n</code></pre> <p>If you accept the defaults, the wizard uses self-signed certificates stored under <code>/witfoo/certs/</code>. To provide your own certificates:</p> <pre><code>Configure custom TLS certificates? [y/N]: y\n\nClient certificate path [/witfoo/certs/client-cert.pem]: /path/to/client-cert.pem\nClient key path [/witfoo/certs/client-key.pem]: /path/to/client-key.pem\nServer certificate path [/witfoo/certs/server-cert.pem]: /path/to/server-cert.pem\nServer key path [/witfoo/certs/server-key.pem]: /path/to/server-key.pem\nCA certificate path [/witfoo/certs/ca-cert.pem]: /path/to/ca-cert.pem\n\nValidating certificates... \u2713\n</code></pre> <p>Production TLS</p> <p>Self-signed certificates are suitable for evaluation only. For production deployments, provide certificates signed by your organization's certificate authority or a trusted public CA.</p> <p>Certificate Paths</p> <p>Default certificate paths are under <code>/witfoo/certs/</code>. You can place your certificates there before running the wizard to accept the defaults.</p>"},{"location":"getting-started/wfa-configure/#step-9-admin-password","title":"Step 9: Admin Password","text":"<p>Set the administrative password for the appliance.</p> <pre><code>=== Admin Password ===\nEnter admin password (min 8 characters): ********\nConfirm admin password: ********\nAdmin password saved.\n</code></pre> <ul> <li>Minimum 8 characters required</li> <li>Input is masked (not displayed)</li> <li>Confirmation must match</li> <li>Password is saved to <code>/data/local/.passwd</code></li> </ul> <p>Choose a Strong Password</p> <p>This password is used for appliance-level administration. Choose a strong, unique password and store it securely. It is separate from the web UI admin password.</p>"},{"location":"getting-started/wfa-configure/#step-10-optional-features","title":"Step 10: Optional Features","text":"<p>The wizard presents role-specific optional features. Available options vary by role.</p>"},{"location":"getting-started/wfa-configure/#conductor-options","title":"Conductor Options","text":"<pre><code>=== Optional Features ===\nEnable local metrics (Prometheus/Grafana)? [y/N]: y\nEnable offline mode? [y/N]: n\nEnable metrics export? [y/N]: y\nEnable auto-update? [y/N]: y\nRemote console FQDN (leave blank to skip): console.mycompany.com\n</code></pre> <ul> <li>Local metrics \u2014 Deploy Prometheus and Grafana containers for local monitoring of the Conductor node.</li> <li>Offline mode \u2014 Operate without internet connectivity. Requires pre-loaded container images.</li> <li>Metrics export \u2014 Export Conductor metrics to an external monitoring system.</li> <li>Auto-update \u2014 Automatically pull and apply updates from the WitFoo registry.</li> <li>Remote console FQDN \u2014 The fully qualified domain name of the Console node that manages this Conductor.</li> </ul>"},{"location":"getting-started/wfa-configure/#console-options","title":"Console Options","text":"<pre><code>=== Optional Features ===\nEnable offline mode? [y/N]: n\nEnable auto-update? [y/N]: y\n</code></pre> <ul> <li>Offline mode \u2014 Operate without internet connectivity.</li> <li>Auto-update \u2014 Automatically pull and apply updates from the WitFoo registry.</li> </ul>"},{"location":"getting-started/wfa-configure/#analytics-options","title":"Analytics Options","text":"<pre><code>=== Optional Features ===\nConfigure data retention policies? [y/N]: y\n  Artifact retention (days) [7]: 30\n  Work unit retention (days) [365]: 365\n  Work collection retention (days) [365]: 365\n  Report retention (days) [1825]: 1825\n\nConfigure UI module visibility? [y/N]: y\n  Module visibility [all/search_only/search_observer]: all\n\nEnable CyberGrid integration? [y/N]: y\n  CyberGrid mode [consumer/contributor/full]: consumer\n\nConfigure clustering? [y/N]: n\n</code></pre> <ul> <li>Data retention policies \u2014 Set how long different data types are retained in the database.</li> <li>UI module visibility \u2014 Control which modules appear in the web UI (all, search only, or search + observer).</li> <li>CyberGrid integration \u2014 Enable threat intelligence sharing. Choose Consumer (receive only), Contributor (send and receive), or Full participation.</li> <li>Clustering \u2014 Configure multi-node Cassandra clustering for horizontal scaling. Prompts for seed nodes and data node addresses.</li> </ul> <p>Analytics Retention Defaults</p> <p>The default retention periods are optimized for most deployments. Artifacts (raw data) default to 7 days, while work units, collections, and reports are retained for 1\u20135 years. Adjust based on your compliance requirements and available disk space.</p>"},{"location":"getting-started/wfa-configure/#step-11-review-and-save","title":"Step 11: Review and Save","text":"<p>The wizard displays a summary of all configured settings for review.</p> <pre><code>=== Configuration Summary ===\nOrganization ID:    mycompany\nOrganization Name:  My Company Inc.\nRole:               Analytics\nAppliance ID:       a1b2c3d4-e5f6-7890-abcd-ef1234567890\nHostname:           wfa-analytics-01\nIP Address:         10.0.1.50\nRegistry:           registry.witfoo.com\nTLS:                Custom certificates\nAuto-update:        Enabled\nData Retention:     Artifacts: 30d, Work Units: 365d, Reports: 1825d\nUI Modules:         All\nCyberGrid:          Consumer\n\nSave this configuration? [Y/n]: y\n\nConfiguration saved to /witfoo/configs/node.json\nStarting services...\n</code></pre> <p>After confirmation, the wizard writes the configuration to <code>/witfoo/configs/node.json</code> and the WFA daemon begins pulling container images and starting services.</p> <p>Re-running the Wizard</p> <p>You can re-run <code>sudo wfa configure</code> at any time to modify settings. The wizard will load existing values from <code>/witfoo/configs/node.json</code> as defaults, allowing you to change only what's needed.</p>"},{"location":"getting-started/wfa-configure/#what-happens-next","title":"What Happens Next","text":"<p>After the wizard completes:</p> <ol> <li>The WFA daemon pulls container images from the configured registry</li> <li>Services start in dependency order (Cassandra first, then dependent services)</li> <li>For Analytics nodes, the web UI becomes available on port 443 within a few minutes</li> <li>Proceed to First Login to change default passwords and complete the onboarding wizard</li> </ol>"},{"location":"reference/","title":"Reference","text":"<p>Technical reference documentation for WitFoo Analytics.</p>"},{"location":"reference/#sections","title":"Sections","text":"<ul> <li>Permissions \u2014 Complete permission list</li> <li>Roles \u2014 Built-in role definitions</li> <li>Environment Variables \u2014 Full configuration reference</li> <li>Cassandra Schema \u2014 Database schema overview</li> <li>Changelog \u2014 Version history and release notes</li> </ul>"},{"location":"reference/cassandra-schema/","title":"Cassandra Schema","text":"<p>Overview of the WitFoo Analytics Cassandra database schema.</p>"},{"location":"reference/cassandra-schema/#keyspace","title":"Keyspace","text":"<pre><code>CREATE KEYSPACE IF NOT EXISTS witfoo\nWITH replication = {'class': 'SimpleStrategy', 'replication_factor': 1};\n</code></pre>"},{"location":"reference/cassandra-schema/#core-tables","title":"Core Tables","text":"Table Partition Key Description <code>artifacts</code> <code>org_id, artifact_id</code> Security artifacts <code>incidents</code> <code>org_id, incident_id</code> Correlated incidents <code>graph_nodes</code> <code>org_id, node_id</code> Entity nodes <code>graph_edges</code> <code>org_id, edge_id</code> Relationship edges <code>users</code> <code>org_id, user_id</code> User accounts <code>roles</code> <code>org_id, role_id</code> Role definitions"},{"location":"reference/cassandra-schema/#settings-tables","title":"Settings Tables","text":"Table Partition Key Description <code>business_settings</code> <code>org_id</code> Financial/operational settings <code>frameworks</code> <code>org_id, framework_id</code> Compliance frameworks <code>framework_controls</code> <code>org_id, framework_id, control_id</code> Framework controls <code>product_framework_controls</code> <code>org_id</code> Product-control mapping"},{"location":"reference/cassandra-schema/#observer-tables","title":"Observer Tables","text":"Table Partition Key Description <code>work_units</code> <code>org_id, work_unit_id</code> Analyst work tasks <code>work_collections</code> <code>org_id, collection_id</code> Work groups <code>mo_definitions</code> <code>org_id, mo_id</code> MO patterns <code>observations</code> <code>org_id, observation_id</code> Investigation notes"},{"location":"reference/cassandra-schema/#health-tables","title":"Health Tables","text":"Table Partition Key Description <code>container_metrics</code> <code>org_id, container_name, metric_id</code> Container stats <code>health_alerts</code> <code>org_id, alert_id</code> Alert rules"},{"location":"reference/cassandra-schema/#notification-tables","title":"Notification Tables","text":"Table Partition Key Description <code>notification_channels</code> <code>org_id, channel_id</code> Notification channels <code>notification_rules</code> <code>org_id, rule_id</code> Notification rules <code>notification_history</code> <code>org_id, rule_id, incident_id, delivery_id</code> Delivery log (TTL 30 days)"},{"location":"reference/cassandra-schema/#schema-initialization","title":"Schema Initialization","text":"<p>Schema is initialized from <code>cassandra/init-schema.cql</code> on first boot. Seed data is applied from <code>cassandra/seeders/</code>.</p>"},{"location":"reference/changelog/","title":"Changelog","text":"<p>Version history for WitFoo Analytics.</p>"},{"location":"reference/changelog/#dev-initial-release","title":"dev (Initial Release)","text":"<ul> <li>Initial documentation site created</li> <li>Getting Started guide with architecture diagrams</li> <li>User Guide for all 6 modules (Signals, Graph, Observer, Reporter, CyberGrid, Health)</li> <li>Admin Guide with RBAC permissions reference</li> <li>API Reference for 150+ endpoints</li> <li>AI &amp; MCP documentation</li> <li>Deployment guide for Docker, WFA, and Conductor</li> <li>Reference section with permissions, roles, and environment variables</li> </ul>"},{"location":"reference/environment-variables/","title":"Environment Variables","text":"<p>Complete reference for WitFoo Analytics environment variables.</p>"},{"location":"reference/environment-variables/#required","title":"Required","text":"Variable Description <code>JWT_SECRET</code> HS256 signing key for JWT tokens"},{"location":"reference/environment-variables/#core","title":"Core","text":"Variable Default Description <code>ORG_ID</code> <code>witfoo</code> Organization identifier <code>CASSANDRA_HOST</code> <code>cassandra</code> Cassandra hostname <code>NATS_URL</code> <code>nats://nats:4222</code> NATS server URL"},{"location":"reference/environment-variables/#service-ports","title":"Service Ports","text":"Variable Default Service <code>REVERSE_PROXY_PORT</code> <code>8080</code> Reverse proxy <code>API_PORT</code> <code>8090</code> API gateway <code>IE_PORT</code> <code>8082</code> Incident Engine <code>UI_PORT</code> <code>5173</code> SvelteKit <code>AI_PORT</code> <code>8003</code> Artifact Ingestion"},{"location":"reference/environment-variables/#security","title":"Security","text":"Variable Default Description <code>AUTH_CONFIG_ENCRYPTION_KEY</code> (empty) AES-256-GCM encryption key (base64) <code>ANALYTICS_SECRET</code> (empty) HMAC-SHA256 secret for Conductor auth"},{"location":"reference/environment-variables/#feature-flags","title":"Feature Flags","text":"Variable Default Description <code>WF_LICENSE</code> (empty) Intel API license for framework sync <code>VITE_UI_MODULES</code> <code>all</code> UI module visibility <code>REVERSE_PROXY_MODE</code> <code>false</code> Enable proxy header trust for Conductor UI"},{"location":"reference/environment-variables/#monitoring","title":"Monitoring","text":"Variable Default Description <code>GRAFANA_REMOTE_WRITE_URL</code> (empty) Prometheus remote write endpoint <code>GRAFANA_INSTANCE_ID</code> (empty) Grafana Cloud instance ID <code>GRAFANA_API_KEY</code> (empty) Grafana Cloud API key"},{"location":"reference/environment-variables/#cassandra-tuning","title":"Cassandra Tuning","text":"Variable Default Description <code>CASSANDRA_HEAP</code> <code>1G</code> JVM heap size <code>CASSANDRA_NEWSIZE</code> <code>200M</code> JVM new generation size <code>DATA_NODE_HOSTS</code> (empty) External Cassandra hosts (comma-separated)"},{"location":"reference/permissions/","title":"Permissions Reference","text":"<p>Complete list of WitFoo Analytics permissions.</p>"},{"location":"reference/permissions/#permission-list","title":"Permission List","text":"Permission Description <code>admin</code> Full administrative access (grants all other permissions) <code>signals:read</code> View artifacts, incidents, nodes, edges <code>signals:write</code> Create/edit lead rules, classification rules, saved searches <code>signals:manage</code> Delete signals data, manage enrichment settings <code>observer:read</code> View work units, collections, MO definitions, observations <code>observer:write</code> Create/edit observer data <code>observer:manage</code> Delete observer data, manage MO definitions <code>reports:read</code> View all Reporter sections <code>reports:write</code> Export reports (CSV) <code>reports:manage</code> Configure report settings <code>frameworks:read</code> View compliance frameworks and controls <code>frameworks:write</code> Edit framework associations <code>frameworks:manage</code> Enable/disable frameworks, set primary, sync <code>cybergrid:read</code> View subscriptions, publications, library <code>cybergrid:write</code> Manage subscriptions, trigger syncs <code>cybergrid:manage</code> Create publications, manage feeds <code>health:read</code> View container metrics and health dashboard <code>health:manage</code> Configure health alerts <code>metrics:read</code> Access Prometheus metrics endpoint <code>settings:read</code> View system settings <code>settings:manage</code> Modify all settings (business, auth, notifications, certs) <code>ai:read</code> Use AI chat interface <code>ai:write</code> Manage chat sessions <code>ai:manage</code> Configure AI providers and MCP <code>ai:export</code> Export chat transcripts <code>conductor:read</code> View Conductor UI <code>conductor:write</code> Configure Conductor <code>conductor:admin</code> Full Conductor administration"},{"location":"reference/permissions/#hierarchy","title":"Hierarchy","text":"<pre><code>admin \u2192 (all permissions)\nresource:manage \u2192 resource:write \u2192 resource:read\n</code></pre>"},{"location":"reference/roles/","title":"Roles Reference","text":"<p>Built-in role definitions and their permission sets.</p>"},{"location":"reference/roles/#role-matrix","title":"Role Matrix","text":"Permission Admin Analyst Auditor ReadOnly Health CyberGrid Reporter AIUser signals:read x x x signals:write x x signals:manage x observer:read x x observer:write x x observer:manage x reports:read x x x x reports:write x x x reports:manage x frameworks:read x x x x frameworks:manage x cybergrid:read x x x cybergrid:write x x cybergrid:manage x x health:read x x health:manage x x metrics:read x x settings:read x settings:manage x ai:read x x x ai:write x x ai:manage x conductor:read x conductor:write x conductor:admin x"},{"location":"user-guide/","title":"User Guide","text":"<p>WitFoo Analytics provides a unified interface for security operations \u2014 from artifact search and incident investigation to compliance reporting and threat intelligence.</p>"},{"location":"user-guide/#modules","title":"Modules","text":""},{"location":"user-guide/#signals","title":"Signals","text":"<p>Search, filter, and investigate security artifacts. Configure lead rules for automatic incident creation and classification rules for severity assignment.</p>"},{"location":"user-guide/#graph","title":"Graph","text":"<p>Explore the relationship graph built from correlated artifacts. Nodes represent entities (IPs, domains, users) and edges represent observed relationships between them.</p>"},{"location":"user-guide/#observer","title":"Observer","text":"<p>Track analyst work through work units, organize investigations into work collections, define modus operandi (MO) patterns, and record observations for institutional knowledge.</p>"},{"location":"user-guide/#reporter","title":"Reporter","text":"<p>Generate executive reports covering compliance readiness, tool effectiveness, and cost/savings analysis. Date-range filtering and CSV export for all report data.</p>"},{"location":"user-guide/#cybergrid","title":"CyberGrid","text":"<p>Subscribe to and publish threat intelligence feeds. Manage intelligence jobs, browse the threat intelligence library, and share indicators across organizations.</p>"},{"location":"user-guide/#health","title":"Health","text":"<p>Monitor system health with real-time container metrics, historical performance data, and configurable alert rules for CPU, memory, disk, and service availability.</p>"},{"location":"user-guide/#navigation","title":"Navigation","text":"<p>Use the top navigation bar to switch between modules. The sidebar within each module provides access to sub-pages. Your available modules depend on your assigned role and the deployment's UI module configuration.</p>"},{"location":"user-guide/cybergrid/","title":"CyberGrid","text":"<p>CyberGrid is WitFoo Analytics' threat intelligence sharing platform. Subscribe to curated feeds, publish indicators, and enrich security data with community intelligence.</p>"},{"location":"user-guide/cybergrid/#components","title":"Components","text":""},{"location":"user-guide/cybergrid/#subscriptions","title":"Subscriptions","text":"<p>Subscribe to threat intelligence feeds. Indicators are automatically used for artifact enrichment.</p>"},{"location":"user-guide/cybergrid/#publications","title":"Publications","text":"<p>Share your organization's threat indicators with the CyberGrid community.</p>"},{"location":"user-guide/cybergrid/#jobs","title":"Jobs","text":"<p>Monitor synchronization jobs for feed downloads, processing, and uploads.</p>"},{"location":"user-guide/cybergrid/#library","title":"Library","text":"<p>Browse available feeds and manage your intelligence library.</p>"},{"location":"user-guide/cybergrid/#how-cybergrid-works","title":"How CyberGrid Works","text":"<pre><code>graph LR\n    P[Publishers] --&gt; CG[CyberGrid Hub]\n    CG --&gt; S[Subscribers]\n    S --&gt; E[Enrichment Engine]\n    E --&gt; N[Node Scoring]</code></pre>"},{"location":"user-guide/cybergrid/#permissions","title":"Permissions","text":"Action Required Permission View CyberGrid <code>cybergrid:read</code> Manage subscriptions <code>cybergrid:write</code> Publish indicators <code>cybergrid:manage</code>"},{"location":"user-guide/cybergrid/jobs/","title":"Jobs","text":"<p>Background synchronization jobs for threat intelligence feeds.</p>"},{"location":"user-guide/cybergrid/jobs/#job-types","title":"Job Types","text":"Type Direction Description Sync Inbound Download from subscribed feed Publish Outbound Upload to a publication Enrich Internal Apply indicators to nodes"},{"location":"user-guide/cybergrid/jobs/#job-properties","title":"Job Properties","text":"Column Description Job ID Unique identifier Type Sync, Publish, or Enrich Status Pending, Running, Complete, Failed Started Start timestamp Duration Execution time Indicators Indicators processed <p>Failed jobs are automatically retried. Click Run Now on any subscription for immediate sync.</p>"},{"location":"user-guide/cybergrid/jobs/#job-history","title":"Job History","text":"<p>Retained for 30 days with automatic cleanup.</p>"},{"location":"user-guide/cybergrid/library/","title":"Library","text":"<p>Browse and manage threat intelligence content.</p>"},{"location":"user-guide/cybergrid/library/#browsing","title":"Browsing","text":"<ul> <li>Active feeds \u2014 Currently subscribed feeds</li> <li>Available feeds \u2014 Public feeds for subscription</li> <li>Local collections \u2014 Locally imported indicators</li> </ul>"},{"location":"user-guide/cybergrid/library/#feed-details","title":"Feed Details","text":"<p>View publisher, description, indicator types/count, update frequency, and confidence range.</p>"},{"location":"user-guide/cybergrid/library/#indicator-search","title":"Indicator Search","text":"<p>Search by value (IP, domain, hash), type, source, confidence threshold, or date range.</p>"},{"location":"user-guide/cybergrid/library/#local-collections","title":"Local Collections","text":"<p>Create local collections for internally-sourced intelligence. Import from CSV or add manually.</p>"},{"location":"user-guide/cybergrid/library/#intel-api-integration","title":"Intel API Integration","text":"<p>CyberGrid syncs with intel.witfoo.com when <code>WF_LICENSE</code> is configured. Without a license key, operates with local data only.</p>"},{"location":"user-guide/cybergrid/publications/","title":"Publications","text":"<p>Share threat indicators with the CyberGrid community.</p>"},{"location":"user-guide/cybergrid/publications/#creating-a-publication","title":"Creating a Publication","text":"<ol> <li>Navigate to CyberGrid &gt; Publications</li> <li>Click Create Publication</li> <li>Configure name, description, visibility (Public/Private), and indicator sources</li> </ol>"},{"location":"user-guide/cybergrid/publications/#publication-properties","title":"Publication Properties","text":"Field Description Name Publication title Status Active, Paused, or Draft Indicator count Published indicators Subscribers Organizations subscribed Visibility Public or Private"},{"location":"user-guide/cybergrid/publications/#what-gets-published","title":"What Gets Published","text":"<ul> <li>Indicators from confirmed (true-positive) incidents</li> <li>Nodes flagged as malicious during investigation</li> <li>Manually added indicators</li> </ul> <p>Review Before Publishing</p> <p>Published indicators are shared externally. Do not include internal IPs or legitimate domains.</p>"},{"location":"user-guide/cybergrid/subscriptions/","title":"Subscriptions","text":"<p>Connect to external threat intelligence feeds via CyberGrid.</p>"},{"location":"user-guide/cybergrid/subscriptions/#managing-subscriptions","title":"Managing Subscriptions","text":"<ol> <li>Navigate to CyberGrid &gt; Subscriptions</li> <li>Browse available feeds</li> <li>Click Subscribe and configure sync schedule</li> <li>Set confidence thresholds (optional)</li> </ol>"},{"location":"user-guide/cybergrid/subscriptions/#subscription-properties","title":"Subscription Properties","text":"Field Description Feed name Intelligence feed name Publisher Organization providing the feed Status Active, Paused, or Error Last sync Most recent successful sync Indicator count Indicators from this feed Sync schedule Update frequency"},{"location":"user-guide/cybergrid/subscriptions/#indicator-types","title":"Indicator Types","text":"<p>Feeds can include IPs, domains, file hashes, URLs, and email addresses.</p>"},{"location":"user-guide/cybergrid/subscriptions/#enrichment-integration","title":"Enrichment Integration","text":"<p>Matched indicators update node threat scores, affecting incident severity and compliance calculations.</p>"},{"location":"user-guide/graph/","title":"Graph","text":"<p>The Graph module visualizes the relationship network built from correlated security artifacts. As artifacts are ingested, the Graph Processor extracts entities (nodes) and identifies relationships (edges) between them, forming a queryable knowledge graph stored in Cassandra.</p>"},{"location":"user-guide/graph/#how-the-graph-works","title":"How the Graph Works","text":"<pre><code>graph LR\n    A[Artifact Ingested] --&gt; GP[Graph Processor]\n    GP --&gt; N[Create/Update Nodes]\n    GP --&gt; E[Create/Update Edges]\n    N --&gt; C[(Cassandra)]\n    E --&gt; C</code></pre> <ol> <li>Artifact ingestion \u2014 Security events arrive via the Artifact Ingestion service</li> <li>Entity extraction \u2014 The Graph Processor identifies entities: IP addresses, domains, users, hostnames, hashes</li> <li>Node creation \u2014 Each unique entity becomes a node with properties and classification flags</li> <li>Edge creation \u2014 Relationships between entities become edges with timestamps and metadata</li> <li>Correlation \u2014 The Dispatcher uses the graph to group related artifacts into incidents</li> </ol>"},{"location":"user-guide/graph/#graph-entities","title":"Graph Entities","text":""},{"location":"user-guide/graph/#nodes","title":"Nodes","text":"<p>Nodes represent distinct entities observed in your security data. Each node has a type, value, and set of classification flags (managed, internal, trusted, infrastructure).</p>"},{"location":"user-guide/graph/#edges","title":"Edges","text":"<p>Edges represent observed relationships between nodes. Each edge records the relationship type, first/last seen timestamps, and the artifacts that created the relationship.</p>"},{"location":"user-guide/graph/#node-classification","title":"Node Classification","text":"<p>Nodes are automatically classified using framework-based rules:</p> Flag Meaning Managed Entity is under your organization's management Internal Entity is within your network boundary Trusted Entity is known-good and trusted Infrastructure Entity is an infrastructure device (router, switch, firewall) <p>These flags are used by classification rules to determine incident severity and by compliance calculations for focus-based scoring.</p>"},{"location":"user-guide/graph/edges/","title":"Edges","text":"<p>Edges represent observed relationships between nodes in the knowledge graph. When the Graph Processor identifies that two entities appear together in an artifact, it creates or updates an edge recording that relationship.</p>"},{"location":"user-guide/graph/edges/#edge-properties","title":"Edge Properties","text":"Property Description Source node The originating entity Target node The destination entity Relationship type Category of the connection First seen Timestamp of the earliest observation Last seen Timestamp of the most recent observation Artifact count Number of artifacts creating this relationship Weight Calculated significance based on frequency and recency"},{"location":"user-guide/graph/edges/#relationship-types","title":"Relationship Types","text":"Type Example Description communicated_with IP to IP Network communication observed resolved_to Domain to IP DNS resolution authenticated_as IP to User Authentication event accessed User to Hostname System access contains Hostname to Hash File observed on system associated_with Generic Artifact co-occurrence"},{"location":"user-guide/graph/edges/#browsing-edges","title":"Browsing Edges","text":"<ol> <li>Navigate to Graph &gt; Edges</li> <li>Filter by source/target node type or relationship type</li> <li>Use the time range selector to view edges within a specific window</li> <li>Click an edge to see the underlying artifacts</li> </ol>"},{"location":"user-guide/graph/edges/#edge-detail","title":"Edge Detail","text":"<p>The edge detail view shows:</p> <ul> <li>Source and target nodes with links to their detail pages</li> <li>Timeline of observations (first seen through last seen)</li> <li>Artifact list \u2014 All artifacts that contributed to this edge</li> <li>Related incidents \u2014 Incidents that include artifacts from this edge</li> </ul>"},{"location":"user-guide/graph/edges/#graph-traversal","title":"Graph Traversal","text":"<p>Edges enable graph traversal for incident investigation. Starting from any node, follow edges to discover related entities and understand the full scope of an incident. The correlation engine uses this traversal to automatically group related artifacts into incidents.</p>"},{"location":"user-guide/graph/nodes/","title":"Nodes","text":"<p>Nodes are the fundamental entities in the WitFoo Analytics knowledge graph. Each node represents a distinct object observed in your security data.</p>"},{"location":"user-guide/graph/nodes/#node-types","title":"Node Types","text":"Type Example Description IP <code>192.168.1.100</code> IPv4 or IPv6 address Domain <code>example.com</code> DNS domain name User <code>jsmith</code> User account identifier Hostname <code>workstation-01</code> System hostname Hash <code>a1b2c3...</code> File hash (MD5, SHA1, SHA256) Email <code>user@example.com</code> Email address URL <code>https://example.com/path</code> Full URL"},{"location":"user-guide/graph/nodes/#node-properties","title":"Node Properties","text":"<p>Each node stores:</p> <ul> <li>Value \u2014 The entity identifier (IP, domain, etc.)</li> <li>Type \u2014 Entity type from the table above</li> <li>First seen \u2014 Timestamp of earliest artifact referencing this node</li> <li>Last seen \u2014 Timestamp of most recent artifact</li> <li>Artifact count \u2014 Number of artifacts associated with this node</li> <li>Frameworks \u2014 Compliance framework indices where this node appears</li> <li>Flags \u2014 Classification flags (managed, internal, trusted, infrastructure)</li> </ul>"},{"location":"user-guide/graph/nodes/#classification-flags","title":"Classification Flags","text":"Flag Purpose Managed Part of your managed infrastructure \u2014 counts toward compliance denominators Internal Inside your network boundary Trusted Known-good entity \u2014 reduces incident severity Infrastructure Network infrastructure device \u2014 used in infrastructure-focus compliance <p>Flags are set automatically by framework-based classification rules and can be manually overridden.</p>"},{"location":"user-guide/graph/nodes/#searching-nodes","title":"Searching Nodes","text":"<ol> <li>Navigate to Graph &gt; Nodes</li> <li>Enter a search term (IP, domain, username, etc.)</li> <li>Filter by node type, flags, or framework association</li> <li>Click a node to view its detail page</li> </ol>"},{"location":"user-guide/graph/nodes/#node-detail-page","title":"Node Detail Page","text":"<p>The detail page shows:</p> <ul> <li>Summary \u2014 Node value, type, flags, first/last seen</li> <li>Edges \u2014 All relationships to other nodes</li> <li>Artifacts \u2014 Artifacts that reference this node</li> <li>Incidents \u2014 Incidents containing this node</li> <li>Enrichments \u2014 GeoIP, DNS, WHOIS, threat intel data (when available)</li> </ul>"},{"location":"user-guide/graph/nodes/#framework-association","title":"Framework Association","text":"<p>Nodes are associated with compliance frameworks via integer indices. The indices are assigned by sorting enabled framework machine names alphabetically. This mapping is used by compliance calculations to count nodes per framework.</p>"},{"location":"user-guide/health/","title":"Health","text":"<p>Real-time monitoring of your WitFoo Analytics deployment.</p>"},{"location":"user-guide/health/#components","title":"Components","text":""},{"location":"user-guide/health/#containers","title":"Containers","text":"<p>Real-time and historical metrics for all Docker containers. Auto-refreshes every 15 seconds.</p>"},{"location":"user-guide/health/#alerts","title":"Alerts","text":"<p>Configurable alert rules for container metrics and service availability.</p>"},{"location":"user-guide/health/#dashboard-overview","title":"Dashboard Overview","text":"<ul> <li>Service status cards \u2014 Clickable tiles showing container state with CPU/memory gauges</li> <li>KPI tiles \u2014 Total containers, healthy count, average CPU/memory</li> <li>Historical charts \u2014 Time-series resource usage (limited to 100 data points)</li> </ul>"},{"location":"user-guide/health/#container-states","title":"Container States","text":"State Color Running Green Unhealthy Yellow Stopped Red Restarting Orange"},{"location":"user-guide/health/#auto-refresh","title":"Auto-Refresh","text":"<p>Updates every 15 seconds via silent background requests.</p>"},{"location":"user-guide/health/#permissions","title":"Permissions","text":"Action Required Permission View health data <code>health:read</code> Configure alerts <code>health:manage</code> View metrics <code>metrics:read</code>"},{"location":"user-guide/health/alerts/","title":"Alerts","text":"<p>Configurable notifications when container metrics exceed thresholds.</p>"},{"location":"user-guide/health/alerts/#alert-types","title":"Alert Types","text":"Type Triggers On CPU CPU exceeds threshold for duration Memory Memory exceeds threshold Disk Disk exceeds threshold Container State Container stops/unhealthy/restarting Restart Count Restarts exceed N in window"},{"location":"user-guide/health/alerts/#creating-alert-rules","title":"Creating Alert Rules","text":"<ol> <li>Navigate to Health &gt; Alerts</li> <li>Click Create Alert</li> <li>Select type, container, threshold, duration, severity</li> <li>Choose notification channels</li> <li>Click Save</li> </ol> <p>The form adapts based on alert type \u2014 CPU/Memory/Disk show threshold/duration; Container State shows state selector; Restart Count shows count/window fields.</p>"},{"location":"user-guide/health/alerts/#cooldown","title":"Cooldown","text":"<p>Default 15-minute cooldown per alert type + severity + container combination. Prevents notification spam during sustained issues.</p>"},{"location":"user-guide/health/alerts/#notification-channels","title":"Notification Channels","text":"Channel Format Email HTML with severity-colored header Slack Block Kit structured message Webhook JSON payload <p>Configure channels in Admin &gt; Settings &gt; Notifications.</p>"},{"location":"user-guide/health/alerts/#alert-history","title":"Alert History","text":"<p>Retained for 30 days with timestamp, type, severity, container, metric value, and notification status.</p>"},{"location":"user-guide/health/containers/","title":"Containers","text":"<p>Detailed metrics for every Docker container in your deployment.</p>"},{"location":"user-guide/health/containers/#container-list","title":"Container List","text":"<p>Each container displays as a clickable card with name, state, health, CPU %, memory, and uptime.</p>"},{"location":"user-guide/health/containers/#color-coded-metrics","title":"Color-Coded Metrics","text":"Threshold Color &lt; 70% Normal 70-90% Yellow &gt; 90% Red"},{"location":"user-guide/health/containers/#container-detail","title":"Container Detail","text":""},{"location":"user-guide/health/containers/#current-metrics","title":"Current Metrics","text":"Metric Source CPU % <code>(cpuDelta / systemDelta) * numCPUs * 100</code> Memory RSS from Docker stats Network I/O Bytes received/transmitted Disk I/O Bytes read/written PIDs Process count"},{"location":"user-guide/health/containers/#historical-charts","title":"Historical Charts","text":"<p>Time-series bar charts stored in Cassandra using TimeUUID ordering.</p>"},{"location":"user-guide/health/containers/#core-services","title":"Core Services","text":"Container Service <code>witfoo-analytics-cassandra</code> Cassandra database <code>witfoo-analytics-nats</code> NATS message broker <code>witfoo-analytics-incident-engine</code> Core business logic <code>witfoo-analytics-api</code> API gateway <code>witfoo-analytics-ui</code> SvelteKit frontend <code>witfoo-analytics-artifact-ingestion</code> Artifact receiver <code>witfoo-analytics-graph-processor</code> Graph builder <code>witfoo-analytics-dispatcher</code> Event dispatcher <code>witfoo-analytics-reverse-proxy</code> Request router"},{"location":"user-guide/health/containers/#prometheus-integration","title":"Prometheus Integration","text":"<p>Metrics exported at <code>/api/v1/metrics</code> with <code>witfoo_container_*</code> prefix.</p>"},{"location":"user-guide/observer/","title":"Observer","text":"<p>The Observer module tracks analyst work and captures institutional knowledge about security operations. It provides structured workflows for documenting investigations, defining threat patterns, and recording observations.</p>"},{"location":"user-guide/observer/#components","title":"Components","text":""},{"location":"user-guide/observer/#work-units","title":"Work Units","text":"<p>Individual tasks or investigation steps performed by analysts. Work units track time spent, status, and outcomes for each piece of security work.</p>"},{"location":"user-guide/observer/#work-collections","title":"Work Collections","text":"<p>Groups of related work units organized into logical investigations. Work collections aggregate time and effort across multiple tasks.</p>"},{"location":"user-guide/observer/#mo-definitions","title":"MO Definitions","text":"<p>Modus operandi (MO) definitions describe known attack patterns and threat behaviors. Analysts create MO definitions to codify institutional knowledge about recurring threats.</p>"},{"location":"user-guide/observer/#observations","title":"Observations","text":"<p>Freeform notes and findings recorded during investigations. Observations capture context that doesn't fit into structured fields \u2014 analyst insights, external research, and contextual notes.</p>"},{"location":"user-guide/observer/#workflow","title":"Workflow","text":"<pre><code>graph TD\n    I[Incident Detected] --&gt; WC[Create Work Collection]\n    WC --&gt; WU1[Work Unit: Triage]\n    WC --&gt; WU2[Work Unit: Investigation]\n    WC --&gt; WU3[Work Unit: Remediation]\n    WU2 --&gt; O[Record Observations]\n    WU2 --&gt; MO[Match/Create MO Definition]</code></pre> <ol> <li>An incident triggers a new work collection</li> <li>Analysts create work units for each investigation step</li> <li>During investigation, analysts record observations and match to known MO definitions</li> <li>Work collection aggregates total effort for reporting</li> </ol>"},{"location":"user-guide/observer/#permissions","title":"Permissions","text":"Action Required Permission View observer data <code>observer:read</code> Create/edit work items <code>observer:write</code> Manage MO definitions <code>observer:manage</code>"},{"location":"user-guide/observer/mo-definitions/","title":"MO Definitions","text":"<p>Modus operandi (MO) definitions capture known attack patterns, threat behaviors, and adversary techniques. They serve as institutional knowledge that helps analysts recognize recurring threats and respond consistently.</p>"},{"location":"user-guide/observer/mo-definitions/#mo-properties","title":"MO Properties","text":"Field Description Name Pattern identifier Description Detailed description of the attack pattern or behavior Category Classification (malware, phishing, lateral movement, etc.) Indicators Observable indicators associated with this MO TTPs Tactics, techniques, and procedures Severity Typical severity when this MO is observed Response playbook Recommended response steps Created by Analyst who defined the MO"},{"location":"user-guide/observer/mo-definitions/#creating-mo-definitions","title":"Creating MO Definitions","text":"<ol> <li>Navigate to Observer &gt; MO Definitions</li> <li>Click Create MO Definition</li> <li>Fill in the name, description, and category</li> <li>Add indicators and TTPs</li> <li>Document the recommended response</li> <li>Click Save</li> </ol>"},{"location":"user-guide/observer/mo-definitions/#using-mo-definitions","title":"Using MO Definitions","text":"<p>During incident investigation, analysts can:</p> <ul> <li>Match incidents to MOs \u2014 Link an incident to a known MO definition</li> <li>Create new MOs \u2014 Document newly observed patterns for future reference</li> <li>Search by indicators \u2014 Find MOs matching observed indicators in current data</li> </ul>"},{"location":"user-guide/observer/mo-definitions/#categories","title":"Categories","text":"Category Examples Malware Ransomware, trojan, worm, rootkit Phishing Spear phishing, credential harvesting, BEC Lateral Movement Pass-the-hash, RDP abuse, SMB pivoting Exfiltration DNS tunneling, cloud storage abuse, encrypted channels Persistence Scheduled tasks, registry modification, backdoor accounts"},{"location":"user-guide/observer/mo-definitions/#relationship-to-observations","title":"Relationship to Observations","text":"<p>MO definitions provide structure while observations capture freeform context. An investigation typically involves linking an incident to an MO definition and recording specific observations about how the pattern manifested in that case.</p>"},{"location":"user-guide/observer/observations/","title":"Observations","text":"<p>Observations are freeform notes and findings recorded during security investigations. They capture analyst insights, external research, and contextual information that complements the structured data in work units and MO definitions.</p>"},{"location":"user-guide/observer/observations/#observation-properties","title":"Observation Properties","text":"Field Description Title Brief summary of the observation Content Detailed findings (supports markdown) Author Analyst who recorded the observation Related incident Associated incident (optional) Related work unit Associated work unit (optional) Tags Freeform labels for categorization Timestamp When the observation was recorded"},{"location":"user-guide/observer/observations/#creating-observations","title":"Creating Observations","text":"<ol> <li>Navigate to Observer &gt; Observations</li> <li>Click Create Observation</li> <li>Enter a title and detailed content</li> <li>Optionally link to an incident or work unit</li> <li>Add relevant tags</li> <li>Click Save</li> </ol> <p>Observations can also be created from the incident detail page or work unit detail page for quick contextual notes.</p>"},{"location":"user-guide/observer/observations/#use-cases","title":"Use Cases","text":"<ul> <li>Investigation notes \u2014 Document findings during incident analysis</li> <li>External intelligence \u2014 Record relevant information from external sources</li> <li>Analyst handoff \u2014 Leave context for the next shift or team member</li> <li>Lessons learned \u2014 Post-incident notes for future reference</li> <li>Evidence documentation \u2014 Capture screenshots, logs, or analysis results</li> </ul>"},{"location":"user-guide/observer/observations/#search-and-filter","title":"Search and Filter","text":"<p>Search observations by:</p> <ul> <li>Text content (full-text search)</li> <li>Author</li> <li>Tags</li> <li>Date range</li> <li>Associated incident or work unit</li> </ul>"},{"location":"user-guide/observer/observations/#relationship-to-other-observer-components","title":"Relationship to Other Observer Components","text":"<p>Observations complement the structured data in the Observer module:</p> <ul> <li>Work units track what was done and how long it took</li> <li>Work collections group related work</li> <li>MO definitions describe known patterns</li> <li>Observations capture everything else \u2014 the human context that makes investigations meaningful</li> </ul>"},{"location":"user-guide/observer/work-collections/","title":"Work Collections","text":"<p>Work collections group related work units into logical investigations. They provide a high-level view of effort spent on a security incident or ongoing investigation.</p>"},{"location":"user-guide/observer/work-collections/#work-collection-properties","title":"Work Collection Properties","text":"Field Description Name Collection title Description Purpose and scope of the investigation Status Active, Complete, or Archived Owner Lead analyst for the collection Work units List of associated work units Total time Aggregated time from all work units Related incidents Linked incidents Created/Updated Timestamps"},{"location":"user-guide/observer/work-collections/#creating-collections","title":"Creating Collections","text":"<ol> <li>Navigate to Observer &gt; Work Collections</li> <li>Click Create Collection</li> <li>Enter a name and description</li> <li>Assign an owner</li> <li>Click Save</li> </ol> <p>Add work units to a collection from either the collection detail page or when creating/editing individual work units.</p>"},{"location":"user-guide/observer/work-collections/#aggregation","title":"Aggregation","text":"<p>Work collections automatically aggregate metrics from their child work units:</p> <ul> <li>Total time \u2014 Sum of all work unit time entries</li> <li>Status breakdown \u2014 Count of open, in-progress, and complete units</li> <li>Priority distribution \u2014 Mix of priority levels across units</li> </ul> <p>These aggregates flow into the Reporter module for cost and efficiency analysis.</p>"},{"location":"user-guide/observer/work-collections/#use-cases","title":"Use Cases","text":"Scenario Collection Scope Incident response All work units related to a single incident Threat hunt Proactive investigation across multiple data sources Compliance audit Evidence gathering for a specific framework Recurring task Ongoing operational tasks (weekly review, etc.)"},{"location":"user-guide/observer/work-units/","title":"Work Units","text":"<p>Work units represent individual tasks or investigation steps performed by security analysts. Each work unit tracks what was done, who did it, and how long it took.</p>"},{"location":"user-guide/observer/work-units/#work-unit-properties","title":"Work Unit Properties","text":"Field Description Title Short description of the task Description Detailed explanation of work performed Assignee Analyst responsible for the work Status Current state (Open, In Progress, Complete, Cancelled) Priority Task priority (Low, Medium, High, Critical) Time spent Hours invested in this task Related incident Link to the associated incident (optional) Work collection Parent collection grouping related units Created/Updated Timestamps for tracking"},{"location":"user-guide/observer/work-units/#creating-work-units","title":"Creating Work Units","text":"<ol> <li>Navigate to Observer &gt; Work Units</li> <li>Click Create Work Unit</li> <li>Fill in the title, description, and assignee</li> <li>Optionally link to an incident or work collection</li> <li>Click Save</li> </ol> <p>Work units can also be created directly from an incident detail page.</p>"},{"location":"user-guide/observer/work-units/#status-workflow","title":"Status Workflow","text":"<pre><code>graph LR\n    O[Open] --&gt; IP[In Progress]\n    IP --&gt; C[Complete]\n    IP --&gt; X[Cancelled]\n    O --&gt; X</code></pre>"},{"location":"user-guide/observer/work-units/#time-tracking","title":"Time Tracking","text":"<p>Time spent on work units feeds into the Reporter module's cost/savings analysis. The total investigation time across all work units contributes to:</p> <ul> <li>FTE calculations \u2014 How many full-time analysts are needed</li> <li>Cost per incident \u2014 Average cost based on analyst hourly rates</li> <li>Savings analysis \u2014 Time saved through automation vs manual investigation</li> </ul>"},{"location":"user-guide/observer/work-units/#filtering-and-search","title":"Filtering and Search","text":"<p>Filter work units by:</p> <ul> <li>Assignee</li> <li>Status</li> <li>Priority</li> <li>Date range</li> <li>Associated incident or work collection</li> </ul>"},{"location":"user-guide/reporter/","title":"Reporter","text":"<p>The Reporter module generates executive-level reports on your security operations posture. It combines data from incidents, compliance frameworks, security products, and business settings.</p>"},{"location":"user-guide/reporter/#report-sections","title":"Report Sections","text":""},{"location":"user-guide/reporter/#executive-summary","title":"Executive Summary","text":"<p>High-level KPIs including incident counts, true positive/false positive ratios, mean time to detect, and mean time to respond.</p>"},{"location":"user-guide/reporter/#compliance-readiness","title":"Compliance Readiness","text":"<p>Framework-by-framework compliance scoring with per-control drill-down, focus-based filtering, and delta indicators.</p>"},{"location":"user-guide/reporter/#tool-effectiveness","title":"Tool Effectiveness","text":"<p>Sankey flow diagrams showing artifact-to-incident pipelines, Venn diagrams of product coverage overlap, and per-product detection metrics.</p>"},{"location":"user-guide/reporter/#cost-savings","title":"Cost &amp; Savings","text":"<p>FTE analysis, profit &amp; loss table, savings histograms, and security spend as a percentage of revenue.</p>"},{"location":"user-guide/reporter/#date-range-selection","title":"Date Range Selection","text":"<p>All reports are filtered by date range. Click the date tag in the report header to open the date range picker. Select from preset ranges (7 days, 30 days, 90 days, 1 year) or choose custom dates.</p>"},{"location":"user-guide/reporter/#csv-export","title":"CSV Export","text":"<p>Each report section supports CSV export. Click the Download button to export data. Filenames include report type and current date.</p>"},{"location":"user-guide/reporter/#permissions","title":"Permissions","text":"Action Required Permission View reports <code>reports:read</code> Export reports <code>reports:write</code> Configure settings <code>reports:manage</code>"},{"location":"user-guide/reporter/#business-settings-dependency","title":"Business Settings Dependency","text":"<p>Reporter calculations depend on settings in Admin &gt; Settings &gt; Business Metrics. See Business Metrics.</p>"},{"location":"user-guide/reporter/compliance/","title":"Compliance Readiness","text":"<p>The Compliance Readiness report shows your organization's compliance posture against enabled security frameworks using focus-based scoring.</p>"},{"location":"user-guide/reporter/compliance/#framework-selection","title":"Framework Selection","text":"<p>Select a framework from the dropdown. The primary framework is selected by default.</p>"},{"location":"user-guide/reporter/compliance/#compliance-score","title":"Compliance Score","text":"<p>Overall score displayed as a gauge chart:</p> Score Range Color Status &gt; 75% Green Compliant &gt; 0% Yellow Partial 0% Red Unmet"},{"location":"user-guide/reporter/compliance/#focus-based-scoring","title":"Focus-Based Scoring","text":"<p>Each control has a focus type determining the compliance denominator:</p> Focus Denominator Computer Managed nodes User User nodes Infrastructure Device Infrastructure nodes Product Security products <p>Score = (green + yellow nodes) / auto-detectable nodes * 100. Manual-only controls excluded.</p>"},{"location":"user-guide/reporter/compliance/#per-control-table","title":"Per-Control Table","text":"Column Description Control ID Framework control identifier Control Name Human-readable name Focus Type (Computer=blue, User=purple, Infra=magenta, Product=green) Compliance % Calculated percentage Detection Product + confidence (e.g., \"Palo Alto (95%)\") Status Compliant / Partial / Unmet / Manual"},{"location":"user-guide/reporter/compliance/#filtering","title":"Filtering","text":"<p>Two combinable filter dimensions: Compliance status and Focus type.</p>"},{"location":"user-guide/reporter/compliance/#delta-indicator","title":"Delta Indicator","text":"<p>Shows compliance score change across date range snapshots.</p>"},{"location":"user-guide/reporter/compliance/#csv-export","title":"CSV Export","text":"<p>Exports per-control table with current filters. Filename: <code>{framework}_compliance_{date}.csv</code>.</p>"},{"location":"user-guide/reporter/cost-savings/","title":"Cost &amp; Savings","text":"<p>Financial analysis of security operations including FTE requirements and automation savings.</p>"},{"location":"user-guide/reporter/cost-savings/#fte-analysis","title":"FTE Analysis","text":"<p>Gauge chart showing calculated analyst headcount:</p> <pre><code>FTE Needed = (Total Incidents * Avg Hours per Incident) / 2,080\n</code></pre> <p>Avg Hours = Investigation Time + Restore Time (default: 2.25 hours). 2,080 = 40 hrs/week * 52 weeks.</p> <p>Shows surplus (green) or deficit (red) versus configured FTE count.</p>"},{"location":"user-guide/reporter/cost-savings/#profit-loss-table","title":"Profit &amp; Loss Table","text":"<p>Financial summary in monospace format (IBM Plex Mono):</p> Section Contents Revenue Annual revenue Security Spend Annual security budget Product Costs Sum of product costs Personnel Costs FTE count * analyst salary Net Position Revenue impact"},{"location":"user-guide/reporter/cost-savings/#security-spend-ratio","title":"Security Spend Ratio","text":"<pre><code>Security Spend % = (Annual Security Spend / Annual Revenue) * 100\n</code></pre>"},{"location":"user-guide/reporter/cost-savings/#savings-histogram","title":"Savings Histogram","text":"<p>Bar chart showing cost savings from automated vs manual investigation.</p>"},{"location":"user-guide/reporter/executive/","title":"Executive Summary","text":"<p>The Executive Summary provides high-level KPIs for security operations leadership.</p>"},{"location":"user-guide/reporter/executive/#key-metrics","title":"Key Metrics","text":"Metric Description Calculation Total Incidents Incidents in the date range Count of all incidents True Positives Confirmed security incidents Status: Disrupted (5) or Resolved (3) False Positives Non-incidents Status: Closed (4) TP/FP Ratio Classification accuracy True positives / false positives MTTD Mean time to detect Avg time from first artifact to incident creation MTTR Mean time to respond Avg time from creation to resolution"},{"location":"user-guide/reporter/executive/#dashboard-layout","title":"Dashboard Layout","text":"<ol> <li>KPI tiles \u2014 Large-format cards with trend indicators</li> <li>Incident timeline \u2014 Bar chart of incident creation over time</li> <li>Severity distribution \u2014 Breakdown by Critical, High, Medium, Low, Info</li> <li>Status distribution \u2014 Current status of incidents in the period</li> </ol>"},{"location":"user-guide/reporter/executive/#true-positive-classification","title":"True Positive Classification","text":"<p>TP/FP classification uses incident status IDs:</p> <ul> <li>True Positive: Status is <code>disrupted</code> (5) or <code>resolved</code> (3)</li> <li>False Positive: Status is <code>closed</code> (4)</li> </ul>"},{"location":"user-guide/reporter/executive/#trend-indicators","title":"Trend Indicators","text":"<p>Each KPI shows a trend arrow comparing the current period to the previous period of equal length.</p>"},{"location":"user-guide/reporter/tool-effectiveness/","title":"Tool Effectiveness","text":"<p>Analyzes how security products contribute to incident detection and response.</p>"},{"location":"user-guide/reporter/tool-effectiveness/#sankey-flow-diagram","title":"Sankey Flow Diagram","text":"<p>Shows artifact flows from products through types to incident severities. Products ranked by artifact count, top-N shown individually, remainder as \"Other\".</p>"},{"location":"user-guide/reporter/tool-effectiveness/#product-coverage-venn","title":"Product Coverage Venn","text":"<p>Overlap between security products. 1-4 products use fixed geometric layouts; 5-8 use radial layout.</p>"},{"location":"user-guide/reporter/tool-effectiveness/#product-metrics-table","title":"Product Metrics Table","text":"Column Description Product Security product name Artifacts Total artifacts generated Incidents Incidents from this product TP Rate True positive rate Coverage Compliance controls detected Cost Annual product cost Cost per Incident Product cost / incidents <p>Help tooltips explain calculations. Chart toolbars disabled for clean presentation.</p>"},{"location":"user-guide/signals/","title":"Signals","text":"<p>The Signals module is your primary interface for investigating security data flowing through WitFoo Analytics. Every log line, alert, and event ingested by the platform becomes a signal -- a searchable artifact enriched with context, classified by type, and evaluated against your lead rules.</p>"},{"location":"user-guide/signals/#what-are-signals","title":"What Are Signals?","text":"<p>Signals are normalized security artifacts collected from your environment. Each signal contains:</p> <ul> <li>Raw data -- the original log entry or alert payload</li> <li>Metadata -- timestamps, source IP, destination IP, hostname, user, and other extracted fields</li> <li>Classification -- the artifact stream (IDS, authentication, firewall, DNS, endpoint, etc.)</li> <li>Severity -- a normalized severity level from informational to critical</li> <li>Enrichment -- additional context added by enrichment sources such as GeoIP location and threat intelligence feeds</li> </ul> <p>When data enters the ingestion pipeline, WitFoo Analytics parses, normalizes, and stores it. Classification rules assign each artifact to a stream, enrichment sources add context, and lead rules evaluate whether the artifact warrants further investigation.</p>"},{"location":"user-guide/signals/#module-layout","title":"Module Layout","text":"<p>The Signals section of the navigation contains the following pages:</p> Page Purpose Search Query and filter artifacts with full-text search, date ranges, and field filters Lead Rules Define rules that flag artifacts as potential leads for investigation Classification Rules Manage rules that assign artifacts to streams (IDS, auth, firewall, etc.) Enrichment Settings Configure external data sources that add context to artifacts"},{"location":"user-guide/signals/#typical-workflow","title":"Typical Workflow","text":"<ol> <li>Search for artifacts matching a time window, severity, or keyword</li> <li>Review results and drill into individual signal details</li> <li>Identify patterns that should trigger future leads by creating lead rules</li> <li>Fine-tune how artifacts are categorized using classification rules</li> <li>Add external context by enabling enrichment sources</li> </ol> <p>Start with Search</p> <p>Most analysts begin their day in the Search page. Use saved searches to quickly revisit common queries, and export results when you need to share findings with your team.</p>"},{"location":"user-guide/signals/#permissions","title":"Permissions","text":"<p>Access to the Signals module requires the <code>signals:read</code> permission. Creating and editing rules requires <code>signals:write</code>. Your administrator assigns these permissions through role-based access control in the Admin section.</p> <p>Data Retention</p> <p>The volume of signals stored depends on your organization's retention settings. Administrators can configure retention periods in Admin &gt; Settings &gt; Business Metrics. Older signals are automatically purged when the retention window expires.</p>"},{"location":"user-guide/signals/#key-concepts","title":"Key Concepts","text":"<p>Streams -- Logical groupings of artifacts by source type. Common streams include IDS alerts, authentication events, firewall logs, DNS queries, and endpoint telemetry. Classification rules determine which stream an artifact belongs to.</p> <p>Leads -- Artifacts that match a lead rule are flagged for analyst attention. A lead indicates that an artifact has characteristics worth investigating, such as a connection to a known malicious IP or an unusual authentication pattern.</p> <p>Enrichment -- The process of augmenting raw artifact data with external context. GeoIP enrichment adds geographic location to IP addresses. Threat intelligence enrichment cross-references indicators against known threat feeds.</p> <p>Severity Levels -- Each artifact carries a severity from informational through critical. Severity is determined during ingestion based on the source data and any matching classification rules.</p>"},{"location":"user-guide/signals/#next-steps","title":"Next Steps","text":"<ul> <li>Search Artifacts -- Learn the search syntax and filtering options</li> <li>Lead Rules -- Create rules that surface important artifacts</li> <li>Classification Rules -- Control how artifacts are categorized</li> <li>Enrichment Settings -- Add context from external sources</li> </ul>"},{"location":"user-guide/signals/classification-rules/","title":"Classification Rules","text":"<p>Classification rules automatically assign severity and status to incidents based on matching criteria. They run after lead rules create incidents, evaluating node properties, artifact types, and graph relationships.</p>"},{"location":"user-guide/signals/classification-rules/#how-classification-works","title":"How Classification Works","text":"<p>When an incident is created or updated, the classification engine evaluates all enabled rules in priority order. The first matching rule sets the incident's severity and status.</p> <pre><code>graph LR\n    I[Incident Created] --&gt; E[Evaluate Rules]\n    E --&gt; M{Match Found?}\n    M --&gt;|Yes| A[Apply Severity + Status]\n    M --&gt;|No| D[Keep Default]</code></pre>"},{"location":"user-guide/signals/classification-rules/#rule-properties","title":"Rule Properties","text":"Field Description Name Human-readable rule identifier Priority Evaluation order (lower = higher priority) Enabled Whether the rule is active Severity Severity to assign on match (Critical, High, Medium, Low, Info) Status Status to assign on match Target Infrastructure When enabled, rule only matches infrastructure-flagged nodes"},{"location":"user-guide/signals/classification-rules/#conditions","title":"Conditions","text":"<p>Rules can match on:</p> <ul> <li>Node types \u2014 IP addresses, domains, users, hostnames</li> <li>Node flags \u2014 Managed, internal, trusted, infrastructure</li> <li>Artifact sources \u2014 Specific security products or log sources</li> <li>Framework controls \u2014 Nodes associated with specific compliance controls</li> <li>Lead rule matches \u2014 Incidents created by specific lead rules</li> </ul>"},{"location":"user-guide/signals/classification-rules/#managing-rules","title":"Managing Rules","text":""},{"location":"user-guide/signals/classification-rules/#create-a-rule","title":"Create a Rule","text":"<ol> <li>Navigate to Signals &gt; Classification Rules</li> <li>Click Create Rule</li> <li>Configure the matching conditions and assignment values</li> <li>Set the priority relative to existing rules</li> <li>Click Save</li> </ol>"},{"location":"user-guide/signals/classification-rules/#edit-or-disable","title":"Edit or Disable","text":"<p>Click a rule in the table to edit its properties. Toggle the Enabled switch to activate or deactivate a rule without deleting it.</p> <p>Rule Priority</p> <p>Rules evaluate in priority order. Place more specific rules at higher priority (lower number) than general catch-all rules.</p>"},{"location":"user-guide/signals/classification-rules/#permissions","title":"Permissions","text":"Action Required Permission View rules <code>signals:read</code> Create/edit rules <code>signals:write</code> Delete rules <code>signals:manage</code>"},{"location":"user-guide/signals/enrichment-settings/","title":"Enrichment Settings","text":"<p>Enrichment settings control how WitFoo Analytics augments artifacts and nodes with additional context during processing. Enrichments add metadata such as geolocation, DNS resolution, WHOIS data, and threat intelligence scoring.</p>"},{"location":"user-guide/signals/enrichment-settings/#enrichment-types","title":"Enrichment Types","text":"Type Description Applied To GeoIP Geographic location lookup for IP addresses IP nodes DNS Reverse DNS and forward resolution IP and domain nodes WHOIS Domain registration and ownership data Domain nodes Threat Intel Reputation scoring from CyberGrid feeds IP, domain, hash nodes ASN Autonomous System Number lookup IP nodes"},{"location":"user-guide/signals/enrichment-settings/#configuration","title":"Configuration","text":"<p>Navigate to Signals &gt; Enrichment Settings to manage enrichment configuration.</p>"},{"location":"user-guide/signals/enrichment-settings/#enable-or-disable-enrichments","title":"Enable or Disable Enrichments","text":"<p>Each enrichment type can be independently enabled or disabled. Disabled enrichments are skipped during artifact processing.</p>"},{"location":"user-guide/signals/enrichment-settings/#rate-limiting","title":"Rate Limiting","text":"<p>External enrichment sources have configurable rate limits to prevent API throttling:</p> Setting Default Description Max requests per minute 60 Throttle for external API calls Cache TTL 24 hours How long enrichment results are cached Retry on failure 3 Number of retry attempts for failed lookups"},{"location":"user-guide/signals/enrichment-settings/#viewing-enrichment-data","title":"Viewing Enrichment Data","text":"<p>Enrichment results appear on node detail pages in the Enrichment tab. Each enrichment shows:</p> <ul> <li>Source name and type</li> <li>Timestamp of last enrichment</li> <li>Raw enrichment data</li> <li>Confidence score (when available)</li> </ul>"},{"location":"user-guide/signals/enrichment-settings/#permissions","title":"Permissions","text":"Action Required Permission View settings <code>signals:read</code> Modify settings <code>signals:manage</code>"},{"location":"user-guide/signals/lead-rules/","title":"Lead Rules","text":"<p>Lead rules automatically flag artifacts that match specified criteria, surfacing them as potential leads for analyst investigation. Rather than manually searching for patterns, you define the conditions once and let WitFoo Analytics continuously evaluate incoming data against your rules.</p>"},{"location":"user-guide/signals/lead-rules/#what-is-a-lead","title":"What Is a Lead?","text":"<p>A lead is an artifact that has been flagged by one or more lead rules as potentially significant. When an artifact matches a lead rule, it is marked as a lead and becomes visible in lead-focused views throughout the platform. Leads feed into the incident analysis pipeline, where they may contribute to the creation or escalation of incidents.</p>"},{"location":"user-guide/signals/lead-rules/#accessing-lead-rules","title":"Accessing Lead Rules","text":"<p>Navigate to Signals &gt; Lead Rules from the main navigation. This page displays a table of all configured lead rules for your organization.</p> <p>Required Permission</p> <p>Viewing lead rules requires <code>signals:read</code>. Creating or editing lead rules requires <code>signals:write</code>.</p>"},{"location":"user-guide/signals/lead-rules/#lead-rules-table","title":"Lead Rules Table","text":"<p>The lead rules table shows all existing rules with the following columns:</p> Column Description Name A descriptive name for the rule Description A brief summary of what the rule detects Stream Which artifact stream the rule applies to (IDS, auth, firewall, etc.) Severity The severity level assigned to matching leads Status Whether the rule is enabled or disabled Match Count The number of artifacts that have matched this rule Last Match Timestamp of the most recent match"},{"location":"user-guide/signals/lead-rules/#creating-a-lead-rule","title":"Creating a Lead Rule","text":"<ol> <li>Click the Create Rule button in the toolbar</li> <li>Fill in the rule definition form:<ul> <li>Name -- A clear, descriptive name (e.g., \"Brute Force SSH Attempts\")</li> <li>Description -- What the rule is designed to detect</li> <li>Stream -- Select the artifact stream to evaluate (or \"All\" for cross-stream rules)</li> <li>Severity -- The severity level to assign when matched (informational, low, medium, high, critical)</li> <li>Conditions -- Define the matching criteria (see below)</li> </ul> </li> <li>Click Save to create the rule in an enabled state</li> </ol>"},{"location":"user-guide/signals/lead-rules/#defining-conditions","title":"Defining Conditions","text":"<p>Conditions specify which artifact fields to evaluate and what values to match. Each condition consists of:</p> <ul> <li>Field -- The artifact field to inspect (e.g., <code>src_ip</code>, <code>dst_ip</code>, <code>hostname</code>, <code>user</code>)</li> <li>Operator -- How to compare the field value (equals, contains, starts with, regex)</li> <li>Value -- The target value to match against</li> </ul> <p>You can add multiple conditions to a single rule. All conditions must match for the rule to trigger (AND logic).</p> <p>Use Regex for Complex Patterns</p> <p>The regex operator supports regular expressions for advanced pattern matching. For example, use <code>user:admin.*</code> to match any username starting with \"admin\".</p>"},{"location":"user-guide/signals/lead-rules/#editing-a-lead-rule","title":"Editing a Lead Rule","text":"<ol> <li>Click on a rule row in the table to open the edit form</li> <li>Modify the fields you want to change</li> <li>Click Save to apply your changes</li> </ol> <p>Changes take effect immediately. Existing artifacts are not retroactively re-evaluated, but all new incoming artifacts will be checked against the updated rule.</p>"},{"location":"user-guide/signals/lead-rules/#enabling-and-disabling-rules","title":"Enabling and Disabling Rules","text":"<p>Toggle a rule's status to temporarily disable it without deleting the configuration:</p> <ol> <li>Click on the rule to open the edit form</li> <li>Toggle the Enabled switch</li> <li>Click Save</li> </ol> <p>Disabled rules are shown with a dimmed appearance in the table and do not evaluate incoming artifacts.</p> <p>Disabling vs. Deleting</p> <p>Disable a rule when you want to temporarily stop it. Delete a rule only when you are certain it is no longer needed. Deleted rules cannot be recovered.</p>"},{"location":"user-guide/signals/lead-rules/#deleting-a-lead-rule","title":"Deleting a Lead Rule","text":"<ol> <li>Click on the rule to open the edit form</li> <li>Click the Delete button</li> <li>Confirm the deletion in the dialog</li> </ol>"},{"location":"user-guide/signals/lead-rules/#how-lead-rules-are-evaluated","title":"How Lead Rules Are Evaluated","text":"<p>When an artifact is ingested:</p> <ol> <li>The artifact is classified into a stream by classification rules</li> <li>All enabled lead rules for that stream (and any \"All\" stream rules) are evaluated</li> <li>If the artifact's fields satisfy all conditions of a rule, the artifact is marked as a lead</li> <li>The lead is tagged with the rule name and assigned the rule's severity</li> <li>Leads flow into the incident analysis pipeline for correlation</li> </ol> <p>Multiple rules can match the same artifact. In this case, the artifact carries all matching lead tags and the highest matched severity applies.</p>"},{"location":"user-guide/signals/lead-rules/#best-practices","title":"Best Practices","text":"<ul> <li>Name rules clearly -- Use names that describe the threat or behavior being detected, such as \"Lateral Movement via RDP\" or \"DNS Tunneling Indicators\"</li> <li>Start broad, then narrow -- Begin with simple conditions and refine as you observe match volumes</li> <li>Monitor match counts -- A rule with zero matches may have overly restrictive conditions; a rule with thousands of matches may need tightening</li> <li>Use severity wisely -- Reserve critical and high severity for rules that detect confirmed threats or policy violations</li> <li>Review regularly -- Periodically audit your lead rules to retire stale rules and add new ones based on emerging threats</li> </ul>"},{"location":"user-guide/signals/lead-rules/#relationship-to-incidents","title":"Relationship to Incidents","text":"<p>Leads generated by lead rules feed into the incident analysis engine. When multiple leads correlate around the same entities (IPs, users, hosts), the system may group them into an incident. The lead rule's severity influences the incident's overall severity assessment.</p> <p>See the Observer module for how leads connect to work units and investigations.</p>"},{"location":"user-guide/signals/search/","title":"Search","text":"<p>The Search page is the primary investigation tool in WitFoo Analytics. Use it to query artifacts across your entire data set, apply filters, visualize geographic distribution, and export results for further analysis.</p>"},{"location":"user-guide/signals/search/#accessing-search","title":"Accessing Search","text":"<p>Navigate to Signals &gt; Search from the main navigation bar. The page loads with a default time range showing recent artifacts.</p>"},{"location":"user-guide/signals/search/#the-search-interface","title":"The Search Interface","text":"<p>The Search page is organized into several areas:</p> <ul> <li>Search bar -- Enter keywords, field queries, or free-text searches with autocomplete suggestions</li> <li>Time range picker -- Select predefined ranges (last 15 minutes, 1 hour, 24 hours, 7 days) or set a custom absolute date range</li> <li>Filter bar -- Active filters displayed as removable tags below the search bar</li> <li>Results table -- Paginated list of matching artifacts with configurable columns</li> <li>Detail panel -- Click any row to inspect the full artifact, view its graph relationships, and take action</li> </ul>"},{"location":"user-guide/signals/search/#searching-artifacts","title":"Searching Artifacts","text":""},{"location":"user-guide/signals/search/#basic-search","title":"Basic Search","text":"<p>Type a keyword into the search bar and press Enter. The search matches against all indexed fields including IP addresses, hostnames, usernames, and raw log content.</p>"},{"location":"user-guide/signals/search/#field-specific-search","title":"Field-Specific Search","text":"<p>Narrow your query by targeting specific fields:</p> Field Example Description <code>src_ip</code> <code>src_ip:192.168.1.100</code> Source IP address <code>dst_ip</code> <code>dst_ip:10.0.0.5</code> Destination IP address <code>hostname</code> <code>hostname:web-server-01</code> Hostname of the source or target <code>user</code> <code>user:jsmith</code> Username associated with the event <code>severity</code> <code>severity:critical</code> Severity level (informational, low, medium, high, critical) <code>stream</code> <code>stream:ids</code> Artifact stream / classification"},{"location":"user-guide/signals/search/#combining-filters","title":"Combining Filters","text":"<p>Apply multiple filters simultaneously to narrow results. Each active filter appears as a tag in the filter bar. Remove a filter by clicking the close icon on its tag.</p> <p>Filter Stacking</p> <p>Filters are combined with AND logic. Adding a severity filter of \"high\" and a stream filter of \"authentication\" returns only high-severity authentication artifacts.</p>"},{"location":"user-guide/signals/search/#time-range-selection","title":"Time Range Selection","text":"<p>Click the time range picker to choose from preset windows or define a custom range.</p> <p>Preset Ranges:</p> Preset Window Last 15 minutes Rolling 15-minute window Last 1 hour Rolling 1-hour window Last 24 hours Rolling 24-hour window Last 7 days Rolling 7-day window Last 30 days Rolling 30-day window <p>Custom Range: Select \"Custom\" to pick specific start and end dates using the date picker calendar.</p> <p>Large Time Ranges</p> <p>Queries spanning more than 30 days may take longer to return results. Consider narrowing your time range or adding additional filters to improve performance.</p>"},{"location":"user-guide/signals/search/#working-with-results","title":"Working with Results","text":""},{"location":"user-guide/signals/search/#column-configuration","title":"Column Configuration","text":"<p>Click the Settings icon in the toolbar to open the column configurator. Toggle columns on or off and drag to reorder them. Your column preferences are saved in your browser.</p>"},{"location":"user-guide/signals/search/#viewing-artifact-details","title":"Viewing Artifact Details","text":"<p>Click any row to open the signal detail modal. The detail view shows:</p> <ol> <li>Summary -- Key fields including timestamp, source, destination, severity, and stream</li> <li>Raw Data -- The original log entry or event payload in JSON format</li> <li>Graph View -- A mini graph showing the artifact's relationships with nodes (IPs, domains, hosts)</li> <li>Enrichment -- GeoIP data, threat intelligence matches, and other enriched context</li> </ol>"},{"location":"user-guide/signals/search/#geographic-visualization","title":"Geographic Visualization","text":"<p>When artifacts contain IP addresses with GeoIP data, a world map heatmap appears above the results table. Countries are shaded by artifact volume, and country flags appear next to geographic data in the results.</p> <p>Internal IPs</p> <p>Private IP addresses (RFC 1918 ranges such as 10.x.x.x, 172.16-31.x.x, and 192.168.x.x) do not have geographic data and will not appear on the map.</p>"},{"location":"user-guide/signals/search/#saved-searches","title":"Saved Searches","text":"<p>Save frequently used search criteria for quick access later.</p> <ol> <li>Configure your search term, filters, and time range</li> <li>Click the Save icon in the toolbar</li> <li>Enter a descriptive name for the saved search</li> <li>Click Save</li> </ol> <p>To load a saved search, click the Folder icon and select from your list of saved searches.</p>"},{"location":"user-guide/signals/search/#sharing-searches","title":"Sharing Searches","text":"<p>Saved searches can generate a share link. Recipients who have access to the same organization can open the link to load the exact same search criteria in their browser.</p>"},{"location":"user-guide/signals/search/#exporting-results","title":"Exporting Results","text":"<p>Click the Download button in the toolbar to export the current results. Exported data includes all visible columns and respects your active filters and time range.</p>"},{"location":"user-guide/signals/search/#creating-incidents-from-search","title":"Creating Incidents from Search","text":"<p>When you identify artifacts that require a coordinated response:</p> <ol> <li>Select one or more artifacts in the results table</li> <li>Click Create Incident in the toolbar</li> <li>The selected artifacts are attached to a new incident for tracking through the investigation lifecycle</li> </ol>"},{"location":"user-guide/signals/search/#adding-to-work-collections","title":"Adding to Work Collections","text":"<p>Selected artifacts can also be added to an existing work collection in the Observer module:</p> <ol> <li>Select artifacts in the results table</li> <li>Click Add to Collection</li> <li>Choose the target work collection from the dropdown</li> <li>The artifacts are linked to the collection for organized investigation</li> </ol>"},{"location":"user-guide/signals/search/#performance-tips","title":"Performance Tips","text":"<ul> <li>Use specific field filters rather than broad keyword searches</li> <li>Narrow the time range to the smallest window that covers your investigation</li> <li>The search page prefetches the next page of results in the background for faster navigation</li> <li>Results are cached briefly to speed up pagination through the same result set</li> </ul>"}]}