# WitFoo SIEM Analytics - Saved Searches
# Generated from Sigma detection rules via pySigma
# Deploy to default/savedsearches.conf in the WitFoo SIEM app

[WitFoo - Data Destruction]
description = WitFoo Sigma rule 0310bb40-a034-52b0-a7c1-8ebc25af5328: Data Destruction
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="data_destruction" | table clientIP,serverIP,userName,fileName,filePath,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Endpoint Protection Alert]
description = WitFoo Sigma rule 0505792a-a79b-5fcb-96ee-bb82d8f9e895: Endpoint Protection Alert
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="endpoint_protection" | table clientIP,userName,fileName,fileHash,program,action,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Malicious Session Detection]
description = WitFoo Sigma rule 0827c275-02b9-5e34-9258-d6ad77f373e7: Malicious Session Detection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="malicious_session" | table clientIP,serverIP,userName,application,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Policy Violation]
description = WitFoo Sigma rule 0eeb4864-956e-5a11-8cd4-20e3176fe7ae: Policy Violation
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="policy_violation" | table clientIP,userName,application,action,ruleName,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Ransomware Download Indicator]
description = WitFoo Sigma rule 11444b32-1bd8-56d1-817f-e9a82457cf64: Ransomware Download Indicator
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="ransomware_download" | table clientIP,serverIP,fileName,fileHash,uri,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Suricata High Severity Alert]
description = WitFoo Sigma rule 13044d28-8b43-5eb6-9dab-11cd610bfb7e: Suricata High Severity Alert
search = index=witfoo sourcetype="witfoo:artifact" | spath | search streamName="*suricata*" severityCode IN ("1", "2") | table clientIP,serverIP,serverPort,protocol,ruleName,ruleCategory,severityLabel,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - SMB Lateral Movement]
description = WitFoo Sigma rule 162819cf-fcf8-5cb9-a342-4f1834a388e9: SMB Lateral Movement
search = index=witfoo sourcetype="witfoo:artifact" | spath | search serverPort IN ("445", "139") OR streamName IN ("*smb*", "*zeek_smb*") | table clientIP,serverIP,serverPort,userName,fileName,streamName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Cloud Configuration Change]
description = WitFoo Sigma rule 1c1ef0ad-ed2c-5d21-a627-1da2bc33e2b0: Cloud Configuration Change
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="config_change" streamName IN ("*aws*", "*azure*", "*gcp*", "*cloud*") | table clientIP,userName,application,action,severityLabel,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Defense Evasion Activity]
description = WitFoo Sigma rule 2f252d3e-23b1-50f6-9eba-b8165067769d: Defense Evasion Activity
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="defense_evasion" | table clientIP,serverIP,userName,program,action,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Malicious Software Detection]
description = WitFoo Sigma rule 33db94d5-bc40-55e5-a122-803f79293d9e: Malicious Software Detection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="malicious_software" | table clientIP,fileName,fileHash,filePath,program,matchedLeadRules,ruleName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Ransomware Encryption Activity]
description = WitFoo Sigma rule 35ddd011-c568-5bf7-8bc1-3c2c48cb9e01: Ransomware Encryption Activity
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="ransomware_encryption" | table clientIP,serverIP,fileName,filePath,userName,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Unusual Port Activity]
description = WitFoo Sigma rule 38f913d0-eb55-5d2e-8aa7-61eefe219d6a: Unusual Port Activity
search = index=witfoo sourcetype="witfoo:artifact" | spath | search protocol IN ("*TCP*", "*UDP*") NOT (serverPort IN ("443", "8443", "8080", "3389", "5432", "3306", "27017", "6379")) | regex serverPort="^(4[0-9]{4}|[5-9][0-9]{4}|[0-9]{6})$" | table clientIP,serverIP,serverPort,protocol,application
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Indicator of Misconfiguration Match]
description = WitFoo Sigma rule 4005ffe7-c887-5239-a0a6-65076fd215bb: Indicator of Misconfiguration Match
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="iom_match" | table clientIP,serverIP,serverPort,cve,cveDescription,ruleName,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Administrative Account Activity]
description = WitFoo Sigma rule 42447905-4754-53b3-9772-dbe5b8c3d8b7: Administrative Account Activity
search = index=witfoo sourcetype="witfoo:artifact" | spath | search userName IN ("*admin*", "*root*", "*Administrator*") severityLabel IN ("high", "critical") | table clientIP,serverIP,userName,application,action,streamName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Long-Lived Network Connection]
description = WitFoo Sigma rule 4a280e86-419b-5e46-abe9-2df70020709b: Long-Lived Network Connection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="anomalous_behavior" protocol IN ("*TCP*", "*SSL*", "*TLS*") | table clientIP,serverIP,serverPort,protocol,totalBytes,startTimeUTC,endTimeUTC
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Data Exfiltration]
description = WitFoo Sigma rule 4a9c6988-4b05-51d0-b019-fa76a56d3a5a: Data Exfiltration
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="data_exfiltration" | table clientIP,serverIP,userName,totalBytes,protocol,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Zeek Notice Event]
description = WitFoo Sigma rule 4dc0777c-148e-55cf-855a-2a88fcc7f7fc: Zeek Notice Event
search = index=witfoo sourcetype="witfoo:artifact" | spath | search streamName IN ("*zeek_notice*", "*zeek_weird*") | table clientIP,serverIP,serverPort,protocol,ruleName,message,streamName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Suspicious SSL/TLS Certificate]
description = WitFoo Sigma rule 4fe33f21-5e75-572e-9175-7122b6f849bb: Suspicious SSL/TLS Certificate
search = index=witfoo sourcetype="witfoo:artifact" | spath | search (streamName="*zeek*" ruleCategory IN ("*SSL*", "*certificate*", "*X509*")) OR (messageType="ids_event" ruleName IN ("*certificate*", "*self-signed*", "*expired*")) | table clientIP,serverIP,serverPort,fqdn,ruleName,streamName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Threat Event Detection]
description = WitFoo Sigma rule 56287074-cbcd-5d6a-88cc-c7b70db1058a: Threat Event Detection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="threat_event" | table clientIP,serverIP,ruleName,ruleCategory,program,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Data Staging Activity]
description = WitFoo Sigma rule 5d7a00bb-45a8-5123-918e-fbce8d521dcc: Data Staging Activity
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="data_staging" | table clientIP,serverIP,userName,fileName,filePath,totalBytes,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Deprecated TLS Version Usage]
description = WitFoo Sigma rule 67a095d3-2652-56e8-95af-19e63ba1f20c: Deprecated TLS Version Usage
search = index=witfoo sourcetype="witfoo:artifact" | spath | search streamName IN ("*zeek_ssl*", "*tls*") message IN ("*TLSv1.0*", "*TLSv1.1*", "*SSLv3*", "*SSLv2*") | table clientIP,serverIP,serverPort,fqdn,message,streamName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - ICMP Anomaly Detection]
description = WitFoo Sigma rule 6e60bb4d-2021-5b0a-9c2a-f5ac65779aee: ICMP Anomaly Detection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search protocol="ICMP" totalBytes>=1024 | table clientIP,serverIP,totalBytes,streamName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - IDS Event Detection]
description = WitFoo Sigma rule 79c8f7cf-8a02-5ce5-ac03-d1817c3ae0fc: IDS Event Detection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="ids_event" | table clientIP,serverIP,serverPort,ruleName,ruleCategory,severityLabel,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Phishing Email Detection]
description = WitFoo Sigma rule 7a933235-06ec-555f-96ba-3371a531c0e3: Phishing Email Detection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="phishing_email" | table emailFrom,emailTo,emailSubject,clientIP,emailSendingServer,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Anomalous Network Behavior]
description = WitFoo Sigma rule 7d8315be-17f4-5a48-ba1c-565e88a3680f: Anomalous Network Behavior
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="anomalous_behavior" | table clientIP,serverIP,serverPort,protocol,totalBytes,streamName,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Infrastructure Exploit Attempt]
description = WitFoo Sigma rule 89099789-c049-554d-8e43-b5233eee7d83: Infrastructure Exploit Attempt
search = index=witfoo sourcetype="witfoo:artifact" | spath | search | rex field=cve "(?<cveMatch>^CVE-\\d{4}-\\d+)" | eval cveCondition=if(isnotnull(cveMatch), "true", "false") | search messageType="exploit_attempt" OR cveCondition="true" | table clientIP,serverIP,serverPort,cve,cveDescription,uri,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Brute Force Indicator]
description = WitFoo Sigma rule 8aab7806-a54b-59a6-9a1b-9970f42ec97d: Brute Force Indicator
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="auth_failure" severityLabel IN ("high", "critical") | table clientIP,serverIP,userName,application,severityCode,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Service Discovery Activity]
description = WitFoo Sigma rule 8c303506-bd68-5cd6-a98f-944d27bf0e6c: Service Discovery Activity
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="service_discovery" | table clientIP,serverIP,serverPort,protocol,userName,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - C2 Beaconing Activity]
description = WitFoo Sigma rule 8e769ed8-4f63-516c-b5e1-69a8b05f3c5d: C2 Beaconing Activity
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="botnet_connection" | table clientIP,serverIP,serverPort,protocol,streamName,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Port Scan Detection]
description = WitFoo Sigma rule 94e00767-bc73-54ee-891c-0d1133d0ae12: Port Scan Detection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="service_discovery" OR (messageType="ids_event" ruleCategory="*scan*") | table clientIP,serverIP,serverPort,protocol,ruleName,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Degraded Hardware Alert]
description = WitFoo Sigma rule 9c2fd067-2bde-5277-b736-500b2d549772: Degraded Hardware Alert
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="degraded_hardware" | table serverIP,serverHostname,application,message,severityLabel,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Content Filter Match]
description = WitFoo Sigma rule a538c551-98dd-5619-9864-680006f6246e: Content Filter Match
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="content_filter" | table clientIP,serverIP,userName,uri,application,ruleName,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Authentication Failure]
description = WitFoo Sigma rule a5bd8123-efcd-5b32-b876-d25249e8eb1e: Authentication Failure
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="auth_failure" | table clientIP,serverIP,userName,application,streamName,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Financial System Anomaly]
description = WitFoo Sigma rule aa7de010-3e25-50e4-b43e-978e93da0c4e: Financial System Anomaly
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="financial_anomaly" | table clientIP,serverIP,userName,application,action,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Cloud Privilege Escalation]
description = WitFoo Sigma rule af72779c-1803-5f8c-8a5f-4a9552583bec: Cloud Privilege Escalation
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="privilege_escalation" streamName IN ("*aws*", "*azure*", "*gcp*", "*cloud*") | table clientIP,userName,application,action,severityLabel,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - IPS Action Taken]
description = WitFoo Sigma rule b557ee31-1109-58a0-8d48-f5f61961ceb1: IPS Action Taken
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="ids_action" OR action IN ("*block*", "*drop*", "*reset*", "*deny*") | table clientIP,serverIP,serverPort,ruleName,ruleCategory,action,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Unauthorized File Transfer]
description = WitFoo Sigma rule b66c2977-3f6b-5d5f-a90b-f199836711a2: Unauthorized File Transfer
search = index=witfoo sourcetype="witfoo:artifact" | spath | search | rex field=fileName "(?<fileNameMatch>.+)" | eval fileNameCondition=if(isnotnull(fileNameMatch), "true", "false") | search protocol IN ("*FTP*", "*SCP*", "*SFTP*") OR (serverPort IN ("21", "22", "69") fileNameCondition="true") | table clientIP,serverIP,serverPort,protocol,fileName,totalBytes,userName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Botnet Connection]
description = WitFoo Sigma rule bced670e-b1e7-5b9f-9968-917bb708c126: Botnet Connection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="botnet_connection" | table clientIP,serverIP,serverPort,protocol,stixIndicatorIds,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Credential Access Attempt]
description = WitFoo Sigma rule be26a7dc-4b66-55bc-aa4b-e0069b960f9c: Credential Access Attempt
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="credential_access" | table clientIP,serverIP,userName,program,filePath,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - DNS Tunneling Detection]
description = WitFoo Sigma rule c09dc03e-23e0-5d3c-a605-5d9eb632b6c5: DNS Tunneling Detection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search protocol="DNS" | regex fqdn=".{100,}" | table clientIP,serverIP,fqdn,totalBytes,streamName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - NXDOMAIN/DGA Detection]
description = WitFoo Sigma rule c12ff605-8260-5cbb-af5b-8be79d9e36cf: NXDOMAIN/DGA Detection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search protocol="DNS" action IN ("*NXDOMAIN*", "*nxdomain*", "*SERVFAIL*") | table clientIP,fqdn,serverIP,streamName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Service Disruption]
description = WitFoo Sigma rule c3875f59-ef02-50ad-aaa6-cc39dd56d049: Service Disruption
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="service_disruption" | table clientIP,serverIP,application,action,severityLabel,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Blacklisted Process Execution]
description = WitFoo Sigma rule c8597820-be6a-5d34-85dc-e3a2166e2a18: Blacklisted Process Execution
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="blacklisted_process" | table clientIP,userName,program,fileName,filePath,fileHash,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Indicator of Compromise Match]
description = WitFoo Sigma rule cbff388c-58e8-5ada-9528-20bf07c52d9d: Indicator of Compromise Match
search = index=witfoo sourcetype="witfoo:artifact" | spath | search | rex field=stixIndicatorIds "(?<stixIndicatorIdsMatch>.+)" | eval stixIndicatorIdsCondition=if(isnotnull(stixIndicatorIdsMatch), "true", "false") | search messageType="ioc_match" OR stixIndicatorIdsCondition="true" | table clientIP,serverIP,fqdn,fileHash,stixIndicatorIds,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Large Data Transfer]
description = WitFoo Sigma rule cc59abbb-24b0-5a9b-b95c-6b02a7e3f1c2: Large Data Transfer
search = index=witfoo sourcetype="witfoo:artifact" | spath | search totalBytes>=104857600 | table clientIP,serverIP,totalBytes,protocol,application,userName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Suricata ATT&CK Mapped Alert]
description = WitFoo Sigma rule ce08894a-1962-51b2-8370-da3a61953bb2: Suricata ATT&CK Mapped Alert
search = index=witfoo sourcetype="witfoo:artifact" | spath | search streamName="*suricata*" | regex attackTechniqueIds="T\\d{4}" | table clientIP,serverIP,serverPort,ruleName,ruleCategory,attackTechniqueIds,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Non-Standard HTTP/HTTPS Port Usage]
description = WitFoo Sigma rule ce3d5805-5e01-5c1d-8cae-3b475200ed9a: Non-Standard HTTP/HTTPS Port Usage
search = index=witfoo sourcetype="witfoo:artifact" | spath | search application IN ("*HTTP*", "*http*") NOT (serverPort IN ("80", "443", "8080", "8443")) | table clientIP,serverIP,serverPort,application,uri
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Degraded Service Alert]
description = WitFoo Sigma rule cf160da6-924f-5c99-99d6-f9978d0ddbc4: Degraded Service Alert
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="degraded_service" | table serverIP,serverHostname,application,action,message,severityLabel,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Privilege Escalation]
description = WitFoo Sigma rule d134c547-be64-589a-94eb-fe05969ead09: Privilege Escalation
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="privilege_escalation" | table clientIP,serverIP,userName,program,cve,severityLabel,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Malicious Behavior Detection]
description = WitFoo Sigma rule d4d56bc1-240b-58e9-a427-d06211773eee: Malicious Behavior Detection
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="malicious_behavior" | table clientIP,serverIP,program,fileName,fileHash,matchedLeadRules,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Suspicious HTTP POST Exfiltration]
description = WitFoo Sigma rule e71fe11b-3ac4-5762-9689-f129d2ae9207: Suspicious HTTP POST Exfiltration
search = index=witfoo sourcetype="witfoo:artifact" | spath | search action="*POST*" clientBytes>=10485760 | table clientIP,serverIP,uri,clientBytes,application,userName
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Large Outbound Data Transfer]
description = WitFoo Sigma rule f0efba8d-32db-549d-950d-b339bf124348: Large Outbound Data Transfer
search = index=witfoo sourcetype="witfoo:artifact" | spath | search clientBytes>=52428800 | table clientIP,serverIP,clientBytes,totalBytes,protocol,userName,application
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Phishing Link Click]
description = WitFoo Sigma rule f95d4319-a649-5635-be85-f488d8b357c9: Phishing Link Click
search = index=witfoo sourcetype="witfoo:artifact" | spath | search messageType="phishing_click" | table userName,clientIP,uri,emailFrom,emailSubject,matchedLeadRules
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Executable File Transfer Over Network]
description = WitFoo Sigma rule fccc3daa-2075-5253-9cb7-6237a14a4f1f: Executable File Transfer Over Network
search = index=witfoo sourcetype="witfoo:artifact" | spath | search fileName IN ("*.exe", "*.dll", "*.scr", "*.bat", "*.ps1", "*.vbs", "*.msi", "*.elf", "*.sh", "*.py") | table clientIP,serverIP,fileName,fileHash,filePath,totalBytes,uri
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1

[WitFoo - Cloud API Abuse]
description = WitFoo Sigma rule ff214e11-8ed2-52fa-b12f-14b5ef347644: Cloud API Abuse
search = index=witfoo sourcetype="witfoo:artifact" | spath | search streamName IN ("*aws_cloudtrail*", "*azure_activity*", "*gcp_audit*") severityLabel IN ("high", "critical") | table clientIP,userName,application,action,uri,severityLabel
dispatch.earliest_time = -15m
dispatch.latest_time = now
is_scheduled = 1
cron_schedule = */15 * * * *
alert.track = 1
alert.severity = 3
alert.suppress = 1
alert.suppress.period = 1h
disabled = 1
